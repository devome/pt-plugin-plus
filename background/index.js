(function(){"use strict";String.prototype.getQueryString=function(f,s){s==null&&(s="&");var a="(^|"+s+"|\\?)"+f+"=([^"+s+"#]*)("+s+"|#|$)",u=new RegExp(a),l;return(l=this.match(u))?decodeURI(l[2]):null},String.prototype.sizeToNumber=function(){let f=this.match(/^(\d*\.?\d+)(.*[^ZEPTGMK])?([ZEPTGMK](B|iB))$/i);if(f){let s=parseFloat(f[1]),a=f[3];switch(!0){case/Zi?B/i.test(a):return s*Math.pow(2,70);case/Ei?B/i.test(a):return s*Math.pow(2,60);case/Pi?B/i.test(a):return s*Math.pow(2,50);case/Ti?B/i.test(a):return s*Math.pow(2,40);case/Gi?B/i.test(a):return s*Math.pow(2,30);case/Mi?B/i.test(a):return s*Math.pow(2,20);case/Ki?B/i.test(a):return s*Math.pow(2,10);default:return s}}return 0},String.prototype.timeToDays=function(){const s=this.replace(/weeks/ig,"W").replace(/days/ig,"D").replace(/months/ig,"M").replace(/years/ig,"Y").replace(/hours/ig,"H").replace(/\s+/g,"").match(/\d+[天日周月年时DWMYH]/g);let a=0;return s==null?0:(s.forEach(u=>{const l=u.match(/(\d+)([天日周月年时DWMYH])/);if(l==null)return 0;const h=parseInt(l[1]),d=l[2];switch(!0){case d==="D":case d==="天":case d==="日":a+=h;break;case d==="W":case d==="周":a+=h*7;break;case d==="M":case d==="月":a+=h*30;break;case d==="Y":case d==="年":a+=h*365;break;case d==="H":case d==="时":a+=Math.floor(h/24);break}}),a)};var ESizeUnit=(f=>(f.ZiB="ZiB",f.EiB="EiB",f.PiB="PiB",f.TiB="TiB",f.GiB="GiB",f.MiB="MiB",f.KiB="KiB",f))(ESizeUnit||{}),ERequestType=(f=>(f.JSON="json",f.TEXT="urlencode",f))(ERequestType||{}),ERequestResultType=(f=>(f.JSON="json",f.XML="xml",f.HTML="html",f.TEXT="text",f))(ERequestResultType||{}),EDownloadClientType=(f=>(f.transmission="transmission",f.utorrent="utorrent",f.deluge="deluge",f.synologyDownloadStation="synologyDownloadStation",f.rutorrent="rutorrent",f.qbittorrent="qbittorrent",f))(EDownloadClientType||{}),ERequestMethod=(f=>(f.POST="POST",f.GET="GET",f))(ERequestMethod||{}),EAction=(f=>(f.readConfig="readConfig",f.saveConfig="saveConfig",f.reloadConfig="reloadConfig",f.sendTorrentToDefaultClient="sendTorrentToDefaultClient",f.sendTorrentToClient="sendTorrentToClient",f.searchTorrent="searchTorrent",f.copyTextToClipboard="copyTextToClipboard",f.addTorrentFromURL="addTorrentFromURL",f.getFreeSpace="getFreeSpace",f.downloadFromDroper="downloadFromDroper",f.openOptions="openOptions",f.updateOptionsTabId="updateOptionsTabId",f.getSearchResult="getSearchResult",f.getDownloadHistory="getDownloadHistory",f.removeDownloadHistory="removeDownloadHistory",f.clearDownloadHistory="clearDownloadHistory",f.testClientConnectivity="testClientConnectivity",f.getSystemLogs="getSystemLogs",f.removeSystemLogs="removeSystemLogs",f.clearSystemLogs="clearSystemLogs",f.readUIOptions="readUIOptions",f.saveUIOptions="saveUIOptions",f.showMessage="showMessage",f.writeLog="writeLog",f.serviceStoped="serviceStoped",f.addContentPage="addContentPage",f.abortSearch="abortSearch",f.backupToGoogle="backupToGoogle",f.restoreFromGoogle="restoreFromGoogle",f.clearFromGoogle="clearFromGoogle",f.getTorrentDataFromURL="getTorrentDataFromURL",f.getUserInfo="getUserInfo",f.abortGetUserInfo="abortGetUserInfo",f.refreshUserData="refreshUserData",f.getClearedOptions="getClearedOptions",f.resetRunTimeOptions="resetRunTimeOptions",f.getBase64FromImageUrl="getBase64FromImageUrl",f.getUserHistoryData="getUserHistoryData",f.getMovieInfos="getMovieInfos",f.getMovieRatings="getMovieRatings",f.getIMDbIdFromDouban="getIMDbIdFromDouban",f.queryMovieInfoFromDouban="queryMovieInfoFromDouban",f.addBrowserDownloads="addBrowserDownloads",f.checkPermissions="checkPermissions",f.requestPermissions="requestPermissions",f.changeLanguage="changeLanguage",f.getCurrentLanguageResource="getCurrentLanguageResource",f.addLanguage="addLanguage",f.replaceLanguage="replaceLanguage",f.hideMessage="hideMessage",f.resetUserDatas="resetUserDatas",f.backupToServer="backupToServer",f.restoreFromServer="restoreFromServer",f.getBackupListFromServer="getBackupListFromServer",f.deleteFileFromBackupServer="deleteFileFromBackupServer",f.sendTorrentsInBackground="sendTorrentsInBackground",f.createBackupFile="createBackupFile",f.checkBackupData="checkBackupData",f.addTorrentToCollection="addTorrentToCollection",f.getTorrentCollections="getTorrentCollections",f.deleteTorrentFromCollention="deleteTorrentFromCollention",f.clearTorrentCollention="clearTorrentCollention",f.getTorrentCollention="getTorrentCollention",f.getSiteSelectorConfig="getSiteSelectorConfig",f.resetTorrentCollections="resetTorrentCollections",f.getTorrentCollectionGroups="getTorrentCollectionGroups",f.addTorrentCollectionGroup="addTorrentCollectionGroup",f.addTorrentCollectionToGroup="addTorrentCollectionToGroup",f.updateTorrentCollectionGroup="updateTorrentCollectionGroup",f.removeTorrentCollectionFromGroup="removeTorrentCollectionFromGroup",f.removeTorrentCollectionGroup="removeTorrentCollectionGroup",f.updateTorrentCollention="updateTorrentCollention",f.getAllTorrentCollectionLinks="getAllTorrentCollectionLinks",f.restoreCookies="restoreCookies",f.resetFavicons="resetFavicons",f.resetFavicon="resetFavicon",f.getBackupRawData="getBackupRawData",f.testBackupServerConnectivity="testBackupServerConnectivity",f.createSearchResultSnapshot="createSearchResultSnapshot",f.loadSearchResultSnapshot="loadSearchResultSnapshot",f.getSearchResultSnapshot="getSearchResultSnapshot",f.removeSearchResultSnapshot="removeSearchResultSnapshot",f.clearSearchResultSnapshot="clearSearchResultSnapshot",f.resetSearchResultSnapshot="resetSearchResultSnapshot",f.createKeepUploadTask="createKeepUploadTask",f.loadKeepUploadTask="loadKeepUploadTask",f.getKeepUploadTask="getKeepUploadTask",f.removeKeepUploadTask="removeKeepUploadTask",f.clearKeepUploadTask="clearKeepUploadTask",f.resetKeepUploadTask="resetKeepUploadTask",f.updateKeepUploadTask="updateKeepUploadTask",f.resetDownloadHistory="resetDownloadHistory",f.pushDebugMsg="pushDebugMsg",f.updateDebuggerTabId="updateDebuggerTabId",f.getTopSearches="getTopSearches",f))(EAction||{}),EStorageType=(f=>(f.text="TEXT",f.json="JSON",f))(EStorageType||{}),EConfigKey=(f=>(f.default="PT-Plugin-Plus-Config",f.downloadHistory="PT-Plugin-Plus-downloadHistory",f.systemLogs="PT-Plugin-Plus-systemLogs",f.uiOptions="PT-Plugin-Plus-uiOptions",f.cache="PT-Plugin-Plus-Cache-Contents",f.userDatas="PT-Plugin-Plus-User-Datas",f.collection="PT-Plugin-Plus-Collection",f.searchResultSnapshot="PT-Plugin-Plus-SearchResultSnapshot",f.keepUploadTask="PT-Plugin-Plus-KeepUploadTask",f))(EConfigKey||{}),EDataResultType=(f=>(f.success="success",f.error="error",f.info="info",f.warning="warning",f.unknown="unknown",f))(EDataResultType||{}),EModule=(f=>(f.background="background",f.content="content",f.options="options",f.popup="popup",f.debugger="debugger",f))(EModule||{}),ELogEvent=(f=>(f.init="init",f.requestMessage="requestMessage",f))(ELogEvent||{}),EUserDataRange=(f=>(f.latest="latest",f.today="today",f.all="all",f))(EUserDataRange||{}),EUserDataRequestStatus=(f=>(f.needLogin="needLogin",f.notSupported="notSupported",f.unknown="unknown",f.success="success",f))(EUserDataRequestStatus||{}),ECommonKey=(f=>(f.allSite="__allSite__",f.all="__all__",f.noGroup="__noGroup__",f))(ECommonKey||{}),EInstallType=(f=>(f.development="development",f.normal="normal",f.crx="crx",f))(EInstallType||{}),EBeforeSearchingItemSearchMode=(f=>(f.id="id",f.name="name",f))(EBeforeSearchingItemSearchMode||{}),EBackupServerType=(f=>(f.OWSS="OWSS",f.WebDAV="WebDAV",f))(EBackupServerType||{}),EPluginPosition=(f=>(f.left="left",f.right="right",f))(EPluginPosition||{}),EWikiLink=(f=>(f.faq="https://github.com/pt-plugins/PT-Plugin-Plus/wiki/frequently-asked-questions",f))(EWikiLink||{}),EBrowserType=(f=>(f.Chrome="Chrome",f.Firefox="Firefox",f.Edge="Edge",f))(EBrowserType||{}),EResourceOrderBy=(f=>(f.time="time",f.name="name",f.size="size",f))(EResourceOrderBy||{}),EResourceOrderMode=(f=>(f.desc="desc",f.asc="asc",f))(EResourceOrderMode||{}),EEncryptMode=(f=>(f.AES="AES",f))(EEncryptMode||{}),ERestoreError=(f=>(f.needSecretKey="needSecretKey",f.errorSecretKey="errorSecretKey",f))(ERestoreError||{}),EAlarm=(f=>(f.refreshJob="PTPP_RefreshUserData_JOB",f))(EAlarm||{});const BASE_TAG_COLORS={Free:"blue","2xFree":"green","2xUp":"lime","2x50%":"light-green","25%":"purple","30%":"indigo","35%":"indigo darken-3","50%":"orange","70%":"blue-grey","75%":"lime darken-3",VIP:"orange darken-2","⛔️":"deep-orange darken-1"};class localStorage{constructor(){this.isExtensionMode=!1,window.chrome&&chrome.extension&&(this.isExtensionMode=!0)}set(s,a,u=EStorageType.json){return new Promise((l,h)=>{if(this.isExtensionMode){let d={};d[s]=a,chrome.storage.local.set(d,()=>{l()})}else typeof a!="string"&&u==EStorageType.json&&(a=JSON.stringify(a)),window.localStorage.setItem(s,a),l()})}get(s,a,u=EStorageType.json){if(this.isExtensionMode)chrome.storage.local.get(s,l=>{l&&l[s]?a(l[s]):a(null)});else{let l=window.localStorage.getItem(s);l&&u==EStorageType.json&&(l=JSON.parse(l)),a&&a(l)}}}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}function getAugmentedNamespace(f){if(f.__esModule)return f;var s=f.default;if(typeof s=="function"){var a=function u(){return this instanceof u?Reflect.construct(s,arguments,this.constructor):s.apply(this,arguments)};a.prototype=s.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(f).forEach(function(u){var l=Object.getOwnPropertyDescriptor(f,u);Object.defineProperty(a,u,l.get?l:{enumerable:!0,get:function(){return f[u]}})}),a}var cryptoJs={exports:{}};function commonjsRequire(f){throw new Error('Could not dynamically require "'+f+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var core={exports:{}};const path={},__viteBrowserExternal=Object.freeze(Object.defineProperty({__proto__:null,default:path},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(__viteBrowserExternal);var hasRequiredCore;function requireCore(){return hasRequiredCore||(hasRequiredCore=1,function(f,s){(function(a,u){f.exports=u()})(commonjsGlobal,function(){var a=a||function(u,l){var h;if(typeof window<"u"&&window.crypto&&(h=window.crypto),typeof self<"u"&&self.crypto&&(h=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(h=globalThis.crypto),!h&&typeof window<"u"&&window.msCrypto&&(h=window.msCrypto),!h&&typeof commonjsGlobal<"u"&&commonjsGlobal.crypto&&(h=commonjsGlobal.crypto),!h&&typeof commonjsRequire=="function")try{h=require$$0}catch{}var d=function(){if(h){if(typeof h.getRandomValues=="function")try{return h.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof h.randomBytes=="function")try{return h.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},p=Object.create||function(){function _(){}return function(S){var A;return _.prototype=S,A=new _,_.prototype=null,A}}(),y={},g=y.lib={},x=g.Base=function(){return{extend:function(_){var S=p(this);return _&&S.mixIn(_),(!S.hasOwnProperty("init")||this.init===S.init)&&(S.init=function(){S.$super.init.apply(this,arguments)}),S.init.prototype=S,S.$super=this,S},create:function(){var _=this.extend();return _.init.apply(_,arguments),_},init:function(){},mixIn:function(_){for(var S in _)_.hasOwnProperty(S)&&(this[S]=_[S]);_.hasOwnProperty("toString")&&(this.toString=_.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),C=g.WordArray=x.extend({init:function(_,S){_=this.words=_||[],S!=l?this.sigBytes=S:this.sigBytes=_.length*4},toString:function(_){return(_||v).stringify(this)},concat:function(_){var S=this.words,A=_.words,P=this.sigBytes,I=_.sigBytes;if(this.clamp(),P%4)for(var R=0;R<I;R++){var j=A[R>>>2]>>>24-R%4*8&255;S[P+R>>>2]|=j<<24-(P+R)%4*8}else for(var q=0;q<I;q+=4)S[P+q>>>2]=A[q>>>2];return this.sigBytes+=I,this},clamp:function(){var _=this.words,S=this.sigBytes;_[S>>>2]&=4294967295<<32-S%4*8,_.length=u.ceil(S/4)},clone:function(){var _=x.clone.call(this);return _.words=this.words.slice(0),_},random:function(_){for(var S=[],A=0;A<_;A+=4)S.push(d());return new C.init(S,_)}}),m=y.enc={},v=m.Hex={stringify:function(_){for(var S=_.words,A=_.sigBytes,P=[],I=0;I<A;I++){var R=S[I>>>2]>>>24-I%4*8&255;P.push((R>>>4).toString(16)),P.push((R&15).toString(16))}return P.join("")},parse:function(_){for(var S=_.length,A=[],P=0;P<S;P+=2)A[P>>>3]|=parseInt(_.substr(P,2),16)<<24-P%8*4;return new C.init(A,S/2)}},w=m.Latin1={stringify:function(_){for(var S=_.words,A=_.sigBytes,P=[],I=0;I<A;I++){var R=S[I>>>2]>>>24-I%4*8&255;P.push(String.fromCharCode(R))}return P.join("")},parse:function(_){for(var S=_.length,A=[],P=0;P<S;P++)A[P>>>2]|=(_.charCodeAt(P)&255)<<24-P%4*8;return new C.init(A,S)}},b=m.Utf8={stringify:function(_){try{return decodeURIComponent(escape(w.stringify(_)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(_){return w.parse(unescape(encodeURIComponent(_)))}},E=g.BufferedBlockAlgorithm=x.extend({reset:function(){this._data=new C.init,this._nDataBytes=0},_append:function(_){typeof _=="string"&&(_=b.parse(_)),this._data.concat(_),this._nDataBytes+=_.sigBytes},_process:function(_){var S,A=this._data,P=A.words,I=A.sigBytes,R=this.blockSize,j=R*4,q=I/j;_?q=u.ceil(q):q=u.max((q|0)-this._minBufferSize,0);var U=q*R,z=u.min(U*4,I);if(U){for(var L=0;L<U;L+=R)this._doProcessBlock(P,L);S=P.splice(0,U),A.sigBytes-=z}return new C.init(S,z)},clone:function(){var _=x.clone.call(this);return _._data=this._data.clone(),_},_minBufferSize:0});g.Hasher=E.extend({cfg:x.extend(),init:function(_){this.cfg=this.cfg.extend(_),this.reset()},reset:function(){E.reset.call(this),this._doReset()},update:function(_){return this._append(_),this._process(),this},finalize:function(_){_&&this._append(_);var S=this._doFinalize();return S},blockSize:16,_createHelper:function(_){return function(S,A){return new _.init(A).finalize(S)}},_createHmacHelper:function(_){return function(S,A){return new k.HMAC.init(_,A).finalize(S)}}});var k=y.algo={};return y}(Math);return a})}(core)),core.exports}var x64Core={exports:{}},hasRequiredX64Core;function requireX64Core(){return hasRequiredX64Core||(hasRequiredX64Core=1,function(f,s){(function(a,u){f.exports=u(requireCore())})(commonjsGlobal,function(a){return function(u){var l=a,h=l.lib,d=h.Base,p=h.WordArray,y=l.x64={};y.Word=d.extend({init:function(g,x){this.high=g,this.low=x}}),y.WordArray=d.extend({init:function(g,x){g=this.words=g||[],x!=u?this.sigBytes=x:this.sigBytes=g.length*8},toX32:function(){for(var g=this.words,x=g.length,C=[],m=0;m<x;m++){var v=g[m];C.push(v.high),C.push(v.low)}return p.create(C,this.sigBytes)},clone:function(){for(var g=d.clone.call(this),x=g.words=this.words.slice(0),C=x.length,m=0;m<C;m++)x[m]=x[m].clone();return g}})}(),a})}(x64Core)),x64Core.exports}var libTypedarrays={exports:{}},hasRequiredLibTypedarrays;function requireLibTypedarrays(){return hasRequiredLibTypedarrays||(hasRequiredLibTypedarrays=1,function(f,s){(function(a,u){f.exports=u(requireCore())})(commonjsGlobal,function(a){return function(){if(typeof ArrayBuffer=="function"){var u=a,l=u.lib,h=l.WordArray,d=h.init,p=h.init=function(y){if(y instanceof ArrayBuffer&&(y=new Uint8Array(y)),(y instanceof Int8Array||typeof Uint8ClampedArray<"u"&&y instanceof Uint8ClampedArray||y instanceof Int16Array||y instanceof Uint16Array||y instanceof Int32Array||y instanceof Uint32Array||y instanceof Float32Array||y instanceof Float64Array)&&(y=new Uint8Array(y.buffer,y.byteOffset,y.byteLength)),y instanceof Uint8Array){for(var g=y.byteLength,x=[],C=0;C<g;C++)x[C>>>2]|=y[C]<<24-C%4*8;d.call(this,x,g)}else d.apply(this,arguments)};p.prototype=h}}(),a.lib.WordArray})}(libTypedarrays)),libTypedarrays.exports}var encUtf16={exports:{}},hasRequiredEncUtf16;function requireEncUtf16(){return hasRequiredEncUtf16||(hasRequiredEncUtf16=1,function(f,s){(function(a,u){f.exports=u(requireCore())})(commonjsGlobal,function(a){return function(){var u=a,l=u.lib,h=l.WordArray,d=u.enc;d.Utf16=d.Utf16BE={stringify:function(y){for(var g=y.words,x=y.sigBytes,C=[],m=0;m<x;m+=2){var v=g[m>>>2]>>>16-m%4*8&65535;C.push(String.fromCharCode(v))}return C.join("")},parse:function(y){for(var g=y.length,x=[],C=0;C<g;C++)x[C>>>1]|=y.charCodeAt(C)<<16-C%2*16;return h.create(x,g*2)}},d.Utf16LE={stringify:function(y){for(var g=y.words,x=y.sigBytes,C=[],m=0;m<x;m+=2){var v=p(g[m>>>2]>>>16-m%4*8&65535);C.push(String.fromCharCode(v))}return C.join("")},parse:function(y){for(var g=y.length,x=[],C=0;C<g;C++)x[C>>>1]|=p(y.charCodeAt(C)<<16-C%2*16);return h.create(x,g*2)}};function p(y){return y<<8&4278255360|y>>>8&16711935}}(),a.enc.Utf16})}(encUtf16)),encUtf16.exports}var encBase64={exports:{}},hasRequiredEncBase64;function requireEncBase64(){return hasRequiredEncBase64||(hasRequiredEncBase64=1,function(f,s){(function(a,u){f.exports=u(requireCore())})(commonjsGlobal,function(a){return function(){var u=a,l=u.lib,h=l.WordArray,d=u.enc;d.Base64={stringify:function(y){var g=y.words,x=y.sigBytes,C=this._map;y.clamp();for(var m=[],v=0;v<x;v+=3)for(var w=g[v>>>2]>>>24-v%4*8&255,b=g[v+1>>>2]>>>24-(v+1)%4*8&255,E=g[v+2>>>2]>>>24-(v+2)%4*8&255,k=w<<16|b<<8|E,_=0;_<4&&v+_*.75<x;_++)m.push(C.charAt(k>>>6*(3-_)&63));var S=C.charAt(64);if(S)for(;m.length%4;)m.push(S);return m.join("")},parse:function(y){var g=y.length,x=this._map,C=this._reverseMap;if(!C){C=this._reverseMap=[];for(var m=0;m<x.length;m++)C[x.charCodeAt(m)]=m}var v=x.charAt(64);if(v){var w=y.indexOf(v);w!==-1&&(g=w)}return p(y,g,C)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function p(y,g,x){for(var C=[],m=0,v=0;v<g;v++)if(v%4){var w=x[y.charCodeAt(v-1)]<<v%4*2,b=x[y.charCodeAt(v)]>>>6-v%4*2,E=w|b;C[m>>>2]|=E<<24-m%4*8,m++}return h.create(C,m)}}(),a.enc.Base64})}(encBase64)),encBase64.exports}var encBase64url={exports:{}},hasRequiredEncBase64url;function requireEncBase64url(){return hasRequiredEncBase64url||(hasRequiredEncBase64url=1,function(f,s){(function(a,u){f.exports=u(requireCore())})(commonjsGlobal,function(a){return function(){var u=a,l=u.lib,h=l.WordArray,d=u.enc;d.Base64url={stringify:function(y,g){g===void 0&&(g=!0);var x=y.words,C=y.sigBytes,m=g?this._safe_map:this._map;y.clamp();for(var v=[],w=0;w<C;w+=3)for(var b=x[w>>>2]>>>24-w%4*8&255,E=x[w+1>>>2]>>>24-(w+1)%4*8&255,k=x[w+2>>>2]>>>24-(w+2)%4*8&255,_=b<<16|E<<8|k,S=0;S<4&&w+S*.75<C;S++)v.push(m.charAt(_>>>6*(3-S)&63));var A=m.charAt(64);if(A)for(;v.length%4;)v.push(A);return v.join("")},parse:function(y,g){g===void 0&&(g=!0);var x=y.length,C=g?this._safe_map:this._map,m=this._reverseMap;if(!m){m=this._reverseMap=[];for(var v=0;v<C.length;v++)m[C.charCodeAt(v)]=v}var w=C.charAt(64);if(w){var b=y.indexOf(w);b!==-1&&(x=b)}return p(y,x,m)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function p(y,g,x){for(var C=[],m=0,v=0;v<g;v++)if(v%4){var w=x[y.charCodeAt(v-1)]<<v%4*2,b=x[y.charCodeAt(v)]>>>6-v%4*2,E=w|b;C[m>>>2]|=E<<24-m%4*8,m++}return h.create(C,m)}}(),a.enc.Base64url})}(encBase64url)),encBase64url.exports}var md5={exports:{}},hasRequiredMd5;function requireMd5(){return hasRequiredMd5||(hasRequiredMd5=1,function(f,s){(function(a,u){f.exports=u(requireCore())})(commonjsGlobal,function(a){return function(u){var l=a,h=l.lib,d=h.WordArray,p=h.Hasher,y=l.algo,g=[];(function(){for(var b=0;b<64;b++)g[b]=u.abs(u.sin(b+1))*4294967296|0})();var x=y.MD5=p.extend({_doReset:function(){this._hash=new d.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(b,E){for(var k=0;k<16;k++){var _=E+k,S=b[_];b[_]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360}var A=this._hash.words,P=b[E+0],I=b[E+1],R=b[E+2],j=b[E+3],q=b[E+4],U=b[E+5],z=b[E+6],L=b[E+7],N=b[E+8],B=b[E+9],V=b[E+10],se=b[E+11],X=b[E+12],oe=b[E+13],Q=b[E+14],ce=b[E+15],H=A[0],W=A[1],ne=A[2],ee=A[3];H=C(H,W,ne,ee,P,7,g[0]),ee=C(ee,H,W,ne,I,12,g[1]),ne=C(ne,ee,H,W,R,17,g[2]),W=C(W,ne,ee,H,j,22,g[3]),H=C(H,W,ne,ee,q,7,g[4]),ee=C(ee,H,W,ne,U,12,g[5]),ne=C(ne,ee,H,W,z,17,g[6]),W=C(W,ne,ee,H,L,22,g[7]),H=C(H,W,ne,ee,N,7,g[8]),ee=C(ee,H,W,ne,B,12,g[9]),ne=C(ne,ee,H,W,V,17,g[10]),W=C(W,ne,ee,H,se,22,g[11]),H=C(H,W,ne,ee,X,7,g[12]),ee=C(ee,H,W,ne,oe,12,g[13]),ne=C(ne,ee,H,W,Q,17,g[14]),W=C(W,ne,ee,H,ce,22,g[15]),H=m(H,W,ne,ee,I,5,g[16]),ee=m(ee,H,W,ne,z,9,g[17]),ne=m(ne,ee,H,W,se,14,g[18]),W=m(W,ne,ee,H,P,20,g[19]),H=m(H,W,ne,ee,U,5,g[20]),ee=m(ee,H,W,ne,V,9,g[21]),ne=m(ne,ee,H,W,ce,14,g[22]),W=m(W,ne,ee,H,q,20,g[23]),H=m(H,W,ne,ee,B,5,g[24]),ee=m(ee,H,W,ne,Q,9,g[25]),ne=m(ne,ee,H,W,j,14,g[26]),W=m(W,ne,ee,H,N,20,g[27]),H=m(H,W,ne,ee,oe,5,g[28]),ee=m(ee,H,W,ne,R,9,g[29]),ne=m(ne,ee,H,W,L,14,g[30]),W=m(W,ne,ee,H,X,20,g[31]),H=v(H,W,ne,ee,U,4,g[32]),ee=v(ee,H,W,ne,N,11,g[33]),ne=v(ne,ee,H,W,se,16,g[34]),W=v(W,ne,ee,H,Q,23,g[35]),H=v(H,W,ne,ee,I,4,g[36]),ee=v(ee,H,W,ne,q,11,g[37]),ne=v(ne,ee,H,W,L,16,g[38]),W=v(W,ne,ee,H,V,23,g[39]),H=v(H,W,ne,ee,oe,4,g[40]),ee=v(ee,H,W,ne,P,11,g[41]),ne=v(ne,ee,H,W,j,16,g[42]),W=v(W,ne,ee,H,z,23,g[43]),H=v(H,W,ne,ee,B,4,g[44]),ee=v(ee,H,W,ne,X,11,g[45]),ne=v(ne,ee,H,W,ce,16,g[46]),W=v(W,ne,ee,H,R,23,g[47]),H=w(H,W,ne,ee,P,6,g[48]),ee=w(ee,H,W,ne,L,10,g[49]),ne=w(ne,ee,H,W,Q,15,g[50]),W=w(W,ne,ee,H,U,21,g[51]),H=w(H,W,ne,ee,X,6,g[52]),ee=w(ee,H,W,ne,j,10,g[53]),ne=w(ne,ee,H,W,V,15,g[54]),W=w(W,ne,ee,H,I,21,g[55]),H=w(H,W,ne,ee,N,6,g[56]),ee=w(ee,H,W,ne,ce,10,g[57]),ne=w(ne,ee,H,W,z,15,g[58]),W=w(W,ne,ee,H,oe,21,g[59]),H=w(H,W,ne,ee,q,6,g[60]),ee=w(ee,H,W,ne,se,10,g[61]),ne=w(ne,ee,H,W,R,15,g[62]),W=w(W,ne,ee,H,B,21,g[63]),A[0]=A[0]+H|0,A[1]=A[1]+W|0,A[2]=A[2]+ne|0,A[3]=A[3]+ee|0},_doFinalize:function(){var b=this._data,E=b.words,k=this._nDataBytes*8,_=b.sigBytes*8;E[_>>>5]|=128<<24-_%32;var S=u.floor(k/4294967296),A=k;E[(_+64>>>9<<4)+15]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,E[(_+64>>>9<<4)+14]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,b.sigBytes=(E.length+1)*4,this._process();for(var P=this._hash,I=P.words,R=0;R<4;R++){var j=I[R];I[R]=(j<<8|j>>>24)&16711935|(j<<24|j>>>8)&4278255360}return P},clone:function(){var b=p.clone.call(this);return b._hash=this._hash.clone(),b}});function C(b,E,k,_,S,A,P){var I=b+(E&k|~E&_)+S+P;return(I<<A|I>>>32-A)+E}function m(b,E,k,_,S,A,P){var I=b+(E&_|k&~_)+S+P;return(I<<A|I>>>32-A)+E}function v(b,E,k,_,S,A,P){var I=b+(E^k^_)+S+P;return(I<<A|I>>>32-A)+E}function w(b,E,k,_,S,A,P){var I=b+(k^(E|~_))+S+P;return(I<<A|I>>>32-A)+E}l.MD5=p._createHelper(x),l.HmacMD5=p._createHmacHelper(x)}(Math),a.MD5})}(md5)),md5.exports}var sha1={exports:{}},hasRequiredSha1;function requireSha1(){return hasRequiredSha1||(hasRequiredSha1=1,function(f,s){(function(a,u){f.exports=u(requireCore())})(commonjsGlobal,function(a){return function(){var u=a,l=u.lib,h=l.WordArray,d=l.Hasher,p=u.algo,y=[],g=p.SHA1=d.extend({_doReset:function(){this._hash=new h.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(x,C){for(var m=this._hash.words,v=m[0],w=m[1],b=m[2],E=m[3],k=m[4],_=0;_<80;_++){if(_<16)y[_]=x[C+_]|0;else{var S=y[_-3]^y[_-8]^y[_-14]^y[_-16];y[_]=S<<1|S>>>31}var A=(v<<5|v>>>27)+k+y[_];_<20?A+=(w&b|~w&E)+1518500249:_<40?A+=(w^b^E)+1859775393:_<60?A+=(w&b|w&E|b&E)-1894007588:A+=(w^b^E)-899497514,k=E,E=b,b=w<<30|w>>>2,w=v,v=A}m[0]=m[0]+v|0,m[1]=m[1]+w|0,m[2]=m[2]+b|0,m[3]=m[3]+E|0,m[4]=m[4]+k|0},_doFinalize:function(){var x=this._data,C=x.words,m=this._nDataBytes*8,v=x.sigBytes*8;return C[v>>>5]|=128<<24-v%32,C[(v+64>>>9<<4)+14]=Math.floor(m/4294967296),C[(v+64>>>9<<4)+15]=m,x.sigBytes=C.length*4,this._process(),this._hash},clone:function(){var x=d.clone.call(this);return x._hash=this._hash.clone(),x}});u.SHA1=d._createHelper(g),u.HmacSHA1=d._createHmacHelper(g)}(),a.SHA1})}(sha1)),sha1.exports}var sha256={exports:{}},hasRequiredSha256;function requireSha256(){return hasRequiredSha256||(hasRequiredSha256=1,function(f,s){(function(a,u){f.exports=u(requireCore())})(commonjsGlobal,function(a){return function(u){var l=a,h=l.lib,d=h.WordArray,p=h.Hasher,y=l.algo,g=[],x=[];(function(){function v(k){for(var _=u.sqrt(k),S=2;S<=_;S++)if(!(k%S))return!1;return!0}function w(k){return(k-(k|0))*4294967296|0}for(var b=2,E=0;E<64;)v(b)&&(E<8&&(g[E]=w(u.pow(b,1/2))),x[E]=w(u.pow(b,1/3)),E++),b++})();var C=[],m=y.SHA256=p.extend({_doReset:function(){this._hash=new d.init(g.slice(0))},_doProcessBlock:function(v,w){for(var b=this._hash.words,E=b[0],k=b[1],_=b[2],S=b[3],A=b[4],P=b[5],I=b[6],R=b[7],j=0;j<64;j++){if(j<16)C[j]=v[w+j]|0;else{var q=C[j-15],U=(q<<25|q>>>7)^(q<<14|q>>>18)^q>>>3,z=C[j-2],L=(z<<15|z>>>17)^(z<<13|z>>>19)^z>>>10;C[j]=U+C[j-7]+L+C[j-16]}var N=A&P^~A&I,B=E&k^E&_^k&_,V=(E<<30|E>>>2)^(E<<19|E>>>13)^(E<<10|E>>>22),se=(A<<26|A>>>6)^(A<<21|A>>>11)^(A<<7|A>>>25),X=R+se+N+x[j]+C[j],oe=V+B;R=I,I=P,P=A,A=S+X|0,S=_,_=k,k=E,E=X+oe|0}b[0]=b[0]+E|0,b[1]=b[1]+k|0,b[2]=b[2]+_|0,b[3]=b[3]+S|0,b[4]=b[4]+A|0,b[5]=b[5]+P|0,b[6]=b[6]+I|0,b[7]=b[7]+R|0},_doFinalize:function(){var v=this._data,w=v.words,b=this._nDataBytes*8,E=v.sigBytes*8;return w[E>>>5]|=128<<24-E%32,w[(E+64>>>9<<4)+14]=u.floor(b/4294967296),w[(E+64>>>9<<4)+15]=b,v.sigBytes=w.length*4,this._process(),this._hash},clone:function(){var v=p.clone.call(this);return v._hash=this._hash.clone(),v}});l.SHA256=p._createHelper(m),l.HmacSHA256=p._createHmacHelper(m)}(Math),a.SHA256})}(sha256)),sha256.exports}var sha224={exports:{}},hasRequiredSha224;function requireSha224(){return hasRequiredSha224||(hasRequiredSha224=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireSha256())})(commonjsGlobal,function(a){return function(){var u=a,l=u.lib,h=l.WordArray,d=u.algo,p=d.SHA256,y=d.SHA224=p.extend({_doReset:function(){this._hash=new h.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var g=p._doFinalize.call(this);return g.sigBytes-=4,g}});u.SHA224=p._createHelper(y),u.HmacSHA224=p._createHmacHelper(y)}(),a.SHA224})}(sha224)),sha224.exports}var sha512={exports:{}},hasRequiredSha512;function requireSha512(){return hasRequiredSha512||(hasRequiredSha512=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireX64Core())})(commonjsGlobal,function(a){return function(){var u=a,l=u.lib,h=l.Hasher,d=u.x64,p=d.Word,y=d.WordArray,g=u.algo;function x(){return p.create.apply(p,arguments)}var C=[x(1116352408,3609767458),x(1899447441,602891725),x(3049323471,3964484399),x(3921009573,2173295548),x(961987163,4081628472),x(1508970993,3053834265),x(2453635748,2937671579),x(2870763221,3664609560),x(3624381080,2734883394),x(310598401,1164996542),x(607225278,1323610764),x(1426881987,3590304994),x(1925078388,4068182383),x(2162078206,991336113),x(2614888103,633803317),x(3248222580,3479774868),x(3835390401,2666613458),x(4022224774,944711139),x(264347078,2341262773),x(604807628,2007800933),x(770255983,1495990901),x(1249150122,1856431235),x(1555081692,3175218132),x(1996064986,2198950837),x(2554220882,3999719339),x(2821834349,766784016),x(2952996808,2566594879),x(3210313671,3203337956),x(3336571891,1034457026),x(3584528711,2466948901),x(113926993,3758326383),x(338241895,168717936),x(666307205,1188179964),x(773529912,1546045734),x(1294757372,1522805485),x(1396182291,2643833823),x(1695183700,2343527390),x(1986661051,1014477480),x(2177026350,1206759142),x(2456956037,344077627),x(2730485921,1290863460),x(2820302411,3158454273),x(3259730800,3505952657),x(3345764771,106217008),x(3516065817,3606008344),x(3600352804,1432725776),x(4094571909,1467031594),x(275423344,851169720),x(430227734,3100823752),x(506948616,1363258195),x(659060556,3750685593),x(883997877,3785050280),x(958139571,3318307427),x(1322822218,3812723403),x(1537002063,2003034995),x(1747873779,3602036899),x(1955562222,1575990012),x(2024104815,1125592928),x(2227730452,2716904306),x(2361852424,442776044),x(2428436474,593698344),x(2756734187,3733110249),x(3204031479,2999351573),x(3329325298,3815920427),x(3391569614,3928383900),x(3515267271,566280711),x(3940187606,3454069534),x(4118630271,4000239992),x(116418474,1914138554),x(174292421,2731055270),x(289380356,3203993006),x(460393269,320620315),x(685471733,587496836),x(852142971,1086792851),x(1017036298,365543100),x(1126000580,2618297676),x(1288033470,3409855158),x(1501505948,4234509866),x(1607167915,987167468),x(1816402316,1246189591)],m=[];(function(){for(var w=0;w<80;w++)m[w]=x()})();var v=g.SHA512=h.extend({_doReset:function(){this._hash=new y.init([new p.init(1779033703,4089235720),new p.init(3144134277,2227873595),new p.init(1013904242,4271175723),new p.init(2773480762,1595750129),new p.init(1359893119,2917565137),new p.init(2600822924,725511199),new p.init(528734635,4215389547),new p.init(1541459225,327033209)])},_doProcessBlock:function(w,b){for(var E=this._hash.words,k=E[0],_=E[1],S=E[2],A=E[3],P=E[4],I=E[5],R=E[6],j=E[7],q=k.high,U=k.low,z=_.high,L=_.low,N=S.high,B=S.low,V=A.high,se=A.low,X=P.high,oe=P.low,Q=I.high,ce=I.low,H=R.high,W=R.low,ne=j.high,ee=j.low,fe=q,_e=U,Ae=z,ye=L,Se=N,Pe=B,Fe=V,Me=se,De=X,O=oe,le=Q,ae=ce,Y=H,G=W,te=ne,ge=ee,ue=0;ue<80;ue++){var re,he,xe=m[ue];if(ue<16)he=xe.high=w[b+ue*2]|0,re=xe.low=w[b+ue*2+1]|0;else{var pe=m[ue-15],be=pe.high,Ee=pe.low,Ie=(be>>>1|Ee<<31)^(be>>>8|Ee<<24)^be>>>7,Le=(Ee>>>1|be<<31)^(Ee>>>8|be<<24)^(Ee>>>7|be<<25),Ve=m[ue-2],$e=Ve.high,Ze=Ve.low,qe=($e>>>19|Ze<<13)^($e<<3|Ze>>>29)^$e>>>6,rt=(Ze>>>19|$e<<13)^(Ze<<3|$e>>>29)^(Ze>>>6|$e<<26),st=m[ue-7],Je=st.high,ct=st.low,ut=m[ue-16],pt=ut.high,lt=ut.low;re=Le+ct,he=Ie+Je+(re>>>0<Le>>>0?1:0),re=re+rt,he=he+qe+(re>>>0<rt>>>0?1:0),re=re+lt,he=he+pt+(re>>>0<lt>>>0?1:0),xe.high=he,xe.low=re}var ht=De&le^~De&Y,et=O&ae^~O&G,nt=fe&Ae^fe&Se^Ae&Se,Ct=_e&ye^_e&Pe^ye&Pe,Qe=(fe>>>28|_e<<4)^(fe<<30|_e>>>2)^(fe<<25|_e>>>7),gt=(_e>>>28|fe<<4)^(_e<<30|fe>>>2)^(_e<<25|fe>>>7),mt=(De>>>14|O<<18)^(De>>>18|O<<14)^(De<<23|O>>>9),xt=(O>>>14|De<<18)^(O>>>18|De<<14)^(O<<23|De>>>9),vt=C[ue],Pt=vt.high,_t=vt.low,ze=ge+xt,tt=te+mt+(ze>>>0<ge>>>0?1:0),ze=ze+et,tt=tt+ht+(ze>>>0<et>>>0?1:0),ze=ze+_t,tt=tt+Pt+(ze>>>0<_t>>>0?1:0),ze=ze+re,tt=tt+he+(ze>>>0<re>>>0?1:0),ot=gt+Ct,Et=Qe+nt+(ot>>>0<gt>>>0?1:0);te=Y,ge=G,Y=le,G=ae,le=De,ae=O,O=Me+ze|0,De=Fe+tt+(O>>>0<Me>>>0?1:0)|0,Fe=Se,Me=Pe,Se=Ae,Pe=ye,Ae=fe,ye=_e,_e=ze+ot|0,fe=tt+Et+(_e>>>0<ze>>>0?1:0)|0}U=k.low=U+_e,k.high=q+fe+(U>>>0<_e>>>0?1:0),L=_.low=L+ye,_.high=z+Ae+(L>>>0<ye>>>0?1:0),B=S.low=B+Pe,S.high=N+Se+(B>>>0<Pe>>>0?1:0),se=A.low=se+Me,A.high=V+Fe+(se>>>0<Me>>>0?1:0),oe=P.low=oe+O,P.high=X+De+(oe>>>0<O>>>0?1:0),ce=I.low=ce+ae,I.high=Q+le+(ce>>>0<ae>>>0?1:0),W=R.low=W+G,R.high=H+Y+(W>>>0<G>>>0?1:0),ee=j.low=ee+ge,j.high=ne+te+(ee>>>0<ge>>>0?1:0)},_doFinalize:function(){var w=this._data,b=w.words,E=this._nDataBytes*8,k=w.sigBytes*8;b[k>>>5]|=128<<24-k%32,b[(k+128>>>10<<5)+30]=Math.floor(E/4294967296),b[(k+128>>>10<<5)+31]=E,w.sigBytes=b.length*4,this._process();var _=this._hash.toX32();return _},clone:function(){var w=h.clone.call(this);return w._hash=this._hash.clone(),w},blockSize:1024/32});u.SHA512=h._createHelper(v),u.HmacSHA512=h._createHmacHelper(v)}(),a.SHA512})}(sha512)),sha512.exports}var sha384={exports:{}},hasRequiredSha384;function requireSha384(){return hasRequiredSha384||(hasRequiredSha384=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireX64Core(),requireSha512())})(commonjsGlobal,function(a){return function(){var u=a,l=u.x64,h=l.Word,d=l.WordArray,p=u.algo,y=p.SHA512,g=p.SHA384=y.extend({_doReset:function(){this._hash=new d.init([new h.init(3418070365,3238371032),new h.init(1654270250,914150663),new h.init(2438529370,812702999),new h.init(355462360,4144912697),new h.init(1731405415,4290775857),new h.init(2394180231,1750603025),new h.init(3675008525,1694076839),new h.init(1203062813,3204075428)])},_doFinalize:function(){var x=y._doFinalize.call(this);return x.sigBytes-=16,x}});u.SHA384=y._createHelper(g),u.HmacSHA384=y._createHmacHelper(g)}(),a.SHA384})}(sha384)),sha384.exports}var sha3={exports:{}},hasRequiredSha3;function requireSha3(){return hasRequiredSha3||(hasRequiredSha3=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireX64Core())})(commonjsGlobal,function(a){return function(u){var l=a,h=l.lib,d=h.WordArray,p=h.Hasher,y=l.x64,g=y.Word,x=l.algo,C=[],m=[],v=[];(function(){for(var E=1,k=0,_=0;_<24;_++){C[E+5*k]=(_+1)*(_+2)/2%64;var S=k%5,A=(2*E+3*k)%5;E=S,k=A}for(var E=0;E<5;E++)for(var k=0;k<5;k++)m[E+5*k]=k+(2*E+3*k)%5*5;for(var P=1,I=0;I<24;I++){for(var R=0,j=0,q=0;q<7;q++){if(P&1){var U=(1<<q)-1;U<32?j^=1<<U:R^=1<<U-32}P&128?P=P<<1^113:P<<=1}v[I]=g.create(R,j)}})();var w=[];(function(){for(var E=0;E<25;E++)w[E]=g.create()})();var b=x.SHA3=p.extend({cfg:p.cfg.extend({outputLength:512}),_doReset:function(){for(var E=this._state=[],k=0;k<25;k++)E[k]=new g.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(E,k){for(var _=this._state,S=this.blockSize/2,A=0;A<S;A++){var P=E[k+2*A],I=E[k+2*A+1];P=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360,I=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360;var R=_[A];R.high^=I,R.low^=P}for(var j=0;j<24;j++){for(var q=0;q<5;q++){for(var U=0,z=0,L=0;L<5;L++){var R=_[q+5*L];U^=R.high,z^=R.low}var N=w[q];N.high=U,N.low=z}for(var q=0;q<5;q++)for(var B=w[(q+4)%5],V=w[(q+1)%5],se=V.high,X=V.low,U=B.high^(se<<1|X>>>31),z=B.low^(X<<1|se>>>31),L=0;L<5;L++){var R=_[q+5*L];R.high^=U,R.low^=z}for(var oe=1;oe<25;oe++){var U,z,R=_[oe],Q=R.high,ce=R.low,H=C[oe];H<32?(U=Q<<H|ce>>>32-H,z=ce<<H|Q>>>32-H):(U=ce<<H-32|Q>>>64-H,z=Q<<H-32|ce>>>64-H);var W=w[m[oe]];W.high=U,W.low=z}var ne=w[0],ee=_[0];ne.high=ee.high,ne.low=ee.low;for(var q=0;q<5;q++)for(var L=0;L<5;L++){var oe=q+5*L,R=_[oe],fe=w[oe],_e=w[(q+1)%5+5*L],Ae=w[(q+2)%5+5*L];R.high=fe.high^~_e.high&Ae.high,R.low=fe.low^~_e.low&Ae.low}var R=_[0],ye=v[j];R.high^=ye.high,R.low^=ye.low}},_doFinalize:function(){var E=this._data,k=E.words;this._nDataBytes*8;var _=E.sigBytes*8,S=this.blockSize*32;k[_>>>5]|=1<<24-_%32,k[(u.ceil((_+1)/S)*S>>>5)-1]|=128,E.sigBytes=k.length*4,this._process();for(var A=this._state,P=this.cfg.outputLength/8,I=P/8,R=[],j=0;j<I;j++){var q=A[j],U=q.high,z=q.low;U=(U<<8|U>>>24)&16711935|(U<<24|U>>>8)&4278255360,z=(z<<8|z>>>24)&16711935|(z<<24|z>>>8)&4278255360,R.push(z),R.push(U)}return new d.init(R,P)},clone:function(){for(var E=p.clone.call(this),k=E._state=this._state.slice(0),_=0;_<25;_++)k[_]=k[_].clone();return E}});l.SHA3=p._createHelper(b),l.HmacSHA3=p._createHmacHelper(b)}(Math),a.SHA3})}(sha3)),sha3.exports}var ripemd160={exports:{}},hasRequiredRipemd160;function requireRipemd160(){return hasRequiredRipemd160||(hasRequiredRipemd160=1,function(f,s){(function(a,u){f.exports=u(requireCore())})(commonjsGlobal,function(a){/** @preserve
  			(c) 2012 by Cédric Mesnil. All rights reserved.

  			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

  			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
  			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

  			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  			*/return function(u){var l=a,h=l.lib,d=h.WordArray,p=h.Hasher,y=l.algo,g=d.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),x=d.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),C=d.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),m=d.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),v=d.create([0,1518500249,1859775393,2400959708,2840853838]),w=d.create([1352829926,1548603684,1836072691,2053994217,0]),b=y.RIPEMD160=p.extend({_doReset:function(){this._hash=d.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(I,R){for(var j=0;j<16;j++){var q=R+j,U=I[q];I[q]=(U<<8|U>>>24)&16711935|(U<<24|U>>>8)&4278255360}var z=this._hash.words,L=v.words,N=w.words,B=g.words,V=x.words,se=C.words,X=m.words,oe,Q,ce,H,W,ne,ee,fe,_e,Ae;ne=oe=z[0],ee=Q=z[1],fe=ce=z[2],_e=H=z[3],Ae=W=z[4];for(var ye,j=0;j<80;j+=1)ye=oe+I[R+B[j]]|0,j<16?ye+=E(Q,ce,H)+L[0]:j<32?ye+=k(Q,ce,H)+L[1]:j<48?ye+=_(Q,ce,H)+L[2]:j<64?ye+=S(Q,ce,H)+L[3]:ye+=A(Q,ce,H)+L[4],ye=ye|0,ye=P(ye,se[j]),ye=ye+W|0,oe=W,W=H,H=P(ce,10),ce=Q,Q=ye,ye=ne+I[R+V[j]]|0,j<16?ye+=A(ee,fe,_e)+N[0]:j<32?ye+=S(ee,fe,_e)+N[1]:j<48?ye+=_(ee,fe,_e)+N[2]:j<64?ye+=k(ee,fe,_e)+N[3]:ye+=E(ee,fe,_e)+N[4],ye=ye|0,ye=P(ye,X[j]),ye=ye+Ae|0,ne=Ae,Ae=_e,_e=P(fe,10),fe=ee,ee=ye;ye=z[1]+ce+_e|0,z[1]=z[2]+H+Ae|0,z[2]=z[3]+W+ne|0,z[3]=z[4]+oe+ee|0,z[4]=z[0]+Q+fe|0,z[0]=ye},_doFinalize:function(){var I=this._data,R=I.words,j=this._nDataBytes*8,q=I.sigBytes*8;R[q>>>5]|=128<<24-q%32,R[(q+64>>>9<<4)+14]=(j<<8|j>>>24)&16711935|(j<<24|j>>>8)&4278255360,I.sigBytes=(R.length+1)*4,this._process();for(var U=this._hash,z=U.words,L=0;L<5;L++){var N=z[L];z[L]=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360}return U},clone:function(){var I=p.clone.call(this);return I._hash=this._hash.clone(),I}});function E(I,R,j){return I^R^j}function k(I,R,j){return I&R|~I&j}function _(I,R,j){return(I|~R)^j}function S(I,R,j){return I&j|R&~j}function A(I,R,j){return I^(R|~j)}function P(I,R){return I<<R|I>>>32-R}l.RIPEMD160=p._createHelper(b),l.HmacRIPEMD160=p._createHmacHelper(b)}(),a.RIPEMD160})}(ripemd160)),ripemd160.exports}var hmac={exports:{}},hasRequiredHmac;function requireHmac(){return hasRequiredHmac||(hasRequiredHmac=1,function(f,s){(function(a,u){f.exports=u(requireCore())})(commonjsGlobal,function(a){(function(){var u=a,l=u.lib,h=l.Base,d=u.enc,p=d.Utf8,y=u.algo;y.HMAC=h.extend({init:function(g,x){g=this._hasher=new g.init,typeof x=="string"&&(x=p.parse(x));var C=g.blockSize,m=C*4;x.sigBytes>m&&(x=g.finalize(x)),x.clamp();for(var v=this._oKey=x.clone(),w=this._iKey=x.clone(),b=v.words,E=w.words,k=0;k<C;k++)b[k]^=1549556828,E[k]^=909522486;v.sigBytes=w.sigBytes=m,this.reset()},reset:function(){var g=this._hasher;g.reset(),g.update(this._iKey)},update:function(g){return this._hasher.update(g),this},finalize:function(g){var x=this._hasher,C=x.finalize(g);x.reset();var m=x.finalize(this._oKey.clone().concat(C));return m}})})()})}(hmac)),hmac.exports}var pbkdf2={exports:{}},hasRequiredPbkdf2;function requirePbkdf2(){return hasRequiredPbkdf2||(hasRequiredPbkdf2=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireSha256(),requireHmac())})(commonjsGlobal,function(a){return function(){var u=a,l=u.lib,h=l.Base,d=l.WordArray,p=u.algo,y=p.SHA256,g=p.HMAC,x=p.PBKDF2=h.extend({cfg:h.extend({keySize:128/32,hasher:y,iterations:25e4}),init:function(C){this.cfg=this.cfg.extend(C)},compute:function(C,m){for(var v=this.cfg,w=g.create(v.hasher,C),b=d.create(),E=d.create([1]),k=b.words,_=E.words,S=v.keySize,A=v.iterations;k.length<S;){var P=w.update(m).finalize(E);w.reset();for(var I=P.words,R=I.length,j=P,q=1;q<A;q++){j=w.finalize(j),w.reset();for(var U=j.words,z=0;z<R;z++)I[z]^=U[z]}b.concat(P),_[0]++}return b.sigBytes=S*4,b}});u.PBKDF2=function(C,m,v){return x.create(v).compute(C,m)}}(),a.PBKDF2})}(pbkdf2)),pbkdf2.exports}var evpkdf={exports:{}},hasRequiredEvpkdf;function requireEvpkdf(){return hasRequiredEvpkdf||(hasRequiredEvpkdf=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireSha1(),requireHmac())})(commonjsGlobal,function(a){return function(){var u=a,l=u.lib,h=l.Base,d=l.WordArray,p=u.algo,y=p.MD5,g=p.EvpKDF=h.extend({cfg:h.extend({keySize:128/32,hasher:y,iterations:1}),init:function(x){this.cfg=this.cfg.extend(x)},compute:function(x,C){for(var m,v=this.cfg,w=v.hasher.create(),b=d.create(),E=b.words,k=v.keySize,_=v.iterations;E.length<k;){m&&w.update(m),m=w.update(x).finalize(C),w.reset();for(var S=1;S<_;S++)m=w.finalize(m),w.reset();b.concat(m)}return b.sigBytes=k*4,b}});u.EvpKDF=function(x,C,m){return g.create(m).compute(x,C)}}(),a.EvpKDF})}(evpkdf)),evpkdf.exports}var cipherCore={exports:{}},hasRequiredCipherCore;function requireCipherCore(){return hasRequiredCipherCore||(hasRequiredCipherCore=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireEvpkdf())})(commonjsGlobal,function(a){a.lib.Cipher||function(u){var l=a,h=l.lib,d=h.Base,p=h.WordArray,y=h.BufferedBlockAlgorithm,g=l.enc;g.Utf8;var x=g.Base64,C=l.algo,m=C.EvpKDF,v=h.Cipher=y.extend({cfg:d.extend(),createEncryptor:function(U,z){return this.create(this._ENC_XFORM_MODE,U,z)},createDecryptor:function(U,z){return this.create(this._DEC_XFORM_MODE,U,z)},init:function(U,z,L){this.cfg=this.cfg.extend(L),this._xformMode=U,this._key=z,this.reset()},reset:function(){y.reset.call(this),this._doReset()},process:function(U){return this._append(U),this._process()},finalize:function(U){U&&this._append(U);var z=this._doFinalize();return z},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function U(z){return typeof z=="string"?q:I}return function(z){return{encrypt:function(L,N,B){return U(N).encrypt(z,L,N,B)},decrypt:function(L,N,B){return U(N).decrypt(z,L,N,B)}}}}()});h.StreamCipher=v.extend({_doFinalize:function(){var U=this._process(!0);return U},blockSize:1});var w=l.mode={},b=h.BlockCipherMode=d.extend({createEncryptor:function(U,z){return this.Encryptor.create(U,z)},createDecryptor:function(U,z){return this.Decryptor.create(U,z)},init:function(U,z){this._cipher=U,this._iv=z}}),E=w.CBC=function(){var U=b.extend();U.Encryptor=U.extend({processBlock:function(L,N){var B=this._cipher,V=B.blockSize;z.call(this,L,N,V),B.encryptBlock(L,N),this._prevBlock=L.slice(N,N+V)}}),U.Decryptor=U.extend({processBlock:function(L,N){var B=this._cipher,V=B.blockSize,se=L.slice(N,N+V);B.decryptBlock(L,N),z.call(this,L,N,V),this._prevBlock=se}});function z(L,N,B){var V,se=this._iv;se?(V=se,this._iv=u):V=this._prevBlock;for(var X=0;X<B;X++)L[N+X]^=V[X]}return U}(),k=l.pad={},_=k.Pkcs7={pad:function(U,z){for(var L=z*4,N=L-U.sigBytes%L,B=N<<24|N<<16|N<<8|N,V=[],se=0;se<N;se+=4)V.push(B);var X=p.create(V,N);U.concat(X)},unpad:function(U){var z=U.words[U.sigBytes-1>>>2]&255;U.sigBytes-=z}};h.BlockCipher=v.extend({cfg:v.cfg.extend({mode:E,padding:_}),reset:function(){var U;v.reset.call(this);var z=this.cfg,L=z.iv,N=z.mode;this._xformMode==this._ENC_XFORM_MODE?U=N.createEncryptor:(U=N.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==U?this._mode.init(this,L&&L.words):(this._mode=U.call(N,this,L&&L.words),this._mode.__creator=U)},_doProcessBlock:function(U,z){this._mode.processBlock(U,z)},_doFinalize:function(){var U,z=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(z.pad(this._data,this.blockSize),U=this._process(!0)):(U=this._process(!0),z.unpad(U)),U},blockSize:128/32});var S=h.CipherParams=d.extend({init:function(U){this.mixIn(U)},toString:function(U){return(U||this.formatter).stringify(this)}}),A=l.format={},P=A.OpenSSL={stringify:function(U){var z,L=U.ciphertext,N=U.salt;return N?z=p.create([1398893684,1701076831]).concat(N).concat(L):z=L,z.toString(x)},parse:function(U){var z,L=x.parse(U),N=L.words;return N[0]==1398893684&&N[1]==1701076831&&(z=p.create(N.slice(2,4)),N.splice(0,4),L.sigBytes-=16),S.create({ciphertext:L,salt:z})}},I=h.SerializableCipher=d.extend({cfg:d.extend({format:P}),encrypt:function(U,z,L,N){N=this.cfg.extend(N);var B=U.createEncryptor(L,N),V=B.finalize(z),se=B.cfg;return S.create({ciphertext:V,key:L,iv:se.iv,algorithm:U,mode:se.mode,padding:se.padding,blockSize:U.blockSize,formatter:N.format})},decrypt:function(U,z,L,N){N=this.cfg.extend(N),z=this._parse(z,N.format);var B=U.createDecryptor(L,N).finalize(z.ciphertext);return B},_parse:function(U,z){return typeof U=="string"?z.parse(U,this):U}}),R=l.kdf={},j=R.OpenSSL={execute:function(U,z,L,N,B){if(N||(N=p.random(64/8)),B)var V=m.create({keySize:z+L,hasher:B}).compute(U,N);else var V=m.create({keySize:z+L}).compute(U,N);var se=p.create(V.words.slice(z),L*4);return V.sigBytes=z*4,S.create({key:V,iv:se,salt:N})}},q=h.PasswordBasedCipher=I.extend({cfg:I.cfg.extend({kdf:j}),encrypt:function(U,z,L,N){N=this.cfg.extend(N);var B=N.kdf.execute(L,U.keySize,U.ivSize,N.salt,N.hasher);N.iv=B.iv;var V=I.encrypt.call(this,U,z,B.key,N);return V.mixIn(B),V},decrypt:function(U,z,L,N){N=this.cfg.extend(N),z=this._parse(z,N.format);var B=N.kdf.execute(L,U.keySize,U.ivSize,z.salt,N.hasher);N.iv=B.iv;var V=I.decrypt.call(this,U,z,B.key,N);return V}})}()})}(cipherCore)),cipherCore.exports}var modeCfb={exports:{}},hasRequiredModeCfb;function requireModeCfb(){return hasRequiredModeCfb||(hasRequiredModeCfb=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireCipherCore())})(commonjsGlobal,function(a){return a.mode.CFB=function(){var u=a.lib.BlockCipherMode.extend();u.Encryptor=u.extend({processBlock:function(h,d){var p=this._cipher,y=p.blockSize;l.call(this,h,d,y,p),this._prevBlock=h.slice(d,d+y)}}),u.Decryptor=u.extend({processBlock:function(h,d){var p=this._cipher,y=p.blockSize,g=h.slice(d,d+y);l.call(this,h,d,y,p),this._prevBlock=g}});function l(h,d,p,y){var g,x=this._iv;x?(g=x.slice(0),this._iv=void 0):g=this._prevBlock,y.encryptBlock(g,0);for(var C=0;C<p;C++)h[d+C]^=g[C]}return u}(),a.mode.CFB})}(modeCfb)),modeCfb.exports}var modeCtr={exports:{}},hasRequiredModeCtr;function requireModeCtr(){return hasRequiredModeCtr||(hasRequiredModeCtr=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireCipherCore())})(commonjsGlobal,function(a){return a.mode.CTR=function(){var u=a.lib.BlockCipherMode.extend(),l=u.Encryptor=u.extend({processBlock:function(h,d){var p=this._cipher,y=p.blockSize,g=this._iv,x=this._counter;g&&(x=this._counter=g.slice(0),this._iv=void 0);var C=x.slice(0);p.encryptBlock(C,0),x[y-1]=x[y-1]+1|0;for(var m=0;m<y;m++)h[d+m]^=C[m]}});return u.Decryptor=l,u}(),a.mode.CTR})}(modeCtr)),modeCtr.exports}var modeCtrGladman={exports:{}},hasRequiredModeCtrGladman;function requireModeCtrGladman(){return hasRequiredModeCtrGladman||(hasRequiredModeCtrGladman=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireCipherCore())})(commonjsGlobal,function(a){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return a.mode.CTRGladman=function(){var u=a.lib.BlockCipherMode.extend();function l(p){if((p>>24&255)===255){var y=p>>16&255,g=p>>8&255,x=p&255;y===255?(y=0,g===255?(g=0,x===255?x=0:++x):++g):++y,p=0,p+=y<<16,p+=g<<8,p+=x}else p+=1<<24;return p}function h(p){return(p[0]=l(p[0]))===0&&(p[1]=l(p[1])),p}var d=u.Encryptor=u.extend({processBlock:function(p,y){var g=this._cipher,x=g.blockSize,C=this._iv,m=this._counter;C&&(m=this._counter=C.slice(0),this._iv=void 0),h(m);var v=m.slice(0);g.encryptBlock(v,0);for(var w=0;w<x;w++)p[y+w]^=v[w]}});return u.Decryptor=d,u}(),a.mode.CTRGladman})}(modeCtrGladman)),modeCtrGladman.exports}var modeOfb={exports:{}},hasRequiredModeOfb;function requireModeOfb(){return hasRequiredModeOfb||(hasRequiredModeOfb=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireCipherCore())})(commonjsGlobal,function(a){return a.mode.OFB=function(){var u=a.lib.BlockCipherMode.extend(),l=u.Encryptor=u.extend({processBlock:function(h,d){var p=this._cipher,y=p.blockSize,g=this._iv,x=this._keystream;g&&(x=this._keystream=g.slice(0),this._iv=void 0),p.encryptBlock(x,0);for(var C=0;C<y;C++)h[d+C]^=x[C]}});return u.Decryptor=l,u}(),a.mode.OFB})}(modeOfb)),modeOfb.exports}var modeEcb={exports:{}},hasRequiredModeEcb;function requireModeEcb(){return hasRequiredModeEcb||(hasRequiredModeEcb=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireCipherCore())})(commonjsGlobal,function(a){return a.mode.ECB=function(){var u=a.lib.BlockCipherMode.extend();return u.Encryptor=u.extend({processBlock:function(l,h){this._cipher.encryptBlock(l,h)}}),u.Decryptor=u.extend({processBlock:function(l,h){this._cipher.decryptBlock(l,h)}}),u}(),a.mode.ECB})}(modeEcb)),modeEcb.exports}var padAnsix923={exports:{}},hasRequiredPadAnsix923;function requirePadAnsix923(){return hasRequiredPadAnsix923||(hasRequiredPadAnsix923=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireCipherCore())})(commonjsGlobal,function(a){return a.pad.AnsiX923={pad:function(u,l){var h=u.sigBytes,d=l*4,p=d-h%d,y=h+p-1;u.clamp(),u.words[y>>>2]|=p<<24-y%4*8,u.sigBytes+=p},unpad:function(u){var l=u.words[u.sigBytes-1>>>2]&255;u.sigBytes-=l}},a.pad.Ansix923})}(padAnsix923)),padAnsix923.exports}var padIso10126={exports:{}},hasRequiredPadIso10126;function requirePadIso10126(){return hasRequiredPadIso10126||(hasRequiredPadIso10126=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireCipherCore())})(commonjsGlobal,function(a){return a.pad.Iso10126={pad:function(u,l){var h=l*4,d=h-u.sigBytes%h;u.concat(a.lib.WordArray.random(d-1)).concat(a.lib.WordArray.create([d<<24],1))},unpad:function(u){var l=u.words[u.sigBytes-1>>>2]&255;u.sigBytes-=l}},a.pad.Iso10126})}(padIso10126)),padIso10126.exports}var padIso97971={exports:{}},hasRequiredPadIso97971;function requirePadIso97971(){return hasRequiredPadIso97971||(hasRequiredPadIso97971=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireCipherCore())})(commonjsGlobal,function(a){return a.pad.Iso97971={pad:function(u,l){u.concat(a.lib.WordArray.create([2147483648],1)),a.pad.ZeroPadding.pad(u,l)},unpad:function(u){a.pad.ZeroPadding.unpad(u),u.sigBytes--}},a.pad.Iso97971})}(padIso97971)),padIso97971.exports}var padZeropadding={exports:{}},hasRequiredPadZeropadding;function requirePadZeropadding(){return hasRequiredPadZeropadding||(hasRequiredPadZeropadding=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireCipherCore())})(commonjsGlobal,function(a){return a.pad.ZeroPadding={pad:function(u,l){var h=l*4;u.clamp(),u.sigBytes+=h-(u.sigBytes%h||h)},unpad:function(u){for(var l=u.words,h=u.sigBytes-1,h=u.sigBytes-1;h>=0;h--)if(l[h>>>2]>>>24-h%4*8&255){u.sigBytes=h+1;break}}},a.pad.ZeroPadding})}(padZeropadding)),padZeropadding.exports}var padNopadding={exports:{}},hasRequiredPadNopadding;function requirePadNopadding(){return hasRequiredPadNopadding||(hasRequiredPadNopadding=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireCipherCore())})(commonjsGlobal,function(a){return a.pad.NoPadding={pad:function(){},unpad:function(){}},a.pad.NoPadding})}(padNopadding)),padNopadding.exports}var formatHex={exports:{}},hasRequiredFormatHex;function requireFormatHex(){return hasRequiredFormatHex||(hasRequiredFormatHex=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireCipherCore())})(commonjsGlobal,function(a){return function(u){var l=a,h=l.lib,d=h.CipherParams,p=l.enc,y=p.Hex,g=l.format;g.Hex={stringify:function(x){return x.ciphertext.toString(y)},parse:function(x){var C=y.parse(x);return d.create({ciphertext:C})}}}(),a.format.Hex})}(formatHex)),formatHex.exports}var aes={exports:{}},hasRequiredAes;function requireAes(){return hasRequiredAes||(hasRequiredAes=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(commonjsGlobal,function(a){return function(){var u=a,l=u.lib,h=l.BlockCipher,d=u.algo,p=[],y=[],g=[],x=[],C=[],m=[],v=[],w=[],b=[],E=[];(function(){for(var S=[],A=0;A<256;A++)A<128?S[A]=A<<1:S[A]=A<<1^283;for(var P=0,I=0,A=0;A<256;A++){var R=I^I<<1^I<<2^I<<3^I<<4;R=R>>>8^R&255^99,p[P]=R,y[R]=P;var j=S[P],q=S[j],U=S[q],z=S[R]*257^R*16843008;g[P]=z<<24|z>>>8,x[P]=z<<16|z>>>16,C[P]=z<<8|z>>>24,m[P]=z;var z=U*16843009^q*65537^j*257^P*16843008;v[R]=z<<24|z>>>8,w[R]=z<<16|z>>>16,b[R]=z<<8|z>>>24,E[R]=z,P?(P=j^S[S[S[U^j]]],I^=S[S[I]]):P=I=1}})();var k=[0,1,2,4,8,16,32,64,128,27,54],_=d.AES=h.extend({_doReset:function(){var S;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var A=this._keyPriorReset=this._key,P=A.words,I=A.sigBytes/4,R=this._nRounds=I+6,j=(R+1)*4,q=this._keySchedule=[],U=0;U<j;U++)U<I?q[U]=P[U]:(S=q[U-1],U%I?I>6&&U%I==4&&(S=p[S>>>24]<<24|p[S>>>16&255]<<16|p[S>>>8&255]<<8|p[S&255]):(S=S<<8|S>>>24,S=p[S>>>24]<<24|p[S>>>16&255]<<16|p[S>>>8&255]<<8|p[S&255],S^=k[U/I|0]<<24),q[U]=q[U-I]^S);for(var z=this._invKeySchedule=[],L=0;L<j;L++){var U=j-L;if(L%4)var S=q[U];else var S=q[U-4];L<4||U<=4?z[L]=S:z[L]=v[p[S>>>24]]^w[p[S>>>16&255]]^b[p[S>>>8&255]]^E[p[S&255]]}}},encryptBlock:function(S,A){this._doCryptBlock(S,A,this._keySchedule,g,x,C,m,p)},decryptBlock:function(S,A){var P=S[A+1];S[A+1]=S[A+3],S[A+3]=P,this._doCryptBlock(S,A,this._invKeySchedule,v,w,b,E,y);var P=S[A+1];S[A+1]=S[A+3],S[A+3]=P},_doCryptBlock:function(S,A,P,I,R,j,q,U){for(var z=this._nRounds,L=S[A]^P[0],N=S[A+1]^P[1],B=S[A+2]^P[2],V=S[A+3]^P[3],se=4,X=1;X<z;X++){var oe=I[L>>>24]^R[N>>>16&255]^j[B>>>8&255]^q[V&255]^P[se++],Q=I[N>>>24]^R[B>>>16&255]^j[V>>>8&255]^q[L&255]^P[se++],ce=I[B>>>24]^R[V>>>16&255]^j[L>>>8&255]^q[N&255]^P[se++],H=I[V>>>24]^R[L>>>16&255]^j[N>>>8&255]^q[B&255]^P[se++];L=oe,N=Q,B=ce,V=H}var oe=(U[L>>>24]<<24|U[N>>>16&255]<<16|U[B>>>8&255]<<8|U[V&255])^P[se++],Q=(U[N>>>24]<<24|U[B>>>16&255]<<16|U[V>>>8&255]<<8|U[L&255])^P[se++],ce=(U[B>>>24]<<24|U[V>>>16&255]<<16|U[L>>>8&255]<<8|U[N&255])^P[se++],H=(U[V>>>24]<<24|U[L>>>16&255]<<16|U[N>>>8&255]<<8|U[B&255])^P[se++];S[A]=oe,S[A+1]=Q,S[A+2]=ce,S[A+3]=H},keySize:256/32});u.AES=h._createHelper(_)}(),a.AES})}(aes)),aes.exports}var tripledes={exports:{}},hasRequiredTripledes;function requireTripledes(){return hasRequiredTripledes||(hasRequiredTripledes=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(commonjsGlobal,function(a){return function(){var u=a,l=u.lib,h=l.WordArray,d=l.BlockCipher,p=u.algo,y=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],g=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],x=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],C=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],m=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],v=p.DES=d.extend({_doReset:function(){for(var k=this._key,_=k.words,S=[],A=0;A<56;A++){var P=y[A]-1;S[A]=_[P>>>5]>>>31-P%32&1}for(var I=this._subKeys=[],R=0;R<16;R++){for(var j=I[R]=[],q=x[R],A=0;A<24;A++)j[A/6|0]|=S[(g[A]-1+q)%28]<<31-A%6,j[4+(A/6|0)]|=S[28+(g[A+24]-1+q)%28]<<31-A%6;j[0]=j[0]<<1|j[0]>>>31;for(var A=1;A<7;A++)j[A]=j[A]>>>(A-1)*4+3;j[7]=j[7]<<5|j[7]>>>27}for(var U=this._invSubKeys=[],A=0;A<16;A++)U[A]=I[15-A]},encryptBlock:function(k,_){this._doCryptBlock(k,_,this._subKeys)},decryptBlock:function(k,_){this._doCryptBlock(k,_,this._invSubKeys)},_doCryptBlock:function(k,_,S){this._lBlock=k[_],this._rBlock=k[_+1],w.call(this,4,252645135),w.call(this,16,65535),b.call(this,2,858993459),b.call(this,8,16711935),w.call(this,1,1431655765);for(var A=0;A<16;A++){for(var P=S[A],I=this._lBlock,R=this._rBlock,j=0,q=0;q<8;q++)j|=C[q][((R^P[q])&m[q])>>>0];this._lBlock=R,this._rBlock=I^j}var U=this._lBlock;this._lBlock=this._rBlock,this._rBlock=U,w.call(this,1,1431655765),b.call(this,8,16711935),b.call(this,2,858993459),w.call(this,16,65535),w.call(this,4,252645135),k[_]=this._lBlock,k[_+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function w(k,_){var S=(this._lBlock>>>k^this._rBlock)&_;this._rBlock^=S,this._lBlock^=S<<k}function b(k,_){var S=(this._rBlock>>>k^this._lBlock)&_;this._lBlock^=S,this._rBlock^=S<<k}u.DES=d._createHelper(v);var E=p.TripleDES=d.extend({_doReset:function(){var k=this._key,_=k.words;if(_.length!==2&&_.length!==4&&_.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var S=_.slice(0,2),A=_.length<4?_.slice(0,2):_.slice(2,4),P=_.length<6?_.slice(0,2):_.slice(4,6);this._des1=v.createEncryptor(h.create(S)),this._des2=v.createEncryptor(h.create(A)),this._des3=v.createEncryptor(h.create(P))},encryptBlock:function(k,_){this._des1.encryptBlock(k,_),this._des2.decryptBlock(k,_),this._des3.encryptBlock(k,_)},decryptBlock:function(k,_){this._des3.decryptBlock(k,_),this._des2.encryptBlock(k,_),this._des1.decryptBlock(k,_)},keySize:192/32,ivSize:64/32,blockSize:64/32});u.TripleDES=d._createHelper(E)}(),a.TripleDES})}(tripledes)),tripledes.exports}var rc4={exports:{}},hasRequiredRc4;function requireRc4(){return hasRequiredRc4||(hasRequiredRc4=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(commonjsGlobal,function(a){return function(){var u=a,l=u.lib,h=l.StreamCipher,d=u.algo,p=d.RC4=h.extend({_doReset:function(){for(var x=this._key,C=x.words,m=x.sigBytes,v=this._S=[],w=0;w<256;w++)v[w]=w;for(var w=0,b=0;w<256;w++){var E=w%m,k=C[E>>>2]>>>24-E%4*8&255;b=(b+v[w]+k)%256;var _=v[w];v[w]=v[b],v[b]=_}this._i=this._j=0},_doProcessBlock:function(x,C){x[C]^=y.call(this)},keySize:256/32,ivSize:0});function y(){for(var x=this._S,C=this._i,m=this._j,v=0,w=0;w<4;w++){C=(C+1)%256,m=(m+x[C])%256;var b=x[C];x[C]=x[m],x[m]=b,v|=x[(x[C]+x[m])%256]<<24-w*8}return this._i=C,this._j=m,v}u.RC4=h._createHelper(p);var g=d.RC4Drop=p.extend({cfg:p.cfg.extend({drop:192}),_doReset:function(){p._doReset.call(this);for(var x=this.cfg.drop;x>0;x--)y.call(this)}});u.RC4Drop=h._createHelper(g)}(),a.RC4})}(rc4)),rc4.exports}var rabbit={exports:{}},hasRequiredRabbit;function requireRabbit(){return hasRequiredRabbit||(hasRequiredRabbit=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(commonjsGlobal,function(a){return function(){var u=a,l=u.lib,h=l.StreamCipher,d=u.algo,p=[],y=[],g=[],x=d.Rabbit=h.extend({_doReset:function(){for(var m=this._key.words,v=this.cfg.iv,w=0;w<4;w++)m[w]=(m[w]<<8|m[w]>>>24)&16711935|(m[w]<<24|m[w]>>>8)&4278255360;var b=this._X=[m[0],m[3]<<16|m[2]>>>16,m[1],m[0]<<16|m[3]>>>16,m[2],m[1]<<16|m[0]>>>16,m[3],m[2]<<16|m[1]>>>16],E=this._C=[m[2]<<16|m[2]>>>16,m[0]&4294901760|m[1]&65535,m[3]<<16|m[3]>>>16,m[1]&4294901760|m[2]&65535,m[0]<<16|m[0]>>>16,m[2]&4294901760|m[3]&65535,m[1]<<16|m[1]>>>16,m[3]&4294901760|m[0]&65535];this._b=0;for(var w=0;w<4;w++)C.call(this);for(var w=0;w<8;w++)E[w]^=b[w+4&7];if(v){var k=v.words,_=k[0],S=k[1],A=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,P=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,I=A>>>16|P&4294901760,R=P<<16|A&65535;E[0]^=A,E[1]^=I,E[2]^=P,E[3]^=R,E[4]^=A,E[5]^=I,E[6]^=P,E[7]^=R;for(var w=0;w<4;w++)C.call(this)}},_doProcessBlock:function(m,v){var w=this._X;C.call(this),p[0]=w[0]^w[5]>>>16^w[3]<<16,p[1]=w[2]^w[7]>>>16^w[5]<<16,p[2]=w[4]^w[1]>>>16^w[7]<<16,p[3]=w[6]^w[3]>>>16^w[1]<<16;for(var b=0;b<4;b++)p[b]=(p[b]<<8|p[b]>>>24)&16711935|(p[b]<<24|p[b]>>>8)&4278255360,m[v+b]^=p[b]},blockSize:128/32,ivSize:64/32});function C(){for(var m=this._X,v=this._C,w=0;w<8;w++)y[w]=v[w];v[0]=v[0]+1295307597+this._b|0,v[1]=v[1]+3545052371+(v[0]>>>0<y[0]>>>0?1:0)|0,v[2]=v[2]+886263092+(v[1]>>>0<y[1]>>>0?1:0)|0,v[3]=v[3]+1295307597+(v[2]>>>0<y[2]>>>0?1:0)|0,v[4]=v[4]+3545052371+(v[3]>>>0<y[3]>>>0?1:0)|0,v[5]=v[5]+886263092+(v[4]>>>0<y[4]>>>0?1:0)|0,v[6]=v[6]+1295307597+(v[5]>>>0<y[5]>>>0?1:0)|0,v[7]=v[7]+3545052371+(v[6]>>>0<y[6]>>>0?1:0)|0,this._b=v[7]>>>0<y[7]>>>0?1:0;for(var w=0;w<8;w++){var b=m[w]+v[w],E=b&65535,k=b>>>16,_=((E*E>>>17)+E*k>>>15)+k*k,S=((b&4294901760)*b|0)+((b&65535)*b|0);g[w]=_^S}m[0]=g[0]+(g[7]<<16|g[7]>>>16)+(g[6]<<16|g[6]>>>16)|0,m[1]=g[1]+(g[0]<<8|g[0]>>>24)+g[7]|0,m[2]=g[2]+(g[1]<<16|g[1]>>>16)+(g[0]<<16|g[0]>>>16)|0,m[3]=g[3]+(g[2]<<8|g[2]>>>24)+g[1]|0,m[4]=g[4]+(g[3]<<16|g[3]>>>16)+(g[2]<<16|g[2]>>>16)|0,m[5]=g[5]+(g[4]<<8|g[4]>>>24)+g[3]|0,m[6]=g[6]+(g[5]<<16|g[5]>>>16)+(g[4]<<16|g[4]>>>16)|0,m[7]=g[7]+(g[6]<<8|g[6]>>>24)+g[5]|0}u.Rabbit=h._createHelper(x)}(),a.Rabbit})}(rabbit)),rabbit.exports}var rabbitLegacy={exports:{}},hasRequiredRabbitLegacy;function requireRabbitLegacy(){return hasRequiredRabbitLegacy||(hasRequiredRabbitLegacy=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(commonjsGlobal,function(a){return function(){var u=a,l=u.lib,h=l.StreamCipher,d=u.algo,p=[],y=[],g=[],x=d.RabbitLegacy=h.extend({_doReset:function(){var m=this._key.words,v=this.cfg.iv,w=this._X=[m[0],m[3]<<16|m[2]>>>16,m[1],m[0]<<16|m[3]>>>16,m[2],m[1]<<16|m[0]>>>16,m[3],m[2]<<16|m[1]>>>16],b=this._C=[m[2]<<16|m[2]>>>16,m[0]&4294901760|m[1]&65535,m[3]<<16|m[3]>>>16,m[1]&4294901760|m[2]&65535,m[0]<<16|m[0]>>>16,m[2]&4294901760|m[3]&65535,m[1]<<16|m[1]>>>16,m[3]&4294901760|m[0]&65535];this._b=0;for(var E=0;E<4;E++)C.call(this);for(var E=0;E<8;E++)b[E]^=w[E+4&7];if(v){var k=v.words,_=k[0],S=k[1],A=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,P=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,I=A>>>16|P&4294901760,R=P<<16|A&65535;b[0]^=A,b[1]^=I,b[2]^=P,b[3]^=R,b[4]^=A,b[5]^=I,b[6]^=P,b[7]^=R;for(var E=0;E<4;E++)C.call(this)}},_doProcessBlock:function(m,v){var w=this._X;C.call(this),p[0]=w[0]^w[5]>>>16^w[3]<<16,p[1]=w[2]^w[7]>>>16^w[5]<<16,p[2]=w[4]^w[1]>>>16^w[7]<<16,p[3]=w[6]^w[3]>>>16^w[1]<<16;for(var b=0;b<4;b++)p[b]=(p[b]<<8|p[b]>>>24)&16711935|(p[b]<<24|p[b]>>>8)&4278255360,m[v+b]^=p[b]},blockSize:128/32,ivSize:64/32});function C(){for(var m=this._X,v=this._C,w=0;w<8;w++)y[w]=v[w];v[0]=v[0]+1295307597+this._b|0,v[1]=v[1]+3545052371+(v[0]>>>0<y[0]>>>0?1:0)|0,v[2]=v[2]+886263092+(v[1]>>>0<y[1]>>>0?1:0)|0,v[3]=v[3]+1295307597+(v[2]>>>0<y[2]>>>0?1:0)|0,v[4]=v[4]+3545052371+(v[3]>>>0<y[3]>>>0?1:0)|0,v[5]=v[5]+886263092+(v[4]>>>0<y[4]>>>0?1:0)|0,v[6]=v[6]+1295307597+(v[5]>>>0<y[5]>>>0?1:0)|0,v[7]=v[7]+3545052371+(v[6]>>>0<y[6]>>>0?1:0)|0,this._b=v[7]>>>0<y[7]>>>0?1:0;for(var w=0;w<8;w++){var b=m[w]+v[w],E=b&65535,k=b>>>16,_=((E*E>>>17)+E*k>>>15)+k*k,S=((b&4294901760)*b|0)+((b&65535)*b|0);g[w]=_^S}m[0]=g[0]+(g[7]<<16|g[7]>>>16)+(g[6]<<16|g[6]>>>16)|0,m[1]=g[1]+(g[0]<<8|g[0]>>>24)+g[7]|0,m[2]=g[2]+(g[1]<<16|g[1]>>>16)+(g[0]<<16|g[0]>>>16)|0,m[3]=g[3]+(g[2]<<8|g[2]>>>24)+g[1]|0,m[4]=g[4]+(g[3]<<16|g[3]>>>16)+(g[2]<<16|g[2]>>>16)|0,m[5]=g[5]+(g[4]<<8|g[4]>>>24)+g[3]|0,m[6]=g[6]+(g[5]<<16|g[5]>>>16)+(g[4]<<16|g[4]>>>16)|0,m[7]=g[7]+(g[6]<<8|g[6]>>>24)+g[5]|0}u.RabbitLegacy=h._createHelper(x)}(),a.RabbitLegacy})}(rabbitLegacy)),rabbitLegacy.exports}var blowfish={exports:{}},hasRequiredBlowfish;function requireBlowfish(){return hasRequiredBlowfish||(hasRequiredBlowfish=1,function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(commonjsGlobal,function(a){return function(){var u=a,l=u.lib,h=l.BlockCipher,d=u.algo;const p=16,y=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],g=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var x={pbox:[],sbox:[]};function C(E,k){let _=k>>24&255,S=k>>16&255,A=k>>8&255,P=k&255,I=E.sbox[0][_]+E.sbox[1][S];return I=I^E.sbox[2][A],I=I+E.sbox[3][P],I}function m(E,k,_){let S=k,A=_,P;for(let I=0;I<p;++I)S=S^E.pbox[I],A=C(E,S)^A,P=S,S=A,A=P;return P=S,S=A,A=P,A=A^E.pbox[p],S=S^E.pbox[p+1],{left:S,right:A}}function v(E,k,_){let S=k,A=_,P;for(let I=p+1;I>1;--I)S=S^E.pbox[I],A=C(E,S)^A,P=S,S=A,A=P;return P=S,S=A,A=P,A=A^E.pbox[1],S=S^E.pbox[0],{left:S,right:A}}function w(E,k,_){for(let R=0;R<4;R++){E.sbox[R]=[];for(let j=0;j<256;j++)E.sbox[R][j]=g[R][j]}let S=0;for(let R=0;R<p+2;R++)E.pbox[R]=y[R]^k[S],S++,S>=_&&(S=0);let A=0,P=0,I=0;for(let R=0;R<p+2;R+=2)I=m(E,A,P),A=I.left,P=I.right,E.pbox[R]=A,E.pbox[R+1]=P;for(let R=0;R<4;R++)for(let j=0;j<256;j+=2)I=m(E,A,P),A=I.left,P=I.right,E.sbox[R][j]=A,E.sbox[R][j+1]=P;return!0}var b=d.Blowfish=h.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var E=this._keyPriorReset=this._key,k=E.words,_=E.sigBytes/4;w(x,k,_)}},encryptBlock:function(E,k){var _=m(x,E[k],E[k+1]);E[k]=_.left,E[k+1]=_.right},decryptBlock:function(E,k){var _=v(x,E[k],E[k+1]);E[k]=_.left,E[k+1]=_.right},blockSize:64/32,keySize:128/32,ivSize:64/32});u.Blowfish=h._createHelper(b)}(),a.Blowfish})}(blowfish)),blowfish.exports}(function(f,s){(function(a,u,l){f.exports=u(requireCore(),requireX64Core(),requireLibTypedarrays(),requireEncUtf16(),requireEncBase64(),requireEncBase64url(),requireMd5(),requireSha1(),requireSha256(),requireSha224(),requireSha512(),requireSha384(),requireSha3(),requireRipemd160(),requireHmac(),requirePbkdf2(),requireEvpkdf(),requireCipherCore(),requireModeCfb(),requireModeCtr(),requireModeCtrGladman(),requireModeOfb(),requireModeEcb(),requirePadAnsix923(),requirePadIso10126(),requirePadIso97971(),requirePadZeropadding(),requirePadNopadding(),requireFormatHex(),requireAes(),requireTripledes(),requireRc4(),requireRabbit(),requireRabbitLegacy(),requireBlowfish())})(commonjsGlobal,function(a){return a})})(cryptoJs);var cryptoJsExports=cryptoJs.exports,basicContext_min={exports:{}};(function(f){(function(s,a){f.exports?f.exports=a():window[s]=a()})("basicContext",function(){var s=null,a="item",u="separator",l=function(){var w=arguments.length<=0||arguments[0]===void 0?"":arguments[0];return document.querySelector(".basicContext "+w)},h=function(){var w=arguments.length<=0||arguments[0]===void 0?{}:arguments[0],b=Object.keys(w).length===0;return b===!0&&(w.type=u),w.type==null&&(w.type=a),w.class==null&&(w.class=""),w.visible!==!1&&(w.visible=!0),w.icon==null&&(w.icon=null),w.title==null&&(w.title="Undefined"),w.disabled!==!0&&(w.disabled=!1),w.disabled===!0&&(w.class+=" basicContext__item--disabled"),w.fn==null&&w.type!==u&&w.disabled===!1?(console.warn("Missing fn for item '"+w.title+"'"),!1):!0},d=function(w,b){var E="",k="";return h(w)===!1||w.visible===!1?"":(w.num=b,w.icon!==null&&(k="<span class='basicContext__icon "+w.icon+"'></span>"),w.type===a?E=`
		       <tr class='basicContext__item `+w.class+`'>
		           <td class='basicContext__data' data-num='`+w.num+"'>"+k+w.title+`</td>
		       </tr>
		       `:w.type===u&&(E=`
		       <tr class='basicContext__item basicContext__item--separator'></tr>
		       `),E)},p=function(w){var b="";return b+=`
	        <div class='basicContextContainer'>
	            <div class='basicContext'>
	                <table>
	                    <tbody>
	        `,w.forEach(function(E,k){return b+=d(E,k)}),b+=`
	                    </tbody>
	                </table>
	            </div>
	        </div>
	        `},y=function(){var w=arguments.length<=0||arguments[0]===void 0?{}:arguments[0],b={x:w.clientX,y:w.clientY};if(w.type==="touchend"&&(b.x==null||b.y==null)){var E=w.changedTouches;E!=null&&E.length>0&&(b.x=E[0].clientX,b.y=E[0].clientY)}return(b.x==null||b.x<0)&&(b.x=0),(b.y==null||b.y<0)&&(b.y=0),b},g=function(w,b){var E=y(w),k=E.x,_=E.y,S={width:window.innerWidth,height:window.innerHeight},A={width:b.offsetWidth,height:b.offsetHeight};k+A.width>S.width&&(k-=k+A.width-S.width),_+A.height>S.height&&(_-=_+A.height-S.height),A.height>S.height&&(_=0,b.classList.add("basicContext--scrollable"));var P=E.x-k,I=E.y-_;return{x:k,y:_,rx:P,ry:I}},x=function(){var w=arguments.length<=0||arguments[0]===void 0?{}:arguments[0];return w.fn==null||w.visible===!1||w.disabled===!0?!1:(l("td[data-num='"+w.num+"']").onclick=w.fn,l("td[data-num='"+w.num+"']").oncontextmenu=w.fn,!0)},C=function(w,b,E,k){var _=p(w);document.body.insertAdjacentHTML("beforeend",_),s==null&&(s=document.body.style.overflow,document.body.style.overflow="hidden");var S=l(),A=g(b,S);return S.style.left=A.x+"px",S.style.top=A.y+"px",S.style.transformOrigin=A.rx+"px "+A.ry+"px",S.style.opacity=1,E==null&&(E=v),S.parentElement.onclick=E,S.parentElement.oncontextmenu=E,w.forEach(x),typeof b.preventDefault=="function"&&b.preventDefault(),typeof b.stopPropagation=="function"&&b.stopPropagation(),typeof k=="function"&&k(),!0},m=function(){var w=l();return!(w==null||w.length===0)},v=function(){if(m()===!1)return!1;var w=document.querySelector(".basicContextContainer");return w.parentElement.removeChild(w),s!=null&&(document.body.style.overflow=s,s=null),!0};return{ITEM:a,SEPARATOR:u,show:C,visible:m,close:v}})})(basicContext_min);var basicContext_minExports=basicContext_min.exports,dayjs_min={exports:{}};(function(f,s){(function(a,u){f.exports=u()})(commonjsGlobal,function(){var a=1e3,u=6e4,l=36e5,h="millisecond",d="second",p="minute",y="hour",g="day",x="week",C="month",m="quarter",v="year",w="date",b="Invalid Date",E=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,k=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,_={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(N){var B=["th","st","nd","rd"],V=N%100;return"["+N+(B[(V-20)%10]||B[V]||B[0])+"]"}},S=function(N,B,V){var se=String(N);return!se||se.length>=B?N:""+Array(B+1-se.length).join(V)+N},A={s:S,z:function(N){var B=-N.utcOffset(),V=Math.abs(B),se=Math.floor(V/60),X=V%60;return(B<=0?"+":"-")+S(se,2,"0")+":"+S(X,2,"0")},m:function N(B,V){if(B.date()<V.date())return-N(V,B);var se=12*(V.year()-B.year())+(V.month()-B.month()),X=B.clone().add(se,C),oe=V-X<0,Q=B.clone().add(se+(oe?-1:1),C);return+(-(se+(V-X)/(oe?X-Q:Q-X))||0)},a:function(N){return N<0?Math.ceil(N)||0:Math.floor(N)},p:function(N){return{M:C,y:v,w:x,d:g,D:w,h:y,m:p,s:d,ms:h,Q:m}[N]||String(N||"").toLowerCase().replace(/s$/,"")},u:function(N){return N===void 0}},P="en",I={};I[P]=_;var R=function(N){return N instanceof z},j=function N(B,V,se){var X;if(!B)return P;if(typeof B=="string"){var oe=B.toLowerCase();I[oe]&&(X=oe),V&&(I[oe]=V,X=oe);var Q=B.split("-");if(!X&&Q.length>1)return N(Q[0])}else{var ce=B.name;I[ce]=B,X=ce}return!se&&X&&(P=X),X||!se&&P},q=function(N,B){if(R(N))return N.clone();var V=typeof B=="object"?B:{};return V.date=N,V.args=arguments,new z(V)},U=A;U.l=j,U.i=R,U.w=function(N,B){return q(N,{locale:B.$L,utc:B.$u,x:B.$x,$offset:B.$offset})};var z=function(){function N(V){this.$L=j(V.locale,null,!0),this.parse(V)}var B=N.prototype;return B.parse=function(V){this.$d=function(se){var X=se.date,oe=se.utc;if(X===null)return new Date(NaN);if(U.u(X))return new Date;if(X instanceof Date)return new Date(X);if(typeof X=="string"&&!/Z$/i.test(X)){var Q=X.match(E);if(Q){var ce=Q[2]-1||0,H=(Q[7]||"0").substring(0,3);return oe?new Date(Date.UTC(Q[1],ce,Q[3]||1,Q[4]||0,Q[5]||0,Q[6]||0,H)):new Date(Q[1],ce,Q[3]||1,Q[4]||0,Q[5]||0,Q[6]||0,H)}}return new Date(X)}(V),this.$x=V.x||{},this.init()},B.init=function(){var V=this.$d;this.$y=V.getFullYear(),this.$M=V.getMonth(),this.$D=V.getDate(),this.$W=V.getDay(),this.$H=V.getHours(),this.$m=V.getMinutes(),this.$s=V.getSeconds(),this.$ms=V.getMilliseconds()},B.$utils=function(){return U},B.isValid=function(){return this.$d.toString()!==b},B.isSame=function(V,se){var X=q(V);return this.startOf(se)<=X&&X<=this.endOf(se)},B.isAfter=function(V,se){return q(V)<this.startOf(se)},B.isBefore=function(V,se){return this.endOf(se)<q(V)},B.$g=function(V,se,X){return U.u(V)?this[se]:this.set(X,V)},B.unix=function(){return Math.floor(this.valueOf()/1e3)},B.valueOf=function(){return this.$d.getTime()},B.startOf=function(V,se){var X=this,oe=!!U.u(se)||se,Q=U.p(V),ce=function(ye,Se){var Pe=U.w(X.$u?Date.UTC(X.$y,Se,ye):new Date(X.$y,Se,ye),X);return oe?Pe:Pe.endOf(g)},H=function(ye,Se){return U.w(X.toDate()[ye].apply(X.toDate("s"),(oe?[0,0,0,0]:[23,59,59,999]).slice(Se)),X)},W=this.$W,ne=this.$M,ee=this.$D,fe="set"+(this.$u?"UTC":"");switch(Q){case v:return oe?ce(1,0):ce(31,11);case C:return oe?ce(1,ne):ce(0,ne+1);case x:var _e=this.$locale().weekStart||0,Ae=(W<_e?W+7:W)-_e;return ce(oe?ee-Ae:ee+(6-Ae),ne);case g:case w:return H(fe+"Hours",0);case y:return H(fe+"Minutes",1);case p:return H(fe+"Seconds",2);case d:return H(fe+"Milliseconds",3);default:return this.clone()}},B.endOf=function(V){return this.startOf(V,!1)},B.$set=function(V,se){var X,oe=U.p(V),Q="set"+(this.$u?"UTC":""),ce=(X={},X[g]=Q+"Date",X[w]=Q+"Date",X[C]=Q+"Month",X[v]=Q+"FullYear",X[y]=Q+"Hours",X[p]=Q+"Minutes",X[d]=Q+"Seconds",X[h]=Q+"Milliseconds",X)[oe],H=oe===g?this.$D+(se-this.$W):se;if(oe===C||oe===v){var W=this.clone().set(w,1);W.$d[ce](H),W.init(),this.$d=W.set(w,Math.min(this.$D,W.daysInMonth())).$d}else ce&&this.$d[ce](H);return this.init(),this},B.set=function(V,se){return this.clone().$set(V,se)},B.get=function(V){return this[U.p(V)]()},B.add=function(V,se){var X,oe=this;V=Number(V);var Q=U.p(se),ce=function(ne){var ee=q(oe);return U.w(ee.date(ee.date()+Math.round(ne*V)),oe)};if(Q===C)return this.set(C,this.$M+V);if(Q===v)return this.set(v,this.$y+V);if(Q===g)return ce(1);if(Q===x)return ce(7);var H=(X={},X[p]=u,X[y]=l,X[d]=a,X)[Q]||1,W=this.$d.getTime()+V*H;return U.w(W,this)},B.subtract=function(V,se){return this.add(-1*V,se)},B.format=function(V){var se=this,X=this.$locale();if(!this.isValid())return X.invalidDate||b;var oe=V||"YYYY-MM-DDTHH:mm:ssZ",Q=U.z(this),ce=this.$H,H=this.$m,W=this.$M,ne=X.weekdays,ee=X.months,fe=function(Se,Pe,Fe,Me){return Se&&(Se[Pe]||Se(se,oe))||Fe[Pe].slice(0,Me)},_e=function(Se){return U.s(ce%12||12,Se,"0")},Ae=X.meridiem||function(Se,Pe,Fe){var Me=Se<12?"AM":"PM";return Fe?Me.toLowerCase():Me},ye={YY:String(this.$y).slice(-2),YYYY:this.$y,M:W+1,MM:U.s(W+1,2,"0"),MMM:fe(X.monthsShort,W,ee,3),MMMM:fe(ee,W),D:this.$D,DD:U.s(this.$D,2,"0"),d:String(this.$W),dd:fe(X.weekdaysMin,this.$W,ne,2),ddd:fe(X.weekdaysShort,this.$W,ne,3),dddd:ne[this.$W],H:String(ce),HH:U.s(ce,2,"0"),h:_e(1),hh:_e(2),a:Ae(ce,H,!0),A:Ae(ce,H,!1),m:String(H),mm:U.s(H,2,"0"),s:String(this.$s),ss:U.s(this.$s,2,"0"),SSS:U.s(this.$ms,3,"0"),Z:Q};return oe.replace(k,function(Se,Pe){return Pe||ye[Se]||Q.replace(":","")})},B.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},B.diff=function(V,se,X){var oe,Q=U.p(se),ce=q(V),H=(ce.utcOffset()-this.utcOffset())*u,W=this-ce,ne=U.m(this,ce);return ne=(oe={},oe[v]=ne/12,oe[C]=ne,oe[m]=ne/3,oe[x]=(W-H)/6048e5,oe[g]=(W-H)/864e5,oe[y]=W/l,oe[p]=W/u,oe[d]=W/a,oe)[Q]||W,X?ne:U.a(ne)},B.daysInMonth=function(){return this.endOf(C).$D},B.$locale=function(){return I[this.$L]},B.locale=function(V,se){if(!V)return this.$L;var X=this.clone(),oe=j(V,se,!0);return oe&&(X.$L=oe),X},B.clone=function(){return U.w(this.$d,this)},B.toDate=function(){return new Date(this.valueOf())},B.toJSON=function(){return this.isValid()?this.toISOString():null},B.toISOString=function(){return this.$d.toISOString()},B.toString=function(){return this.$d.toUTCString()},N}(),L=z.prototype;return q.prototype=L,[["$ms",h],["$s",d],["$m",p],["$H",y],["$W",g],["$M",C],["$y",v],["$D",w]].forEach(function(N){L[N[1]]=function(B){return this.$g(B,N[0],N[1])}}),q.extend=function(N,B){return N.$i||(N(B,z,q),N.$i=!0),q},q.locale=j,q.isDayjs=R,q.unix=function(N){return q(1e3*N)},q.en=I[P],q.Ls=I,q.p={},q})})(dayjs_min);var dayjs_minExports=dayjs_min.exports;const dayjs=getDefaultExportFromCjs(dayjs_minExports);var uaParser={exports:{}};(function(f,s){(function(a,u){var l="1.0.33",h="",d="?",p="function",y="undefined",g="object",x="string",C="major",m="model",v="name",w="type",b="vendor",E="version",k="architecture",_="console",S="mobile",A="tablet",P="smarttv",I="wearable",R="embedded",j=350,q="Amazon",U="Apple",z="ASUS",L="BlackBerry",N="Browser",B="Chrome",V="Edge",se="Firefox",X="Google",oe="Huawei",Q="LG",ce="Microsoft",H="Motorola",W="Opera",ne="Samsung",ee="Sharp",fe="Sony",_e="Xiaomi",Ae="Zebra",ye="Facebook",Se=function(he,xe){var pe={};for(var be in he)xe[be]&&xe[be].length%2===0?pe[be]=xe[be].concat(he[be]):pe[be]=he[be];return pe},Pe=function(he){for(var xe={},pe=0;pe<he.length;pe++)xe[he[pe].toUpperCase()]=he[pe];return xe},Fe=function(he,xe){return typeof he===x?Me(xe).indexOf(Me(he))!==-1:!1},Me=function(he){return he.toLowerCase()},De=function(he){return typeof he===x?he.replace(/[^\d\.]/g,h).split(".")[0]:u},O=function(he,xe){if(typeof he===x)return he=he.replace(/^\s\s*/,h),typeof xe===y?he:he.substring(0,j)},le=function(he,xe){for(var pe=0,be,Ee,Ie,Le,Ve,$e;pe<xe.length&&!Ve;){var Ze=xe[pe],qe=xe[pe+1];for(be=Ee=0;be<Ze.length&&!Ve;)if(Ve=Ze[be++].exec(he),Ve)for(Ie=0;Ie<qe.length;Ie++)$e=Ve[++Ee],Le=qe[Ie],typeof Le===g&&Le.length>0?Le.length===2?typeof Le[1]==p?this[Le[0]]=Le[1].call(this,$e):this[Le[0]]=Le[1]:Le.length===3?typeof Le[1]===p&&!(Le[1].exec&&Le[1].test)?this[Le[0]]=$e?Le[1].call(this,$e,Le[2]):u:this[Le[0]]=$e?$e.replace(Le[1],Le[2]):u:Le.length===4&&(this[Le[0]]=$e?Le[3].call(this,$e.replace(Le[1],Le[2])):u):this[Le]=$e||u;pe+=2}},ae=function(he,xe){for(var pe in xe)if(typeof xe[pe]===g&&xe[pe].length>0){for(var be=0;be<xe[pe].length;be++)if(Fe(xe[pe][be],he))return pe===d?u:pe}else if(Fe(xe[pe],he))return pe===d?u:pe;return he},Y={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},G={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},te={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[E,[v,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[E,[v,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[v,E],[/opios[\/ ]+([\w\.]+)/i],[E,[v,W+" Mini"]],[/\bopr\/([\w\.]+)/i],[E,[v,W]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[v,E],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[E,[v,"UC"+N]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[E,[v,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[E,[v,"WeChat"]],[/konqueror\/([\w\.]+)/i],[E,[v,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[E,[v,"IE"]],[/yabrowser\/([\w\.]+)/i],[E,[v,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[v,/(.+)/,"$1 Secure "+N],E],[/\bfocus\/([\w\.]+)/i],[E,[v,se+" Focus"]],[/\bopt\/([\w\.]+)/i],[E,[v,W+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[E,[v,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[E,[v,"Dolphin"]],[/coast\/([\w\.]+)/i],[E,[v,W+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[E,[v,"MIUI "+N]],[/fxios\/([-\w\.]+)/i],[E,[v,se]],[/\bqihu|(qi?ho?o?|360)browser/i],[[v,"360 "+N]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[v,/(.+)/,"$1 "+N],E],[/(comodo_dragon)\/([\w\.]+)/i],[[v,/_/g," "],E],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[v,E],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[v],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[v,ye],E],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[v,E],[/\bgsa\/([\w\.]+) .*safari\//i],[E,[v,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[E,[v,B+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[v,B+" WebView"],E],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[E,[v,"Android "+N]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[v,E],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[E,[v,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[E,v],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[v,[E,ae,Y]],[/(webkit|khtml)\/([\w\.]+)/i],[v,E],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[v,"Netscape"],E],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[E,[v,se+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[v,E],[/(cobalt)\/([\w\.]+)/i],[v,[E,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[k,"amd64"]],[/(ia32(?=;))/i],[[k,Me]],[/((?:i[346]|x)86)[;\)]/i],[[k,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[k,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[k,"armhf"]],[/windows (ce|mobile); ppc;/i],[[k,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[k,/ower/,h,Me]],[/(sun4\w)[;\)]/i],[[k,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[k,Me]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[m,[b,ne],[w,A]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[m,[b,ne],[w,S]],[/\((ip(?:hone|od)[\w ]*);/i],[m,[b,U],[w,S]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[m,[b,U],[w,A]],[/(macintosh);/i],[m,[b,U]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[m,[b,oe],[w,A]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[m,[b,oe],[w,S]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[m,/_/g," "],[b,_e],[w,S]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[m,/_/g," "],[b,_e],[w,A]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[m,[b,"OPPO"],[w,S]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[m,[b,"Vivo"],[w,S]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[m,[b,"Realme"],[w,S]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[m,[b,H],[w,S]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[m,[b,H],[w,A]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[m,[b,Q],[w,A]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[m,[b,Q],[w,S]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[m,[b,"Lenovo"],[w,A]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[m,/_/g," "],[b,"Nokia"],[w,S]],[/(pixel c)\b/i],[m,[b,X],[w,A]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[m,[b,X],[w,S]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[m,[b,fe],[w,S]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[m,"Xperia Tablet"],[b,fe],[w,A]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[m,[b,"OnePlus"],[w,S]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[m,[b,q],[w,A]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[m,/(.+)/g,"Fire Phone $1"],[b,q],[w,S]],[/(playbook);[-\w\),; ]+(rim)/i],[m,b,[w,A]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[m,[b,L],[w,S]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[m,[b,z],[w,A]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[m,[b,z],[w,S]],[/(nexus 9)/i],[m,[b,"HTC"],[w,A]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony(?!-bra))[-_ ]?([-\w]*)/i],[b,[m,/_/g," "],[w,S]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[m,[b,"Acer"],[w,A]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[m,[b,"Meizu"],[w,S]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[m,[b,ee],[w,S]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[b,m,[w,S]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[b,m,[w,A]],[/(surface duo)/i],[m,[b,ce],[w,A]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[m,[b,"Fairphone"],[w,S]],[/(u304aa)/i],[m,[b,"AT&T"],[w,S]],[/\bsie-(\w*)/i],[m,[b,"Siemens"],[w,S]],[/\b(rct\w+) b/i],[m,[b,"RCA"],[w,A]],[/\b(venue[\d ]{2,7}) b/i],[m,[b,"Dell"],[w,A]],[/\b(q(?:mv|ta)\w+) b/i],[m,[b,"Verizon"],[w,A]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[m,[b,"Barnes & Noble"],[w,A]],[/\b(tm\d{3}\w+) b/i],[m,[b,"NuVision"],[w,A]],[/\b(k88) b/i],[m,[b,"ZTE"],[w,A]],[/\b(nx\d{3}j) b/i],[m,[b,"ZTE"],[w,S]],[/\b(gen\d{3}) b.+49h/i],[m,[b,"Swiss"],[w,S]],[/\b(zur\d{3}) b/i],[m,[b,"Swiss"],[w,A]],[/\b((zeki)?tb.*\b) b/i],[m,[b,"Zeki"],[w,A]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[b,"Dragon Touch"],m,[w,A]],[/\b(ns-?\w{0,9}) b/i],[m,[b,"Insignia"],[w,A]],[/\b((nxa|next)-?\w{0,9}) b/i],[m,[b,"NextBook"],[w,A]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[b,"Voice"],m,[w,S]],[/\b(lvtel\-)?(v1[12]) b/i],[[b,"LvTel"],m,[w,S]],[/\b(ph-1) /i],[m,[b,"Essential"],[w,S]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[m,[b,"Envizen"],[w,A]],[/\b(trio[-\w\. ]+) b/i],[m,[b,"MachSpeed"],[w,A]],[/\btu_(1491) b/i],[m,[b,"Rotor"],[w,A]],[/(shield[\w ]+) b/i],[m,[b,"Nvidia"],[w,A]],[/(sprint) (\w+)/i],[b,m,[w,S]],[/(kin\.[onetw]{3})/i],[[m,/\./g," "],[b,ce],[w,S]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[m,[b,Ae],[w,A]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[m,[b,Ae],[w,S]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[b,m,[w,_]],[/droid.+; (shield) bui/i],[m,[b,"Nvidia"],[w,_]],[/(playstation [345portablevi]+)/i],[m,[b,fe],[w,_]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[m,[b,ce],[w,_]],[/smart-tv.+(samsung)/i],[b,[w,P]],[/hbbtv.+maple;(\d+)/i],[[m,/^/,"SmartTV"],[b,ne],[w,P]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[b,Q],[w,P]],[/(apple) ?tv/i],[b,[m,U+" TV"],[w,P]],[/crkey/i],[[m,B+"cast"],[b,X],[w,P]],[/droid.+aft(\w)( bui|\))/i],[m,[b,q],[w,P]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[m,[b,ee],[w,P]],[/(bravia[\w ]+)( bui|\))/i],[m,[b,fe],[w,P]],[/(mitv-\w{5}) bui/i],[m,[b,_e],[w,P]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[b,O],[m,O],[w,P]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[w,P]],[/((pebble))app/i],[b,m,[w,I]],[/droid.+; (glass) \d/i],[m,[b,X],[w,I]],[/droid.+; (wt63?0{2,3})\)/i],[m,[b,Ae],[w,I]],[/(quest( 2)?)/i],[m,[b,ye],[w,I]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[b,[w,R]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[m,[w,S]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[m,[w,A]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[w,A]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[w,S]],[/(android[-\w\. ]{0,9});.+buil/i],[m,[b,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[E,[v,V+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[E,[v,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[v,E],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[E,v]],os:[[/microsoft (windows) (vista|xp)/i],[v,E],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[v,[E,ae,G]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[v,"Windows"],[E,ae,G]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[E,/_/g,"."],[v,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[v,"Mac OS"],[E,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[E,v],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[v,E],[/\(bb(10);/i],[E,[v,L]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[E,[v,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[E,[v,se+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[E,[v,"webOS"]],[/crkey\/([\d\.]+)/i],[E,[v,B+"cast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[v,"Chromium OS"],E],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[v,E],[/(sunos) ?([\w\.\d]*)/i],[[v,"Solaris"],E],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[v,E]]},ge=function(he,xe){if(typeof he===g&&(xe=he,he=u),!(this instanceof ge))return new ge(he,xe).getResult();var pe=he||(typeof a!==y&&a.navigator&&a.navigator.userAgent?a.navigator.userAgent:h),be=xe?Se(te,xe):te;return this.getBrowser=function(){var Ee={};return Ee[v]=u,Ee[E]=u,le.call(Ee,pe,be.browser),Ee.major=De(Ee.version),Ee},this.getCPU=function(){var Ee={};return Ee[k]=u,le.call(Ee,pe,be.cpu),Ee},this.getDevice=function(){var Ee={};return Ee[b]=u,Ee[m]=u,Ee[w]=u,le.call(Ee,pe,be.device),Ee},this.getEngine=function(){var Ee={};return Ee[v]=u,Ee[E]=u,le.call(Ee,pe,be.engine),Ee},this.getOS=function(){var Ee={};return Ee[v]=u,Ee[E]=u,le.call(Ee,pe,be.os),Ee},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return pe},this.setUA=function(Ee){return pe=typeof Ee===x&&Ee.length>j?O(Ee,j):Ee,this},this.setUA(pe),this};ge.VERSION=l,ge.BROWSER=Pe([v,E,C]),ge.CPU=Pe([k]),ge.DEVICE=Pe([m,b,w,_,S,P,A,I,R]),ge.ENGINE=ge.OS=Pe([v,E]),f.exports&&(s=f.exports=ge),s.UAParser=ge;var ue=typeof a!==y&&(a.jQuery||a.Zepto);if(ue&&!ue.ua){var re=new ge;ue.ua=re.getResult(),ue.ua.get=function(){return re.getUA()},ue.ua.set=function(he){re.setUA(he);var xe=re.getResult();for(var pe in xe)ue.ua[pe]=xe[pe]}}})(typeof window=="object"?window:commonjsGlobal)})(uaParser,uaParser.exports);var uaParserExports=uaParser.exports;class HelpFunctions{constructor(){this.isExtensionMode=!1,this.browserName="",this.manifest={manifest_version:2,name:"",version:""};try{this.isExtensionMode=!!(chrome.runtime&&chrome.extension&&chrome.runtime.getManifest),this.manifest=chrome.runtime.getManifest()}catch(s){console.log("HelpFunctions: is not extension mode.",s)}this.browserName=new uaParserExports.UAParser().getBrowser().name||""}getToDay(s){let a=new Date;s&&(a=new Date(s));let u=a.getFullYear(),l=a.getMonth()+1,h=l<10?"0"+l:l,d=a.getDate(),p=d<10?"0"+d:d;return`${u}-${h}-${p}`}updateBadge(s){if(this.isExtensionMode)try{s==0?(chrome.browserAction.setBadgeText({text:""}),chrome.browserAction.enable()):(chrome.browserAction.setBadgeText({text:s.toString()}),chrome.browserAction.setBadgeBackgroundColor({color:"#aabbcc"}),chrome.browserAction.disable())}catch(a){console.log(a)}}getVersion(){return this.isExtensionMode?"v"+(this.manifest.version_name||this.manifest.version):"localVersion"}getRandomString(s=32,a=!1){let u=a?"abcdefhijkmnprstwxyz2345678ABCDEFGHJKMNPQRSTWXYZ":"abcdefghijkmnopqrstuvwxyz0123456789ABCDEFGHIJKMNOPQRSTUVWXYZ",l=u.length,h=[];for(let d=0;d<s;d++)h.push(u.charAt(Math.floor(Math.random()*l)));return h.join("")}getNewId(){return cryptoJsExports.MD5(new Date().getTime().toString()+this.getRandomString()).toString()}showNotifications(s,a=3e3){s=Object.assign({type:"basic",iconUrl:chrome.runtime.getURL("/assets/icon-128.png"),title:"PT 助手 Plus",priority:0,message:""},s);let u=Math.floor(Math.random()*99999)+"";chrome.notifications.create(u,s,function(l){u=l}),setTimeout(()=>{chrome.notifications.clear(u,()=>{})},a)}removeDuplicateQueryString(s){let a=[],u="",l=/([^&=]+)=([^&]*)/g,h,d="",p=s.indexOf("?");if(p!==-1){for(d=s.substr(0,p+1),u=s.substr(p+1);h=l.exec(u);){const y=h[1]+"="+h[2];a.includes(y)||a.push(y)}return d+a.join("&")}return s}removeQueryStringFromValue(s,a){let u=[],l="",h=/([^&=]+)=([^&]*)/g,d,p="",y=s.indexOf("?");if(y!==-1){for(p=s.substr(0,y+1),l=s.substr(y+1);d=h.exec(l);){const g=d[1]+"="+d[2];d[2]!==a&&u.push(g)}return p+u.join("&")}return s}removeQueryStringFields(s,a){let u=[],l="",h=/([^&=]+)=([^&]*)/g,d,p="",y=s.indexOf("?");if(y!==-1){for(p=s.substr(0,y+1),l=s.substr(y+1);d=h.exec(l);){const g=d[1]+"="+d[2];a.includes(d[1])||u.push(g)}return p+u.join("&")}return s}clone(s){return JSON.parse(JSON.stringify(s))}debug(...s){console.log(new Date().toLocaleString(),...s)}showContextMenu(s,a){try{basicContext_minExports.show(s,a),$(".basicContext").css({left:"-=20px",top:"+=10px"})}catch{}}getCleaningURL(s){return this.removeQueryStringFields(s,["hit","cmtpage","page"])}checkPermissions(s){return new Promise((a,u)=>{chrome&&chrome.permissions?chrome.permissions.contains({permissions:s},l=>{l===!0?a(!0):u({success:!1})}):u({success:!1})})}requestPermissions(s){return new Promise((a,u)=>{chrome&&chrome.permissions?chrome.permissions.request({permissions:s},l=>{l===!0?a(!0):u({success:!1})}):u({success:!1})})}usePermissions(s,a=!1,u=""){return new Promise((l,h)=>{this.checkPermissions(s).then(d=>{l(d)}).catch(()=>{let d=!0;if(a&&(d=confirm(u)),!d){h({success:!1});return}this.requestPermissions(s).then(p=>{l(p)}).catch(p=>{h(p)})})})}getSiteFromHost(s,a){let u=[];a.sites&&u.push(...a.sites),a.system&&a.system.publicSites&&u.push(...a.system.publicSites);let l=u.find(h=>{var p;let d=[h.url].concat(h.cdn,(p=h.formerHosts)==null?void 0:p.map(y=>`//${y}`));return h.host==s||d.join("").indexOf(`//${s}`)>-1});return l?this.clone(l):null}getNewBackupFileName(){return"PT-Plugin-Plus-Backup-"+dayjs().format("YYYY-MM-DD_HH-mm-ss")+".zip"}replaceKeys(s,a,u=""){if(!s||typeof s!="string")return s;let l=s;for(const h in a)if(a.hasOwnProperty(h)){const d=a[h];let p="$"+h+"$";u&&(p=`$${u}.${h}$`),l=l.replace(p,d)}return l}checkOptionalPermission(s){return this.isExtensionMode&&this.manifest&&this.manifest.optional_permissions?this.manifest.optional_permissions.includes(s):!1}transformTime(s,a){if(!a||!s)return s;let u=s;/^(\d){10}$/.test(u+"")&&(u=parseInt(u+"")*1e3);let l=dayjs(u).format("YYYY-MM-DDTHH:mm:ss");return u=new Date(`${l}${a}`).getTime(),u}resolveURL(s,a){const u=new URL(a,new URL(s,"resolve://"));if(u.protocol==="resolve:"){const{pathname:l,search:h,hash:d}=u;return l+h+d}return u.toString()}getIdFromMTURL(s){try{let a=new URL(s).pathname.split("/").pop();if(a)return parseInt(a),a}catch(a){console.log("getIdFromMTURL error",a)}}getSiteActiveUrl(s){return s.activeURL?s.activeURL:s.cdn&&s.cdn.length>0?s.cdn[0]:s.url}resolveMTDownloadURL(s,a,u=void 0){let l=this.getSiteActiveUrl(a);return $.ajax(this.resolveURL(l,"/api/torrent/genDlToken"),{method:"POST",data:{id:s},cache:!0,headers:{"x-api-key":a.authToken},success:function(d){if(d.code==="0")console.log(`种子 ${s} 下载链接获取成功`,d);else{let p=`种子 ${s} 下载链接获取失败, code != 0`;console.log(p,d),u&&u({msg:p})}},error:function(d){let p=`种子 ${s} 下载链接获取失败`;console.log(p,d),u&&u({msg:p})},async:!1}).responseJSON.data||""}}const PPF=new HelpFunctions,filters={formatNumber(f,s="###,###,###,###.00"){if(f===void 0)return"";const a=(p,y,g)=>{if(p===""||p===void 0)return y===""||y===void 0?"":y;let x="",C="",m="",v=0;g||(p=p.split("").reverse().join(""),y=y.split("").reverse().join(""));let w=0;for(let b=0;b<y.length;b++,w++)if(C=p.charAt(w),C!==void 0)switch(x=y.charAt(b),x){case"#":m+=C,v=b;break;case"0":m=C||C===x?m+C:m+0,v=b;break;case".":m+=C===x?C:(w--,x);break;case",":m+=C===x?C:(w--,x);break;default:m+=x,w--}return w!==p.length&&y.charAt(y.length-1)!=="0"&&v!==y.length&&y.charAt(v)!=="0"&&(m=m.substr(0,v+1)+p.substr(w)+m.substr(v+1)),m=(g?m:m.split("").reverse().join("")).replace(/(^,)|(,$)|(,,+)/g,""),m.substr(0,1)===","&&(m=m.substr(1)),m.substr(0,2)==="-,"&&(m="-"+m.substr(2)),m},u=f.toString();if(u.length===0)return"";let l=parseFloat(u);if(isNaN(l)||!s)return u;const h=s.split("."),d=u.split(".");return h.length>1?a(d[0],h[0])+"."+a(d[1],h[1],1):a(d[0],h[0])},formatSize(f,s=!1,a=""){let u=parseFloat(f);if(isNaN(u))return"";if(u<0)return"N/A";if(u===0)return s?"":a==="speed"?"0.00 KiB/s":"0.00";let l,h="KiB",d="###,###,###,###.00 ",p="###,###,###,###.000 ";return u<1e3*Math.pow(2,10)?(l=u/Math.pow(2,10),h="KiB"):u<1e3*Math.pow(2,20)?(l=u/Math.pow(2,20),h="MiB"):u<1e3*Math.pow(2,30)?(l=u/Math.pow(2,30),h="GiB"):u<1e3*Math.pow(2,40)?(l=u/Math.pow(2,40),h="TiB",d=p):u<1e3*Math.pow(2,50)?(l=u/Math.pow(2,50),h="PiB",d=p):u<1e3*Math.pow(2,60)?(l=u/Math.pow(2,60),h="EiB",d=p):(l=u/Math.pow(2,70),h="ZiB",d=p),a==="speed"&&(h+="/s"),this.formatNumber(l,d)+h},formatSizetoPrecision(f,s=!1,a=""){let u=parseFloat(f);if(isNaN(u))return"";if(u<0)return"N/A";if(u===0)return s?"":a==="speed"?"0.00 KiB/s":"0.00";let l,h="KiB";return u<1e3*Math.pow(2,10)?(l=u/Math.pow(2,10),h="KiB"):u<1e3*Math.pow(2,20)?(l=u/Math.pow(2,20),h="MiB"):u<1e3*Math.pow(2,30)?(l=u/Math.pow(2,30),h="GiB"):u<1e3*Math.pow(2,40)?(l=u/Math.pow(2,40),h="TiB"):u<1e3*Math.pow(2,50)?(l=u/Math.pow(2,50),h="PiB"):u<1e3*Math.pow(2,60)?(l=u/Math.pow(2,60),h="EiB"):(l=u/Math.pow(2,70),h="ZiB"),a==="speed"&&(h+="/s"),l.toPrecision(4)+" "+h},formatSizeWithNegative(f,s=!1,a=""){f=parseFloat(f);let u=f;f<0&&(u=-u);let l=this.formatSize(u,s,a);return f<0&&(l=`- ${l}`),l},formatSpeed(f,s=!1){return this.formatSize(f,s,"speed")},parseURL(f){var s=document.createElement("a");return s.href=f,{source:f,protocol:s.protocol.replace(":",""),host:s.hostname,port:s.port,query:s.search,params:function(){for(var a={},u=s.search.replace(/^\?/,"").split("&"),l=u.length,h=0,d;h<l;h++)u[h]&&(d=u[h].split("="),a[d[0]]=d[1]);return a}(),hash:s.hash.replace("#",""),path:s.pathname.replace(/^([^/])/,"/$1"),segments:s.pathname.replace(/^\//,"").split("/"),origin:`${s.protocol}//${s.hostname}`+(s.port?`:${s.port}`:"")}},formatIMDbId(f){return Number(f)&&(f.length<7&&(f=f.padStart(7,"0")),f="tt"+f),f},timeAgoToNumber(f){let s=/^([\d.]+).+?((year|month|week|day|hour|min|minute)s?)( +ago)?(.+)?$/i,a=f.trim().match(s);if(!a)return 0;let u=new Date,l=a[3],h=Math.round(parseFloat(a[1])),d=new Date;switch(l.toLowerCase()){case"year":d=new Date(u.setFullYear(u.getFullYear()-h));break;case"month":d=new Date(u.setMonth(u.getMonth()-h));break;case"day":d=new Date(u.setDate(u.getDate()-h));break;case"week":d=new Date(u.setDate(u.getDate()-7*h));break;case"hour":d=new Date(u.setHours(u.getHours()-h));break;case"min":case"minute":d=new Date(u.setMinutes(u.getMinutes()-h));break}return d.getTime()},formatInteger(f){return this.formatNumber(f,"###,###,###,###")}};var FileSaver_min={exports:{}};(function(f,s){(function(a,u){u()})(commonjsGlobal,function(){function a(g,x){return typeof x>"u"?x={autoBom:!1}:typeof x!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),x={autoBom:!x}),x.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(g.type)?new Blob(["\uFEFF",g],{type:g.type}):g}function u(g,x,C){var m=new XMLHttpRequest;m.open("GET",g),m.responseType="blob",m.onload=function(){y(m.response,x,C)},m.onerror=function(){console.error("could not download file")},m.send()}function l(g){var x=new XMLHttpRequest;x.open("HEAD",g,!1);try{x.send()}catch{}return 200<=x.status&&299>=x.status}function h(g){try{g.dispatchEvent(new MouseEvent("click"))}catch{var x=document.createEvent("MouseEvents");x.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),g.dispatchEvent(x)}}var d=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof commonjsGlobal=="object"&&commonjsGlobal.global===commonjsGlobal?commonjsGlobal:void 0,p=d.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),y=d.saveAs||(typeof window!="object"||window!==d?function(){}:"download"in HTMLAnchorElement.prototype&&!p?function(g,x,C){var m=d.URL||d.webkitURL,v=document.createElement("a");x=x||g.name||"download",v.download=x,v.rel="noopener",typeof g=="string"?(v.href=g,v.origin===location.origin?h(v):l(v.href)?u(g,x,C):h(v,v.target="_blank")):(v.href=m.createObjectURL(g),setTimeout(function(){m.revokeObjectURL(v.href)},4e4),setTimeout(function(){h(v)},0))}:"msSaveOrOpenBlob"in navigator?function(g,x,C){if(x=x||g.name||"download",typeof g!="string")navigator.msSaveOrOpenBlob(a(g,C),x);else if(l(g))u(g,x,C);else{var m=document.createElement("a");m.href=g,m.target="_blank",setTimeout(function(){h(m)})}}:function(g,x,C,m){if(m=m||open("","_blank"),m&&(m.document.title=m.document.body.innerText="downloading..."),typeof g=="string")return u(g,x,C);var v=g.type==="application/octet-stream",w=/constructor/i.test(d.HTMLElement)||d.safari,b=/CriOS\/[\d]+/.test(navigator.userAgent);if((b||v&&w||p)&&typeof FileReader<"u"){var E=new FileReader;E.onloadend=function(){var S=E.result;S=b?S:S.replace(/^data:[^;]*;/,"data:attachment/file;"),m?m.location.href=S:location=S,m=null},E.readAsDataURL(g)}else{var k=d.URL||d.webkitURL,_=k.createObjectURL(g);m?m.location=_:location.href=_,m=null,setTimeout(function(){k.revokeObjectURL(_)},4e4)}});d.saveAs=y.saveAs=y,f.exports=y})})(FileSaver_min);var FileSaver_minExports=FileSaver_min.exports;const FileSaver=getDefaultExportFromCjs(FileSaver_minExports);class FileDownloader{constructor(s){this.lastTime=0,this.startTime=0,this.status=0,this.statusText="",this.url="",this.requestMethod=ERequestMethod.GET,this.postData=null,this.fileName="",this.loaded=0,this.total=0,this.percent=0,this.speed=0,this.showSpeed="",this.onProgress=function(){},this.onCompleted=function(){},this.onError=function(){},this.onStart=function(){},this.getDataOnly=!1,this.timeout=0,this.xhr=new XMLHttpRequest,this.fileName=s.fileName||"",this.url=s.url,this.getDataOnly=s.getDataOnly||!1,this.timeout=s.timeout||0,this.requestMethod=s.method||ERequestMethod.GET}start(){this.lastTime=+new Date,this.startTime=this.lastTime,this.statusText="数据准备中……",this.timeout>0&&(this.xhr.timeout=this.timeout),this.xhr.open(this.requestMethod,this.url,!0),this.xhr.responseType="blob",this.xhr.onreadystatechange=()=>{switch(this.xhr.readyState){case 4:switch(this.xhr.status){case 200:case 302:this.content=this.xhr.response,this.downloadCompleted();break;default:this.xhr.status!=0&&this.downloadError(`[${this.url}] 下载失败，返回的状态码为：${this.xhr.status}`);break}break;case 2:var a=this.xhr.getResponseHeader("Content-Disposition");a&&!this.fileName&&!this.getDataOnly&&(this.fileName=this.getFileName(a));break}},this.xhr.onprogress=a=>{this.loaded=a.loaded,this.total=a.total,this.percent=(100*(a.loaded/a.total)).toFixed(2),this.lastTime=+new Date,this.speed=this.loaded/(this.startTime-this.lastTime),this.updateProgress()},this.xhr.onerror=a=>{this.downloadError(a)},this.xhr.ontimeout=()=>{this.downloadError(`[${this.url}] 下载超时`)};var s=null;this.postData&&(s=$.param(this.postData)),this.requestMethod==ERequestMethod.POST&&this.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.xhr.send(s),this.onStart&&this.onStart.call(this)}getFileName(s=""){let a=s.split(";"),u={},l="";for(let d=0;d<a.length;d++){let y=a[d].replace(" ","").split("=");y.length==2&&(u[y[0]]=y[1].trim())}let h;if(h=u["filename*"]){let d=h.lastIndexOf("'");l=h.substr(d+1)}else l=u.filename;return l=l.replace(/"/g,""),decodeURI(l)}downloadCompleted(){this.loaded>0&&!this.getDataOnly&&FileSaver.saveAs(this.content,this.fileName),this.onCompleted&&this.onCompleted.call(this)}downloadError(s){this.onError&&this.onError.call(this,s)}updateProgress(){this.onProgress&&this.onProgress.call(this,this.loaded,this.total,this.speed)}}const StorageKey="Favicon-Cache",NOIMAGE="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";class Favicon{constructor(s){this.service=s,this.cache={},this.loadCache()}loadCache(){let s=window.localStorage.getItem(StorageKey);s&&(this.cache=JSON.parse(s)||{})}saveCache(){window.localStorage.setItem(StorageKey,JSON.stringify(this.cache))}clear(){this.cache={},this.saveCache()}reset(){let s=JSON.parse(JSON.stringify(this.cache));this.cache={};let a=[];for(const u in s)if(s.hasOwnProperty(u)){let l=s[u];a.push(l.origin)}return this.gets(a)}gets(s){return new Promise((a,u)=>{let l=[];s.forEach(h=>{l.push(this.get(h))}),Promise.all(l).then(h=>{a(h)}).catch(h=>{u(h)})})}get(s,a=!1){return new Promise((u,l)=>{let h=filters.parseURL(s),d=this.cache[h.host];if(!d||a){this.cacheFavicon(h.origin,h.host).then(p=>{u(p)}).catch(p=>{l(p)});return}return u(d)})}cacheFavicon(s,a){return new Promise((u,l)=>{var d;let h=((d=new URL(s).pathname)==null?void 0:d.length)>1?s:`${s}/favicon.ico`;this.download(h).then(p=>{p&&p.size>0?this.transformBlob(p,"base64").then(y=>{u(this.set(s,y))}).catch(y=>{l(y)}):this.cacheFromIndex(s,a).then(y=>{u(y)}).catch(y=>{l(y)})}).catch(()=>{this.cacheFromIndex(s,a).then(p=>{u(p)}).catch(p=>{l(p)})})})}set(s,a){let u=filters.parseURL(s),l={origin:u.origin,host:u.host,data:a};return this.cache[u.host]=l,this.saveCache(),l}cacheFromIndex(s,a){return new Promise((u,l)=>{this.download(s).then(h=>{h&&h.size>0&&/text/gi.test(h.type)?this.transformBlob(h,"text").then(d=>{try{const p=new DOMParser().parseFromString(d,"text/html");let g=$(p).find("head").find("link[rel*=icon]:first");if(g&&g.length>0){let x=filters.parseURL(s),C=g.attr("href")+"";C.substr(0,2)==="//"?C=`${x.protocol}:${C}`:C.substr(0,4)!=="http"&&(C=C.startsWith("/")?`${x.origin}${C}`:`${x.origin}/${C}`),this.download(C).then(m=>{m&&/image/gi.test(m.type)?this.transformBlob(m,"base64").then(v=>{u(this.set(s,v))}).catch(v=>{this.debug(v),l(v)}):u(this.set(s,NOIMAGE))}).catch(()=>{u(this.set(s,NOIMAGE))})}else u(this.set(s,NOIMAGE))}catch(p){console.log(p),this.debug(p),u(this.set(s,NOIMAGE))}}).catch(d=>{this.debug(`cacheFromIndex.error, url: ${s}, host: ${a}, result.length: ${h==null?void 0:h.length}`,d),l(d)}):l()}).catch(()=>{u(this.set(s,NOIMAGE))})})}transformBlob(s,a){return new Promise((u,l)=>{const h=new FileReader;switch(h.addEventListener("loadend",()=>{h.result?u(h.result):(this.debug("transformBlob.error",s,a),l())}),a){case"text":h.readAsText(s);break;case"base64":h.readAsDataURL(s);break}})}download(s){return new Promise((a,u)=>{let l=new FileDownloader({url:s,getDataOnly:!0,timeout:5e3});l.onCompleted=()=>{l.content?a(l.content):u()},l.onError=h=>{console.log("Favicon.download.error",h),this.debug(h),u(h)},l.start()})}debug(...s){this.service&&this.service.debug(...s)}}let rootPath="",isExtensionMode=!1;const isDebugMode=!1;try{let f=chrome.runtime;isExtensionMode=!0,rootPath=f.getManifest().options_ui.page.replace("index.html",""),rootPath&&rootPath.substr(-1)=="/"&&(rootPath=rootPath.substr(0,rootPath.length-1)),rootPath||(rootPath=`chrome-extension://${chrome.runtime.id}`),isDebugMode&&console.log("is extension mode.")}catch(f){isExtensionMode=!1}const RESOURCE_URL=isExtensionMode?(isExtensionMode?rootPath:"")+"/resource":`http://${window.location.hostname}:8001`;let RESOURCE_API={host:RESOURCE_URL,schemas:`${RESOURCE_URL}/schemas.json`,schemaConfig:`${RESOURCE_URL}/schemas/{$schema}/config.json`,sites:`${RESOURCE_URL}/sites.json`,siteConfig:`${RESOURCE_URL}/sites/{$site}/config.json`,clients:`${RESOURCE_URL}/clients.json`,clientConfig:`${RESOURCE_URL}/clients/{$client}/config.json`,latestReleases:"https://api.github.com/repos/pt-plugins/PT-Plugin-Plus/releases/latest",systemConfig:`${RESOURCE_URL}/systemConfig.json`};const APP={debugMode:isDebugMode,scriptQueues:[],isExtensionMode,cache:{localStorage:new localStorage,cacheKey:EConfigKey.cache,contents:{},expires:60*60*24*1,init(f){APP.debugMode&&console.log("cache.init"),this.localStorage.get(this.cacheKey,s=>{if(s){let a=s.expires;a&&new Date>new Date(a)||APP.debugMode?this.contents={}:this.contents=s}f&&f()})},get(f){return this.contents?this.contents[cryptoJsExports.MD5(f).toString()]:null},set(f,s){this.contents[cryptoJsExports.MD5(f).toString()]=s,this.contents.update=new Date().getTime(),this.contents.expires=new Date().getTime()+this.expires,this.localStorage.set(this.cacheKey,this.contents)},clear(){this.contents={},this.localStorage.set(this.cacheKey,this.contents)},getLastUpdateTime(){return new Promise((f,s)=>{this.localStorage.get(this.cacheKey,a=>{if(a){let u=a.update;f(u||0)}else s()})})}},addScript(f){APP.debugMode&&console.log("addScript",f),this.scriptQueues.push(f)},applyScripts(){let f=this.scriptQueues.shift();f&&this.execScript(f).then(()=>{this.applyScripts()})},execScript(f){return new Promise((s,a)=>{switch(f.type){case"code":this.runScript(f.content),s();break;default:{let u=f.content||f;u.substr(0,4)!=="http"&&(u.substr(0,1)!=="/"&&(u=`/${u}`),u=`${API.host}${u}`);let l=this.cache.get(u);try{l?(this.runScript(l),s()):(console.log("execScript: %s",u),$.ajax({url:u,dataType:"text"}).done(h=>{this.runScript(h),this.cache.set(u,h),s()}).fail((h,d,p)=>{h.responseJSON&&h.responseJSON.code&&h.responseJSON.msg?a(h.responseJSON.msg+" ("+h.responseJSON.code+")"):a(d+", "+p)}))}catch(h){a(h)}}break}})},runScript(f,s=window){eval.call(s,f)},applyStyle(f){return new Promise((s,a)=>{let u=$("<style/>").appendTo(document.body);switch(f.type){case"file":{let l=f.content;l.substr(0,4)!=="http"&&(l.substr(0,1)!=="/"&&(l=`/${l}`),l=`${API.host}${l}`);let h=this.cache.get(l);h?(u.html(h),s()):$.get(l,d=>{u.html(d),this.cache.set(l,d),s()},"text");break}default:u.html(f.content),s();break}})},getScriptContent(f){let s=`${API.host}/${f}`;return f.substr(0,4)==="http"?s=f:s=s.replace("resource//","resource/"),APP.debugMode&&console.log("getScriptContent",s),$.ajax({url:s,dataType:"text"})},createErrorMessage(f){return{type:EDataResultType.error,msg:f,success:!1}},showNotifications(f,s=3e3){PPF.showNotifications(f,s)},getInstallType(){return new Promise((f,s)=>{chrome&&chrome.management?chrome.management.getSelf(a=>{a.updateUrl&&a.updateUrl.indexOf("pt-plugins/PT-Plugin-Plus")>0?f(EInstallType.crx):f(a.installType)}):s()})}};APP.cache.init();const API=RESOURCE_API;class SyncStorage{constructor(){this.arrayValues={}}isArray(s){return Object.prototype.toString.call(s)=="[object Array]"}clear(){return new Promise((s,a)=>{try{chrome.storage.sync.clear(),chrome.runtime.lastError?a(chrome.runtime.lastError):s()}catch(u){a(u)}})}_set(s,a,u=0,l,h){let d=a,p=s,y=-1;if(this.isArray(a)){if(u==0){u=a.length,this._set(`${s}__count`,u,0,()=>{this._set(s,a,u,l,h)},h);return}y=a.length-1,d=a.pop(),p=`${s}_${y}`}chrome.storage.sync.set({[p]:d},()=>{chrome.runtime.lastError?h(chrome.runtime.lastError):y>0?this._set(s,a,u,l,h):l(a)})}_get(s,a=!1,u=0,l,h){if(a){this._get(`${s}__count`,!1,0,p=>{p>0?(this.arrayValues[s]=[],this._get(s,!1,p,l,h)):this._get(s,!1,0,l,h)},p=>{p=="参数不存在"?this._get(s,!1,0,l,h):h&&h(p)});return}let d=s;u>0&&(d=`${s}_${u-1}`);try{chrome.storage.sync.get(d,p=>{let y=null;try{if(p[d])y=p[d];else{h("参数不存在");return}}catch(g){h(g);return}u--,u<=0?this.arrayValues[s]?(this.arrayValues[s].push(y),l(this.arrayValues[s]),delete this.arrayValues[s]):l(y):(this.arrayValues[s].push(y),this._get(s,!1,u,l,h))})}catch(p){h(p)}}set(s,a){return new Promise((u,l)=>{if(chrome.storage&&chrome.storage.sync)try{this._set(s,a,0,()=>{u(a)},h=>{l(h)})}catch(h){l(h)}else l("chrome.storage 不存在")})}get(s){return new Promise((a,u)=>{if(chrome.storage&&chrome.storage.sync)try{this._get(s,!0,0,l=>{a(l)},l=>{u(l)})}catch(l){u(l)}else u("chrome.storage 不存在")})}}class OWSS{constructor(s){this.options=s,this.serverURL="",this.serverURL=this.options.address,this.serverURL.substr(-1)!=="/"&&(this.serverURL+="/")}request(s,a=ERequestMethod.GET,u){return new Promise((l,h)=>{let d={url:this.serverURL+`${s}`,method:a,dataType:"json",data:u};a===ERequestMethod.POST&&(d.processData=!1,d.contentType=!1),$.ajax(d).done(p=>{l(p)}).fail(p=>{h(p)})})}create(){return new Promise((s,a)=>{this.request("create").then(u=>{u&&u.data?s(u.data):a()}).catch(u=>{a(u)})})}add(s){return new Promise((a,u)=>{this.request(`${this.options.authCode}/add`,ERequestMethod.POST,s).then(l=>{l&&l.data===!0?a(!0):u(!1)}).catch(l=>{u(l)})})}get(s){return new Promise((a,u)=>{let l=`${this.serverURL}${this.options.authCode}/get/${s}`,h=new FileDownloader({url:l,getDataOnly:!0});h.onCompleted=()=>{a(h.content)},h.onError=d=>{console.log(d),u(d)},h.start()})}delete(s){return new Promise((a,u)=>{this.request(`${this.options.authCode}/delete/${s}`,ERequestMethod.POST).then(l=>{l&&l.data?a(l.data):u(!1)}).catch(l=>{u(l)})})}list(s={}){return new Promise((a,u)=>{this.request(`${this.options.authCode}/list`,ERequestMethod.GET,s).then(l=>{l&&l.data?a(l.data):u(!1)}).catch(l=>{u(l)})})}ping(){return new Promise((s,a)=>{this.request(`${this.options.authCode}/list`,ERequestMethod.GET,{pageSize:1}).then(()=>{s(!0)}).catch(u=>{a(u)})})}}/*! For license information please see index.js.LICENSE.txt */var t={2:f=>{function s(l,h,d){l instanceof RegExp&&(l=a(l,d)),h instanceof RegExp&&(h=a(h,d));var p=u(l,h,d);return p&&{start:p[0],end:p[1],pre:d.slice(0,p[0]),body:d.slice(p[0]+l.length,p[1]),post:d.slice(p[1]+h.length)}}function a(l,h){var d=h.match(l);return d?d[0]:null}function u(l,h,d){var p,y,g,x,C,m=d.indexOf(l),v=d.indexOf(h,m+1),w=m;if(m>=0&&v>0){for(p=[],g=d.length;w>=0&&!C;)w==m?(p.push(w),m=d.indexOf(l,w+1)):p.length==1?C=[p.pop(),v]:((y=p.pop())<g&&(g=y,x=v),v=d.indexOf(h,w+1)),w=m<v&&m>=0?m:v;p.length&&(C=[g,x])}return C}f.exports=s,s.range=u},101:function(f,s,a){var u;f=a.nmd(f),function(l){f&&f.exports,typeof global=="object"&&global;var h=function(x){this.message=x};(h.prototype=new Error).name="InvalidCharacterError";var d=function(x){throw new h(x)},p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",y=/[\t\n\f\r ]/g,g={encode:function(x){x=String(x),/[^\0-\xFF]/.test(x)&&d("The string to be encoded contains characters outside of the Latin1 range.");for(var C,m,v,w,b=x.length%3,E="",k=-1,_=x.length-b;++k<_;)C=x.charCodeAt(k)<<16,m=x.charCodeAt(++k)<<8,v=x.charCodeAt(++k),E+=p.charAt((w=C+m+v)>>18&63)+p.charAt(w>>12&63)+p.charAt(w>>6&63)+p.charAt(63&w);return b==2?(C=x.charCodeAt(k)<<8,m=x.charCodeAt(++k),E+=p.charAt((w=C+m)>>10)+p.charAt(w>>4&63)+p.charAt(w<<2&63)+"="):b==1&&(w=x.charCodeAt(k),E+=p.charAt(w>>2)+p.charAt(w<<4&63)+"=="),E},decode:function(x){var C=(x=String(x).replace(y,"")).length;C%4==0&&(C=(x=x.replace(/==?$/,"")).length),(C%4==1||/[^+a-zA-Z0-9/]/.test(x))&&d("Invalid character: the string to be decoded is not correctly encoded.");for(var m,v,w=0,b="",E=-1;++E<C;)v=p.indexOf(x.charAt(E)),m=w%4?64*m+v:v,w++%4&&(b+=String.fromCharCode(255&m>>(-2*w&6)));return b},version:"1.0.0"};(u=(function(){return g}).call(s,a,s,f))===void 0||(f.exports=u)}()},172:(f,s)=>{s.d=function(a){if(!a)return 0;for(var u=(a=a.toString()).length,l=a.length;l--;){var h=a.charCodeAt(l);56320<=h&&h<=57343&&l--,127<h&&h<=2047?u++:2047<h&&h<=65535&&(u+=2)}return u}},526:f=>{var s={utf8:{stringToBytes:function(a){return s.bin.stringToBytes(unescape(encodeURIComponent(a)))},bytesToString:function(a){return decodeURIComponent(escape(s.bin.bytesToString(a)))}},bin:{stringToBytes:function(a){for(var u=[],l=0;l<a.length;l++)u.push(255&a.charCodeAt(l));return u},bytesToString:function(a){for(var u=[],l=0;l<a.length;l++)u.push(String.fromCharCode(a[l]));return u.join("")}}};f.exports=s},298:f=>{var s,a;s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a={rotl:function(u,l){return u<<l|u>>>32-l},rotr:function(u,l){return u<<32-l|u>>>l},endian:function(u){if(u.constructor==Number)return 16711935&a.rotl(u,8)|4278255360&a.rotl(u,24);for(var l=0;l<u.length;l++)u[l]=a.endian(u[l]);return u},randomBytes:function(u){for(var l=[];u>0;u--)l.push(Math.floor(256*Math.random()));return l},bytesToWords:function(u){for(var l=[],h=0,d=0;h<u.length;h++,d+=8)l[d>>>5]|=u[h]<<24-d%32;return l},wordsToBytes:function(u){for(var l=[],h=0;h<32*u.length;h+=8)l.push(u[h>>>5]>>>24-h%32&255);return l},bytesToHex:function(u){for(var l=[],h=0;h<u.length;h++)l.push((u[h]>>>4).toString(16)),l.push((15&u[h]).toString(16));return l.join("")},hexToBytes:function(u){for(var l=[],h=0;h<u.length;h+=2)l.push(parseInt(u.substr(h,2),16));return l},bytesToBase64:function(u){for(var l=[],h=0;h<u.length;h+=3)for(var d=u[h]<<16|u[h+1]<<8|u[h+2],p=0;p<4;p++)8*h+6*p<=8*u.length?l.push(s.charAt(d>>>6*(3-p)&63)):l.push("=");return l.join("")},base64ToBytes:function(u){u=u.replace(/[^A-Z0-9+\/]/gi,"");for(var l=[],h=0,d=0;h<u.length;d=++h%4)d!=0&&l.push((s.indexOf(u.charAt(h-1))&Math.pow(2,-2*d+8)-1)<<2*d|s.indexOf(u.charAt(h))>>>6-2*d);return l}},f.exports=a},635:(f,s,a)=>{const u=a(31),l=a(338),h=a(221);f.exports={XMLParser:l,XMLValidator:u,XMLBuilder:h}},705:(f,s)=>{const a=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",u="["+a+"]["+a+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*",l=new RegExp("^"+u+"$");s.isExist=function(h){return h!==void 0},s.isEmptyObject=function(h){return Object.keys(h).length===0},s.merge=function(h,d,p){if(d){const y=Object.keys(d),g=y.length;for(let x=0;x<g;x++)h[y[x]]=p==="strict"?[d[y[x]]]:d[y[x]]}},s.getValue=function(h){return s.isExist(h)?h:""},s.isName=function(h){return l.exec(h)!=null},s.getAllMatches=function(h,d){const p=[];let y=d.exec(h);for(;y;){const g=[];g.startIndex=d.lastIndex-y[0].length;const x=y.length;for(let C=0;C<x;C++)g.push(y[C]);p.push(g),y=d.exec(h)}return p},s.nameRegexp=u},31:(f,s,a)=>{const u=a(705),l={allowBooleanAttributes:!1,unpairedTags:[]};function h(_){return _===" "||_==="	"||_===`
`||_==="\r"}function d(_,S){const A=S;for(;S<_.length;S++)if(!(_[S]!="?"&&_[S]!=" ")){const P=_.substr(A,S-A);if(S>5&&P==="xml")return w("InvalidXml","XML declaration allowed only at the start of the document.",E(_,S));if(_[S]=="?"&&_[S+1]==">"){S++;break}}return S}function p(_,S){if(_.length>S+5&&_[S+1]==="-"&&_[S+2]==="-"){for(S+=3;S<_.length;S++)if(_[S]==="-"&&_[S+1]==="-"&&_[S+2]===">"){S+=2;break}}else if(_.length>S+8&&_[S+1]==="D"&&_[S+2]==="O"&&_[S+3]==="C"&&_[S+4]==="T"&&_[S+5]==="Y"&&_[S+6]==="P"&&_[S+7]==="E"){let A=1;for(S+=8;S<_.length;S++)if(_[S]==="<")A++;else if(_[S]===">"&&(A--,A===0))break}else if(_.length>S+9&&_[S+1]==="["&&_[S+2]==="C"&&_[S+3]==="D"&&_[S+4]==="A"&&_[S+5]==="T"&&_[S+6]==="A"&&_[S+7]==="["){for(S+=8;S<_.length;S++)if(_[S]==="]"&&_[S+1]==="]"&&_[S+2]===">"){S+=2;break}}return S}s.validate=function(_,S){S=Object.assign({},l,S);const A=[];let P=!1,I=!1;_[0]==="\uFEFF"&&(_=_.substr(1));for(let j=0;j<_.length;j++)if(_[j]==="<"&&_[j+1]==="?"){if(j+=2,j=d(_,j),j.err)return j}else{if(_[j]!=="<"){if(h(_[j]))continue;return w("InvalidChar","char '"+_[j]+"' is not expected.",E(_,j))}{let q=j;if(j++,_[j]==="!"){j=p(_,j);continue}{let U=!1;_[j]==="/"&&(U=!0,j++);let z="";for(;j<_.length&&_[j]!==">"&&_[j]!==" "&&_[j]!=="	"&&_[j]!==`
`&&_[j]!=="\r";j++)z+=_[j];if(z=z.trim(),z[z.length-1]==="/"&&(z=z.substring(0,z.length-1),j--),R=z,!u.isName(R)){let B;return B=z.trim().length===0?"Invalid space after '<'.":"Tag '"+z+"' is an invalid name.",w("InvalidTag",B,E(_,j))}const L=x(_,j);if(L===!1)return w("InvalidAttr","Attributes for '"+z+"' have open quote.",E(_,j));let N=L.value;if(j=L.index,N[N.length-1]==="/"){const B=j-N.length;N=N.substring(0,N.length-1);const V=m(N,S);if(V!==!0)return w(V.err.code,V.err.msg,E(_,B+V.err.line));P=!0}else if(U){if(!L.tagClosed)return w("InvalidTag","Closing tag '"+z+"' doesn't have proper closing.",E(_,j));if(N.trim().length>0)return w("InvalidTag","Closing tag '"+z+"' can't have attributes or invalid starting.",E(_,q));{const B=A.pop();if(z!==B.tagName){let V=E(_,B.tagStartPos);return w("InvalidTag","Expected closing tag '"+B.tagName+"' (opened in line "+V.line+", col "+V.col+") instead of closing tag '"+z+"'.",E(_,q))}A.length==0&&(I=!0)}}else{const B=m(N,S);if(B!==!0)return w(B.err.code,B.err.msg,E(_,j-N.length+B.err.line));if(I===!0)return w("InvalidXml","Multiple possible root nodes found.",E(_,j));S.unpairedTags.indexOf(z)!==-1||A.push({tagName:z,tagStartPos:q}),P=!0}for(j++;j<_.length;j++)if(_[j]==="<"){if(_[j+1]==="!"){j++,j=p(_,j);continue}if(_[j+1]!=="?")break;if(j=d(_,++j),j.err)return j}else if(_[j]==="&"){const B=v(_,j);if(B==-1)return w("InvalidChar","char '&' is not expected.",E(_,j));j=B}else if(I===!0&&!h(_[j]))return w("InvalidXml","Extra text at the end",E(_,j));_[j]==="<"&&j--}}}var R;return P?A.length==1?w("InvalidTag","Unclosed tag '"+A[0].tagName+"'.",E(_,A[0].tagStartPos)):!(A.length>0)||w("InvalidXml","Invalid '"+JSON.stringify(A.map(j=>j.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1}):w("InvalidXml","Start tag expected.",1)};const y='"',g="'";function x(_,S){let A="",P="",I=!1;for(;S<_.length;S++){if(_[S]===y||_[S]===g)P===""?P=_[S]:P!==_[S]||(P="");else if(_[S]===">"&&P===""){I=!0;break}A+=_[S]}return P===""&&{value:A,index:S,tagClosed:I}}const C=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function m(_,S){const A=u.getAllMatches(_,C),P={};for(let I=0;I<A.length;I++){if(A[I][1].length===0)return w("InvalidAttr","Attribute '"+A[I][2]+"' has no space in starting.",k(A[I]));if(A[I][3]!==void 0&&A[I][4]===void 0)return w("InvalidAttr","Attribute '"+A[I][2]+"' is without value.",k(A[I]));if(A[I][3]===void 0&&!S.allowBooleanAttributes)return w("InvalidAttr","boolean attribute '"+A[I][2]+"' is not allowed.",k(A[I]));const R=A[I][2];if(!b(R))return w("InvalidAttr","Attribute '"+R+"' is an invalid name.",k(A[I]));if(P.hasOwnProperty(R))return w("InvalidAttr","Attribute '"+R+"' is repeated.",k(A[I]));P[R]=1}return!0}function v(_,S){if(_[++S]===";")return-1;if(_[S]==="#")return function(P,I){let R=/\d/;for(P[I]==="x"&&(I++,R=/[\da-fA-F]/);I<P.length;I++){if(P[I]===";")return I;if(!P[I].match(R))break}return-1}(_,++S);let A=0;for(;S<_.length;S++,A++)if(!(_[S].match(/\w/)&&A<20)){if(_[S]===";")break;return-1}return S}function w(_,S,A){return{err:{code:_,msg:S,line:A.line||A,col:A.col}}}function b(_){return u.isName(_)}function E(_,S){const A=_.substring(0,S).split(/\r?\n/);return{line:A.length,col:A[A.length-1].length+1}}function k(_){return _.startIndex+_[1].length}},221:(f,s,a)=>{const u=a(87),l={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(g,x){return x},attributeValueProcessor:function(g,x){return x},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function h(g){this.options=Object.assign({},l,g),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=y),this.processTextOrObjNode=d,this.options.format?(this.indentate=p,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}function d(g,x,C){const m=this.j2x(g,C+1);return g[this.options.textNodeName]!==void 0&&Object.keys(g).length===1?this.buildTextValNode(g[this.options.textNodeName],x,m.attrStr,C):this.buildObjectNode(m.val,x,m.attrStr,C)}function p(g){return this.options.indentBy.repeat(g)}function y(g){return!(!g.startsWith(this.options.attributeNamePrefix)||g===this.options.textNodeName)&&g.substr(this.attrPrefixLen)}h.prototype.build=function(g){return this.options.preserveOrder?u(g,this.options):(Array.isArray(g)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(g={[this.options.arrayNodeName]:g}),this.j2x(g,0).val)},h.prototype.j2x=function(g,x){let C="",m="";for(let v in g)if(g[v]===void 0)this.isAttribute(v)&&(m+="");else if(g[v]===null)this.isAttribute(v)?m+="":v[0]==="?"?m+=this.indentate(x)+"<"+v+"?"+this.tagEndChar:m+=this.indentate(x)+"<"+v+"/"+this.tagEndChar;else if(g[v]instanceof Date)m+=this.buildTextValNode(g[v],v,"",x);else if(typeof g[v]!="object"){const w=this.isAttribute(v);if(w)C+=this.buildAttrPairStr(w,""+g[v]);else if(v===this.options.textNodeName){let b=this.options.tagValueProcessor(v,""+g[v]);m+=this.replaceEntitiesValue(b)}else m+=this.buildTextValNode(g[v],v,"",x)}else if(Array.isArray(g[v])){const w=g[v].length;let b="";for(let E=0;E<w;E++){const k=g[v][E];k===void 0||(k===null?v[0]==="?"?m+=this.indentate(x)+"<"+v+"?"+this.tagEndChar:m+=this.indentate(x)+"<"+v+"/"+this.tagEndChar:typeof k=="object"?this.options.oneListGroup?b+=this.j2x(k,x+1).val:b+=this.processTextOrObjNode(k,v,x):b+=this.buildTextValNode(k,v,"",x))}this.options.oneListGroup&&(b=this.buildObjectNode(b,v,"",x)),m+=b}else if(this.options.attributesGroupName&&v===this.options.attributesGroupName){const w=Object.keys(g[v]),b=w.length;for(let E=0;E<b;E++)C+=this.buildAttrPairStr(w[E],""+g[v][w[E]])}else m+=this.processTextOrObjNode(g[v],v,x);return{attrStr:C,val:m}},h.prototype.buildAttrPairStr=function(g,x){return x=this.options.attributeValueProcessor(g,""+x),x=this.replaceEntitiesValue(x),this.options.suppressBooleanAttributes&&x==="true"?" "+g:" "+g+'="'+x+'"'},h.prototype.buildObjectNode=function(g,x,C,m){if(g==="")return x[0]==="?"?this.indentate(m)+"<"+x+C+"?"+this.tagEndChar:this.indentate(m)+"<"+x+C+this.closeTag(x)+this.tagEndChar;{let v="</"+x+this.tagEndChar,w="";return x[0]==="?"&&(w="?",v=""),!C&&C!==""||g.indexOf("<")!==-1?this.options.commentPropName!==!1&&x===this.options.commentPropName&&w.length===0?this.indentate(m)+"<!--".concat(g,"-->")+this.newLine:this.indentate(m)+"<"+x+C+w+this.tagEndChar+g+this.indentate(m)+v:this.indentate(m)+"<"+x+C+w+">"+g+v}},h.prototype.closeTag=function(g){let x="";return this.options.unpairedTags.indexOf(g)!==-1?this.options.suppressUnpairedNode||(x="/"):x=this.options.suppressEmptyNode?"/":"></".concat(g),x},h.prototype.buildTextValNode=function(g,x,C,m){if(this.options.cdataPropName!==!1&&x===this.options.cdataPropName)return this.indentate(m)+"<![CDATA[".concat(g,"]]>")+this.newLine;if(this.options.commentPropName!==!1&&x===this.options.commentPropName)return this.indentate(m)+"<!--".concat(g,"-->")+this.newLine;if(x[0]==="?")return this.indentate(m)+"<"+x+C+"?"+this.tagEndChar;{let v=this.options.tagValueProcessor(x,g);return v=this.replaceEntitiesValue(v),v===""?this.indentate(m)+"<"+x+C+this.closeTag(x)+this.tagEndChar:this.indentate(m)+"<"+x+C+">"+v+"</"+x+this.tagEndChar}},h.prototype.replaceEntitiesValue=function(g){if(g&&g.length>0&&this.options.processEntities)for(let x=0;x<this.options.entities.length;x++){const C=this.options.entities[x];g=g.replace(C.regex,C.val)}return g},f.exports=h},87:f=>{function s(d,p,y,g){let x="",C=!1;for(let m=0;m<d.length;m++){const v=d[m],w=a(v);let b="";if(b=y.length===0?w:"".concat(y,".").concat(w),w===p.textNodeName){let A=v[w];l(b,p)||(A=p.tagValueProcessor(w,A),A=h(A,p)),C&&(x+=g),x+=A,C=!1;continue}if(w===p.cdataPropName){C&&(x+=g),x+="<![CDATA[".concat(v[w][0][p.textNodeName],"]]>"),C=!1;continue}if(w===p.commentPropName){x+=g+"<!--".concat(v[w][0][p.textNodeName],"-->"),C=!0;continue}if(w[0]==="?"){const A=u(v[":@"],p),P=w==="?xml"?"":g;let I=v[w][0][p.textNodeName];I=I.length!==0?" "+I:"",x+=P+"<".concat(w).concat(I).concat(A,"?>"),C=!0;continue}let E=g;E!==""&&(E+=p.indentBy);const k=u(v[":@"],p),_=g+"<".concat(w).concat(k),S=s(v[w],p,b,E);p.unpairedTags.indexOf(w)!==-1?p.suppressUnpairedNode?x+=_+">":x+=_+"/>":S&&S.length!==0||!p.suppressEmptyNode?S&&S.endsWith(">")?x+=_+">".concat(S).concat(g,"</").concat(w,">"):(x+=_+">",S&&g!==""&&(S.includes("/>")||S.includes("</"))?x+=g+p.indentBy+S+g:x+=S,x+="</".concat(w,">")):x+=_+"/>",C=!0}return x}function a(d){const p=Object.keys(d);for(let y=0;y<p.length;y++){const g=p[y];if(g!==":@")return g}}function u(d,p){let y="";if(d&&!p.ignoreAttributes)for(let g in d){let x=p.attributeValueProcessor(g,d[g]);x=h(x,p),x===!0&&p.suppressBooleanAttributes?y+=" ".concat(g.substr(p.attributeNamePrefix.length)):y+=" ".concat(g.substr(p.attributeNamePrefix.length),'="').concat(x,'"')}return y}function l(d,p){let y=(d=d.substr(0,d.length-p.textNodeName.length-1)).substr(d.lastIndexOf(".")+1);for(let g in p.stopNodes)if(p.stopNodes[g]===d||p.stopNodes[g]==="*."+y)return!0;return!1}function h(d,p){if(d&&d.length>0&&p.processEntities)for(let y=0;y<p.entities.length;y++){const g=p.entities[y];d=d.replace(g.regex,g.val)}return d}f.exports=function(d,p){let y="";return p.format&&p.indentBy.length>0&&(y=`
`),s(d,p,"",y)}},193:(f,s,a)=>{const u=a(705);function l(C,m){let v="";for(;m<C.length&&C[m]!=="'"&&C[m]!=='"';m++)v+=C[m];if(v=v.trim(),v.indexOf(" ")!==-1)throw new Error("External entites are not supported");const w=C[m++];let b="";for(;m<C.length&&C[m]!==w;m++)b+=C[m];return[v,b,m]}function h(C,m){return C[m+1]==="!"&&C[m+2]==="-"&&C[m+3]==="-"}function d(C,m){return C[m+1]==="!"&&C[m+2]==="E"&&C[m+3]==="N"&&C[m+4]==="T"&&C[m+5]==="I"&&C[m+6]==="T"&&C[m+7]==="Y"}function p(C,m){return C[m+1]==="!"&&C[m+2]==="E"&&C[m+3]==="L"&&C[m+4]==="E"&&C[m+5]==="M"&&C[m+6]==="E"&&C[m+7]==="N"&&C[m+8]==="T"}function y(C,m){return C[m+1]==="!"&&C[m+2]==="A"&&C[m+3]==="T"&&C[m+4]==="T"&&C[m+5]==="L"&&C[m+6]==="I"&&C[m+7]==="S"&&C[m+8]==="T"}function g(C,m){return C[m+1]==="!"&&C[m+2]==="N"&&C[m+3]==="O"&&C[m+4]==="T"&&C[m+5]==="A"&&C[m+6]==="T"&&C[m+7]==="I"&&C[m+8]==="O"&&C[m+9]==="N"}function x(C){if(u.isName(C))return C;throw new Error("Invalid entity name ".concat(C))}f.exports=function(C,m){const v={};if(C[m+3]!=="O"||C[m+4]!=="C"||C[m+5]!=="T"||C[m+6]!=="Y"||C[m+7]!=="P"||C[m+8]!=="E")throw new Error("Invalid Tag instead of DOCTYPE");{m+=9;let w=1,b=!1,E=!1,k="";for(;m<C.length;m++)if(C[m]!=="<"||E)if(C[m]===">"){if(E?C[m-1]==="-"&&C[m-2]==="-"&&(E=!1,w--):w--,w===0)break}else C[m]==="["?b=!0:k+=C[m];else{if(b&&d(C,m))m+=7,[entityName,val,m]=l(C,m+1),val.indexOf("&")===-1&&(v[x(entityName)]={regx:RegExp("&".concat(entityName,";"),"g"),val});else if(b&&p(C,m))m+=8;else if(b&&y(C,m))m+=8;else if(b&&g(C,m))m+=9;else{if(!h)throw new Error("Invalid DOCTYPE");E=!0}w++,k=""}if(w!==0)throw new Error("Unclosed DOCTYPE")}return{entities:v,i:m}}},63:(f,s)=>{const a={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(u,l){return l},attributeValueProcessor:function(u,l){return l},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(u,l,h){return u}};s.buildOptions=function(u){return Object.assign({},a,u)},s.defaultOptions=a},299:(f,s,a)=>{const u=a(705),l=a(365),h=a(193),d=a(494);function p(P){const I=Object.keys(P);for(let R=0;R<I.length;R++){const j=I[R];this.lastEntities[j]={regex:new RegExp("&"+j+";","g"),val:P[j]}}}function y(P,I,R,j,q,U,z){if(P!==void 0&&(this.options.trimValues&&!j&&(P=P.trim()),P.length>0)){z||(P=this.replaceEntitiesValue(P));const L=this.options.tagValueProcessor(I,P,R,q,U);return L==null?P:typeof L!=typeof P||L!==P?L:this.options.trimValues||P.trim()===P?A(P,this.options.parseTagValue,this.options.numberParseOptions):P}}function g(P){if(this.options.removeNSPrefix){const I=P.split(":"),R=P.charAt(0)==="/"?"/":"";if(I[0]==="xmlns")return"";I.length===2&&(P=R+I[1])}return P}"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,u.nameRegexp);const x=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function C(P,I,R){if(!this.options.ignoreAttributes&&typeof P=="string"){const j=u.getAllMatches(P,x),q=j.length,U={};for(let z=0;z<q;z++){const L=this.resolveNameSpace(j[z][1]);let N=j[z][4],B=this.options.attributeNamePrefix+L;if(L.length)if(this.options.transformAttributeName&&(B=this.options.transformAttributeName(B)),B==="__proto__"&&(B="#__proto__"),N!==void 0){this.options.trimValues&&(N=N.trim()),N=this.replaceEntitiesValue(N);const V=this.options.attributeValueProcessor(L,N,I);U[B]=V==null?N:typeof V!=typeof N||V!==N?V:A(N,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(U[B]=!0)}if(!Object.keys(U).length)return;if(this.options.attributesGroupName){const z={};return z[this.options.attributesGroupName]=U,z}return U}}const m=function(P){P=P.replace(/\r\n?/g,`
`);const I=new l("!xml");let R=I,j="",q="";for(let U=0;U<P.length;U++)if(P[U]==="<")if(P[U+1]==="/"){const z=k(P,">",U,"Closing Tag is not closed.");let L=P.substring(U+2,z).trim();if(this.options.removeNSPrefix){const V=L.indexOf(":");V!==-1&&(L=L.substr(V+1))}this.options.transformTagName&&(L=this.options.transformTagName(L)),R&&(j=this.saveTextToParentTag(j,R,q));const N=q.substring(q.lastIndexOf(".")+1);if(L&&this.options.unpairedTags.indexOf(L)!==-1)throw new Error("Unpaired tag can not be used as closing tag: </".concat(L,">"));let B=0;N&&this.options.unpairedTags.indexOf(N)!==-1?(B=q.lastIndexOf(".",q.lastIndexOf(".")-1),this.tagsNodeStack.pop()):B=q.lastIndexOf("."),q=q.substring(0,B),R=this.tagsNodeStack.pop(),j="",U=z}else if(P[U+1]==="?"){let z=_(P,U,!1,"?>");if(!z)throw new Error("Pi Tag is not closed.");if(j=this.saveTextToParentTag(j,R,q),!(this.options.ignoreDeclaration&&z.tagName==="?xml"||this.options.ignorePiTags)){const L=new l(z.tagName);L.add(this.options.textNodeName,""),z.tagName!==z.tagExp&&z.attrExpPresent&&(L[":@"]=this.buildAttributesMap(z.tagExp,q,z.tagName)),this.addChild(R,L,q)}U=z.closeIndex+1}else if(P.substr(U+1,3)==="!--"){const z=k(P,"-->",U+4,"Comment is not closed.");if(this.options.commentPropName){const L=P.substring(U+4,z-2);j=this.saveTextToParentTag(j,R,q),R.add(this.options.commentPropName,[{[this.options.textNodeName]:L}])}U=z}else if(P.substr(U+1,2)==="!D"){const z=h(P,U);this.docTypeEntities=z.entities,U=z.i}else if(P.substr(U+1,2)==="!["){const z=k(P,"]]>",U,"CDATA is not closed.")-2,L=P.substring(U+9,z);if(j=this.saveTextToParentTag(j,R,q),this.options.cdataPropName)R.add(this.options.cdataPropName,[{[this.options.textNodeName]:L}]);else{let N=this.parseTextData(L,R.tagname,q,!0,!1,!0);N==null&&(N=""),R.add(this.options.textNodeName,N)}U=z+2}else{let z=_(P,U,this.options.removeNSPrefix),L=z.tagName,N=z.tagExp,B=z.attrExpPresent,V=z.closeIndex;this.options.transformTagName&&(L=this.options.transformTagName(L)),R&&j&&R.tagname!=="!xml"&&(j=this.saveTextToParentTag(j,R,q,!1));const se=R;if(se&&this.options.unpairedTags.indexOf(se.tagname)!==-1&&(R=this.tagsNodeStack.pop(),q=q.substring(0,q.lastIndexOf("."))),L!==I.tagname&&(q+=q?"."+L:L),this.isItStopNode(this.options.stopNodes,q,L)){let X="";if(N.length>0&&N.lastIndexOf("/")===N.length-1)U=z.closeIndex;else if(this.options.unpairedTags.indexOf(L)!==-1)U=z.closeIndex;else{const Q=this.readStopNodeData(P,L,V+1);if(!Q)throw new Error("Unexpected end of ".concat(L));U=Q.i,X=Q.tagContent}const oe=new l(L);L!==N&&B&&(oe[":@"]=this.buildAttributesMap(N,q,L)),X&&(X=this.parseTextData(X,L,q,!0,B,!0,!0)),q=q.substr(0,q.lastIndexOf(".")),oe.add(this.options.textNodeName,X),this.addChild(R,oe,q)}else{if(N.length>0&&N.lastIndexOf("/")===N.length-1){L[L.length-1]==="/"?(L=L.substr(0,L.length-1),q=q.substr(0,q.length-1),N=L):N=N.substr(0,N.length-1),this.options.transformTagName&&(L=this.options.transformTagName(L));const X=new l(L);L!==N&&B&&(X[":@"]=this.buildAttributesMap(N,q,L)),this.addChild(R,X,q),q=q.substr(0,q.lastIndexOf("."))}else{const X=new l(L);this.tagsNodeStack.push(R),L!==N&&B&&(X[":@"]=this.buildAttributesMap(N,q,L)),this.addChild(R,X,q),R=X}j="",U=V}}else j+=P[U];return I.child};function v(P,I,R){const j=this.options.updateTag(I.tagname,R,I[":@"]);j===!1||(typeof j=="string"&&(I.tagname=j),P.addChild(I))}const w=function(P){if(this.options.processEntities){for(let I in this.docTypeEntities){const R=this.docTypeEntities[I];P=P.replace(R.regx,R.val)}for(let I in this.lastEntities){const R=this.lastEntities[I];P=P.replace(R.regex,R.val)}if(this.options.htmlEntities)for(let I in this.htmlEntities){const R=this.htmlEntities[I];P=P.replace(R.regex,R.val)}P=P.replace(this.ampEntity.regex,this.ampEntity.val)}return P};function b(P,I,R,j){return P&&(j===void 0&&(j=Object.keys(I.child).length===0),(P=this.parseTextData(P,I.tagname,R,!1,!!I[":@"]&&Object.keys(I[":@"]).length!==0,j))!==void 0&&P!==""&&I.add(this.options.textNodeName,P),P=""),P}function E(P,I,R){const j="*."+R;for(const q in P){const U=P[q];if(j===U||I===U)return!0}return!1}function k(P,I,R,j){const q=P.indexOf(I,R);if(q===-1)throw new Error(j);return q+I.length-1}function _(P,I,R){const j=function(B,V){let se,X=arguments.length>2&&arguments[2]!==void 0?arguments[2]:">",oe="";for(let Q=V;Q<B.length;Q++){let ce=B[Q];if(se)ce===se&&(se="");else if(ce==='"'||ce==="'")se=ce;else if(ce===X[0]){if(!X[1])return{data:oe,index:Q};if(B[Q+1]===X[1])return{data:oe,index:Q}}else ce==="	"&&(ce=" ");oe+=ce}}(P,I+1,arguments.length>3&&arguments[3]!==void 0?arguments[3]:">");if(!j)return;let q=j.data;const U=j.index,z=q.search(/\s/);let L=q,N=!0;if(z!==-1&&(L=q.substr(0,z).replace(/\s\s*$/,""),q=q.substr(z+1)),R){const B=L.indexOf(":");B!==-1&&(L=L.substr(B+1),N=L!==j.data.substr(B+1))}return{tagName:L,tagExp:q,closeIndex:U,attrExpPresent:N}}function S(P,I,R){const j=R;let q=1;for(;R<P.length;R++)if(P[R]==="<")if(P[R+1]==="/"){const U=k(P,">",R,"".concat(I," is not closed"));if(P.substring(R+2,U).trim()===I&&(q--,q===0))return{tagContent:P.substring(j,R),i:U};R=U}else if(P[R+1]==="?")R=k(P,"?>",R+1,"StopNode is not closed.");else if(P.substr(R+1,3)==="!--")R=k(P,"-->",R+3,"StopNode is not closed.");else if(P.substr(R+1,2)==="![")R=k(P,"]]>",R,"StopNode is not closed.")-2;else{const U=_(P,R,">");U&&((U&&U.tagName)===I&&U.tagExp[U.tagExp.length-1]!=="/"&&q++,R=U.closeIndex)}}function A(P,I,R){if(I&&typeof P=="string"){const j=P.trim();return j==="true"||j!=="false"&&d(P,R)}return u.isExist(P)?P:""}f.exports=class{constructor(P){this.options=P,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¢"},pound:{regex:/&(pound|#163);/g,val:"£"},yen:{regex:/&(yen|#165);/g,val:"¥"},euro:{regex:/&(euro|#8364);/g,val:"€"},copyright:{regex:/&(copy|#169);/g,val:"©"},reg:{regex:/&(reg|#174);/g,val:"®"},inr:{regex:/&(inr|#8377);/g,val:"₹"}},this.addExternalEntities=p,this.parseXml=m,this.parseTextData=y,this.resolveNameSpace=g,this.buildAttributesMap=C,this.isItStopNode=E,this.replaceEntitiesValue=w,this.readStopNodeData=S,this.saveTextToParentTag=b,this.addChild=v}}},338:(f,s,a)=>{const{buildOptions:u}=a(63),l=a(299),{prettify:h}=a(728),d=a(31);f.exports=class{constructor(p){this.externalEntities={},this.options=u(p)}parse(p,y){if(typeof p!="string"){if(!p.toString)throw new Error("XML data is accepted in String or Bytes[] form.");p=p.toString()}if(y){y===!0&&(y={});const C=d.validate(p,y);if(C!==!0)throw Error("".concat(C.err.msg,":").concat(C.err.line,":").concat(C.err.col))}const g=new l(this.options);g.addExternalEntities(this.externalEntities);const x=g.parseXml(p);return this.options.preserveOrder||x===void 0?x:h(x,this.options)}addEntity(p,y){if(y.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(p.indexOf("&")!==-1||p.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(y==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[p]=y}}},728:(f,s)=>{function a(d,p,y){let g;const x={};for(let C=0;C<d.length;C++){const m=d[C],v=u(m);let w="";if(w=y===void 0?v:y+"."+v,v===p.textNodeName)g===void 0?g=m[v]:g+=""+m[v];else{if(v===void 0)continue;if(m[v]){let b=a(m[v],p,w);const E=h(b,p);m[":@"]?l(b,m[":@"],w,p):Object.keys(b).length!==1||b[p.textNodeName]===void 0||p.alwaysCreateTextNode?Object.keys(b).length===0&&(p.alwaysCreateTextNode?b[p.textNodeName]="":b=""):b=b[p.textNodeName],x[v]!==void 0&&x.hasOwnProperty(v)?(Array.isArray(x[v])||(x[v]=[x[v]]),x[v].push(b)):p.isArray(v,w,E)?x[v]=[b]:x[v]=b}}}return typeof g=="string"?g.length>0&&(x[p.textNodeName]=g):g!==void 0&&(x[p.textNodeName]=g),x}function u(d){const p=Object.keys(d);for(let y=0;y<p.length;y++){const g=p[y];if(g!==":@")return g}}function l(d,p,y,g){if(p){const x=Object.keys(p),C=x.length;for(let m=0;m<C;m++){const v=x[m];g.isArray(v,y+"."+v,!0,!0)?d[v]=[p[v]]:d[v]=p[v]}}}function h(d,p){const{textNodeName:y}=p,g=Object.keys(d).length;return g===0||!(g!==1||!d[y]&&typeof d[y]!="boolean"&&d[y]!==0)}s.prettify=function(d,p){return a(d,p)}},365:f=>{f.exports=class{constructor(s){this.tagname=s,this.child=[],this[":@"]={}}add(s,a){s==="__proto__"&&(s="#__proto__"),this.child.push({[s]:a})}addChild(s){s.tagname==="__proto__"&&(s.tagname="#__proto__"),s[":@"]&&Object.keys(s[":@"]).length>0?this.child.push({[s.tagname]:s.child,":@":s[":@"]}):this.child.push({[s.tagname]:s.child})}}},135:f=>{function s(a){return!!a.constructor&&typeof a.constructor.isBuffer=="function"&&a.constructor.isBuffer(a)}f.exports=function(a){return a!=null&&(s(a)||function(u){return typeof u.readFloatLE=="function"&&typeof u.slice=="function"&&s(u.slice(0,0))}(a)||!!a._isBuffer)}},542:(f,s,a)=>{var u,l,h,d,p;u=a(298),l=a(526).utf8,h=a(135),d=a(526).bin,(p=function(y,g){y.constructor==String?y=g&&g.encoding==="binary"?d.stringToBytes(y):l.stringToBytes(y):h(y)?y=Array.prototype.slice.call(y,0):Array.isArray(y)||y.constructor===Uint8Array||(y=y.toString());for(var x=u.bytesToWords(y),C=8*y.length,m=1732584193,v=-271733879,w=-1732584194,b=271733878,E=0;E<x.length;E++)x[E]=16711935&(x[E]<<8|x[E]>>>24)|4278255360&(x[E]<<24|x[E]>>>8);x[C>>>5]|=128<<C%32,x[14+(C+64>>>9<<4)]=C;var k=p._ff,_=p._gg,S=p._hh,A=p._ii;for(E=0;E<x.length;E+=16){var P=m,I=v,R=w,j=b;m=k(m,v,w,b,x[E+0],7,-680876936),b=k(b,m,v,w,x[E+1],12,-389564586),w=k(w,b,m,v,x[E+2],17,606105819),v=k(v,w,b,m,x[E+3],22,-1044525330),m=k(m,v,w,b,x[E+4],7,-176418897),b=k(b,m,v,w,x[E+5],12,1200080426),w=k(w,b,m,v,x[E+6],17,-1473231341),v=k(v,w,b,m,x[E+7],22,-45705983),m=k(m,v,w,b,x[E+8],7,1770035416),b=k(b,m,v,w,x[E+9],12,-1958414417),w=k(w,b,m,v,x[E+10],17,-42063),v=k(v,w,b,m,x[E+11],22,-1990404162),m=k(m,v,w,b,x[E+12],7,1804603682),b=k(b,m,v,w,x[E+13],12,-40341101),w=k(w,b,m,v,x[E+14],17,-1502002290),m=_(m,v=k(v,w,b,m,x[E+15],22,1236535329),w,b,x[E+1],5,-165796510),b=_(b,m,v,w,x[E+6],9,-1069501632),w=_(w,b,m,v,x[E+11],14,643717713),v=_(v,w,b,m,x[E+0],20,-373897302),m=_(m,v,w,b,x[E+5],5,-701558691),b=_(b,m,v,w,x[E+10],9,38016083),w=_(w,b,m,v,x[E+15],14,-660478335),v=_(v,w,b,m,x[E+4],20,-405537848),m=_(m,v,w,b,x[E+9],5,568446438),b=_(b,m,v,w,x[E+14],9,-1019803690),w=_(w,b,m,v,x[E+3],14,-187363961),v=_(v,w,b,m,x[E+8],20,1163531501),m=_(m,v,w,b,x[E+13],5,-1444681467),b=_(b,m,v,w,x[E+2],9,-51403784),w=_(w,b,m,v,x[E+7],14,1735328473),m=S(m,v=_(v,w,b,m,x[E+12],20,-1926607734),w,b,x[E+5],4,-378558),b=S(b,m,v,w,x[E+8],11,-2022574463),w=S(w,b,m,v,x[E+11],16,1839030562),v=S(v,w,b,m,x[E+14],23,-35309556),m=S(m,v,w,b,x[E+1],4,-1530992060),b=S(b,m,v,w,x[E+4],11,1272893353),w=S(w,b,m,v,x[E+7],16,-155497632),v=S(v,w,b,m,x[E+10],23,-1094730640),m=S(m,v,w,b,x[E+13],4,681279174),b=S(b,m,v,w,x[E+0],11,-358537222),w=S(w,b,m,v,x[E+3],16,-722521979),v=S(v,w,b,m,x[E+6],23,76029189),m=S(m,v,w,b,x[E+9],4,-640364487),b=S(b,m,v,w,x[E+12],11,-421815835),w=S(w,b,m,v,x[E+15],16,530742520),m=A(m,v=S(v,w,b,m,x[E+2],23,-995338651),w,b,x[E+0],6,-198630844),b=A(b,m,v,w,x[E+7],10,1126891415),w=A(w,b,m,v,x[E+14],15,-1416354905),v=A(v,w,b,m,x[E+5],21,-57434055),m=A(m,v,w,b,x[E+12],6,1700485571),b=A(b,m,v,w,x[E+3],10,-1894986606),w=A(w,b,m,v,x[E+10],15,-1051523),v=A(v,w,b,m,x[E+1],21,-2054922799),m=A(m,v,w,b,x[E+8],6,1873313359),b=A(b,m,v,w,x[E+15],10,-30611744),w=A(w,b,m,v,x[E+6],15,-1560198380),v=A(v,w,b,m,x[E+13],21,1309151649),m=A(m,v,w,b,x[E+4],6,-145523070),b=A(b,m,v,w,x[E+11],10,-1120210379),w=A(w,b,m,v,x[E+2],15,718787259),v=A(v,w,b,m,x[E+9],21,-343485551),m=m+P>>>0,v=v+I>>>0,w=w+R>>>0,b=b+j>>>0}return u.endian([m,v,w,b])})._ff=function(y,g,x,C,m,v,w){var b=y+(g&x|~g&C)+(m>>>0)+w;return(b<<v|b>>>32-v)+g},p._gg=function(y,g,x,C,m,v,w){var b=y+(g&C|x&~C)+(m>>>0)+w;return(b<<v|b>>>32-v)+g},p._hh=function(y,g,x,C,m,v,w){var b=y+(g^x^C)+(m>>>0)+w;return(b<<v|b>>>32-v)+g},p._ii=function(y,g,x,C,m,v,w){var b=y+(x^(g|~C))+(m>>>0)+w;return(b<<v|b>>>32-v)+g},p._blocksize=16,p._digestsize=16,f.exports=function(y,g){if(y==null)throw new Error("Illegal argument "+y);var x=u.wordsToBytes(p(y,g));return g&&g.asBytes?x:g&&g.asString?d.bytesToString(x):u.bytesToHex(x)}},285:(f,s,a)=>{var u=a(2);f.exports=function(k){return k?(k.substr(0,2)==="{}"&&(k="\\{\\}"+k.substr(2)),E(function(_){return _.split("\\\\").join(l).split("\\{").join(h).split("\\}").join(d).split("\\,").join(p).split("\\.").join(y)}(k),!0).map(x)):[]};var l="\0SLASH"+Math.random()+"\0",h="\0OPEN"+Math.random()+"\0",d="\0CLOSE"+Math.random()+"\0",p="\0COMMA"+Math.random()+"\0",y="\0PERIOD"+Math.random()+"\0";function g(k){return parseInt(k,10)==k?parseInt(k,10):k.charCodeAt(0)}function x(k){return k.split(l).join("\\").split(h).join("{").split(d).join("}").split(p).join(",").split(y).join(".")}function C(k){if(!k)return[""];var _=[],S=u("{","}",k);if(!S)return k.split(",");var A=S.pre,P=S.body,I=S.post,R=A.split(",");R[R.length-1]+="{"+P+"}";var j=C(I);return I.length&&(R[R.length-1]+=j.shift(),R.push.apply(R,j)),_.push.apply(_,R),_}function m(k){return"{"+k+"}"}function v(k){return/^-?0\d/.test(k)}function w(k,_){return k<=_}function b(k,_){return k>=_}function E(k,_){var S=[],A=u("{","}",k);if(!A)return[k];var P=A.pre,I=A.post.length?E(A.post,!1):[""];if(/\$$/.test(A.pre))for(var R=0;R<I.length;R++){var j=P+"{"+A.body+"}"+I[R];S.push(j)}else{var q,U,z=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(A.body),L=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(A.body),N=z||L,B=A.body.indexOf(",")>=0;if(!N&&!B)return A.post.match(/,.*\}/)?E(k=A.pre+"{"+A.body+d+A.post):[k];if(N)q=A.body.split(/\.\./);else if((q=C(A.body)).length===1&&(q=E(q[0],!1).map(m)).length===1)return I.map(function(_e){return A.pre+q[0]+_e});if(N){var V=g(q[0]),se=g(q[1]),X=Math.max(q[0].length,q[1].length),oe=q.length==3?Math.abs(g(q[2])):1,Q=w;se<V&&(oe*=-1,Q=b);var ce=q.some(v);U=[];for(var H=V;Q(H,se);H+=oe){var W;if(L)(W=String.fromCharCode(H))==="\\"&&(W="");else if(W=String(H),ce){var ne=X-W.length;if(ne>0){var ee=new Array(ne+1).join("0");W=H<0?"-"+ee+W.slice(1):ee+W}}U.push(W)}}else{U=[];for(var fe=0;fe<q.length;fe++)U.push.apply(U,E(q[fe],!1))}for(fe=0;fe<U.length;fe++)for(R=0;R<I.length;R++)j=P+U[fe]+I[R],(!_||N||j)&&S.push(j)}return S}},829:f=>{function s(g){return s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},s(g)}function a(g){var x=typeof Map=="function"?new Map:void 0;return a=function(C){if(C===null||(m=C,Function.toString.call(m).indexOf("[native code]")===-1))return C;var m;if(typeof C!="function")throw new TypeError("Super expression must either be null or a function");if(x!==void 0){if(x.has(C))return x.get(C);x.set(C,v)}function v(){return u(C,arguments,h(this).constructor)}return v.prototype=Object.create(C.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),l(v,C)},a(g)}function u(g,x,C){return u=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}()?Reflect.construct:function(m,v,w){var b=[null];b.push.apply(b,v);var E=new(Function.bind.apply(m,b));return w&&l(E,w.prototype),E},u.apply(null,arguments)}function l(g,x){return l=Object.setPrototypeOf||function(C,m){return C.__proto__=m,C},l(g,x)}function h(g){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(x){return x.__proto__||Object.getPrototypeOf(x)},h(g)}var d=function(g){function x(C){var m;return function(v,w){if(!(v instanceof w))throw new TypeError("Cannot call a class as a function")}(this,x),(m=function(v,w){return!w||s(w)!=="object"&&typeof w!="function"?function(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}(v):w}(this,h(x).call(this,C))).name="ObjectPrototypeMutationError",m}return function(C,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function");C.prototype=Object.create(m&&m.prototype,{constructor:{value:C,writable:!0,configurable:!0}}),m&&l(C,m)}(x,g),x}(a(Error));function p(g,x){for(var C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){},m=x.split("."),v=m.length,w=function(k){var _=m[k];if(!g)return{v:void 0};if(_==="+"){if(Array.isArray(g))return{v:g.map(function(A,P){var I=m.slice(k+1);return I.length>0?p(A,I.join("."),C):C(g,P,m,k)})};var S=m.slice(0,k).join(".");throw new Error("Object at wildcard (".concat(S,") is not an array"))}g=C(g,_,m,k)},b=0;b<v;b++){var E=w(b);if(s(E)==="object")return E.v}return g}function y(g,x){return g.length===x+1}f.exports={set:function(g,x,C){if(s(g)!="object"||g===null||x===void 0)return g;if(typeof x=="number")return g[x]=C,g[x];try{return p(g,x,function(m,v,w,b){if(m===Reflect.getPrototypeOf({}))throw new d("Attempting to mutate Object.prototype");if(!m[v]){var E=Number.isInteger(Number(w[b+1])),k=w[b+1]==="+";m[v]=E||k?[]:{}}return y(w,b)&&(m[v]=C),m[v]})}catch(m){if(m instanceof d)throw m;return g}},get:function(g,x){if(s(g)!="object"||g===null||x===void 0)return g;if(typeof x=="number")return g[x];try{return p(g,x,function(C,m){return C[m]})}catch{return g}},has:function(g,x){var C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(s(g)!="object"||g===null||x===void 0)return!1;if(typeof x=="number")return x in g;try{var m=!1;return p(g,x,function(v,w,b,E){if(!y(b,E))return v&&v[w];m=C.own?v.hasOwnProperty(w):w in v}),m}catch{return!1}},hasOwn:function(g,x,C){return this.has(g,x,C||{own:!0})},isIn:function(g,x,C){var m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};if(s(g)!="object"||g===null||x===void 0)return!1;try{var v=!1,w=!1;return p(g,x,function(b,E,k,_){return v=v||b===C||!!b&&b[E]===C,w=y(k,_)&&s(b)==="object"&&E in b,b&&b[E]}),m.validPath?v&&w:v}catch{return!1}},ObjectPrototypeMutationError:d}},47:(f,s,a)=>{var u=a(410),l=function(g){return typeof g=="string"};function h(g,x){for(var C=[],m=0;m<g.length;m++){var v=g[m];v&&v!=="."&&(v===".."?C.length&&C[C.length-1]!==".."?C.pop():x&&C.push(".."):C.push(v))}return C}var d=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,p={};function y(g){return d.exec(g).slice(1)}p.resolve=function(){for(var g="",x=!1,C=arguments.length-1;C>=-1&&!x;C--){var m=C>=0?arguments[C]:process.cwd();if(!l(m))throw new TypeError("Arguments to path.resolve must be strings");m&&(g=m+"/"+g,x=m.charAt(0)==="/")}return(x?"/":"")+(g=h(g.split("/"),!x).join("/"))||"."},p.normalize=function(g){var x=p.isAbsolute(g),C=g.substr(-1)==="/";return(g=h(g.split("/"),!x).join("/"))||x||(g="."),g&&C&&(g+="/"),(x?"/":"")+g},p.isAbsolute=function(g){return g.charAt(0)==="/"},p.join=function(){for(var g="",x=0;x<arguments.length;x++){var C=arguments[x];if(!l(C))throw new TypeError("Arguments to path.join must be strings");C&&(g+=g?"/"+C:C)}return p.normalize(g)},p.relative=function(g,x){function C(_){for(var S=0;S<_.length&&_[S]==="";S++);for(var A=_.length-1;A>=0&&_[A]==="";A--);return S>A?[]:_.slice(S,A+1)}g=p.resolve(g).substr(1),x=p.resolve(x).substr(1);for(var m=C(g.split("/")),v=C(x.split("/")),w=Math.min(m.length,v.length),b=w,E=0;E<w;E++)if(m[E]!==v[E]){b=E;break}var k=[];for(E=b;E<m.length;E++)k.push("..");return(k=k.concat(v.slice(b))).join("/")},p._makeLong=function(g){return g},p.dirname=function(g){var x=y(g),C=x[0],m=x[1];return C||m?(m&&(m=m.substr(0,m.length-1)),C+m):"."},p.basename=function(g,x){var C=y(g)[2];return x&&C.substr(-1*x.length)===x&&(C=C.substr(0,C.length-x.length)),C},p.extname=function(g){return y(g)[3]},p.format=function(g){if(!u.isObject(g))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof g);var x=g.root||"";if(!l(x))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof g.root);return(g.dir?g.dir+p.sep:"")+(g.base||"")},p.parse=function(g){if(!l(g))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof g);var x=y(g);if(!x||x.length!==4)throw new TypeError("Invalid path '"+g+"'");return x[1]=x[1]||"",x[2]=x[2]||"",x[3]=x[3]||"",{root:x[0],dir:x[0]+x[1].slice(0,x[1].length-1),base:x[2],ext:x[3],name:x[2].slice(0,x[2].length-x[3].length)}},p.sep="/",p.delimiter=":",f.exports=p},647:(f,s)=>{var a=Object.prototype.hasOwnProperty;function u(h){try{return decodeURIComponent(h.replace(/\+/g," "))}catch{return null}}function l(h){try{return encodeURIComponent(h)}catch{return null}}s.stringify=function(h,d){d=d||"";var p,y,g=[];for(y in typeof d!="string"&&(d="?"),h)if(a.call(h,y)){if((p=h[y])||p!=null&&!isNaN(p)||(p=""),y=l(y),p=l(p),y===null||p===null)continue;g.push(y+"="+p)}return g.length?d+g.join("&"):""},s.parse=function(h){for(var d,p=/([^=?#&]+)=?([^&]*)/g,y={};d=p.exec(h);){var g=u(d[1]),x=u(d[2]);g===null||x===null||g in y||(y[g]=x)}return y}},670:f=>{f.exports=function(s,a){if(a=a.split(":")[0],!(s=+s))return!1;switch(a){case"http":case"ws":return s!==80;case"https":case"wss":return s!==443;case"ftp":return s!==21;case"gopher":return s!==70;case"file":return!1}return s!==0}},494:f=>{const s=/^[-+]?0x[a-fA-F0-9]+$/,a=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const u={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};f.exports=function(l){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(h=Object.assign({},u,h),!l||typeof l!="string")return l;let d=l.trim();if(h.skipLike!==void 0&&h.skipLike.test(d))return l;if(h.hex&&s.test(d))return Number.parseInt(d,16);{const y=a.exec(d);if(y){const g=y[1],x=y[2];let C=((p=y[3])&&p.indexOf(".")!==-1&&((p=p.replace(/0+$/,""))==="."?p="0":p[0]==="."?p="0"+p:p[p.length-1]==="."&&(p=p.substr(0,p.length-1))),p);const m=y[4]||y[6];if(!h.leadingZeros&&x.length>0&&g&&d[2]!=="."||!h.leadingZeros&&x.length>0&&!g&&d[1]!==".")return l;{const v=Number(d),w=""+v;return w.search(/[eE]/)!==-1||m?h.eNotation?v:l:d.indexOf(".")!==-1?w==="0"&&C===""||w===C||g&&w==="-"+C?v:l:x?C===w||g+C===w?v:l:d===w||d===g+w?v:l}}return l}var p}},737:(f,s,a)=>{var u=a(670),l=a(647),h=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,d=/[\n\r\t]/g,p=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,y=/:\d+$/,g=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,x=/^[a-zA-Z]:/;function C(_){return(_||"").toString().replace(h,"")}var m=[["#","hash"],["?","query"],function(_,S){return b(S.protocol)?_.replace(/\\/g,"/"):_},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],v={hash:1,query:1};function w(_){var S,A=(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{}).location||{},P={},I=typeof(_=_||A);if(_.protocol==="blob:")P=new k(unescape(_.pathname),{});else if(I==="string")for(S in P=new k(_,{}),v)delete P[S];else if(I==="object"){for(S in _)S in v||(P[S]=_[S]);P.slashes===void 0&&(P.slashes=p.test(_.href))}return P}function b(_){return _==="file:"||_==="ftp:"||_==="http:"||_==="https:"||_==="ws:"||_==="wss:"}function E(_,S){_=(_=C(_)).replace(d,""),S=S||{};var A,P=g.exec(_),I=P[1]?P[1].toLowerCase():"",R=!!P[2],j=!!P[3],q=0;return R?j?(A=P[2]+P[3]+P[4],q=P[2].length+P[3].length):(A=P[2]+P[4],q=P[2].length):j?(A=P[3]+P[4],q=P[3].length):A=P[4],I==="file:"?q>=2&&(A=A.slice(2)):b(I)?A=P[4]:I?R&&(A=A.slice(2)):q>=2&&b(S.protocol)&&(A=P[4]),{protocol:I,slashes:R||b(I),slashesCount:q,rest:A}}function k(_,S,A){if(_=(_=C(_)).replace(d,""),!(this instanceof k))return new k(_,S,A);var P,I,R,j,q,U,z=m.slice(),L=typeof S,N=this,B=0;for(L!=="object"&&L!=="string"&&(A=S,S=null),A&&typeof A!="function"&&(A=l.parse),P=!(I=E(_||"",S=w(S))).protocol&&!I.slashes,N.slashes=I.slashes||P&&S.slashes,N.protocol=I.protocol||S.protocol||"",_=I.rest,(I.protocol==="file:"&&(I.slashesCount!==2||x.test(_))||!I.slashes&&(I.protocol||I.slashesCount<2||!b(N.protocol)))&&(z[3]=[/(.*)/,"pathname"]);B<z.length;B++)typeof(j=z[B])!="function"?(R=j[0],U=j[1],R!=R?N[U]=_:typeof R=="string"?~(q=R==="@"?_.lastIndexOf(R):_.indexOf(R))&&(typeof j[2]=="number"?(N[U]=_.slice(0,q),_=_.slice(q+j[2])):(N[U]=_.slice(q),_=_.slice(0,q))):(q=R.exec(_))&&(N[U]=q[1],_=_.slice(0,q.index)),N[U]=N[U]||P&&j[3]&&S[U]||"",j[4]&&(N[U]=N[U].toLowerCase())):_=j(_,N);A&&(N.query=A(N.query)),P&&S.slashes&&N.pathname.charAt(0)!=="/"&&(N.pathname!==""||S.pathname!=="")&&(N.pathname=function(V,se){if(V==="")return se;for(var X=(se||"/").split("/").slice(0,-1).concat(V.split("/")),oe=X.length,Q=X[oe-1],ce=!1,H=0;oe--;)X[oe]==="."?X.splice(oe,1):X[oe]===".."?(X.splice(oe,1),H++):H&&(oe===0&&(ce=!0),X.splice(oe,1),H--);return ce&&X.unshift(""),Q!=="."&&Q!==".."||X.push(""),X.join("/")}(N.pathname,S.pathname)),N.pathname.charAt(0)!=="/"&&b(N.protocol)&&(N.pathname="/"+N.pathname),u(N.port,N.protocol)||(N.host=N.hostname,N.port=""),N.username=N.password="",N.auth&&(~(q=N.auth.indexOf(":"))?(N.username=N.auth.slice(0,q),N.username=encodeURIComponent(decodeURIComponent(N.username)),N.password=N.auth.slice(q+1),N.password=encodeURIComponent(decodeURIComponent(N.password))):N.username=encodeURIComponent(decodeURIComponent(N.auth)),N.auth=N.password?N.username+":"+N.password:N.username),N.origin=N.protocol!=="file:"&&b(N.protocol)&&N.host?N.protocol+"//"+N.host:"null",N.href=N.toString()}k.prototype={set:function(_,S,A){var P=this;switch(_){case"query":typeof S=="string"&&S.length&&(S=(A||l.parse)(S)),P[_]=S;break;case"port":P[_]=S,u(S,P.protocol)?S&&(P.host=P.hostname+":"+S):(P.host=P.hostname,P[_]="");break;case"hostname":P[_]=S,P.port&&(S+=":"+P.port),P.host=S;break;case"host":P[_]=S,y.test(S)?(S=S.split(":"),P.port=S.pop(),P.hostname=S.join(":")):(P.hostname=S,P.port="");break;case"protocol":P.protocol=S.toLowerCase(),P.slashes=!A;break;case"pathname":case"hash":if(S){var I=_==="pathname"?"/":"#";P[_]=S.charAt(0)!==I?I+S:S}else P[_]=S;break;case"username":case"password":P[_]=encodeURIComponent(S);break;case"auth":var R=S.indexOf(":");~R?(P.username=S.slice(0,R),P.username=encodeURIComponent(decodeURIComponent(P.username)),P.password=S.slice(R+1),P.password=encodeURIComponent(decodeURIComponent(P.password))):P.username=encodeURIComponent(decodeURIComponent(S))}for(var j=0;j<m.length;j++){var q=m[j];q[4]&&(P[q[1]]=P[q[1]].toLowerCase())}return P.auth=P.password?P.username+":"+P.password:P.username,P.origin=P.protocol!=="file:"&&b(P.protocol)&&P.host?P.protocol+"//"+P.host:"null",P.href=P.toString(),P},toString:function(_){_&&typeof _=="function"||(_=l.stringify);var S,A=this,P=A.host,I=A.protocol;I&&I.charAt(I.length-1)!==":"&&(I+=":");var R=I+(A.protocol&&A.slashes||b(A.protocol)?"//":"");return A.username?(R+=A.username,A.password&&(R+=":"+A.password),R+="@"):A.password?(R+=":"+A.password,R+="@"):A.protocol!=="file:"&&b(A.protocol)&&!P&&A.pathname!=="/"&&(R+="@"),(P[P.length-1]===":"||y.test(A.hostname)&&!A.port)&&(P+=":"),R+=P+A.pathname,(S=typeof A.query=="object"?_(A.query):A.query)&&(R+=S.charAt(0)!=="?"?"?"+S:S),A.hash&&(R+=A.hash),R}},k.extractProtocol=E,k.location=w,k.trimLeft=C,k.qs=l,f.exports=k},410:()=>{},388:()=>{},805:()=>{},345:()=>{},800:()=>{}},e={};function n(f){var s=e[f];if(s!==void 0)return s.exports;var a=e[f]={id:f,loaded:!1,exports:{}};return t[f].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.n=f=>{var s=f&&f.__esModule?()=>f.default:()=>f;return n.d(s,{a:s}),s},n.d=(f,s)=>{for(var a in s)n.o(s,a)&&!n.o(f,a)&&Object.defineProperty(f,a,{enumerable:!0,get:s[a]})},n.o=(f,s)=>Object.prototype.hasOwnProperty.call(f,s),n.nmd=f=>(f.paths=[],f.children||(f.children=[]),f);var r={};(()=>{n.d(r,{hT:()=>z,O4:()=>L,Kd:()=>q,YK:()=>U,UU:()=>Fr,Gu:()=>Q,ky:()=>Ht,h4:()=>yt,ch:()=>At,hq:()=>at,i5:()=>Kt});var f=n(737),s=n.n(f);function a(F){if(!u(F))throw new Error("Parameter was not an error")}function u(F){return D=F,Object.prototype.toString.call(D)==="[object Error]"||F instanceof Error;var D}class l extends Error{constructor(D,T){const M=[...arguments],{options:Z,shortMessage:K}=function(ie){let de,me="";if(ie.length===0)de={};else if(u(ie[0]))de={cause:ie[0]},me=ie.slice(1).join(" ")||"";else if(ie[0]&&typeof ie[0]=="object")de=Object.assign({},ie[0]),me=ie.slice(1).join(" ")||"";else{if(typeof ie[0]!="string")throw new Error("Invalid arguments passed to Layerr");de={},me=me=ie.join(" ")||""}return{options:de,shortMessage:me}}(M);let J=K;if(Z.cause&&(J="".concat(J,": ").concat(Z.cause.message)),super(J),this.message=J,Z.name&&typeof Z.name=="string"?this.name=Z.name:this.name="Layerr",Z.cause&&Object.defineProperty(this,"_cause",{value:Z.cause}),Object.defineProperty(this,"_info",{value:{}}),Z.info&&typeof Z.info=="object"&&Object.assign(this._info,Z.info),Error.captureStackTrace){const ie=Z.constructorOpt||this.constructor;Error.captureStackTrace(this,ie)}}static cause(D){return a(D),D._cause&&u(D._cause)?D._cause:null}static fullStack(D){a(D);const T=l.cause(D);return T?"".concat(D.stack,`
caused by: `).concat(l.fullStack(T)):D.stack}static info(D){a(D);const T={},M=l.cause(D);return M&&Object.assign(T,l.info(M)),D._info&&Object.assign(T,D._info),T}cause(){return l.cause(this)}toString(){let D=this.name||this.constructor.name||this.constructor.prototype.name;return this.message&&(D="".concat(D,": ").concat(this.message)),D}}var h=n(47),d=n.n(h);const p="__PATH_SEPARATOR_POSIX__",y="__PATH_SEPARATOR_WINDOWS__";function g(F){try{const D=F.replace(/\//g,p).replace(/\\\\/g,y);return encodeURIComponent(D).split(y).join("\\\\").split(p).join("/")}catch(D){throw new l(D,"Failed encoding path")}}function x(F){return F.startsWith("/")?F:"/"+F}function C(F){let D=F;return D[0]!=="/"&&(D="/"+D),/^.+\/$/.test(D)&&(D=D.substr(0,D.length-1)),D}function m(F){let D=new(s())(F).pathname;return D.length<=0&&(D="/"),C(D)}function v(){for(var F=arguments.length,D=new Array(F),T=0;T<F;T++)D[T]=arguments[T];return function(){return function(M){var Z=[];if(M.length===0)return"";if(typeof M[0]!="string")throw new TypeError("Url must be a string. Received "+M[0]);if(M[0].match(/^[^/:]+:\/*$/)&&M.length>1){var K=M.shift();M[0]=K+M[0]}M[0].match(/^file:\/\/\//)?M[0]=M[0].replace(/^([^/:]+):\/*/,"$1:///"):M[0]=M[0].replace(/^([^/:]+):\/*/,"$1://");for(var J=0;J<M.length;J++){var ie=M[J];if(typeof ie!="string")throw new TypeError("Url must be a string. Received "+ie);ie!==""&&(J>0&&(ie=ie.replace(/^[\/]+/,"")),ie=J<M.length-1?ie.replace(/[\/]+$/,""):ie.replace(/[\/]+$/,"/"),Z.push(ie))}var de=Z.join("/"),me=(de=de.replace(/\/(\?|&|#[^!])/g,"$1")).split("?");return me.shift()+(me.length>0?"?":"")+me.join("&")}(typeof arguments[0]=="object"?arguments[0]:[].slice.call(arguments))}(D.reduce((M,Z,K)=>((K===0||Z!=="/"||Z==="/"&&M[M.length-1]!=="/")&&M.push(Z),M),[]))}var w=n(542),b=n.n(w);const E="abcdef0123456789";function k(F,D){const T=F.url.replace("//",""),M=T.indexOf("/")==-1?"/":T.slice(T.indexOf("/")),Z=F.method?F.method.toUpperCase():"GET",K=!!/(^|,)\s*auth\s*($|,)/.test(D.qop)&&"auth",J="00000000".concat(D.nc).slice(-8),ie=function(Oe,Ue,Be,we,Ce,Re,Ne){const Te=Ne||b()("".concat(Ue,":").concat(Be,":").concat(we));return Oe&&Oe.toLowerCase()==="md5-sess"?b()("".concat(Te,":").concat(Ce,":").concat(Re)):Te}(D.algorithm,D.username,D.realm,D.password,D.nonce,D.cnonce,D.ha1),de=b()("".concat(Z,":").concat(M)),me=K?b()("".concat(ie,":").concat(D.nonce,":").concat(J,":").concat(D.cnonce,":").concat(K,":").concat(de)):b()("".concat(ie,":").concat(D.nonce,":").concat(de)),ve={username:D.username,realm:D.realm,nonce:D.nonce,uri:M,qop:K,response:me,nc:J,cnonce:D.cnonce,algorithm:D.algorithm,opaque:D.opaque},ke=[];for(const Oe in ve)ve[Oe]&&(Oe==="qop"||Oe==="nc"||Oe==="algorithm"?ke.push("".concat(Oe,"=").concat(ve[Oe])):ke.push("".concat(Oe,'="').concat(ve[Oe],'"')));return"Digest ".concat(ke.join(", "))}function _(F){return(F.headers&&F.headers.get("www-authenticate")||"").split(/\s/)[0].toLowerCase()==="digest"}var S=n(101),A=n.n(S);function P(F){return A().decode(F)}function I(F,D){const T=(M="".concat(F,":").concat(D),A().encode(M));var M;return"Basic ".concat(T)}const R=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:typeof window<"u"?window:globalThis,j=R.fetch.bind(R),q=R.Request,U=R.Response;let z=function(F){return F.Auto="auto",F.Digest="digest",F.None="none",F.Password="password",F.Token="token",F}({}),L=function(F){return F.DataTypeNoLength="data-type-no-length",F.InvalidAuthType="invalid-auth-type",F.InvalidOutputFormat="invalid-output-format",F.LinkUnsupportedAuthType="link-unsupported-auth",F.InvalidUpdateRange="invalid-update-range",F.NotSupported="not-supported",F}({});function N(F,D,T,M,Z){switch(F.authType){case z.Auto:D&&T&&(F.headers.Authorization=I(D,T));break;case z.Digest:F.digest=function(J,ie,de){return{username:J,password:ie,ha1:de,nc:0,algorithm:"md5",hasDigestAuth:!1}}(D,T,Z);break;case z.None:break;case z.Password:F.headers.Authorization=I(D,T);break;case z.Token:F.headers.Authorization="".concat((K=M).token_type," ").concat(K.access_token);break;default:throw new l({info:{code:L.InvalidAuthType}},"Invalid auth type: ".concat(F.authType))}var K}n(345),n(800);const B="@@HOTPATCHER",V=()=>{};function se(F){return{original:F,methods:[F],final:!1}}class X{constructor(){this._configuration={registry:{},getEmptyAction:"null"},this.__type__=B}get configuration(){return this._configuration}get getEmptyAction(){return this.configuration.getEmptyAction}set getEmptyAction(D){this.configuration.getEmptyAction=D}control(D){let T=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!D||D.__type__!==B)throw new Error("Failed taking control of target HotPatcher instance: Invalid type or object");return Object.keys(D.configuration.registry).forEach(M=>{this.configuration.registry.hasOwnProperty(M)?T&&(this.configuration.registry[M]=Object.assign({},D.configuration.registry[M])):this.configuration.registry[M]=Object.assign({},D.configuration.registry[M])}),D._configuration=this.configuration,this}execute(D){const T=this.get(D)||V;for(var M=arguments.length,Z=new Array(M>1?M-1:0),K=1;K<M;K++)Z[K-1]=arguments[K];return T(...Z)}get(D){const T=this.configuration.registry[D];if(!T)switch(this.getEmptyAction){case"null":return null;case"throw":throw new Error("Failed handling method request: No method provided for override: ".concat(D));default:throw new Error("Failed handling request which resulted in an empty method: Invalid empty-action specified: ".concat(this.getEmptyAction))}return function(){for(var M=arguments.length,Z=new Array(M),K=0;K<M;K++)Z[K]=arguments[K];if(Z.length===0)throw new Error("Failed creating sequence: No functions provided");return function(){for(var J=arguments.length,ie=new Array(J),de=0;de<J;de++)ie[de]=arguments[de];let me=ie;const ve=this;for(;Z.length>0;)me=[Z.shift().apply(ve,me)];return me[0]}}(...T.methods)}isPatched(D){return!!this.configuration.registry[D]}patch(D,T){let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{chain:Z=!1}=M;if(this.configuration.registry[D]&&this.configuration.registry[D].final)throw new Error("Failed patching '".concat(D,"': Method marked as being final"));if(typeof T!="function")throw new Error("Failed patching '".concat(D,"': Provided method is not a function"));if(Z)this.configuration.registry[D]?this.configuration.registry[D].methods.push(T):this.configuration.registry[D]=se(T);else if(this.isPatched(D)){const{original:K}=this.configuration.registry[D];this.configuration.registry[D]=Object.assign(se(T),{original:K})}else this.configuration.registry[D]=se(T);return this}patchInline(D,T){this.isPatched(D)||this.patch(D,T);for(var M=arguments.length,Z=new Array(M>2?M-2:0),K=2;K<M;K++)Z[K-2]=arguments[K];return this.execute(D,...Z)}plugin(D){for(var T=arguments.length,M=new Array(T>1?T-1:0),Z=1;Z<T;Z++)M[Z-1]=arguments[Z];return M.forEach(K=>{this.patch(D,K,{chain:!0})}),this}restore(D){if(!this.isPatched(D))throw new Error("Failed restoring method: No method present for key: ".concat(D));if(typeof this.configuration.registry[D].original!="function")throw new Error("Failed restoring method: Original method not found or of invalid type for key: ".concat(D));return this.configuration.registry[D].methods=[this.configuration.registry[D].original],this}setFinal(D){if(!this.configuration.registry.hasOwnProperty(D))throw new Error("Failed marking '".concat(D,"' as final: No method found for key"));return this.configuration.registry[D].final=!0,this}}let oe=null;function Q(){return oe||(oe=new X),oe}function ce(F){return function(D){if(typeof D!="object"||D===null||Object.prototype.toString.call(D)!="[object Object]")return!1;if(Object.getPrototypeOf(D)===null)return!0;let T=D;for(;Object.getPrototypeOf(T)!==null;)T=Object.getPrototypeOf(T);return Object.getPrototypeOf(D)===T}(F)?Object.assign({},F):Object.setPrototypeOf(Object.assign({},F),Object.getPrototypeOf(F))}function H(){for(var F=arguments.length,D=new Array(F),T=0;T<F;T++)D[T]=arguments[T];let M=null,Z=[...D];for(;Z.length>0;){const K=Z.shift();M=M?W(M,K):ce(K)}return M}function W(F,D){const T=ce(F);return Object.keys(D).forEach(M=>{T.hasOwnProperty(M)?Array.isArray(D[M])?T[M]=Array.isArray(T[M])?[...T[M],...D[M]]:[...D[M]]:typeof D[M]=="object"&&D[M]?T[M]=typeof T[M]=="object"&&T[M]?W(T[M],D[M]):ce(D[M]):T[M]=D[M]:T[M]=D[M]}),T}function ne(F){const D={};for(const T of F.keys())D[T]=F.get(T);return D}function ee(){for(var F=arguments.length,D=new Array(F),T=0;T<F;T++)D[T]=arguments[T];if(D.length===0)return{};const M={};return D.reduce((Z,K)=>(Object.keys(K).forEach(J=>{const ie=J.toLowerCase();M.hasOwnProperty(ie)?Z[M[ie]]=K[J]:(M[ie]=J,Z[J]=K[J])}),Z),{})}n(805);const fe=typeof ArrayBuffer=="function",{toString:_e}=Object.prototype;function Ae(F){return fe&&(F instanceof ArrayBuffer||_e.call(F)==="[object ArrayBuffer]")}function ye(F){return F!=null&&F.constructor!=null&&typeof F.constructor.isBuffer=="function"&&F.constructor.isBuffer(F)}function Se(F){return function(){for(var D=[],T=0;T<arguments.length;T++)D[T]=arguments[T];try{return Promise.resolve(F.apply(this,D))}catch(M){return Promise.reject(M)}}}function Pe(F,D,T){return T?D?D(F):F:(F&&F.then||(F=Promise.resolve(F)),D?F.then(D):F)}const Fe=Se(function(F){const D=F._digest;return delete F._digest,D.hasDigestAuth&&(F=H(F,{headers:{Authorization:k(F,D)}})),Pe(le(F),function(T){let M=!1;return Z=function(J){return M?J:T},(K=function(){if(T.status==401)return D.hasDigestAuth=function(J,ie){if(!_(J))return!1;const de=/([a-z0-9_-]+)=(?:"([^"]+)"|([a-z0-9_-]+))/gi;for(;;){const me=J.headers&&J.headers.get("www-authenticate")||"",ve=de.exec(me);if(!ve)break;ie[ve[1]]=ve[2]||ve[3]}return ie.nc+=1,ie.cnonce=function(){let me="";for(let ve=0;ve<32;++ve)me="".concat(me).concat(E[Math.floor(16*Math.random())]);return me}(),!0}(T,D),function(){if(D.hasDigestAuth)return Pe(le(F=H(F,{headers:{Authorization:k(F,D)}})),function(J){return J.status==401?D.hasDigestAuth=!1:D.nc++,M=!0,J})}();D.nc++}())&&K.then?K.then(Z):Z(K);var Z,K})}),Me=Se(function(F,D){return Pe(le(F),function(T){return T.ok?(D.authType=z.Password,T):T.status==401&&_(T)?(D.authType=z.Digest,N(D,D.username,D.password,void 0,void 0),F._digest=D.digest,Fe(F)):T})}),De=Se(function(F,D){return D.authType===z.Auto?Me(F,D):F._digest?Fe(F):le(F)});function O(F,D,T){const M=ce(F);return M.headers=ee(D.headers,M.headers||{},T.headers||{}),T.data!==void 0&&(M.data=T.data),T.signal&&(M.signal=T.signal),D.httpAgent&&(M.httpAgent=D.httpAgent),D.httpsAgent&&(M.httpsAgent=D.httpsAgent),D.digest&&(M._digest=D.digest),typeof D.withCredentials=="boolean"&&(M.withCredentials=D.withCredentials),M}function le(F){const D=Q();return D.patchInline("request",T=>D.patchInline("fetch",j,T.url,function(M){let Z={};const K={method:M.method};if(M.headers&&(Z=ee(Z,M.headers)),M.data!==void 0){const[J,ie]=function(de){if(typeof de=="string")return[de,{}];if(ye(de))return[de,{}];if(Ae(de))return[de,{}];if(de&&typeof de=="object")return[JSON.stringify(de),{"content-type":"application/json"}];throw new Error("Unable to convert request body: Unexpected body type: ".concat(typeof de))}(M.data);K.body=J,Z=ee(Z,ie)}return M.signal&&(K.signal=M.signal),M.withCredentials&&(K.credentials="include"),K.headers=Z,K}(T)),F)}var ae=n(285);const Y={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},G=F=>F.replace(/[[\]\\-]/g,"\\$&"),te=F=>F.join(""),ge=(F,D)=>{const T=D;if(F.charAt(T)!=="[")throw new Error("not in a brace expression");const M=[],Z=[];let K=T+1,J=!1,ie=!1,de=!1,me=!1,ve=T,ke="";e:for(;K<F.length;){const we=F.charAt(K);if(we!=="!"&&we!=="^"||K!==T+1){if(we==="]"&&J&&!de){ve=K+1;break}if(J=!0,we!=="\\"||de){if(we==="["&&!de){for(const[Ce,[Re,Ne,Te]]of Object.entries(Y))if(F.startsWith(Ce,K)){if(ke)return["$.",!1,F.length-T,!0];K+=Ce.length,Te?Z.push(Re):M.push(Re),ie=ie||Ne;continue e}}de=!1,ke?(we>ke?M.push(G(ke)+"-"+G(we)):we===ke&&M.push(G(we)),ke="",K++):F.startsWith("-]",K+1)?(M.push(G(we+"-")),K+=2):F.startsWith("-",K+1)?(ke=we,K+=2):(M.push(G(we)),K++)}else de=!0,K++}else me=!0,K++}if(ve<K)return["",!1,0,!1];if(!M.length&&!Z.length)return["$.",!1,F.length-T,!0];if(Z.length===0&&M.length===1&&/^\\?.$/.test(M[0])&&!me)return[(Oe=M[0].length===2?M[0].slice(-1):M[0],Oe.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")),!1,ve-T,!1];var Oe;const Ue="["+(me?"^":"")+te(M)+"]",Be="["+(me?"":"^")+te(Z)+"]";return[M.length&&Z.length?"("+Ue+"|"+Be+")":M.length?Ue:Be,ie,ve-T,!0]};function ue(F,D,T){var M;return(D=typeof(M=function(Z,K){if(typeof Z!="object"||!Z)return Z;var J=Z[Symbol.toPrimitive];if(J!==void 0){var ie=J.call(Z,"string");if(typeof ie!="object")return ie;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Z)}(D))=="symbol"?M:String(M))in F?Object.defineProperty(F,D,{value:T,enumerable:!0,configurable:!0,writable:!0}):F[D]=T,F}const re=function(F,D){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return ot(D),!(!T.nocomment&&D.charAt(0)==="#")&&new St(D,T).match(F)},he=re,xe=/^\*+([^+@!?\*\[\(]*)$/,pe=F=>D=>!D.startsWith(".")&&D.endsWith(F),be=F=>D=>D.endsWith(F),Ee=F=>(F=F.toLowerCase(),D=>!D.startsWith(".")&&D.toLowerCase().endsWith(F)),Ie=F=>(F=F.toLowerCase(),D=>D.toLowerCase().endsWith(F)),Le=/^\*+\.\*+$/,Ve=F=>!F.startsWith(".")&&F.includes("."),$e=F=>F!=="."&&F!==".."&&F.includes("."),Ze=/^\.\*+$/,qe=F=>F!=="."&&F!==".."&&F.startsWith("."),rt=/^\*+$/,st=F=>F.length!==0&&!F.startsWith("."),Je=F=>F.length!==0&&F!=="."&&F!=="..",ct=/^\?+([^+@!?\*\[\(]*)?$/,ut=F=>{let[D,T=""]=F;const M=et([D]);return T?(T=T.toLowerCase(),Z=>M(Z)&&Z.toLowerCase().endsWith(T)):M},pt=F=>{let[D,T=""]=F;const M=nt([D]);return T?(T=T.toLowerCase(),Z=>M(Z)&&Z.toLowerCase().endsWith(T)):M},lt=F=>{let[D,T=""]=F;const M=nt([D]);return T?Z=>M(Z)&&Z.endsWith(T):M},ht=F=>{let[D,T=""]=F;const M=et([D]);return T?Z=>M(Z)&&Z.endsWith(T):M},et=F=>{let[D]=F;const T=D.length;return M=>M.length===T&&!M.startsWith(".")},nt=F=>{let[D]=F;const T=D.length;return M=>M.length===T&&M!=="."&&M!==".."},Ct=typeof process=="object"&&process?typeof process.env=="object"&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix";re.sep=Ct==="win32"?"\\":"/";const Qe=Symbol("globstar **");re.GLOBSTAR=Qe;const gt={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},mt="[^/]",xt=mt+"*?",vt=F=>F.split("").reduce((D,T)=>(D[T]=!0,D),{}),Pt=vt("().*{}+?[]^$\\!"),_t=vt("[.(");re.filter=function(F){let D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return T=>re(T,F,D)};const ze=function(F){let D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.assign({},F,D)};re.defaults=F=>{if(!F||typeof F!="object"||!Object.keys(F).length)return re;const D=re;return Object.assign(function(T,M){return D(T,M,ze(F,arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}))},{Minimatch:class extends D.Minimatch{constructor(T){super(T,ze(F,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}))}static defaults(T){return D.defaults(ze(F,T)).Minimatch}},unescape:function(T){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return D.unescape(T,ze(F,M))},escape:function(T){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return D.escape(T,ze(F,M))},filter:function(T){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return D.filter(T,ze(F,M))},defaults:T=>D.defaults(ze(F,T)),makeRe:function(T){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return D.makeRe(T,ze(F,M))},braceExpand:function(T){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return D.braceExpand(T,ze(F,M))},match:function(T,M){let Z=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return D.match(T,M,ze(F,Z))},sep:D.sep,GLOBSTAR:Qe})};const tt=function(F){let D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ot(F),D.nobrace||!/\{(?:(?!\{).)*\}/.test(F)?[F]:ae(F)};re.braceExpand=tt;const ot=F=>{if(typeof F!="string")throw new TypeError("invalid pattern");if(F.length>65536)throw new TypeError("pattern is too long")};re.makeRe=function(F){return new St(F,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).makeRe()},re.match=function(F,D){const T=new St(D,arguments.length>2&&arguments[2]!==void 0?arguments[2]:{});return F=F.filter(M=>T.match(M)),T.options.nonull&&!F.length&&F.push(D),F};const Et=/[?*]|[+@!]\(.*?\)|\[|\]/,qt=F=>F.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");class St{constructor(D){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ue(this,"options",void 0),ue(this,"set",void 0),ue(this,"pattern",void 0),ue(this,"windowsPathsNoEscape",void 0),ue(this,"nonegate",void 0),ue(this,"negate",void 0),ue(this,"comment",void 0),ue(this,"empty",void 0),ue(this,"preserveMultipleSlashes",void 0),ue(this,"partial",void 0),ue(this,"globSet",void 0),ue(this,"globParts",void 0),ue(this,"nocase",void 0),ue(this,"isWindows",void 0),ue(this,"platform",void 0),ue(this,"windowsNoMagicRoot",void 0),ue(this,"regexp",void 0),ot(D),T=T||{},this.options=T,this.pattern=D,this.platform=T.platform||Ct,this.isWindows=this.platform==="win32",this.windowsPathsNoEscape=!!T.windowsPathsNoEscape||T.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!T.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!T.nonegate,this.comment=!1,this.empty=!1,this.partial=!!T.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=T.windowsNoMagicRoot!==void 0?T.windowsNoMagicRoot:!(!this.isWindows||!this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(const D of this.set)for(const T of D)if(typeof T!="string")return!0;return!1}debug(){}make(){const D=this.pattern,T=this.options;if(!T.nocomment&&D.charAt(0)==="#")return void(this.comment=!0);if(!D)return void(this.empty=!0);this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],T.debug&&(this.debug=function(){return console.error(...arguments)}),this.debug(this.pattern,this.globSet);const M=this.globSet.map(K=>this.slashSplit(K));this.globParts=this.preprocess(M),this.debug(this.pattern,this.globParts);let Z=this.globParts.map((K,J,ie)=>{if(this.isWindows&&this.windowsNoMagicRoot){const de=!(K[0]!==""||K[1]!==""||K[2]!=="?"&&Et.test(K[2])||Et.test(K[3])),me=/^[a-z]:/i.test(K[0]);if(de)return[...K.slice(0,4),...K.slice(4).map(ve=>this.parse(ve))];if(me)return[K[0],...K.slice(1).map(ve=>this.parse(ve))]}return K.map(de=>this.parse(de))});if(this.debug(this.pattern,Z),this.set=Z.filter(K=>K.indexOf(!1)===-1),this.isWindows)for(let K=0;K<this.set.length;K++){const J=this.set[K];J[0]===""&&J[1]===""&&this.globParts[K][2]==="?"&&typeof J[3]=="string"&&/^[a-z]:$/i.test(J[3])&&(J[2]="?")}this.debug(this.pattern,this.set)}preprocess(D){if(this.options.noglobstar)for(let M=0;M<D.length;M++)for(let Z=0;Z<D[M].length;Z++)D[M][Z]==="**"&&(D[M][Z]="*");const{optimizationLevel:T=1}=this.options;return T>=2?(D=this.firstPhasePreProcess(D),D=this.secondPhasePreProcess(D)):D=T>=1?this.levelOneOptimize(D):this.adjascentGlobstarOptimize(D),D}adjascentGlobstarOptimize(D){return D.map(T=>{let M=-1;for(;(M=T.indexOf("**",M+1))!==-1;){let Z=M;for(;T[Z+1]==="**";)Z++;Z!==M&&T.splice(M,Z-M)}return T})}levelOneOptimize(D){return D.map(T=>(T=T.reduce((M,Z)=>{const K=M[M.length-1];return Z==="**"&&K==="**"?M:Z===".."&&K&&K!==".."&&K!=="."&&K!=="**"?(M.pop(),M):(M.push(Z),M)},[])).length===0?[""]:T)}levelTwoFileOptimize(D){Array.isArray(D)||(D=this.slashSplit(D));let T=!1;do{if(T=!1,!this.preserveMultipleSlashes){for(let Z=1;Z<D.length-1;Z++){const K=D[Z];Z===1&&K===""&&D[0]===""||K!=="."&&K!==""||(T=!0,D.splice(Z,1),Z--)}D[0]!=="."||D.length!==2||D[1]!=="."&&D[1]!==""||(T=!0,D.pop())}let M=0;for(;(M=D.indexOf("..",M+1))!==-1;){const Z=D[M-1];Z&&Z!=="."&&Z!==".."&&Z!=="**"&&(T=!0,D.splice(M-1,2),M-=2)}}while(T);return D.length===0?[""]:D}firstPhasePreProcess(D){let T=!1;do{T=!1;for(let M of D){let Z=-1;for(;(Z=M.indexOf("**",Z+1))!==-1;){let J=Z;for(;M[J+1]==="**";)J++;J>Z&&M.splice(Z+1,J-Z);let ie=M[Z+1];const de=M[Z+2],me=M[Z+3];if(ie!==".."||!de||de==="."||de===".."||!me||me==="."||me==="..")continue;T=!0,M.splice(Z,1);const ve=M.slice(0);ve[Z]="**",D.push(ve),Z--}if(!this.preserveMultipleSlashes){for(let J=1;J<M.length-1;J++){const ie=M[J];J===1&&ie===""&&M[0]===""||ie!=="."&&ie!==""||(T=!0,M.splice(J,1),J--)}M[0]!=="."||M.length!==2||M[1]!=="."&&M[1]!==""||(T=!0,M.pop())}let K=0;for(;(K=M.indexOf("..",K+1))!==-1;){const J=M[K-1];if(J&&J!=="."&&J!==".."&&J!=="**"){T=!0;const ie=K===1&&M[K+1]==="**"?["."]:[];M.splice(K-1,2,...ie),M.length===0&&M.push(""),K-=2}}}}while(T);return D}secondPhasePreProcess(D){for(let T=0;T<D.length-1;T++)for(let M=T+1;M<D.length;M++){const Z=this.partsMatch(D[T],D[M],!this.preserveMultipleSlashes);Z&&(D[T]=Z,D[M]=[])}return D.filter(T=>T.length)}partsMatch(D,T){let M=arguments.length>2&&arguments[2]!==void 0&&arguments[2],Z=0,K=0,J=[],ie="";for(;Z<D.length&&K<T.length;)if(D[Z]===T[K])J.push(ie==="b"?T[K]:D[Z]),Z++,K++;else if(M&&D[Z]==="**"&&T[K]===D[Z+1])J.push(D[Z]),Z++;else if(M&&T[K]==="**"&&D[Z]===T[K+1])J.push(T[K]),K++;else if(D[Z]!=="*"||!T[K]||!this.options.dot&&T[K].startsWith(".")||T[K]==="**"){if(T[K]!=="*"||!D[Z]||!this.options.dot&&D[Z].startsWith(".")||D[Z]==="**"||ie==="a")return!1;ie="b",J.push(T[K]),Z++,K++}else{if(ie==="b")return!1;ie="a",J.push(D[Z]),Z++,K++}return D.length===T.length&&J}parseNegate(){if(this.nonegate)return;const D=this.pattern;let T=!1,M=0;for(let Z=0;Z<D.length&&D.charAt(Z)==="!";Z++)T=!T,M++;M&&(this.pattern=D.slice(M)),this.negate=T}matchOne(D,T){let M=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const Z=this.options;if(this.isWindows){const we=D[0]===""&&D[1]===""&&D[2]==="?"&&typeof D[3]=="string"&&/^[a-z]:$/i.test(D[3]),Ce=T[0]===""&&T[1]===""&&T[2]==="?"&&typeof T[3]=="string"&&/^[a-z]:$/i.test(T[3]);if(we&&Ce){const Re=D[3],Ne=T[3];Re.toLowerCase()===Ne.toLowerCase()&&(D[3]=Ne)}else if(Ce&&typeof D[0]=="string"){const Re=T[3],Ne=D[0];Re.toLowerCase()===Ne.toLowerCase()&&(T[3]=Ne,T=T.slice(3))}else if(we&&typeof T[0]=="string"){const Re=D[3];Re.toLowerCase()===T[0].toLowerCase()&&(T[0]=Re,D=D.slice(3))}}const{optimizationLevel:K=1}=this.options;K>=2&&(D=this.levelTwoFileOptimize(D)),this.debug("matchOne",this,{file:D,pattern:T}),this.debug("matchOne",D.length,T.length);for(var J=0,ie=0,de=D.length,me=T.length;J<de&&ie<me;J++,ie++){this.debug("matchOne loop");var ve=T[ie],ke=D[J];if(this.debug(T,ve,ke),ve===!1)return!1;if(ve===Qe){this.debug("GLOBSTAR",[T,ve,ke]);var Oe=J,Ue=ie+1;if(Ue===me){for(this.debug("** at the end");J<de;J++)if(D[J]==="."||D[J]===".."||!Z.dot&&D[J].charAt(0)===".")return!1;return!0}for(;Oe<de;){var Be=D[Oe];if(this.debug(`
globstar while`,D,Oe,T,Ue,Be),this.matchOne(D.slice(Oe),T.slice(Ue),M))return this.debug("globstar found match!",Oe,de,Be),!0;if(Be==="."||Be===".."||!Z.dot&&Be.charAt(0)==="."){this.debug("dot detected!",D,Oe,T,Ue);break}this.debug("globstar swallow a segment, and continue"),Oe++}return!(!M||(this.debug(`
>>> no match, partial?`,D,Oe,T,Ue),Oe!==de))}let we;if(typeof ve=="string"?(we=ke===ve,this.debug("string match",ve,ke,we)):(we=ve.test(ke),this.debug("pattern match",ve,ke,we)),!we)return!1}if(J===de&&ie===me)return!0;if(J===de)return M;if(ie===me)return J===de-1&&D[J]==="";throw new Error("wtf?")}braceExpand(){return tt(this.pattern,this.options)}parse(D){ot(D);const T=this.options;if(D==="**")return Qe;if(D==="")return"";let M,Z=null;(M=D.match(rt))?Z=T.dot?Je:st:(M=D.match(xe))?Z=(T.nocase?T.dot?Ie:Ee:T.dot?be:pe)(M[1]):(M=D.match(ct))?Z=(T.nocase?T.dot?pt:ut:T.dot?lt:ht)(M):(M=D.match(Le))?Z=T.dot?$e:Ve:(M=D.match(Ze))&&(Z=qe);let K="",J=!1,ie=!1;const de=[],me=[];let ve,ke=!1,Oe=!1,Ue=D.charAt(0)===".",Be=T.dot||Ue;const we=Te=>Te.charAt(0)==="."?"":T.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",Ce=()=>{if(ke){switch(ke){case"*":K+=xt,J=!0;break;case"?":K+=mt,J=!0;break;default:K+="\\"+ke}this.debug("clearStateChar %j %j",ke,K),ke=!1}};for(let Te,je=0;je<D.length&&(Te=D.charAt(je));je++)if(this.debug("%s	%s %s %j",D,je,K,Te),ie){if(Te==="/")return!1;Pt[Te]&&(K+="\\"),K+=Te,ie=!1}else switch(Te){case"/":return!1;case"\\":Ce(),ie=!0;continue;case"?":case"*":case"+":case"@":case"!":this.debug("%s	%s %s %j <-- stateChar",D,je,K,Te),this.debug("call clearStateChar %j",ke),Ce(),ke=Te,T.noext&&Ce();continue;case"(":{if(!ke){K+="\\(";continue}const He={type:ke,start:je-1,reStart:K.length,open:gt[ke].open,close:gt[ke].close};this.debug(this.pattern,"	",He),de.push(He),K+=He.open,He.start===0&&He.type!=="!"&&(Ue=!0,K+=we(D.slice(je+1))),this.debug("plType %j %j",ke,K),ke=!1;continue}case")":{const He=de[de.length-1];if(!He){K+="\\)";continue}de.pop(),Ce(),J=!0,ve=He,K+=ve.close,ve.type==="!"&&me.push(Object.assign(ve,{reEnd:K.length}));continue}case"|":{const He=de[de.length-1];if(!He){K+="\\|";continue}Ce(),K+="|",He.start===0&&He.type!=="!"&&(Ue=!0,K+=we(D.slice(je+1)));continue}case"[":Ce();const[Ye,We,Ge,wt]=ge(D,je);Ge?(K+=Ye,Oe=Oe||We,je+=Ge-1,J=J||wt):K+="\\[";continue;case"]":K+="\\"+Te;continue;default:Ce(),K+=qt(Te)}for(ve=de.pop();ve;ve=de.pop()){let Te;Te=K.slice(ve.reStart+ve.open.length),this.debug(this.pattern,"setting tail",K,ve),Te=Te.replace(/((?:\\{2}){0,64})(\\?)\|/g,(Ye,We,Ge)=>(Ge||(Ge="\\"),We+We+Ge+"|")),this.debug(`tail=%j
   %s`,Te,Te,ve,K);const je=ve.type==="*"?xt:ve.type==="?"?mt:"\\"+ve.type;J=!0,K=K.slice(0,ve.reStart)+je+"\\("+Te}Ce(),ie&&(K+="\\\\");const Re=_t[K.charAt(0)];for(let Te=me.length-1;Te>-1;Te--){const je=me[Te],Ye=K.slice(0,je.reStart),We=K.slice(je.reStart,je.reEnd-8);let Ge=K.slice(je.reEnd);const wt=K.slice(je.reEnd-8,je.reEnd)+Ge,He=Ye.split(")").length,Tr=Ye.split("(").length-He;let $t=Ge;for(let rr=0;rr<Tr;rr++)$t=$t.replace(/\)[+*?]?/,"");Ge=$t,K=Ye+We+Ge+(Ge===""?"(?:$|\\/)":"")+wt}if(K!==""&&J&&(K="(?=.)"+K),Re&&(K=(Ue?"":Be?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)")+K),!T.nocase||J||T.nocaseMagicOnly||(J=D.toUpperCase()!==D.toLowerCase()),!J)return K.replace(/\\(.)/g,"$1");const Ne=(T.nocase?"i":"")+(Oe?"u":"");try{const Te=Z?{_glob:D,_src:K,test:Z}:{_glob:D,_src:K};return Object.assign(new RegExp("^"+K+"$",Ne),Te)}catch(Te){return this.debug("invalid regexp",Te),new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;const D=this.set;if(!D.length)return this.regexp=!1,this.regexp;const T=this.options,M=T.noglobstar?xt:T.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",Z=T.nocase?"i":"";let K=D.map(J=>{const ie=J.map(de=>typeof de=="string"?qt(de):de===Qe?Qe:de._src);return ie.forEach((de,me)=>{const ve=ie[me+1],ke=ie[me-1];de===Qe&&ke!==Qe&&(ke===void 0?ve!==void 0&&ve!==Qe?ie[me+1]="(?:\\/|"+M+"\\/)?"+ve:ie[me]=M:ve===void 0?ie[me-1]=ke+"(?:\\/|"+M+")?":ve!==Qe&&(ie[me-1]=ke+"(?:\\/|\\/"+M+"\\/)"+ve,ie[me+1]=Qe))}),ie.filter(de=>de!==Qe).join("/")}).join("|");K="^(?:"+K+")$",this.negate&&(K="^(?!"+K+").*$");try{this.regexp=new RegExp(K,Z)}catch{this.regexp=!1}return this.regexp}slashSplit(D){return this.preserveMultipleSlashes?D.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(D)?["",...D.split(/\/+/)]:D.split(/\/+/)}match(D){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.partial;if(this.debug("match",D,this.pattern),this.comment)return!1;if(this.empty)return D==="";if(D==="/"&&T)return!0;const M=this.options;this.isWindows&&(D=D.split("\\").join("/"));const Z=this.slashSplit(D);this.debug(this.pattern,"split",Z);const K=this.set;this.debug(this.pattern,"set",K);let J=Z[Z.length-1];if(!J)for(let ie=Z.length-2;!J&&ie>=0;ie--)J=Z[ie];for(let ie=0;ie<K.length;ie++){const de=K[ie];let me=Z;if(M.matchBase&&de.length===1&&(me=[J]),this.matchOne(me,de,T))return!!M.flipNegate||!this.negate}return!M.flipNegate&&this.negate}static defaults(D){return re.defaults(D).Minimatch}}function Bt(F){const D=new Error("".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"","Invalid response: ").concat(F.status," ").concat(F.statusText));return D.status=F.status,D.response=F,D}function Ke(F,D){const{status:T}=D;if(T===401&&F.digest)return D;if(T>=400)throw Bt(D);return D}function at(F,D){return arguments.length>2&&arguments[2]!==void 0&&arguments[2]?{data:D,headers:F.headers?ne(F.headers):{},status:F.status,statusText:F.statusText}:D}re.Minimatch=St,re.escape=function(F){let{windowsPathsNoEscape:D=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return D?F.replace(/[?*()[\]]/g,"[$&]"):F.replace(/[?*()[\]\\]/g,"\\$&")},re.unescape=function(F){let{windowsPathsNoEscape:D=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return D?F.replace(/\[([^\/\\])\]/g,"$1"):F.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1")};const nr=(zt=function(F,D,T){let M=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const Z=O({url:v(F.remoteURL,g(D)),method:"COPY",headers:{Destination:v(F.remoteURL,g(T)),Overwrite:M.overwrite===!1?"F":"T",Depth:M.shallow?"0":"infinity"}},F,M);return J=function(ie){Ke(F,ie)},(K=De(Z,F))&&K.then||(K=Promise.resolve(K)),J?K.then(J):K;var K,J},function(){for(var F=[],D=0;D<arguments.length;D++)F[D]=arguments[D];try{return Promise.resolve(zt.apply(this,F))}catch(T){return Promise.reject(T)}});var zt,Ft=n(635),ir=n(829),it=n.n(ir),ft=function(F){return F.Array="array",F.Object="object",F.Original="original",F}(ft||{});function kt(F,D){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ft.Original;const M=it().get(F,D);return T==="array"&&Array.isArray(M)===!1?[M]:T==="object"&&Array.isArray(M)?M[0]:M}function yt(F){return new Promise(D=>{D(function(T){const{multistatus:M}=T;if(M==="")return{multistatus:{response:[]}};if(!M)throw new Error("Invalid response: No root multistatus found");const Z={multistatus:Array.isArray(M)?M[0]:M};return it().set(Z,"multistatus.response",kt(Z,"multistatus.response",ft.Array)),it().set(Z,"multistatus.response",it().get(Z,"multistatus.response").map(K=>function(J){const ie=Object.assign({},J);return ie.status?it().set(ie,"status",kt(ie,"status",ft.Object)):(it().set(ie,"propstat",kt(ie,"propstat",ft.Object)),it().set(ie,"propstat.prop",kt(ie,"propstat.prop",ft.Object))),ie}(K))),Z}(new Ft.XMLParser({removeNSPrefix:!0,numberParseOptions:{hex:!0,leadingZeros:!1}}).parse(F)))})}function At(F,D){let T=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const{getlastmodified:M=null,getcontentlength:Z="0",resourcetype:K=null,getcontenttype:J=null,getetag:ie=null}=F,de=K&&typeof K=="object"&&K.collection!==void 0?"directory":"file",me={filename:D,basename:d().basename(D),lastmod:M,size:parseInt(Z,10),type:de,etag:typeof ie=="string"?ie.replace(/"/g,""):null};return de==="file"&&(me.mime=J&&typeof J=="string"?J.split(";")[0]:""),T&&(me.props=F),me}function Ht(F,D){let T=arguments.length>2&&arguments[2]!==void 0&&arguments[2],M=null;try{F.multistatus.response[0].propstat&&(M=F.multistatus.response[0])}catch{}if(!M)throw new Error("Failed getting item stat: bad response");const{propstat:{prop:Z,status:K}}=M,[J,ie,de]=K.split(" ",3),me=parseInt(ie,10);if(me>=400){const ve=new Error("Invalid response: ".concat(me," ").concat(de));throw ve.status=me,ve}return At(Z,C(D),T)}function Kt(F){switch(F.toString()){case"-3":return"unlimited";case"-2":case"-1":return"unknown";default:return parseInt(F,10)}}function Tt(F,D,T){return T?D?D(F):F:(F&&F.then||(F=Promise.resolve(F)),D?F.then(D):F)}const Ot=function(F){return function(){for(var D=[],T=0;T<arguments.length;T++)D[T]=arguments[T];try{return Promise.resolve(F.apply(this,D))}catch(M){return Promise.reject(M)}}}(function(F,D){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{details:M=!1}=T,Z=O({url:v(F.remoteURL,g(D)),method:"PROPFIND",headers:{Accept:"text/plain,application/xml",Depth:"0"}},F,T);return Tt(De(Z,F),function(K){return Ke(F,K),Tt(K.text(),function(J){return Tt(yt(J),function(ie){const de=Ht(ie,D,M);return at(K,de,M)})})})});function Wt(F,D,T){return T?D?D(F):F:(F&&F.then||(F=Promise.resolve(F)),D?F.then(D):F)}const sr=Gt(function(F,D){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const M=function(K){if(!K||K==="/")return[];let J=K;const ie=[];do ie.push(J),J=d().dirname(J);while(J&&J!=="/");return ie}(C(D));M.sort((K,J)=>K.length>J.length?1:J.length>K.length?-1:0);let Z=!1;return function(K,J,ie){if(typeof K[Zt]=="function"){let we=function(Ce){try{for(;!(de=ke.next()).done;)if((Ce=J(de.value))&&Ce.then){if(!Yt(Ce))return void Ce.then(we,ve||(ve=Xe.bind(null,me=new dt,2)));Ce=Ce.v}me?Xe(me,1,Ce):me=Ce}catch(Re){Xe(me||(me=new dt),2,Re)}};var de,me,ve,ke=K[Zt]();if(we(),ke.return){var Oe=function(Ce){try{de.done||ke.return()}catch{}return Ce};if(me&&me.then)return me.then(Oe,function(Ce){throw Oe(Ce)});Oe()}return me}if(!("length"in K))throw new TypeError("Object is not iterable");for(var Ue=[],Be=0;Be<K.length;Be++)Ue.push(K[Be]);return function(we,Ce,Re){var Ne,Te,je=-1;return function Ye(We){try{for(;++je<we.length&&(!Re||!Re());)if((We=Ce(je))&&We.then){if(!Yt(We))return void We.then(Ye,Te||(Te=Xe.bind(null,Ne=new dt,2)));We=We.v}Ne?Xe(Ne,1,We):Ne=We}catch(Ge){Xe(Ne||(Ne=new dt),2,Ge)}}(),Ne}(Ue,function(we){return J(Ue[we])},ie)}(M,function(K){return J=function(){return function(de,me){try{var ve=Wt(Ot(F,K),function(ke){if(ke.type!=="directory")throw new Error("Path includes a file: ".concat(D))})}catch(ke){return me(ke)}return ve&&ve.then?ve.then(void 0,me):ve}(0,function(de){const me=de;return function(){if(me.status===404)return Z=!0,Vt(Rt(F,K,{...T,recursive:!1}));throw de}()})},(ie=function(){if(Z)return Vt(Rt(F,K,{...T,recursive:!1}))}())&&ie.then?ie.then(J):J();var J,ie},function(){return!1})});function Gt(F){return function(){for(var D=[],T=0;T<arguments.length;T++)D[T]=arguments[T];try{return Promise.resolve(F.apply(this,D))}catch(M){return Promise.reject(M)}}}function or(){}function Vt(F,D){if(!D)return F&&F.then?F.then(or):Promise.resolve()}const Zt=typeof Symbol<"u"?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function Xe(F,D,T){if(!F.s){if(T instanceof dt){if(!T.s)return void(T.o=Xe.bind(null,F,D));1&D&&(D=T.s),T=T.v}if(T&&T.then)return void T.then(Xe.bind(null,F,D),Xe.bind(null,F,2));F.s=D,F.v=T;const M=F.o;M&&M(F)}}const dt=function(){function F(){}return F.prototype.then=function(D,T){const M=new F,Z=this.s;if(Z){const K=1&Z?D:T;if(K){try{Xe(M,1,K(this.v))}catch(J){Xe(M,2,J)}return M}return this}return this.o=function(K){try{const J=K.v;1&K.s?Xe(M,1,D?D(J):J):T?Xe(M,1,T(J)):Xe(M,2,J)}catch(J){Xe(M,2,J)}},M},F}();function Yt(F){return F instanceof dt&&1&F.s}const Rt=Gt(function(F,D){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(T.recursive===!0)return sr(F,D,T);const M=O({url:v(F.remoteURL,(Z=g(D),Z.endsWith("/")?Z:Z+"/")),method:"MKCOL"},F,T);var Z;return Wt(De(M,F),function(K){Ke(F,K)})});var ar=n(388),Xt=n.n(ar);const cr=function(F){return function(){for(var D=[],T=0;T<arguments.length;T++)D[T]=arguments[T];try{return Promise.resolve(F.apply(this,D))}catch(M){return Promise.reject(M)}}}(function(F,D){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const M={};if(typeof T.range=="object"&&typeof T.range.start=="number"){let ie="bytes=".concat(T.range.start,"-");typeof T.range.end=="number"&&(ie="".concat(ie).concat(T.range.end)),M.Range=ie}const Z=O({url:v(F.remoteURL,g(D)),method:"GET",headers:M},F,T);return J=function(ie){if(Ke(F,ie),M.Range&&ie.status!==206){const de=new Error("Invalid response code for partial request: ".concat(ie.status));throw de.status=ie.status,de}return T.callback&&setTimeout(()=>{T.callback(ie)},0),ie.body},(K=De(Z,F))&&K.then||(K=Promise.resolve(K)),J?K.then(J):K;var K,J}),ur=()=>{},lr=function(F){return function(){for(var D=[],T=0;T<arguments.length;T++)D[T]=arguments[T];try{return Promise.resolve(F.apply(this,D))}catch(M){return Promise.reject(M)}}}(function(F,D,T){T.url||(T.url=v(F.remoteURL,g(D)));const M=O(T,F,{});return K=function(J){return Ke(F,J),J},(Z=De(M,F))&&Z.then||(Z=Promise.resolve(Z)),K?Z.then(K):Z;var Z,K}),hr=function(F){return function(){for(var D=[],T=0;T<arguments.length;T++)D[T]=arguments[T];try{return Promise.resolve(F.apply(this,D))}catch(M){return Promise.reject(M)}}}(function(F,D){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const M=O({url:v(F.remoteURL,g(D)),method:"DELETE"},F,T);return K=function(J){Ke(F,J)},(Z=De(M,F))&&Z.then||(Z=Promise.resolve(Z)),K?Z.then(K):Z;var Z,K}),fr=function(F){return function(){for(var D=[],T=0;T<arguments.length;T++)D[T]=arguments[T];try{return Promise.resolve(F.apply(this,D))}catch(M){return Promise.reject(M)}}}(function(F,D){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function(M,Z){try{var K=(J=Ot(F,D,T),ie=function(){return!0},de?ie?ie(J):J:(J&&J.then||(J=Promise.resolve(J)),ie?J.then(ie):J))}catch(me){return Z(me)}var J,ie,de;return K&&K.then?K.then(void 0,Z):K}(0,function(M){if(M.status===404)return!1;throw M})});function It(F,D,T){return T?D?D(F):F:(F&&F.then||(F=Promise.resolve(F)),D?F.then(D):F)}const dr=function(F){return function(){for(var D=[],T=0;T<arguments.length;T++)D[T]=arguments[T];try{return Promise.resolve(F.apply(this,D))}catch(M){return Promise.reject(M)}}}(function(F,D){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const M=O({url:v(F.remoteURL,g(D),"/"),method:"PROPFIND",headers:{Accept:"text/plain,application/xml",Depth:T.deep?"infinity":"1"}},F,T);return It(De(M,F),function(Z){return Ke(F,Z),It(Z.text(),function(K){if(!K)throw new Error("Failed parsing directory contents: Empty response");return It(yt(K),function(J){const ie=x(D);let de=function(me,ve,ke){let Oe=arguments.length>3&&arguments[3]!==void 0&&arguments[3],Ue=arguments.length>4&&arguments[4]!==void 0&&arguments[4];const Be=d().join(ve,"/"),{multistatus:{response:we}}=me,Ce=we.map(Re=>{const Ne=function(je){try{return je.replace(/^https?:\/\/[^\/]+/,"")}catch(Ye){throw new l(Ye,"Failed normalising HREF")}}(Re.href),{propstat:{prop:Te}}=Re;return At(Te,Be==="/"?decodeURIComponent(C(Ne)):C(d().relative(decodeURIComponent(Be),decodeURIComponent(Ne))),Oe)});return Ue?Ce:Ce.filter(Re=>Re.basename&&(Re.type==="file"||Re.filename!==ke.replace(/\/$/,"")))}(J,x(F.remoteBasePath||F.remotePath),ie,T.details,T.includeSelf);return T.glob&&(de=function(me,ve){return me.filter(ke=>he(ke.filename,ve,{matchBase:!0}))}(de,T.glob)),at(Z,de,T.details)})})})});function Lt(F){return function(){for(var D=[],T=0;T<arguments.length;T++)D[T]=arguments[T];try{return Promise.resolve(F.apply(this,D))}catch(M){return Promise.reject(M)}}}const pr=Lt(function(F,D){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const M=O({url:v(F.remoteURL,g(D)),method:"GET",headers:{Accept:"text/plain"},transformResponse:[xr]},F,T);return Dt(De(M,F),function(Z){return Ke(F,Z),Dt(Z.text(),function(K){return at(Z,K,T.details)})})});function Dt(F,D,T){return T?D?D(F):F:(F&&F.then||(F=Promise.resolve(F)),D?F.then(D):F)}const gr=Lt(function(F,D){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const M=O({url:v(F.remoteURL,g(D)),method:"GET"},F,T);return Dt(De(M,F),function(Z){let K;return Ke(F,Z),function(J,ie){var de=J();return de&&de.then?de.then(ie):ie()}(function(){return Dt(Z.arrayBuffer(),function(J){K=J})},function(){return at(Z,K,T.details)})})}),mr=Lt(function(F,D){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{format:M="binary"}=T;if(M!=="binary"&&M!=="text")throw new l({info:{code:L.InvalidOutputFormat}},"Invalid output format: ".concat(M));return M==="text"?pr(F,D,T):gr(F,D,T)}),xr=F=>F;function vr(F){return new Ft.XMLBuilder({attributeNamePrefix:"@_",format:!0,ignoreAttributes:!1,suppressEmptyNode:!0}).build(Qt({lockinfo:{"@_xmlns:d":"DAV:",lockscope:{exclusive:{}},locktype:{write:{}},owner:{href:F}}},"d"))}function Qt(F,D){const T={...F};for(const M in T)T.hasOwnProperty(M)&&(T[M]&&typeof T[M]=="object"&&M.indexOf(":")===-1?(T["".concat(D,":").concat(M)]=Qt(T[M],D),delete T[M]):/^@_/.test(M)===!1&&(T["".concat(D,":").concat(M)]=T[M],delete T[M]));return T}function Nt(F,D,T){return T?D?D(F):F:(F&&F.then||(F=Promise.resolve(F)),D?F.then(D):F)}function Jt(F){return function(){for(var D=[],T=0;T<arguments.length;T++)D[T]=arguments[T];try{return Promise.resolve(F.apply(this,D))}catch(M){return Promise.reject(M)}}}const yr=Jt(function(F,D,T){let M=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const Z=O({url:v(F.remoteURL,g(D)),method:"UNLOCK",headers:{"Lock-Token":T}},F,M);return Nt(De(Z,F),function(K){if(Ke(F,K),K.status!==204&&K.status!==200)throw Bt(K)})}),br=Jt(function(F,D){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{refreshToken:M,timeout:Z=wr}=T,K={Accept:"text/plain,application/xml",Timeout:Z};M&&(K.If=M);const J=O({url:v(F.remoteURL,g(D)),method:"LOCK",headers:K,data:vr(F.contactHref)},F,T);return Nt(De(J,F),function(ie){return Ke(F,ie),Nt(ie.text(),function(de){const me=(Oe=de,new Ft.XMLParser({removeNSPrefix:!0,parseAttributeValue:!0,parseTagValue:!0}).parse(Oe)),ve=it().get(me,"prop.lockdiscovery.activelock.locktoken.href"),ke=it().get(me,"prop.lockdiscovery.activelock.timeout");var Oe;if(!ve)throw Bt(ie,"No lock token received: ");return{token:ve,serverTimeout:ke}})})}),wr="Infinite, Second-4100000000";function Mt(F,D,T){return T?D?D(F):F:(F&&F.then||(F=Promise.resolve(F)),D?F.then(D):F)}const Cr=function(F){return function(){for(var D=[],T=0;T<arguments.length;T++)D[T]=arguments[T];try{return Promise.resolve(F.apply(this,D))}catch(M){return Promise.reject(M)}}}(function(F){let D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const T=D.path||"/",M=O({url:v(F.remoteURL,T),method:"PROPFIND",headers:{Accept:"text/plain,application/xml",Depth:"0"}},F,D);return Mt(De(M,F),function(Z){return Ke(F,Z),Mt(Z.text(),function(K){return Mt(yt(K),function(J){const ie=function(de){try{const[me]=de.multistatus.response,{propstat:{prop:{"quota-used-bytes":ve,"quota-available-bytes":ke}}}=me;return ve!==void 0&&ke!==void 0?{used:parseInt(ve,10),available:Kt(ke)}:null}catch{}return null}(J);return at(Z,ie,D.details)})})})});function jt(F,D,T){return T?D?D(F):F:(F&&F.then||(F=Promise.resolve(F)),D?F.then(D):F)}const _r=function(F){return function(){for(var D=[],T=0;T<arguments.length;T++)D[T]=arguments[T];try{return Promise.resolve(F.apply(this,D))}catch(M){return Promise.reject(M)}}}(function(F,D){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{details:M=!1}=T,Z=O({url:v(F.remoteURL,g(D)),method:"SEARCH",headers:{Accept:"text/plain,application/xml","Content-Type":F.headers["Content-Type"]||"application/xml; charset=utf-8"}},F,T);return jt(De(Z,F),function(K){return Ke(F,K),jt(K.text(),function(J){return jt(yt(J),function(ie){const de=function(me,ve,ke){const Oe={truncated:!1,results:[]};return Oe.truncated=me.multistatus.response.some(Ue=>{var Be,we;return((Be=(Ue.status||((we=Ue.propstat)===null||we===void 0?void 0:we.status)).split(" ",3))===null||Be===void 0?void 0:Be[1])==="507"&&Ue.href.replace(/\/$/,"").endsWith(g(ve).replace(/\/$/,""))}),me.multistatus.response.forEach(Ue=>{if(Ue.propstat===void 0)return;const Be=Ue.href.split("/").map(decodeURIComponent).join("/");Oe.results.push(At(Ue.propstat.prop,Be,ke))}),Oe}(ie,D,M);return at(K,de,M)})})})}),Er=function(F){return function(){for(var D=[],T=0;T<arguments.length;T++)D[T]=arguments[T];try{return Promise.resolve(F.apply(this,D))}catch(M){return Promise.reject(M)}}}(function(F,D,T){let M=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const Z=O({url:v(F.remoteURL,g(D)),method:"MOVE",headers:{Destination:v(F.remoteURL,g(T)),Overwrite:M.overwrite===!1?"F":"T"}},F,M);return J=function(ie){Ke(F,ie)},(K=De(Z,F))&&K.then||(K=Promise.resolve(K)),J?K.then(J):K;var K,J});var Sr=n(172);const kr=function(F){return function(){for(var D=[],T=0;T<arguments.length;T++)D[T]=arguments[T];try{return Promise.resolve(F.apply(this,D))}catch(M){return Promise.reject(M)}}}(function(F,D,T){let M=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const{contentLength:Z=!0,overwrite:K=!0}=M,J={"Content-Type":"application/octet-stream"};Z===!1||(J["Content-Length"]="".concat(typeof Z=="number"?Z:function(ve){if(Ae(ve))return ve.byteLength;if(ye(ve))return ve.length;if(typeof ve=="string")return(0,Sr.d)(ve);throw new l({info:{code:L.DataTypeNoLength}},"Cannot calculate data length: Invalid type")}(T))),K||(J["If-None-Match"]="*");const ie=O({url:v(F.remoteURL,g(D)),method:"PUT",headers:J,data:T},F,M);return me=function(ve){try{Ke(F,ve)}catch(ke){const Oe=ke;if(Oe.status!==412||K)throw Oe;return!1}return!0},(de=De(ie,F))&&de.then||(de=Promise.resolve(de)),me?de.then(me):de;var de,me}),er=function(F){return function(){for(var D=[],T=0;T<arguments.length;T++)D[T]=arguments[T];try{return Promise.resolve(F.apply(this,D))}catch(M){return Promise.reject(M)}}}(function(F,D){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const M=O({url:v(F.remoteURL,g(D)),method:"OPTIONS"},F,T);return K=function(J){var ie,de;try{Ke(F,J)}catch(me){throw me}return{compliance:((ie=J.headers.get("DAV"))!==null&&ie!==void 0?ie:"").split(",").map(me=>me.trim()),server:(de=J.headers.get("Server"))!==null&&de!==void 0?de:""}},(Z=De(M,F))&&Z.then||(Z=Promise.resolve(Z)),K?Z.then(K):Z;var Z,K});function bt(F,D,T){return T?D?D(F):F:(F&&F.then||(F=Promise.resolve(F)),D?F.then(D):F)}const Ar=Ut(function(F,D,T,M,Z){let K=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};if(T>M||T<0)throw new l({info:{code:L.InvalidUpdateRange}},"Invalid update range ".concat(T," for partial update"));const J={"Content-Type":"application/octet-stream","Content-Length":"".concat(M-T+1),"Content-Range":"bytes ".concat(T,"-").concat(M,"/*")},ie=O({url:v(F.remoteURL,g(D)),method:"PUT",headers:J,data:Z},F,K);return bt(De(ie,F),function(de){Ke(F,de)})});function tr(F,D){var T=F();return T&&T.then?T.then(D):D(T)}const Dr=Ut(function(F,D,T,M,Z){let K=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};if(T>M||T<0)throw new l({info:{code:L.InvalidUpdateRange}},"Invalid update range ".concat(T," for partial update"));const J={"Content-Type":"application/x-sabredav-partialupdate","Content-Length":"".concat(M-T+1),"X-Update-Range":"bytes=".concat(T,"-").concat(M)},ie=O({url:v(F.remoteURL,g(D)),method:"PATCH",headers:J,data:Z},F,K);return bt(De(ie,F),function(de){Ke(F,de)})});function Ut(F){return function(){for(var D=[],T=0;T<arguments.length;T++)D[T]=arguments[T];try{return Promise.resolve(F.apply(this,D))}catch(M){return Promise.reject(M)}}}const Pr=Ut(function(F,D,T,M,Z){let K=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};return bt(er(F,D,K),function(J){let ie=!1;return tr(function(){if(J.compliance.includes("sabredav-partialupdate"))return bt(Dr(F,D,T,M,Z,K),function(de){return ie=!0,de})},function(de){let me=!1;return ie?de:tr(function(){if(J.server.includes("Apache")&&J.compliance.includes("<http://apache.org/dav/propset/fs/1>"))return bt(Ar(F,D,T,M,Z,K),function(ve){return me=!0,ve})},function(ve){if(me)return ve;throw new l({info:{code:L.NotSupported}},"Not supported")})})})}),Br="https://github.com/perry-mitchell/webdav-client/blob/master/LOCK_CONTACT.md";function Fr(F){let D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{authType:T=null,remoteBasePath:M,contactHref:Z=Br,ha1:K,headers:J={},httpAgent:ie,httpsAgent:de,password:me,token:ve,username:ke,withCredentials:Oe}=D;let Ue=T;Ue||(Ue=ke||me?z.Password:z.None);const Be={authType:Ue,remoteBasePath:M,contactHref:Z,ha1:K,headers:Object.assign({},J),httpAgent:ie,httpsAgent:de,password:me,remotePath:m(F),remoteURL:F,token:ve,username:ke,withCredentials:Oe};return N(Be,ke,me,ve,K),{copyFile:(we,Ce,Re)=>nr(Be,we,Ce,Re),createDirectory:(we,Ce)=>Rt(Be,we,Ce),createReadStream:(we,Ce)=>function(Re,Ne){let Te=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const je=new(Xt()).PassThrough;return cr(Re,Ne,Te).then(Ye=>{Ye.pipe(je)}).catch(Ye=>{je.emit("error",Ye)}),je}(Be,we,Ce),createWriteStream:(we,Ce,Re)=>function(Ne,Te){let je=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Ye=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ur;const We=new(Xt()).PassThrough,Ge={};je.overwrite===!1&&(Ge["If-None-Match"]="*");const wt=O({url:v(Ne.remoteURL,g(Te)),method:"PUT",headers:Ge,data:We,maxRedirects:0},Ne,je);return De(wt,Ne).then(He=>Ke(Ne,He)).then(He=>{setTimeout(()=>{Ye(He)},0)}).catch(He=>{We.emit("error",He)}),We}(Be,we,Ce,Re),customRequest:(we,Ce)=>lr(Be,we,Ce),deleteFile:(we,Ce)=>hr(Be,we,Ce),exists:(we,Ce)=>fr(Be,we,Ce),getDirectoryContents:(we,Ce)=>dr(Be,we,Ce),getFileContents:(we,Ce)=>mr(Be,we,Ce),getFileDownloadLink:we=>function(Ce,Re){let Ne=v(Ce.remoteURL,g(Re));const Te=/^https:/i.test(Ne)?"https":"http";switch(Ce.authType){case z.None:break;case z.Password:{const je=P(Ce.headers.Authorization.replace(/^Basic /i,"").trim());Ne=Ne.replace(/^https?:\/\//,"".concat(Te,"://").concat(je,"@"));break}default:throw new l({info:{code:L.LinkUnsupportedAuthType}},"Unsupported auth type for file link: ".concat(Ce.authType))}return Ne}(Be,we),getFileUploadLink:we=>function(Ce,Re){let Ne="".concat(v(Ce.remoteURL,g(Re)),"?Content-Type=application/octet-stream");const Te=/^https:/i.test(Ne)?"https":"http";switch(Ce.authType){case z.None:break;case z.Password:{const je=P(Ce.headers.Authorization.replace(/^Basic /i,"").trim());Ne=Ne.replace(/^https?:\/\//,"".concat(Te,"://").concat(je,"@"));break}default:throw new l({info:{code:L.LinkUnsupportedAuthType}},"Unsupported auth type for file link: ".concat(Ce.authType))}return Ne}(Be,we),getHeaders:()=>Object.assign({},Be.headers),getQuota:we=>Cr(Be,we),lock:(we,Ce)=>br(Be,we,Ce),moveFile:(we,Ce,Re)=>Er(Be,we,Ce,Re),putFileContents:(we,Ce,Re)=>kr(Be,we,Ce,Re),partialUpdateFileContents:(we,Ce,Re,Ne,Te)=>Pr(Be,we,Ce,Re,Ne,Te),getDAVCompliance:we=>er(Be,we),search:(we,Ce)=>_r(Be,we,Ce),setHeaders:we=>{Be.headers=Object.assign({},we)},stat:(we,Ce)=>Ot(Be,we,Ce),unlock:(we,Ce,Re)=>yr(Be,we,Ce,Re)}}})();var o=r.hT;r.O4,r.Kd,r.YK;var c=r.UU;r.Gu,r.ky,r.h4,r.ch,r.hq,r.i5;class WebDAV{constructor(s){this.options=s,this.initServer()}initServer(){this.service=c(this.options.address,{authType:this.options.digest?o.Digest:o.Password,username:this.options.loginName,password:this.options.loginPwd})}list(s={}){return new Promise((a,u)=>{this.service.getDirectoryContents("/",{glob:"*.zip"}).then(l=>{console.log(l);let h=[],d=s.orderMode||EResourceOrderMode.desc;l&&l.length>0&&l.forEach(p=>{h.push({name:p.basename,size:p.size,type:p.type,time:new Date(p.lastmod).getTime()})}),a(h.sort((p,y)=>{let g,x;switch(s.orderBy){case EResourceOrderBy.name:g=p.name,x=y.name;break;case EResourceOrderBy.size:g=p.size,x=y.size;break;default:g=p.time,x=y.time;break}return d===EResourceOrderMode.desc?g.toString().localeCompare(x)==1?-1:1:g.toString().localeCompare(x)}))}).catch(l=>{u(l)})})}get(s){return new Promise((a,u)=>{this.service.getFileContents("/"+s).then(l=>{a(l)}).catch(l=>{u(l)})})}add(s){return new Promise((a,u)=>{s.get("data").arrayBuffer().then(l=>{this.service.putFileContents(s.get("name"),l).then(h=>{console.log(h),h?a(!0):u(!1)}).catch(h=>{console.log(h),u(h)})})})}delete(s){return new Promise((a,u)=>{this.service.deleteFile("/"+s).then(l=>{l?a(l.data):u(!1)}).catch(l=>{u(l)})})}ping(){return new Promise((s,a)=>{this.service.getDirectoryContents("/").then(()=>{s(!0)}).catch(u=>{a(u)})})}}var jszip_min={exports:{}};/*!

  JSZip v3.10.1 - A JavaScript class for generating and reading zip files
  <http://stuartk.com/jszip>

  (c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
  Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

  JSZip uses the library pako released under the MIT license :
  https://github.com/nodeca/pako/blob/main/LICENSE
  */(function(f,s){(function(a){f.exports=a()})(function(){return function a(u,l,h){function d(g,x){if(!l[g]){if(!u[g]){var C=typeof commonjsRequire=="function"&&commonjsRequire;if(!x&&C)return C(g,!0);if(p)return p(g,!0);var m=new Error("Cannot find module '"+g+"'");throw m.code="MODULE_NOT_FOUND",m}var v=l[g]={exports:{}};u[g][0].call(v.exports,function(w){var b=u[g][1][w];return d(b||w)},v,v.exports,a,u,l,h)}return l[g].exports}for(var p=typeof commonjsRequire=="function"&&commonjsRequire,y=0;y<h.length;y++)d(h[y]);return d}({1:[function(a,u,l){var h=a("./utils"),d=a("./support"),p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";l.encode=function(y){for(var g,x,C,m,v,w,b,E=[],k=0,_=y.length,S=_,A=h.getTypeOf(y)!=="string";k<y.length;)S=_-k,C=A?(g=y[k++],x=k<_?y[k++]:0,k<_?y[k++]:0):(g=y.charCodeAt(k++),x=k<_?y.charCodeAt(k++):0,k<_?y.charCodeAt(k++):0),m=g>>2,v=(3&g)<<4|x>>4,w=1<S?(15&x)<<2|C>>6:64,b=2<S?63&C:64,E.push(p.charAt(m)+p.charAt(v)+p.charAt(w)+p.charAt(b));return E.join("")},l.decode=function(y){var g,x,C,m,v,w,b=0,E=0,k="data:";if(y.substr(0,k.length)===k)throw new Error("Invalid base64 input, it looks like a data url.");var _,S=3*(y=y.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(y.charAt(y.length-1)===p.charAt(64)&&S--,y.charAt(y.length-2)===p.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(_=d.uint8array?new Uint8Array(0|S):new Array(0|S);b<y.length;)g=p.indexOf(y.charAt(b++))<<2|(m=p.indexOf(y.charAt(b++)))>>4,x=(15&m)<<4|(v=p.indexOf(y.charAt(b++)))>>2,C=(3&v)<<6|(w=p.indexOf(y.charAt(b++))),_[E++]=g,v!==64&&(_[E++]=x),w!==64&&(_[E++]=C);return _}},{"./support":30,"./utils":32}],2:[function(a,u,l){var h=a("./external"),d=a("./stream/DataWorker"),p=a("./stream/Crc32Probe"),y=a("./stream/DataLengthProbe");function g(x,C,m,v,w){this.compressedSize=x,this.uncompressedSize=C,this.crc32=m,this.compression=v,this.compressedContent=w}g.prototype={getContentWorker:function(){var x=new d(h.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new y("data_length")),C=this;return x.on("end",function(){if(this.streamInfo.data_length!==C.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),x},getCompressedWorker:function(){return new d(h.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},g.createWorkerFrom=function(x,C,m){return x.pipe(new p).pipe(new y("uncompressedSize")).pipe(C.compressWorker(m)).pipe(new y("compressedSize")).withStreamInfo("compression",C)},u.exports=g},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(a,u,l){var h=a("./stream/GenericWorker");l.STORE={magic:"\0\0",compressWorker:function(){return new h("STORE compression")},uncompressWorker:function(){return new h("STORE decompression")}},l.DEFLATE=a("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(a,u,l){var h=a("./utils"),d=function(){for(var p,y=[],g=0;g<256;g++){p=g;for(var x=0;x<8;x++)p=1&p?3988292384^p>>>1:p>>>1;y[g]=p}return y}();u.exports=function(p,y){return p!==void 0&&p.length?h.getTypeOf(p)!=="string"?function(g,x,C,m){var v=d,w=m+C;g^=-1;for(var b=m;b<w;b++)g=g>>>8^v[255&(g^x[b])];return-1^g}(0|y,p,p.length,0):function(g,x,C,m){var v=d,w=m+C;g^=-1;for(var b=m;b<w;b++)g=g>>>8^v[255&(g^x.charCodeAt(b))];return-1^g}(0|y,p,p.length,0):0}},{"./utils":32}],5:[function(a,u,l){l.base64=!1,l.binary=!1,l.dir=!1,l.createFolders=!0,l.date=null,l.compression=null,l.compressionOptions=null,l.comment=null,l.unixPermissions=null,l.dosPermissions=null},{}],6:[function(a,u,l){var h=null;h=typeof Promise<"u"?Promise:a("lie"),u.exports={Promise:h}},{lie:37}],7:[function(a,u,l){var h=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",d=a("pako"),p=a("./utils"),y=a("./stream/GenericWorker"),g=h?"uint8array":"array";function x(C,m){y.call(this,"FlateWorker/"+C),this._pako=null,this._pakoAction=C,this._pakoOptions=m,this.meta={}}l.magic="\b\0",p.inherits(x,y),x.prototype.processChunk=function(C){this.meta=C.meta,this._pako===null&&this._createPako(),this._pako.push(p.transformTo(g,C.data),!1)},x.prototype.flush=function(){y.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},x.prototype.cleanUp=function(){y.prototype.cleanUp.call(this),this._pako=null},x.prototype._createPako=function(){this._pako=new d[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var C=this;this._pako.onData=function(m){C.push({data:m,meta:C.meta})}},l.compressWorker=function(C){return new x("Deflate",C)},l.uncompressWorker=function(){return new x("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(a,u,l){function h(v,w){var b,E="";for(b=0;b<w;b++)E+=String.fromCharCode(255&v),v>>>=8;return E}function d(v,w,b,E,k,_){var S,A,P=v.file,I=v.compression,R=_!==g.utf8encode,j=p.transformTo("string",_(P.name)),q=p.transformTo("string",g.utf8encode(P.name)),U=P.comment,z=p.transformTo("string",_(U)),L=p.transformTo("string",g.utf8encode(U)),N=q.length!==P.name.length,B=L.length!==U.length,V="",se="",X="",oe=P.dir,Q=P.date,ce={crc32:0,compressedSize:0,uncompressedSize:0};w&&!b||(ce.crc32=v.crc32,ce.compressedSize=v.compressedSize,ce.uncompressedSize=v.uncompressedSize);var H=0;w&&(H|=8),R||!N&&!B||(H|=2048);var W=0,ne=0;oe&&(W|=16),k==="UNIX"?(ne=798,W|=function(fe,_e){var Ae=fe;return fe||(Ae=_e?16893:33204),(65535&Ae)<<16}(P.unixPermissions,oe)):(ne=20,W|=function(fe){return 63&(fe||0)}(P.dosPermissions)),S=Q.getUTCHours(),S<<=6,S|=Q.getUTCMinutes(),S<<=5,S|=Q.getUTCSeconds()/2,A=Q.getUTCFullYear()-1980,A<<=4,A|=Q.getUTCMonth()+1,A<<=5,A|=Q.getUTCDate(),N&&(se=h(1,1)+h(x(j),4)+q,V+="up"+h(se.length,2)+se),B&&(X=h(1,1)+h(x(z),4)+L,V+="uc"+h(X.length,2)+X);var ee="";return ee+=`
\0`,ee+=h(H,2),ee+=I.magic,ee+=h(S,2),ee+=h(A,2),ee+=h(ce.crc32,4),ee+=h(ce.compressedSize,4),ee+=h(ce.uncompressedSize,4),ee+=h(j.length,2),ee+=h(V.length,2),{fileRecord:C.LOCAL_FILE_HEADER+ee+j+V,dirRecord:C.CENTRAL_FILE_HEADER+h(ne,2)+ee+h(z.length,2)+"\0\0\0\0"+h(W,4)+h(E,4)+j+V+z}}var p=a("../utils"),y=a("../stream/GenericWorker"),g=a("../utf8"),x=a("../crc32"),C=a("../signature");function m(v,w,b,E){y.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=w,this.zipPlatform=b,this.encodeFileName=E,this.streamFiles=v,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}p.inherits(m,y),m.prototype.push=function(v){var w=v.meta.percent||0,b=this.entriesCount,E=this._sources.length;this.accumulate?this.contentBuffer.push(v):(this.bytesWritten+=v.data.length,y.prototype.push.call(this,{data:v.data,meta:{currentFile:this.currentFile,percent:b?(w+100*(b-E-1))/b:100}}))},m.prototype.openedSource=function(v){this.currentSourceOffset=this.bytesWritten,this.currentFile=v.file.name;var w=this.streamFiles&&!v.file.dir;if(w){var b=d(v,w,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:b.fileRecord,meta:{percent:0}})}else this.accumulate=!0},m.prototype.closedSource=function(v){this.accumulate=!1;var w=this.streamFiles&&!v.file.dir,b=d(v,w,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(b.dirRecord),w)this.push({data:function(E){return C.DATA_DESCRIPTOR+h(E.crc32,4)+h(E.compressedSize,4)+h(E.uncompressedSize,4)}(v),meta:{percent:100}});else for(this.push({data:b.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},m.prototype.flush=function(){for(var v=this.bytesWritten,w=0;w<this.dirRecords.length;w++)this.push({data:this.dirRecords[w],meta:{percent:100}});var b=this.bytesWritten-v,E=function(k,_,S,A,P){var I=p.transformTo("string",P(A));return C.CENTRAL_DIRECTORY_END+"\0\0\0\0"+h(k,2)+h(k,2)+h(_,4)+h(S,4)+h(I.length,2)+I}(this.dirRecords.length,b,v,this.zipComment,this.encodeFileName);this.push({data:E,meta:{percent:100}})},m.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},m.prototype.registerPrevious=function(v){this._sources.push(v);var w=this;return v.on("data",function(b){w.processChunk(b)}),v.on("end",function(){w.closedSource(w.previous.streamInfo),w._sources.length?w.prepareNextSource():w.end()}),v.on("error",function(b){w.error(b)}),this},m.prototype.resume=function(){return!!y.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},m.prototype.error=function(v){var w=this._sources;if(!y.prototype.error.call(this,v))return!1;for(var b=0;b<w.length;b++)try{w[b].error(v)}catch{}return!0},m.prototype.lock=function(){y.prototype.lock.call(this);for(var v=this._sources,w=0;w<v.length;w++)v[w].lock()},u.exports=m},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(a,u,l){var h=a("../compressions"),d=a("./ZipFileWorker");l.generateWorker=function(p,y,g){var x=new d(y.streamFiles,g,y.platform,y.encodeFileName),C=0;try{p.forEach(function(m,v){C++;var w=function(_,S){var A=_||S,P=h[A];if(!P)throw new Error(A+" is not a valid compression method !");return P}(v.options.compression,y.compression),b=v.options.compressionOptions||y.compressionOptions||{},E=v.dir,k=v.date;v._compressWorker(w,b).withStreamInfo("file",{name:m,dir:E,date:k,comment:v.comment||"",unixPermissions:v.unixPermissions,dosPermissions:v.dosPermissions}).pipe(x)}),x.entriesCount=C}catch(m){x.error(m)}return x}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(a,u,l){function h(){if(!(this instanceof h))return new h;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var d=new h;for(var p in this)typeof this[p]!="function"&&(d[p]=this[p]);return d}}(h.prototype=a("./object")).loadAsync=a("./load"),h.support=a("./support"),h.defaults=a("./defaults"),h.version="3.10.1",h.loadAsync=function(d,p){return new h().loadAsync(d,p)},h.external=a("./external"),u.exports=h},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(a,u,l){var h=a("./utils"),d=a("./external"),p=a("./utf8"),y=a("./zipEntries"),g=a("./stream/Crc32Probe"),x=a("./nodejsUtils");function C(m){return new d.Promise(function(v,w){var b=m.decompressed.getContentWorker().pipe(new g);b.on("error",function(E){w(E)}).on("end",function(){b.streamInfo.crc32!==m.decompressed.crc32?w(new Error("Corrupted zip : CRC32 mismatch")):v()}).resume()})}u.exports=function(m,v){var w=this;return v=h.extend(v||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:p.utf8decode}),x.isNode&&x.isStream(m)?d.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):h.prepareContent("the loaded zip file",m,!0,v.optimizedBinaryString,v.base64).then(function(b){var E=new y(v);return E.load(b),E}).then(function(b){var E=[d.Promise.resolve(b)],k=b.files;if(v.checkCRC32)for(var _=0;_<k.length;_++)E.push(C(k[_]));return d.Promise.all(E)}).then(function(b){for(var E=b.shift(),k=E.files,_=0;_<k.length;_++){var S=k[_],A=S.fileNameStr,P=h.resolve(S.fileNameStr);w.file(P,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:v.createFolders}),S.dir||(w.file(P).unsafeOriginalName=A)}return E.zipComment.length&&(w.comment=E.zipComment),w})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(a,u,l){var h=a("../utils"),d=a("../stream/GenericWorker");function p(y,g){d.call(this,"Nodejs stream input adapter for "+y),this._upstreamEnded=!1,this._bindStream(g)}h.inherits(p,d),p.prototype._bindStream=function(y){var g=this;(this._stream=y).pause(),y.on("data",function(x){g.push({data:x,meta:{percent:0}})}).on("error",function(x){g.isPaused?this.generatedError=x:g.error(x)}).on("end",function(){g.isPaused?g._upstreamEnded=!0:g.end()})},p.prototype.pause=function(){return!!d.prototype.pause.call(this)&&(this._stream.pause(),!0)},p.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},u.exports=p},{"../stream/GenericWorker":28,"../utils":32}],13:[function(a,u,l){var h=a("readable-stream").Readable;function d(p,y,g){h.call(this,y),this._helper=p;var x=this;p.on("data",function(C,m){x.push(C)||x._helper.pause(),g&&g(m)}).on("error",function(C){x.emit("error",C)}).on("end",function(){x.push(null)})}a("../utils").inherits(d,h),d.prototype._read=function(){this._helper.resume()},u.exports=d},{"../utils":32,"readable-stream":16}],14:[function(a,u,l){u.exports={isNode:typeof Buffer<"u",newBufferFrom:function(h,d){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(h,d);if(typeof h=="number")throw new Error('The "data" argument must not be a number');return new Buffer(h,d)},allocBuffer:function(h){if(Buffer.alloc)return Buffer.alloc(h);var d=new Buffer(h);return d.fill(0),d},isBuffer:function(h){return Buffer.isBuffer(h)},isStream:function(h){return h&&typeof h.on=="function"&&typeof h.pause=="function"&&typeof h.resume=="function"}}},{}],15:[function(a,u,l){function h(P,I,R){var j,q=p.getTypeOf(I),U=p.extend(R||{},x);U.date=U.date||new Date,U.compression!==null&&(U.compression=U.compression.toUpperCase()),typeof U.unixPermissions=="string"&&(U.unixPermissions=parseInt(U.unixPermissions,8)),U.unixPermissions&&16384&U.unixPermissions&&(U.dir=!0),U.dosPermissions&&16&U.dosPermissions&&(U.dir=!0),U.dir&&(P=k(P)),U.createFolders&&(j=E(P))&&_.call(this,j,!0);var z=q==="string"&&U.binary===!1&&U.base64===!1;R&&R.binary!==void 0||(U.binary=!z),(I instanceof C&&I.uncompressedSize===0||U.dir||!I||I.length===0)&&(U.base64=!1,U.binary=!0,I="",U.compression="STORE",q="string");var L=null;L=I instanceof C||I instanceof y?I:w.isNode&&w.isStream(I)?new b(P,I):p.prepareContent(P,I,U.binary,U.optimizedBinaryString,U.base64);var N=new m(P,L,U);this.files[P]=N}var d=a("./utf8"),p=a("./utils"),y=a("./stream/GenericWorker"),g=a("./stream/StreamHelper"),x=a("./defaults"),C=a("./compressedObject"),m=a("./zipObject"),v=a("./generate"),w=a("./nodejsUtils"),b=a("./nodejs/NodejsStreamInputAdapter"),E=function(P){P.slice(-1)==="/"&&(P=P.substring(0,P.length-1));var I=P.lastIndexOf("/");return 0<I?P.substring(0,I):""},k=function(P){return P.slice(-1)!=="/"&&(P+="/"),P},_=function(P,I){return I=I!==void 0?I:x.createFolders,P=k(P),this.files[P]||h.call(this,P,null,{dir:!0,createFolders:I}),this.files[P]};function S(P){return Object.prototype.toString.call(P)==="[object RegExp]"}var A={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(P){var I,R,j;for(I in this.files)j=this.files[I],(R=I.slice(this.root.length,I.length))&&I.slice(0,this.root.length)===this.root&&P(R,j)},filter:function(P){var I=[];return this.forEach(function(R,j){P(R,j)&&I.push(j)}),I},file:function(P,I,R){if(arguments.length!==1)return P=this.root+P,h.call(this,P,I,R),this;if(S(P)){var j=P;return this.filter(function(U,z){return!z.dir&&j.test(U)})}var q=this.files[this.root+P];return q&&!q.dir?q:null},folder:function(P){if(!P)return this;if(S(P))return this.filter(function(q,U){return U.dir&&P.test(q)});var I=this.root+P,R=_.call(this,I),j=this.clone();return j.root=R.name,j},remove:function(P){P=this.root+P;var I=this.files[P];if(I||(P.slice(-1)!=="/"&&(P+="/"),I=this.files[P]),I&&!I.dir)delete this.files[P];else for(var R=this.filter(function(q,U){return U.name.slice(0,P.length)===P}),j=0;j<R.length;j++)delete this.files[R[j].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(P){var I,R={};try{if((R=p.extend(P||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:d.utf8encode})).type=R.type.toLowerCase(),R.compression=R.compression.toUpperCase(),R.type==="binarystring"&&(R.type="string"),!R.type)throw new Error("No output type specified.");p.checkSupport(R.type),R.platform!=="darwin"&&R.platform!=="freebsd"&&R.platform!=="linux"&&R.platform!=="sunos"||(R.platform="UNIX"),R.platform==="win32"&&(R.platform="DOS");var j=R.comment||this.comment||"";I=v.generateWorker(this,R,j)}catch(q){(I=new y("error")).error(q)}return new g(I,R.type||"string",R.mimeType)},generateAsync:function(P,I){return this.generateInternalStream(P).accumulate(I)},generateNodeStream:function(P,I){return(P=P||{}).type||(P.type="nodebuffer"),this.generateInternalStream(P).toNodejsStream(I)}};u.exports=A},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(a,u,l){u.exports=a("stream")},{stream:void 0}],17:[function(a,u,l){var h=a("./DataReader");function d(p){h.call(this,p);for(var y=0;y<this.data.length;y++)p[y]=255&p[y]}a("../utils").inherits(d,h),d.prototype.byteAt=function(p){return this.data[this.zero+p]},d.prototype.lastIndexOfSignature=function(p){for(var y=p.charCodeAt(0),g=p.charCodeAt(1),x=p.charCodeAt(2),C=p.charCodeAt(3),m=this.length-4;0<=m;--m)if(this.data[m]===y&&this.data[m+1]===g&&this.data[m+2]===x&&this.data[m+3]===C)return m-this.zero;return-1},d.prototype.readAndCheckSignature=function(p){var y=p.charCodeAt(0),g=p.charCodeAt(1),x=p.charCodeAt(2),C=p.charCodeAt(3),m=this.readData(4);return y===m[0]&&g===m[1]&&x===m[2]&&C===m[3]},d.prototype.readData=function(p){if(this.checkOffset(p),p===0)return[];var y=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,y},u.exports=d},{"../utils":32,"./DataReader":18}],18:[function(a,u,l){var h=a("../utils");function d(p){this.data=p,this.length=p.length,this.index=0,this.zero=0}d.prototype={checkOffset:function(p){this.checkIndex(this.index+p)},checkIndex:function(p){if(this.length<this.zero+p||p<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+p+"). Corrupted zip ?")},setIndex:function(p){this.checkIndex(p),this.index=p},skip:function(p){this.setIndex(this.index+p)},byteAt:function(){},readInt:function(p){var y,g=0;for(this.checkOffset(p),y=this.index+p-1;y>=this.index;y--)g=(g<<8)+this.byteAt(y);return this.index+=p,g},readString:function(p){return h.transformTo("string",this.readData(p))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var p=this.readInt(4);return new Date(Date.UTC(1980+(p>>25&127),(p>>21&15)-1,p>>16&31,p>>11&31,p>>5&63,(31&p)<<1))}},u.exports=d},{"../utils":32}],19:[function(a,u,l){var h=a("./Uint8ArrayReader");function d(p){h.call(this,p)}a("../utils").inherits(d,h),d.prototype.readData=function(p){this.checkOffset(p);var y=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,y},u.exports=d},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(a,u,l){var h=a("./DataReader");function d(p){h.call(this,p)}a("../utils").inherits(d,h),d.prototype.byteAt=function(p){return this.data.charCodeAt(this.zero+p)},d.prototype.lastIndexOfSignature=function(p){return this.data.lastIndexOf(p)-this.zero},d.prototype.readAndCheckSignature=function(p){return p===this.readData(4)},d.prototype.readData=function(p){this.checkOffset(p);var y=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,y},u.exports=d},{"../utils":32,"./DataReader":18}],21:[function(a,u,l){var h=a("./ArrayReader");function d(p){h.call(this,p)}a("../utils").inherits(d,h),d.prototype.readData=function(p){if(this.checkOffset(p),p===0)return new Uint8Array(0);var y=this.data.subarray(this.zero+this.index,this.zero+this.index+p);return this.index+=p,y},u.exports=d},{"../utils":32,"./ArrayReader":17}],22:[function(a,u,l){var h=a("../utils"),d=a("../support"),p=a("./ArrayReader"),y=a("./StringReader"),g=a("./NodeBufferReader"),x=a("./Uint8ArrayReader");u.exports=function(C){var m=h.getTypeOf(C);return h.checkSupport(m),m!=="string"||d.uint8array?m==="nodebuffer"?new g(C):d.uint8array?new x(h.transformTo("uint8array",C)):new p(h.transformTo("array",C)):new y(C)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(a,u,l){l.LOCAL_FILE_HEADER="PK",l.CENTRAL_FILE_HEADER="PK",l.CENTRAL_DIRECTORY_END="PK",l.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",l.ZIP64_CENTRAL_DIRECTORY_END="PK",l.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(a,u,l){var h=a("./GenericWorker"),d=a("../utils");function p(y){h.call(this,"ConvertWorker to "+y),this.destType=y}d.inherits(p,h),p.prototype.processChunk=function(y){this.push({data:d.transformTo(this.destType,y.data),meta:y.meta})},u.exports=p},{"../utils":32,"./GenericWorker":28}],25:[function(a,u,l){var h=a("./GenericWorker"),d=a("../crc32");function p(){h.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}a("../utils").inherits(p,h),p.prototype.processChunk=function(y){this.streamInfo.crc32=d(y.data,this.streamInfo.crc32||0),this.push(y)},u.exports=p},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(a,u,l){var h=a("../utils"),d=a("./GenericWorker");function p(y){d.call(this,"DataLengthProbe for "+y),this.propName=y,this.withStreamInfo(y,0)}h.inherits(p,d),p.prototype.processChunk=function(y){if(y){var g=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=g+y.data.length}d.prototype.processChunk.call(this,y)},u.exports=p},{"../utils":32,"./GenericWorker":28}],27:[function(a,u,l){var h=a("../utils"),d=a("./GenericWorker");function p(y){d.call(this,"DataWorker");var g=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,y.then(function(x){g.dataIsReady=!0,g.data=x,g.max=x&&x.length||0,g.type=h.getTypeOf(x),g.isPaused||g._tickAndRepeat()},function(x){g.error(x)})}h.inherits(p,d),p.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this.data=null},p.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,h.delay(this._tickAndRepeat,[],this)),!0)},p.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(h.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},p.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var y=null,g=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":y=this.data.substring(this.index,g);break;case"uint8array":y=this.data.subarray(this.index,g);break;case"array":case"nodebuffer":y=this.data.slice(this.index,g)}return this.index=g,this.push({data:y,meta:{percent:this.max?this.index/this.max*100:0}})},u.exports=p},{"../utils":32,"./GenericWorker":28}],28:[function(a,u,l){function h(d){this.name=d||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}h.prototype={push:function(d){this.emit("data",d)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(d){this.emit("error",d)}return!0},error:function(d){return!this.isFinished&&(this.isPaused?this.generatedError=d:(this.isFinished=!0,this.emit("error",d),this.previous&&this.previous.error(d),this.cleanUp()),!0)},on:function(d,p){return this._listeners[d].push(p),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(d,p){if(this._listeners[d])for(var y=0;y<this._listeners[d].length;y++)this._listeners[d][y].call(this,p)},pipe:function(d){return d.registerPrevious(this)},registerPrevious:function(d){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=d.streamInfo,this.mergeStreamInfo(),this.previous=d;var p=this;return d.on("data",function(y){p.processChunk(y)}),d.on("end",function(){p.end()}),d.on("error",function(y){p.error(y)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var d=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),d=!0),this.previous&&this.previous.resume(),!d},flush:function(){},processChunk:function(d){this.push(d)},withStreamInfo:function(d,p){return this.extraStreamInfo[d]=p,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var d in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,d)&&(this.streamInfo[d]=this.extraStreamInfo[d])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var d="Worker "+this.name;return this.previous?this.previous+" -> "+d:d}},u.exports=h},{}],29:[function(a,u,l){var h=a("../utils"),d=a("./ConvertWorker"),p=a("./GenericWorker"),y=a("../base64"),g=a("../support"),x=a("../external"),C=null;if(g.nodestream)try{C=a("../nodejs/NodejsStreamOutputAdapter")}catch{}function m(w,b){return new x.Promise(function(E,k){var _=[],S=w._internalType,A=w._outputType,P=w._mimeType;w.on("data",function(I,R){_.push(I),b&&b(R)}).on("error",function(I){_=[],k(I)}).on("end",function(){try{var I=function(R,j,q){switch(R){case"blob":return h.newBlob(h.transformTo("arraybuffer",j),q);case"base64":return y.encode(j);default:return h.transformTo(R,j)}}(A,function(R,j){var q,U=0,z=null,L=0;for(q=0;q<j.length;q++)L+=j[q].length;switch(R){case"string":return j.join("");case"array":return Array.prototype.concat.apply([],j);case"uint8array":for(z=new Uint8Array(L),q=0;q<j.length;q++)z.set(j[q],U),U+=j[q].length;return z;case"nodebuffer":return Buffer.concat(j);default:throw new Error("concat : unsupported type '"+R+"'")}}(S,_),P);E(I)}catch(R){k(R)}_=[]}).resume()})}function v(w,b,E){var k=b;switch(b){case"blob":case"arraybuffer":k="uint8array";break;case"base64":k="string"}try{this._internalType=k,this._outputType=b,this._mimeType=E,h.checkSupport(k),this._worker=w.pipe(new d(k)),w.lock()}catch(_){this._worker=new p("error"),this._worker.error(_)}}v.prototype={accumulate:function(w){return m(this,w)},on:function(w,b){var E=this;return w==="data"?this._worker.on(w,function(k){b.call(E,k.data,k.meta)}):this._worker.on(w,function(){h.delay(b,arguments,E)}),this},resume:function(){return h.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(w){if(h.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new C(this,{objectMode:this._outputType!=="nodebuffer"},w)}},u.exports=v},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(a,u,l){if(l.base64=!0,l.array=!0,l.string=!0,l.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",l.nodebuffer=typeof Buffer<"u",l.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")l.blob=!1;else{var h=new ArrayBuffer(0);try{l.blob=new Blob([h],{type:"application/zip"}).size===0}catch{try{var d=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);d.append(h),l.blob=d.getBlob("application/zip").size===0}catch{l.blob=!1}}}try{l.nodestream=!!a("readable-stream").Readable}catch{l.nodestream=!1}},{"readable-stream":16}],31:[function(a,u,l){for(var h=a("./utils"),d=a("./support"),p=a("./nodejsUtils"),y=a("./stream/GenericWorker"),g=new Array(256),x=0;x<256;x++)g[x]=252<=x?6:248<=x?5:240<=x?4:224<=x?3:192<=x?2:1;g[254]=g[254]=1;function C(){y.call(this,"utf-8 decode"),this.leftOver=null}function m(){y.call(this,"utf-8 encode")}l.utf8encode=function(v){return d.nodebuffer?p.newBufferFrom(v,"utf-8"):function(w){var b,E,k,_,S,A=w.length,P=0;for(_=0;_<A;_++)(64512&(E=w.charCodeAt(_)))==55296&&_+1<A&&(64512&(k=w.charCodeAt(_+1)))==56320&&(E=65536+(E-55296<<10)+(k-56320),_++),P+=E<128?1:E<2048?2:E<65536?3:4;for(b=d.uint8array?new Uint8Array(P):new Array(P),_=S=0;S<P;_++)(64512&(E=w.charCodeAt(_)))==55296&&_+1<A&&(64512&(k=w.charCodeAt(_+1)))==56320&&(E=65536+(E-55296<<10)+(k-56320),_++),E<128?b[S++]=E:(E<2048?b[S++]=192|E>>>6:(E<65536?b[S++]=224|E>>>12:(b[S++]=240|E>>>18,b[S++]=128|E>>>12&63),b[S++]=128|E>>>6&63),b[S++]=128|63&E);return b}(v)},l.utf8decode=function(v){return d.nodebuffer?h.transformTo("nodebuffer",v).toString("utf-8"):function(w){var b,E,k,_,S=w.length,A=new Array(2*S);for(b=E=0;b<S;)if((k=w[b++])<128)A[E++]=k;else if(4<(_=g[k]))A[E++]=65533,b+=_-1;else{for(k&=_===2?31:_===3?15:7;1<_&&b<S;)k=k<<6|63&w[b++],_--;1<_?A[E++]=65533:k<65536?A[E++]=k:(k-=65536,A[E++]=55296|k>>10&1023,A[E++]=56320|1023&k)}return A.length!==E&&(A.subarray?A=A.subarray(0,E):A.length=E),h.applyFromCharCode(A)}(v=h.transformTo(d.uint8array?"uint8array":"array",v))},h.inherits(C,y),C.prototype.processChunk=function(v){var w=h.transformTo(d.uint8array?"uint8array":"array",v.data);if(this.leftOver&&this.leftOver.length){if(d.uint8array){var b=w;(w=new Uint8Array(b.length+this.leftOver.length)).set(this.leftOver,0),w.set(b,this.leftOver.length)}else w=this.leftOver.concat(w);this.leftOver=null}var E=function(_,S){var A;for((S=S||_.length)>_.length&&(S=_.length),A=S-1;0<=A&&(192&_[A])==128;)A--;return A<0||A===0?S:A+g[_[A]]>S?A:S}(w),k=w;E!==w.length&&(d.uint8array?(k=w.subarray(0,E),this.leftOver=w.subarray(E,w.length)):(k=w.slice(0,E),this.leftOver=w.slice(E,w.length))),this.push({data:l.utf8decode(k),meta:v.meta})},C.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:l.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},l.Utf8DecodeWorker=C,h.inherits(m,y),m.prototype.processChunk=function(v){this.push({data:l.utf8encode(v.data),meta:v.meta})},l.Utf8EncodeWorker=m},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(a,u,l){var h=a("./support"),d=a("./base64"),p=a("./nodejsUtils"),y=a("./external");function g(b){return b}function x(b,E){for(var k=0;k<b.length;++k)E[k]=255&b.charCodeAt(k);return E}a("setimmediate"),l.newBlob=function(b,E){l.checkSupport("blob");try{return new Blob([b],{type:E})}catch{try{var k=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return k.append(b),k.getBlob(E)}catch{throw new Error("Bug : can't construct the Blob.")}}};var C={stringifyByChunk:function(b,E,k){var _=[],S=0,A=b.length;if(A<=k)return String.fromCharCode.apply(null,b);for(;S<A;)E==="array"||E==="nodebuffer"?_.push(String.fromCharCode.apply(null,b.slice(S,Math.min(S+k,A)))):_.push(String.fromCharCode.apply(null,b.subarray(S,Math.min(S+k,A)))),S+=k;return _.join("")},stringifyByChar:function(b){for(var E="",k=0;k<b.length;k++)E+=String.fromCharCode(b[k]);return E},applyCanBeUsed:{uint8array:function(){try{return h.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return h.nodebuffer&&String.fromCharCode.apply(null,p.allocBuffer(1)).length===1}catch{return!1}}()}};function m(b){var E=65536,k=l.getTypeOf(b),_=!0;if(k==="uint8array"?_=C.applyCanBeUsed.uint8array:k==="nodebuffer"&&(_=C.applyCanBeUsed.nodebuffer),_)for(;1<E;)try{return C.stringifyByChunk(b,k,E)}catch{E=Math.floor(E/2)}return C.stringifyByChar(b)}function v(b,E){for(var k=0;k<b.length;k++)E[k]=b[k];return E}l.applyFromCharCode=m;var w={};w.string={string:g,array:function(b){return x(b,new Array(b.length))},arraybuffer:function(b){return w.string.uint8array(b).buffer},uint8array:function(b){return x(b,new Uint8Array(b.length))},nodebuffer:function(b){return x(b,p.allocBuffer(b.length))}},w.array={string:m,array:g,arraybuffer:function(b){return new Uint8Array(b).buffer},uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return p.newBufferFrom(b)}},w.arraybuffer={string:function(b){return m(new Uint8Array(b))},array:function(b){return v(new Uint8Array(b),new Array(b.byteLength))},arraybuffer:g,uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return p.newBufferFrom(new Uint8Array(b))}},w.uint8array={string:m,array:function(b){return v(b,new Array(b.length))},arraybuffer:function(b){return b.buffer},uint8array:g,nodebuffer:function(b){return p.newBufferFrom(b)}},w.nodebuffer={string:m,array:function(b){return v(b,new Array(b.length))},arraybuffer:function(b){return w.nodebuffer.uint8array(b).buffer},uint8array:function(b){return v(b,new Uint8Array(b.length))},nodebuffer:g},l.transformTo=function(b,E){if(E=E||"",!b)return E;l.checkSupport(b);var k=l.getTypeOf(E);return w[k][b](E)},l.resolve=function(b){for(var E=b.split("/"),k=[],_=0;_<E.length;_++){var S=E[_];S==="."||S===""&&_!==0&&_!==E.length-1||(S===".."?k.pop():k.push(S))}return k.join("/")},l.getTypeOf=function(b){return typeof b=="string"?"string":Object.prototype.toString.call(b)==="[object Array]"?"array":h.nodebuffer&&p.isBuffer(b)?"nodebuffer":h.uint8array&&b instanceof Uint8Array?"uint8array":h.arraybuffer&&b instanceof ArrayBuffer?"arraybuffer":void 0},l.checkSupport=function(b){if(!h[b.toLowerCase()])throw new Error(b+" is not supported by this platform")},l.MAX_VALUE_16BITS=65535,l.MAX_VALUE_32BITS=-1,l.pretty=function(b){var E,k,_="";for(k=0;k<(b||"").length;k++)_+="\\x"+((E=b.charCodeAt(k))<16?"0":"")+E.toString(16).toUpperCase();return _},l.delay=function(b,E,k){setImmediate(function(){b.apply(k||null,E||[])})},l.inherits=function(b,E){function k(){}k.prototype=E.prototype,b.prototype=new k},l.extend=function(){var b,E,k={};for(b=0;b<arguments.length;b++)for(E in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],E)&&k[E]===void 0&&(k[E]=arguments[b][E]);return k},l.prepareContent=function(b,E,k,_,S){return y.Promise.resolve(E).then(function(A){return h.blob&&(A instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(A))!==-1)&&typeof FileReader<"u"?new y.Promise(function(P,I){var R=new FileReader;R.onload=function(j){P(j.target.result)},R.onerror=function(j){I(j.target.error)},R.readAsArrayBuffer(A)}):A}).then(function(A){var P=l.getTypeOf(A);return P?(P==="arraybuffer"?A=l.transformTo("uint8array",A):P==="string"&&(S?A=d.decode(A):k&&_!==!0&&(A=function(I){return x(I,h.uint8array?new Uint8Array(I.length):new Array(I.length))}(A))),A):y.Promise.reject(new Error("Can't read the data of '"+b+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(a,u,l){var h=a("./reader/readerFor"),d=a("./utils"),p=a("./signature"),y=a("./zipEntry"),g=a("./support");function x(C){this.files=[],this.loadOptions=C}x.prototype={checkSignature:function(C){if(!this.reader.readAndCheckSignature(C)){this.reader.index-=4;var m=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+d.pretty(m)+", expected "+d.pretty(C)+")")}},isSignature:function(C,m){var v=this.reader.index;this.reader.setIndex(C);var w=this.reader.readString(4)===m;return this.reader.setIndex(v),w},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var C=this.reader.readData(this.zipCommentLength),m=g.uint8array?"uint8array":"array",v=d.transformTo(m,C);this.zipComment=this.loadOptions.decodeFileName(v)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var C,m,v,w=this.zip64EndOfCentralSize-44;0<w;)C=this.reader.readInt(2),m=this.reader.readInt(4),v=this.reader.readData(m),this.zip64ExtensibleData[C]={id:C,length:m,value:v}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var C,m;for(C=0;C<this.files.length;C++)m=this.files[C],this.reader.setIndex(m.localHeaderOffset),this.checkSignature(p.LOCAL_FILE_HEADER),m.readLocalPart(this.reader),m.handleUTF8(),m.processAttributes()},readCentralDir:function(){var C;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(p.CENTRAL_FILE_HEADER);)(C=new y({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(C);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var C=this.reader.lastIndexOfSignature(p.CENTRAL_DIRECTORY_END);if(C<0)throw this.isSignature(0,p.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(C);var m=C;if(this.checkSignature(p.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===d.MAX_VALUE_16BITS||this.diskWithCentralDirStart===d.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===d.MAX_VALUE_16BITS||this.centralDirRecords===d.MAX_VALUE_16BITS||this.centralDirSize===d.MAX_VALUE_32BITS||this.centralDirOffset===d.MAX_VALUE_32BITS){if(this.zip64=!0,(C=this.reader.lastIndexOfSignature(p.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(C),this.checkSignature(p.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,p.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(p.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(p.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var v=this.centralDirOffset+this.centralDirSize;this.zip64&&(v+=20,v+=12+this.zip64EndOfCentralSize);var w=m-v;if(0<w)this.isSignature(m,p.CENTRAL_FILE_HEADER)||(this.reader.zero=w);else if(w<0)throw new Error("Corrupted zip: missing "+Math.abs(w)+" bytes.")},prepareReader:function(C){this.reader=h(C)},load:function(C){this.prepareReader(C),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},u.exports=x},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(a,u,l){var h=a("./reader/readerFor"),d=a("./utils"),p=a("./compressedObject"),y=a("./crc32"),g=a("./utf8"),x=a("./compressions"),C=a("./support");function m(v,w){this.options=v,this.loadOptions=w}m.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(v){var w,b;if(v.skip(22),this.fileNameLength=v.readInt(2),b=v.readInt(2),this.fileName=v.readData(this.fileNameLength),v.skip(b),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((w=function(E){for(var k in x)if(Object.prototype.hasOwnProperty.call(x,k)&&x[k].magic===E)return x[k];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+d.pretty(this.compressionMethod)+" unknown (inner file : "+d.transformTo("string",this.fileName)+")");this.decompressed=new p(this.compressedSize,this.uncompressedSize,this.crc32,w,v.readData(this.compressedSize))},readCentralPart:function(v){this.versionMadeBy=v.readInt(2),v.skip(2),this.bitFlag=v.readInt(2),this.compressionMethod=v.readString(2),this.date=v.readDate(),this.crc32=v.readInt(4),this.compressedSize=v.readInt(4),this.uncompressedSize=v.readInt(4);var w=v.readInt(2);if(this.extraFieldsLength=v.readInt(2),this.fileCommentLength=v.readInt(2),this.diskNumberStart=v.readInt(2),this.internalFileAttributes=v.readInt(2),this.externalFileAttributes=v.readInt(4),this.localHeaderOffset=v.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");v.skip(w),this.readExtraFields(v),this.parseZIP64ExtraField(v),this.fileComment=v.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var v=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),v==0&&(this.dosPermissions=63&this.externalFileAttributes),v==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var v=h(this.extraFields[1].value);this.uncompressedSize===d.MAX_VALUE_32BITS&&(this.uncompressedSize=v.readInt(8)),this.compressedSize===d.MAX_VALUE_32BITS&&(this.compressedSize=v.readInt(8)),this.localHeaderOffset===d.MAX_VALUE_32BITS&&(this.localHeaderOffset=v.readInt(8)),this.diskNumberStart===d.MAX_VALUE_32BITS&&(this.diskNumberStart=v.readInt(4))}},readExtraFields:function(v){var w,b,E,k=v.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});v.index+4<k;)w=v.readInt(2),b=v.readInt(2),E=v.readData(b),this.extraFields[w]={id:w,length:b,value:E};v.setIndex(k)},handleUTF8:function(){var v=C.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=g.utf8decode(this.fileName),this.fileCommentStr=g.utf8decode(this.fileComment);else{var w=this.findExtraFieldUnicodePath();if(w!==null)this.fileNameStr=w;else{var b=d.transformTo(v,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(b)}var E=this.findExtraFieldUnicodeComment();if(E!==null)this.fileCommentStr=E;else{var k=d.transformTo(v,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(k)}}},findExtraFieldUnicodePath:function(){var v=this.extraFields[28789];if(v){var w=h(v.value);return w.readInt(1)!==1||y(this.fileName)!==w.readInt(4)?null:g.utf8decode(w.readData(v.length-5))}return null},findExtraFieldUnicodeComment:function(){var v=this.extraFields[25461];if(v){var w=h(v.value);return w.readInt(1)!==1||y(this.fileComment)!==w.readInt(4)?null:g.utf8decode(w.readData(v.length-5))}return null}},u.exports=m},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(a,u,l){function h(w,b,E){this.name=w,this.dir=E.dir,this.date=E.date,this.comment=E.comment,this.unixPermissions=E.unixPermissions,this.dosPermissions=E.dosPermissions,this._data=b,this._dataBinary=E.binary,this.options={compression:E.compression,compressionOptions:E.compressionOptions}}var d=a("./stream/StreamHelper"),p=a("./stream/DataWorker"),y=a("./utf8"),g=a("./compressedObject"),x=a("./stream/GenericWorker");h.prototype={internalStream:function(w){var b=null,E="string";try{if(!w)throw new Error("No output type specified.");var k=(E=w.toLowerCase())==="string"||E==="text";E!=="binarystring"&&E!=="text"||(E="string"),b=this._decompressWorker();var _=!this._dataBinary;_&&!k&&(b=b.pipe(new y.Utf8EncodeWorker)),!_&&k&&(b=b.pipe(new y.Utf8DecodeWorker))}catch(S){(b=new x("error")).error(S)}return new d(b,E,"")},async:function(w,b){return this.internalStream(w).accumulate(b)},nodeStream:function(w,b){return this.internalStream(w||"nodebuffer").toNodejsStream(b)},_compressWorker:function(w,b){if(this._data instanceof g&&this._data.compression.magic===w.magic)return this._data.getCompressedWorker();var E=this._decompressWorker();return this._dataBinary||(E=E.pipe(new y.Utf8EncodeWorker)),g.createWorkerFrom(E,w,b)},_decompressWorker:function(){return this._data instanceof g?this._data.getContentWorker():this._data instanceof x?this._data:new p(this._data)}};for(var C=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],m=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},v=0;v<C.length;v++)h.prototype[C[v]]=m;u.exports=h},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(a,u,l){(function(h){var d,p,y=h.MutationObserver||h.WebKitMutationObserver;if(y){var g=0,x=new y(w),C=h.document.createTextNode("");x.observe(C,{characterData:!0}),d=function(){C.data=g=++g%2}}else if(h.setImmediate||h.MessageChannel===void 0)d="document"in h&&"onreadystatechange"in h.document.createElement("script")?function(){var b=h.document.createElement("script");b.onreadystatechange=function(){w(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},h.document.documentElement.appendChild(b)}:function(){setTimeout(w,0)};else{var m=new h.MessageChannel;m.port1.onmessage=w,d=function(){m.port2.postMessage(0)}}var v=[];function w(){var b,E;p=!0;for(var k=v.length;k;){for(E=v,v=[],b=-1;++b<k;)E[b]();k=v.length}p=!1}u.exports=function(b){v.push(b)!==1||p||d()}}).call(this,typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(a,u,l){var h=a("immediate");function d(){}var p={},y=["REJECTED"],g=["FULFILLED"],x=["PENDING"];function C(k){if(typeof k!="function")throw new TypeError("resolver must be a function");this.state=x,this.queue=[],this.outcome=void 0,k!==d&&b(this,k)}function m(k,_,S){this.promise=k,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function v(k,_,S){h(function(){var A;try{A=_(S)}catch(P){return p.reject(k,P)}A===k?p.reject(k,new TypeError("Cannot resolve promise with itself")):p.resolve(k,A)})}function w(k){var _=k&&k.then;if(k&&(typeof k=="object"||typeof k=="function")&&typeof _=="function")return function(){_.apply(k,arguments)}}function b(k,_){var S=!1;function A(R){S||(S=!0,p.reject(k,R))}function P(R){S||(S=!0,p.resolve(k,R))}var I=E(function(){_(P,A)});I.status==="error"&&A(I.value)}function E(k,_){var S={};try{S.value=k(_),S.status="success"}catch(A){S.status="error",S.value=A}return S}(u.exports=C).prototype.finally=function(k){if(typeof k!="function")return this;var _=this.constructor;return this.then(function(S){return _.resolve(k()).then(function(){return S})},function(S){return _.resolve(k()).then(function(){throw S})})},C.prototype.catch=function(k){return this.then(null,k)},C.prototype.then=function(k,_){if(typeof k!="function"&&this.state===g||typeof _!="function"&&this.state===y)return this;var S=new this.constructor(d);return this.state!==x?v(S,this.state===g?k:_,this.outcome):this.queue.push(new m(S,k,_)),S},m.prototype.callFulfilled=function(k){p.resolve(this.promise,k)},m.prototype.otherCallFulfilled=function(k){v(this.promise,this.onFulfilled,k)},m.prototype.callRejected=function(k){p.reject(this.promise,k)},m.prototype.otherCallRejected=function(k){v(this.promise,this.onRejected,k)},p.resolve=function(k,_){var S=E(w,_);if(S.status==="error")return p.reject(k,S.value);var A=S.value;if(A)b(k,A);else{k.state=g,k.outcome=_;for(var P=-1,I=k.queue.length;++P<I;)k.queue[P].callFulfilled(_)}return k},p.reject=function(k,_){k.state=y,k.outcome=_;for(var S=-1,A=k.queue.length;++S<A;)k.queue[S].callRejected(_);return k},C.resolve=function(k){return k instanceof this?k:p.resolve(new this(d),k)},C.reject=function(k){var _=new this(d);return p.reject(_,k)},C.all=function(k){var _=this;if(Object.prototype.toString.call(k)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=k.length,A=!1;if(!S)return this.resolve([]);for(var P=new Array(S),I=0,R=-1,j=new this(d);++R<S;)q(k[R],R);return j;function q(U,z){_.resolve(U).then(function(L){P[z]=L,++I!==S||A||(A=!0,p.resolve(j,P))},function(L){A||(A=!0,p.reject(j,L))})}},C.race=function(k){var _=this;if(Object.prototype.toString.call(k)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=k.length,A=!1;if(!S)return this.resolve([]);for(var P=-1,I=new this(d);++P<S;)R=k[P],_.resolve(R).then(function(j){A||(A=!0,p.resolve(I,j))},function(j){A||(A=!0,p.reject(I,j))});var R;return I}},{immediate:36}],38:[function(a,u,l){var h={};(0,a("./lib/utils/common").assign)(h,a("./lib/deflate"),a("./lib/inflate"),a("./lib/zlib/constants")),u.exports=h},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(a,u,l){var h=a("./zlib/deflate"),d=a("./utils/common"),p=a("./utils/strings"),y=a("./zlib/messages"),g=a("./zlib/zstream"),x=Object.prototype.toString,C=0,m=-1,v=0,w=8;function b(k){if(!(this instanceof b))return new b(k);this.options=d.assign({level:m,method:w,chunkSize:16384,windowBits:15,memLevel:8,strategy:v,to:""},k||{});var _=this.options;_.raw&&0<_.windowBits?_.windowBits=-_.windowBits:_.gzip&&0<_.windowBits&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var S=h.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(S!==C)throw new Error(y[S]);if(_.header&&h.deflateSetHeader(this.strm,_.header),_.dictionary){var A;if(A=typeof _.dictionary=="string"?p.string2buf(_.dictionary):x.call(_.dictionary)==="[object ArrayBuffer]"?new Uint8Array(_.dictionary):_.dictionary,(S=h.deflateSetDictionary(this.strm,A))!==C)throw new Error(y[S]);this._dict_set=!0}}function E(k,_){var S=new b(_);if(S.push(k,!0),S.err)throw S.msg||y[S.err];return S.result}b.prototype.push=function(k,_){var S,A,P=this.strm,I=this.options.chunkSize;if(this.ended)return!1;A=_===~~_?_:_===!0?4:0,typeof k=="string"?P.input=p.string2buf(k):x.call(k)==="[object ArrayBuffer]"?P.input=new Uint8Array(k):P.input=k,P.next_in=0,P.avail_in=P.input.length;do{if(P.avail_out===0&&(P.output=new d.Buf8(I),P.next_out=0,P.avail_out=I),(S=h.deflate(P,A))!==1&&S!==C)return this.onEnd(S),!(this.ended=!0);P.avail_out!==0&&(P.avail_in!==0||A!==4&&A!==2)||(this.options.to==="string"?this.onData(p.buf2binstring(d.shrinkBuf(P.output,P.next_out))):this.onData(d.shrinkBuf(P.output,P.next_out)))}while((0<P.avail_in||P.avail_out===0)&&S!==1);return A===4?(S=h.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===C):A!==2||(this.onEnd(C),!(P.avail_out=0))},b.prototype.onData=function(k){this.chunks.push(k)},b.prototype.onEnd=function(k){k===C&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=k,this.msg=this.strm.msg},l.Deflate=b,l.deflate=E,l.deflateRaw=function(k,_){return(_=_||{}).raw=!0,E(k,_)},l.gzip=function(k,_){return(_=_||{}).gzip=!0,E(k,_)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(a,u,l){var h=a("./zlib/inflate"),d=a("./utils/common"),p=a("./utils/strings"),y=a("./zlib/constants"),g=a("./zlib/messages"),x=a("./zlib/zstream"),C=a("./zlib/gzheader"),m=Object.prototype.toString;function v(b){if(!(this instanceof v))return new v(b);this.options=d.assign({chunkSize:16384,windowBits:0,to:""},b||{});var E=this.options;E.raw&&0<=E.windowBits&&E.windowBits<16&&(E.windowBits=-E.windowBits,E.windowBits===0&&(E.windowBits=-15)),!(0<=E.windowBits&&E.windowBits<16)||b&&b.windowBits||(E.windowBits+=32),15<E.windowBits&&E.windowBits<48&&!(15&E.windowBits)&&(E.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new x,this.strm.avail_out=0;var k=h.inflateInit2(this.strm,E.windowBits);if(k!==y.Z_OK)throw new Error(g[k]);this.header=new C,h.inflateGetHeader(this.strm,this.header)}function w(b,E){var k=new v(E);if(k.push(b,!0),k.err)throw k.msg||g[k.err];return k.result}v.prototype.push=function(b,E){var k,_,S,A,P,I,R=this.strm,j=this.options.chunkSize,q=this.options.dictionary,U=!1;if(this.ended)return!1;_=E===~~E?E:E===!0?y.Z_FINISH:y.Z_NO_FLUSH,typeof b=="string"?R.input=p.binstring2buf(b):m.call(b)==="[object ArrayBuffer]"?R.input=new Uint8Array(b):R.input=b,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new d.Buf8(j),R.next_out=0,R.avail_out=j),(k=h.inflate(R,y.Z_NO_FLUSH))===y.Z_NEED_DICT&&q&&(I=typeof q=="string"?p.string2buf(q):m.call(q)==="[object ArrayBuffer]"?new Uint8Array(q):q,k=h.inflateSetDictionary(this.strm,I)),k===y.Z_BUF_ERROR&&U===!0&&(k=y.Z_OK,U=!1),k!==y.Z_STREAM_END&&k!==y.Z_OK)return this.onEnd(k),!(this.ended=!0);R.next_out&&(R.avail_out!==0&&k!==y.Z_STREAM_END&&(R.avail_in!==0||_!==y.Z_FINISH&&_!==y.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=p.utf8border(R.output,R.next_out),A=R.next_out-S,P=p.buf2string(R.output,S),R.next_out=A,R.avail_out=j-A,A&&d.arraySet(R.output,R.output,S,A,0),this.onData(P)):this.onData(d.shrinkBuf(R.output,R.next_out)))),R.avail_in===0&&R.avail_out===0&&(U=!0)}while((0<R.avail_in||R.avail_out===0)&&k!==y.Z_STREAM_END);return k===y.Z_STREAM_END&&(_=y.Z_FINISH),_===y.Z_FINISH?(k=h.inflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===y.Z_OK):_!==y.Z_SYNC_FLUSH||(this.onEnd(y.Z_OK),!(R.avail_out=0))},v.prototype.onData=function(b){this.chunks.push(b)},v.prototype.onEnd=function(b){b===y.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},l.Inflate=v,l.inflate=w,l.inflateRaw=function(b,E){return(E=E||{}).raw=!0,w(b,E)},l.ungzip=w},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(a,u,l){var h=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";l.assign=function(y){for(var g=Array.prototype.slice.call(arguments,1);g.length;){var x=g.shift();if(x){if(typeof x!="object")throw new TypeError(x+"must be non-object");for(var C in x)x.hasOwnProperty(C)&&(y[C]=x[C])}}return y},l.shrinkBuf=function(y,g){return y.length===g?y:y.subarray?y.subarray(0,g):(y.length=g,y)};var d={arraySet:function(y,g,x,C,m){if(g.subarray&&y.subarray)y.set(g.subarray(x,x+C),m);else for(var v=0;v<C;v++)y[m+v]=g[x+v]},flattenChunks:function(y){var g,x,C,m,v,w;for(g=C=0,x=y.length;g<x;g++)C+=y[g].length;for(w=new Uint8Array(C),g=m=0,x=y.length;g<x;g++)v=y[g],w.set(v,m),m+=v.length;return w}},p={arraySet:function(y,g,x,C,m){for(var v=0;v<C;v++)y[m+v]=g[x+v]},flattenChunks:function(y){return[].concat.apply([],y)}};l.setTyped=function(y){y?(l.Buf8=Uint8Array,l.Buf16=Uint16Array,l.Buf32=Int32Array,l.assign(l,d)):(l.Buf8=Array,l.Buf16=Array,l.Buf32=Array,l.assign(l,p))},l.setTyped(h)},{}],42:[function(a,u,l){var h=a("./common"),d=!0,p=!0;try{String.fromCharCode.apply(null,[0])}catch{d=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{p=!1}for(var y=new h.Buf8(256),g=0;g<256;g++)y[g]=252<=g?6:248<=g?5:240<=g?4:224<=g?3:192<=g?2:1;function x(C,m){if(m<65537&&(C.subarray&&p||!C.subarray&&d))return String.fromCharCode.apply(null,h.shrinkBuf(C,m));for(var v="",w=0;w<m;w++)v+=String.fromCharCode(C[w]);return v}y[254]=y[254]=1,l.string2buf=function(C){var m,v,w,b,E,k=C.length,_=0;for(b=0;b<k;b++)(64512&(v=C.charCodeAt(b)))==55296&&b+1<k&&(64512&(w=C.charCodeAt(b+1)))==56320&&(v=65536+(v-55296<<10)+(w-56320),b++),_+=v<128?1:v<2048?2:v<65536?3:4;for(m=new h.Buf8(_),b=E=0;E<_;b++)(64512&(v=C.charCodeAt(b)))==55296&&b+1<k&&(64512&(w=C.charCodeAt(b+1)))==56320&&(v=65536+(v-55296<<10)+(w-56320),b++),v<128?m[E++]=v:(v<2048?m[E++]=192|v>>>6:(v<65536?m[E++]=224|v>>>12:(m[E++]=240|v>>>18,m[E++]=128|v>>>12&63),m[E++]=128|v>>>6&63),m[E++]=128|63&v);return m},l.buf2binstring=function(C){return x(C,C.length)},l.binstring2buf=function(C){for(var m=new h.Buf8(C.length),v=0,w=m.length;v<w;v++)m[v]=C.charCodeAt(v);return m},l.buf2string=function(C,m){var v,w,b,E,k=m||C.length,_=new Array(2*k);for(v=w=0;v<k;)if((b=C[v++])<128)_[w++]=b;else if(4<(E=y[b]))_[w++]=65533,v+=E-1;else{for(b&=E===2?31:E===3?15:7;1<E&&v<k;)b=b<<6|63&C[v++],E--;1<E?_[w++]=65533:b<65536?_[w++]=b:(b-=65536,_[w++]=55296|b>>10&1023,_[w++]=56320|1023&b)}return x(_,w)},l.utf8border=function(C,m){var v;for((m=m||C.length)>C.length&&(m=C.length),v=m-1;0<=v&&(192&C[v])==128;)v--;return v<0||v===0?m:v+y[C[v]]>m?v:m}},{"./common":41}],43:[function(a,u,l){u.exports=function(h,d,p,y){for(var g=65535&h|0,x=h>>>16&65535|0,C=0;p!==0;){for(p-=C=2e3<p?2e3:p;x=x+(g=g+d[y++]|0)|0,--C;);g%=65521,x%=65521}return g|x<<16|0}},{}],44:[function(a,u,l){u.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(a,u,l){var h=function(){for(var d,p=[],y=0;y<256;y++){d=y;for(var g=0;g<8;g++)d=1&d?3988292384^d>>>1:d>>>1;p[y]=d}return p}();u.exports=function(d,p,y,g){var x=h,C=g+y;d^=-1;for(var m=g;m<C;m++)d=d>>>8^x[255&(d^p[m])];return-1^d}},{}],46:[function(a,u,l){var h,d=a("../utils/common"),p=a("./trees"),y=a("./adler32"),g=a("./crc32"),x=a("./messages"),C=0,m=4,v=0,w=-2,b=-1,E=4,k=2,_=8,S=9,A=286,P=30,I=19,R=2*A+1,j=15,q=3,U=258,z=U+q+1,L=42,N=113,B=1,V=2,se=3,X=4;function oe(O,le){return O.msg=x[le],le}function Q(O){return(O<<1)-(4<O?9:0)}function ce(O){for(var le=O.length;0<=--le;)O[le]=0}function H(O){var le=O.state,ae=le.pending;ae>O.avail_out&&(ae=O.avail_out),ae!==0&&(d.arraySet(O.output,le.pending_buf,le.pending_out,ae,O.next_out),O.next_out+=ae,le.pending_out+=ae,O.total_out+=ae,O.avail_out-=ae,le.pending-=ae,le.pending===0&&(le.pending_out=0))}function W(O,le){p._tr_flush_block(O,0<=O.block_start?O.block_start:-1,O.strstart-O.block_start,le),O.block_start=O.strstart,H(O.strm)}function ne(O,le){O.pending_buf[O.pending++]=le}function ee(O,le){O.pending_buf[O.pending++]=le>>>8&255,O.pending_buf[O.pending++]=255&le}function fe(O,le){var ae,Y,G=O.max_chain_length,te=O.strstart,ge=O.prev_length,ue=O.nice_match,re=O.strstart>O.w_size-z?O.strstart-(O.w_size-z):0,he=O.window,xe=O.w_mask,pe=O.prev,be=O.strstart+U,Ee=he[te+ge-1],Ie=he[te+ge];O.prev_length>=O.good_match&&(G>>=2),ue>O.lookahead&&(ue=O.lookahead);do if(he[(ae=le)+ge]===Ie&&he[ae+ge-1]===Ee&&he[ae]===he[te]&&he[++ae]===he[te+1]){te+=2,ae++;do;while(he[++te]===he[++ae]&&he[++te]===he[++ae]&&he[++te]===he[++ae]&&he[++te]===he[++ae]&&he[++te]===he[++ae]&&he[++te]===he[++ae]&&he[++te]===he[++ae]&&he[++te]===he[++ae]&&te<be);if(Y=U-(be-te),te=be-U,ge<Y){if(O.match_start=le,ue<=(ge=Y))break;Ee=he[te+ge-1],Ie=he[te+ge]}}while((le=pe[le&xe])>re&&--G!=0);return ge<=O.lookahead?ge:O.lookahead}function _e(O){var le,ae,Y,G,te,ge,ue,re,he,xe,pe=O.w_size;do{if(G=O.window_size-O.lookahead-O.strstart,O.strstart>=pe+(pe-z)){for(d.arraySet(O.window,O.window,pe,pe,0),O.match_start-=pe,O.strstart-=pe,O.block_start-=pe,le=ae=O.hash_size;Y=O.head[--le],O.head[le]=pe<=Y?Y-pe:0,--ae;);for(le=ae=pe;Y=O.prev[--le],O.prev[le]=pe<=Y?Y-pe:0,--ae;);G+=pe}if(O.strm.avail_in===0)break;if(ge=O.strm,ue=O.window,re=O.strstart+O.lookahead,he=G,xe=void 0,xe=ge.avail_in,he<xe&&(xe=he),ae=xe===0?0:(ge.avail_in-=xe,d.arraySet(ue,ge.input,ge.next_in,xe,re),ge.state.wrap===1?ge.adler=y(ge.adler,ue,xe,re):ge.state.wrap===2&&(ge.adler=g(ge.adler,ue,xe,re)),ge.next_in+=xe,ge.total_in+=xe,xe),O.lookahead+=ae,O.lookahead+O.insert>=q)for(te=O.strstart-O.insert,O.ins_h=O.window[te],O.ins_h=(O.ins_h<<O.hash_shift^O.window[te+1])&O.hash_mask;O.insert&&(O.ins_h=(O.ins_h<<O.hash_shift^O.window[te+q-1])&O.hash_mask,O.prev[te&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=te,te++,O.insert--,!(O.lookahead+O.insert<q)););}while(O.lookahead<z&&O.strm.avail_in!==0)}function Ae(O,le){for(var ae,Y;;){if(O.lookahead<z){if(_e(O),O.lookahead<z&&le===C)return B;if(O.lookahead===0)break}if(ae=0,O.lookahead>=q&&(O.ins_h=(O.ins_h<<O.hash_shift^O.window[O.strstart+q-1])&O.hash_mask,ae=O.prev[O.strstart&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=O.strstart),ae!==0&&O.strstart-ae<=O.w_size-z&&(O.match_length=fe(O,ae)),O.match_length>=q)if(Y=p._tr_tally(O,O.strstart-O.match_start,O.match_length-q),O.lookahead-=O.match_length,O.match_length<=O.max_lazy_match&&O.lookahead>=q){for(O.match_length--;O.strstart++,O.ins_h=(O.ins_h<<O.hash_shift^O.window[O.strstart+q-1])&O.hash_mask,ae=O.prev[O.strstart&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=O.strstart,--O.match_length!=0;);O.strstart++}else O.strstart+=O.match_length,O.match_length=0,O.ins_h=O.window[O.strstart],O.ins_h=(O.ins_h<<O.hash_shift^O.window[O.strstart+1])&O.hash_mask;else Y=p._tr_tally(O,0,O.window[O.strstart]),O.lookahead--,O.strstart++;if(Y&&(W(O,!1),O.strm.avail_out===0))return B}return O.insert=O.strstart<q-1?O.strstart:q-1,le===m?(W(O,!0),O.strm.avail_out===0?se:X):O.last_lit&&(W(O,!1),O.strm.avail_out===0)?B:V}function ye(O,le){for(var ae,Y,G;;){if(O.lookahead<z){if(_e(O),O.lookahead<z&&le===C)return B;if(O.lookahead===0)break}if(ae=0,O.lookahead>=q&&(O.ins_h=(O.ins_h<<O.hash_shift^O.window[O.strstart+q-1])&O.hash_mask,ae=O.prev[O.strstart&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=O.strstart),O.prev_length=O.match_length,O.prev_match=O.match_start,O.match_length=q-1,ae!==0&&O.prev_length<O.max_lazy_match&&O.strstart-ae<=O.w_size-z&&(O.match_length=fe(O,ae),O.match_length<=5&&(O.strategy===1||O.match_length===q&&4096<O.strstart-O.match_start)&&(O.match_length=q-1)),O.prev_length>=q&&O.match_length<=O.prev_length){for(G=O.strstart+O.lookahead-q,Y=p._tr_tally(O,O.strstart-1-O.prev_match,O.prev_length-q),O.lookahead-=O.prev_length-1,O.prev_length-=2;++O.strstart<=G&&(O.ins_h=(O.ins_h<<O.hash_shift^O.window[O.strstart+q-1])&O.hash_mask,ae=O.prev[O.strstart&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=O.strstart),--O.prev_length!=0;);if(O.match_available=0,O.match_length=q-1,O.strstart++,Y&&(W(O,!1),O.strm.avail_out===0))return B}else if(O.match_available){if((Y=p._tr_tally(O,0,O.window[O.strstart-1]))&&W(O,!1),O.strstart++,O.lookahead--,O.strm.avail_out===0)return B}else O.match_available=1,O.strstart++,O.lookahead--}return O.match_available&&(Y=p._tr_tally(O,0,O.window[O.strstart-1]),O.match_available=0),O.insert=O.strstart<q-1?O.strstart:q-1,le===m?(W(O,!0),O.strm.avail_out===0?se:X):O.last_lit&&(W(O,!1),O.strm.avail_out===0)?B:V}function Se(O,le,ae,Y,G){this.good_length=O,this.max_lazy=le,this.nice_length=ae,this.max_chain=Y,this.func=G}function Pe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new d.Buf16(2*R),this.dyn_dtree=new d.Buf16(2*(2*P+1)),this.bl_tree=new d.Buf16(2*(2*I+1)),ce(this.dyn_ltree),ce(this.dyn_dtree),ce(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new d.Buf16(j+1),this.heap=new d.Buf16(2*A+1),ce(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new d.Buf16(2*A+1),ce(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Fe(O){var le;return O&&O.state?(O.total_in=O.total_out=0,O.data_type=k,(le=O.state).pending=0,le.pending_out=0,le.wrap<0&&(le.wrap=-le.wrap),le.status=le.wrap?L:N,O.adler=le.wrap===2?0:1,le.last_flush=C,p._tr_init(le),v):oe(O,w)}function Me(O){var le=Fe(O);return le===v&&function(ae){ae.window_size=2*ae.w_size,ce(ae.head),ae.max_lazy_match=h[ae.level].max_lazy,ae.good_match=h[ae.level].good_length,ae.nice_match=h[ae.level].nice_length,ae.max_chain_length=h[ae.level].max_chain,ae.strstart=0,ae.block_start=0,ae.lookahead=0,ae.insert=0,ae.match_length=ae.prev_length=q-1,ae.match_available=0,ae.ins_h=0}(O.state),le}function De(O,le,ae,Y,G,te){if(!O)return w;var ge=1;if(le===b&&(le=6),Y<0?(ge=0,Y=-Y):15<Y&&(ge=2,Y-=16),G<1||S<G||ae!==_||Y<8||15<Y||le<0||9<le||te<0||E<te)return oe(O,w);Y===8&&(Y=9);var ue=new Pe;return(O.state=ue).strm=O,ue.wrap=ge,ue.gzhead=null,ue.w_bits=Y,ue.w_size=1<<ue.w_bits,ue.w_mask=ue.w_size-1,ue.hash_bits=G+7,ue.hash_size=1<<ue.hash_bits,ue.hash_mask=ue.hash_size-1,ue.hash_shift=~~((ue.hash_bits+q-1)/q),ue.window=new d.Buf8(2*ue.w_size),ue.head=new d.Buf16(ue.hash_size),ue.prev=new d.Buf16(ue.w_size),ue.lit_bufsize=1<<G+6,ue.pending_buf_size=4*ue.lit_bufsize,ue.pending_buf=new d.Buf8(ue.pending_buf_size),ue.d_buf=1*ue.lit_bufsize,ue.l_buf=3*ue.lit_bufsize,ue.level=le,ue.strategy=te,ue.method=ae,Me(O)}h=[new Se(0,0,0,0,function(O,le){var ae=65535;for(ae>O.pending_buf_size-5&&(ae=O.pending_buf_size-5);;){if(O.lookahead<=1){if(_e(O),O.lookahead===0&&le===C)return B;if(O.lookahead===0)break}O.strstart+=O.lookahead,O.lookahead=0;var Y=O.block_start+ae;if((O.strstart===0||O.strstart>=Y)&&(O.lookahead=O.strstart-Y,O.strstart=Y,W(O,!1),O.strm.avail_out===0)||O.strstart-O.block_start>=O.w_size-z&&(W(O,!1),O.strm.avail_out===0))return B}return O.insert=0,le===m?(W(O,!0),O.strm.avail_out===0?se:X):(O.strstart>O.block_start&&(W(O,!1),O.strm.avail_out),B)}),new Se(4,4,8,4,Ae),new Se(4,5,16,8,Ae),new Se(4,6,32,32,Ae),new Se(4,4,16,16,ye),new Se(8,16,32,32,ye),new Se(8,16,128,128,ye),new Se(8,32,128,256,ye),new Se(32,128,258,1024,ye),new Se(32,258,258,4096,ye)],l.deflateInit=function(O,le){return De(O,le,_,15,8,0)},l.deflateInit2=De,l.deflateReset=Me,l.deflateResetKeep=Fe,l.deflateSetHeader=function(O,le){return O&&O.state?O.state.wrap!==2?w:(O.state.gzhead=le,v):w},l.deflate=function(O,le){var ae,Y,G,te;if(!O||!O.state||5<le||le<0)return O?oe(O,w):w;if(Y=O.state,!O.output||!O.input&&O.avail_in!==0||Y.status===666&&le!==m)return oe(O,O.avail_out===0?-5:w);if(Y.strm=O,ae=Y.last_flush,Y.last_flush=le,Y.status===L)if(Y.wrap===2)O.adler=0,ne(Y,31),ne(Y,139),ne(Y,8),Y.gzhead?(ne(Y,(Y.gzhead.text?1:0)+(Y.gzhead.hcrc?2:0)+(Y.gzhead.extra?4:0)+(Y.gzhead.name?8:0)+(Y.gzhead.comment?16:0)),ne(Y,255&Y.gzhead.time),ne(Y,Y.gzhead.time>>8&255),ne(Y,Y.gzhead.time>>16&255),ne(Y,Y.gzhead.time>>24&255),ne(Y,Y.level===9?2:2<=Y.strategy||Y.level<2?4:0),ne(Y,255&Y.gzhead.os),Y.gzhead.extra&&Y.gzhead.extra.length&&(ne(Y,255&Y.gzhead.extra.length),ne(Y,Y.gzhead.extra.length>>8&255)),Y.gzhead.hcrc&&(O.adler=g(O.adler,Y.pending_buf,Y.pending,0)),Y.gzindex=0,Y.status=69):(ne(Y,0),ne(Y,0),ne(Y,0),ne(Y,0),ne(Y,0),ne(Y,Y.level===9?2:2<=Y.strategy||Y.level<2?4:0),ne(Y,3),Y.status=N);else{var ge=_+(Y.w_bits-8<<4)<<8;ge|=(2<=Y.strategy||Y.level<2?0:Y.level<6?1:Y.level===6?2:3)<<6,Y.strstart!==0&&(ge|=32),ge+=31-ge%31,Y.status=N,ee(Y,ge),Y.strstart!==0&&(ee(Y,O.adler>>>16),ee(Y,65535&O.adler)),O.adler=1}if(Y.status===69)if(Y.gzhead.extra){for(G=Y.pending;Y.gzindex<(65535&Y.gzhead.extra.length)&&(Y.pending!==Y.pending_buf_size||(Y.gzhead.hcrc&&Y.pending>G&&(O.adler=g(O.adler,Y.pending_buf,Y.pending-G,G)),H(O),G=Y.pending,Y.pending!==Y.pending_buf_size));)ne(Y,255&Y.gzhead.extra[Y.gzindex]),Y.gzindex++;Y.gzhead.hcrc&&Y.pending>G&&(O.adler=g(O.adler,Y.pending_buf,Y.pending-G,G)),Y.gzindex===Y.gzhead.extra.length&&(Y.gzindex=0,Y.status=73)}else Y.status=73;if(Y.status===73)if(Y.gzhead.name){G=Y.pending;do{if(Y.pending===Y.pending_buf_size&&(Y.gzhead.hcrc&&Y.pending>G&&(O.adler=g(O.adler,Y.pending_buf,Y.pending-G,G)),H(O),G=Y.pending,Y.pending===Y.pending_buf_size)){te=1;break}te=Y.gzindex<Y.gzhead.name.length?255&Y.gzhead.name.charCodeAt(Y.gzindex++):0,ne(Y,te)}while(te!==0);Y.gzhead.hcrc&&Y.pending>G&&(O.adler=g(O.adler,Y.pending_buf,Y.pending-G,G)),te===0&&(Y.gzindex=0,Y.status=91)}else Y.status=91;if(Y.status===91)if(Y.gzhead.comment){G=Y.pending;do{if(Y.pending===Y.pending_buf_size&&(Y.gzhead.hcrc&&Y.pending>G&&(O.adler=g(O.adler,Y.pending_buf,Y.pending-G,G)),H(O),G=Y.pending,Y.pending===Y.pending_buf_size)){te=1;break}te=Y.gzindex<Y.gzhead.comment.length?255&Y.gzhead.comment.charCodeAt(Y.gzindex++):0,ne(Y,te)}while(te!==0);Y.gzhead.hcrc&&Y.pending>G&&(O.adler=g(O.adler,Y.pending_buf,Y.pending-G,G)),te===0&&(Y.status=103)}else Y.status=103;if(Y.status===103&&(Y.gzhead.hcrc?(Y.pending+2>Y.pending_buf_size&&H(O),Y.pending+2<=Y.pending_buf_size&&(ne(Y,255&O.adler),ne(Y,O.adler>>8&255),O.adler=0,Y.status=N)):Y.status=N),Y.pending!==0){if(H(O),O.avail_out===0)return Y.last_flush=-1,v}else if(O.avail_in===0&&Q(le)<=Q(ae)&&le!==m)return oe(O,-5);if(Y.status===666&&O.avail_in!==0)return oe(O,-5);if(O.avail_in!==0||Y.lookahead!==0||le!==C&&Y.status!==666){var ue=Y.strategy===2?function(re,he){for(var xe;;){if(re.lookahead===0&&(_e(re),re.lookahead===0)){if(he===C)return B;break}if(re.match_length=0,xe=p._tr_tally(re,0,re.window[re.strstart]),re.lookahead--,re.strstart++,xe&&(W(re,!1),re.strm.avail_out===0))return B}return re.insert=0,he===m?(W(re,!0),re.strm.avail_out===0?se:X):re.last_lit&&(W(re,!1),re.strm.avail_out===0)?B:V}(Y,le):Y.strategy===3?function(re,he){for(var xe,pe,be,Ee,Ie=re.window;;){if(re.lookahead<=U){if(_e(re),re.lookahead<=U&&he===C)return B;if(re.lookahead===0)break}if(re.match_length=0,re.lookahead>=q&&0<re.strstart&&(pe=Ie[be=re.strstart-1])===Ie[++be]&&pe===Ie[++be]&&pe===Ie[++be]){Ee=re.strstart+U;do;while(pe===Ie[++be]&&pe===Ie[++be]&&pe===Ie[++be]&&pe===Ie[++be]&&pe===Ie[++be]&&pe===Ie[++be]&&pe===Ie[++be]&&pe===Ie[++be]&&be<Ee);re.match_length=U-(Ee-be),re.match_length>re.lookahead&&(re.match_length=re.lookahead)}if(re.match_length>=q?(xe=p._tr_tally(re,1,re.match_length-q),re.lookahead-=re.match_length,re.strstart+=re.match_length,re.match_length=0):(xe=p._tr_tally(re,0,re.window[re.strstart]),re.lookahead--,re.strstart++),xe&&(W(re,!1),re.strm.avail_out===0))return B}return re.insert=0,he===m?(W(re,!0),re.strm.avail_out===0?se:X):re.last_lit&&(W(re,!1),re.strm.avail_out===0)?B:V}(Y,le):h[Y.level].func(Y,le);if(ue!==se&&ue!==X||(Y.status=666),ue===B||ue===se)return O.avail_out===0&&(Y.last_flush=-1),v;if(ue===V&&(le===1?p._tr_align(Y):le!==5&&(p._tr_stored_block(Y,0,0,!1),le===3&&(ce(Y.head),Y.lookahead===0&&(Y.strstart=0,Y.block_start=0,Y.insert=0))),H(O),O.avail_out===0))return Y.last_flush=-1,v}return le!==m?v:Y.wrap<=0?1:(Y.wrap===2?(ne(Y,255&O.adler),ne(Y,O.adler>>8&255),ne(Y,O.adler>>16&255),ne(Y,O.adler>>24&255),ne(Y,255&O.total_in),ne(Y,O.total_in>>8&255),ne(Y,O.total_in>>16&255),ne(Y,O.total_in>>24&255)):(ee(Y,O.adler>>>16),ee(Y,65535&O.adler)),H(O),0<Y.wrap&&(Y.wrap=-Y.wrap),Y.pending!==0?v:1)},l.deflateEnd=function(O){var le;return O&&O.state?(le=O.state.status)!==L&&le!==69&&le!==73&&le!==91&&le!==103&&le!==N&&le!==666?oe(O,w):(O.state=null,le===N?oe(O,-3):v):w},l.deflateSetDictionary=function(O,le){var ae,Y,G,te,ge,ue,re,he,xe=le.length;if(!O||!O.state||(te=(ae=O.state).wrap)===2||te===1&&ae.status!==L||ae.lookahead)return w;for(te===1&&(O.adler=y(O.adler,le,xe,0)),ae.wrap=0,xe>=ae.w_size&&(te===0&&(ce(ae.head),ae.strstart=0,ae.block_start=0,ae.insert=0),he=new d.Buf8(ae.w_size),d.arraySet(he,le,xe-ae.w_size,ae.w_size,0),le=he,xe=ae.w_size),ge=O.avail_in,ue=O.next_in,re=O.input,O.avail_in=xe,O.next_in=0,O.input=le,_e(ae);ae.lookahead>=q;){for(Y=ae.strstart,G=ae.lookahead-(q-1);ae.ins_h=(ae.ins_h<<ae.hash_shift^ae.window[Y+q-1])&ae.hash_mask,ae.prev[Y&ae.w_mask]=ae.head[ae.ins_h],ae.head[ae.ins_h]=Y,Y++,--G;);ae.strstart=Y,ae.lookahead=q-1,_e(ae)}return ae.strstart+=ae.lookahead,ae.block_start=ae.strstart,ae.insert=ae.lookahead,ae.lookahead=0,ae.match_length=ae.prev_length=q-1,ae.match_available=0,O.next_in=ue,O.input=re,O.avail_in=ge,ae.wrap=te,v},l.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(a,u,l){u.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(a,u,l){u.exports=function(h,d){var p,y,g,x,C,m,v,w,b,E,k,_,S,A,P,I,R,j,q,U,z,L,N,B,V;p=h.state,y=h.next_in,B=h.input,g=y+(h.avail_in-5),x=h.next_out,V=h.output,C=x-(d-h.avail_out),m=x+(h.avail_out-257),v=p.dmax,w=p.wsize,b=p.whave,E=p.wnext,k=p.window,_=p.hold,S=p.bits,A=p.lencode,P=p.distcode,I=(1<<p.lenbits)-1,R=(1<<p.distbits)-1;e:do{S<15&&(_+=B[y++]<<S,S+=8,_+=B[y++]<<S,S+=8),j=A[_&I];t:for(;;){if(_>>>=q=j>>>24,S-=q,(q=j>>>16&255)===0)V[x++]=65535&j;else{if(!(16&q)){if(!(64&q)){j=A[(65535&j)+(_&(1<<q)-1)];continue t}if(32&q){p.mode=12;break e}h.msg="invalid literal/length code",p.mode=30;break e}U=65535&j,(q&=15)&&(S<q&&(_+=B[y++]<<S,S+=8),U+=_&(1<<q)-1,_>>>=q,S-=q),S<15&&(_+=B[y++]<<S,S+=8,_+=B[y++]<<S,S+=8),j=P[_&R];r:for(;;){if(_>>>=q=j>>>24,S-=q,!(16&(q=j>>>16&255))){if(!(64&q)){j=P[(65535&j)+(_&(1<<q)-1)];continue r}h.msg="invalid distance code",p.mode=30;break e}if(z=65535&j,S<(q&=15)&&(_+=B[y++]<<S,(S+=8)<q&&(_+=B[y++]<<S,S+=8)),v<(z+=_&(1<<q)-1)){h.msg="invalid distance too far back",p.mode=30;break e}if(_>>>=q,S-=q,(q=x-C)<z){if(b<(q=z-q)&&p.sane){h.msg="invalid distance too far back",p.mode=30;break e}if(N=k,(L=0)===E){if(L+=w-q,q<U){for(U-=q;V[x++]=k[L++],--q;);L=x-z,N=V}}else if(E<q){if(L+=w+E-q,(q-=E)<U){for(U-=q;V[x++]=k[L++],--q;);if(L=0,E<U){for(U-=q=E;V[x++]=k[L++],--q;);L=x-z,N=V}}}else if(L+=E-q,q<U){for(U-=q;V[x++]=k[L++],--q;);L=x-z,N=V}for(;2<U;)V[x++]=N[L++],V[x++]=N[L++],V[x++]=N[L++],U-=3;U&&(V[x++]=N[L++],1<U&&(V[x++]=N[L++]))}else{for(L=x-z;V[x++]=V[L++],V[x++]=V[L++],V[x++]=V[L++],2<(U-=3););U&&(V[x++]=V[L++],1<U&&(V[x++]=V[L++]))}break}}break}}while(y<g&&x<m);y-=U=S>>3,_&=(1<<(S-=U<<3))-1,h.next_in=y,h.next_out=x,h.avail_in=y<g?g-y+5:5-(y-g),h.avail_out=x<m?m-x+257:257-(x-m),p.hold=_,p.bits=S}},{}],49:[function(a,u,l){var h=a("../utils/common"),d=a("./adler32"),p=a("./crc32"),y=a("./inffast"),g=a("./inftrees"),x=1,C=2,m=0,v=-2,w=1,b=852,E=592;function k(L){return(L>>>24&255)+(L>>>8&65280)+((65280&L)<<8)+((255&L)<<24)}function _(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new h.Buf16(320),this.work=new h.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(L){var N;return L&&L.state?(N=L.state,L.total_in=L.total_out=N.total=0,L.msg="",N.wrap&&(L.adler=1&N.wrap),N.mode=w,N.last=0,N.havedict=0,N.dmax=32768,N.head=null,N.hold=0,N.bits=0,N.lencode=N.lendyn=new h.Buf32(b),N.distcode=N.distdyn=new h.Buf32(E),N.sane=1,N.back=-1,m):v}function A(L){var N;return L&&L.state?((N=L.state).wsize=0,N.whave=0,N.wnext=0,S(L)):v}function P(L,N){var B,V;return L&&L.state?(V=L.state,N<0?(B=0,N=-N):(B=1+(N>>4),N<48&&(N&=15)),N&&(N<8||15<N)?v:(V.window!==null&&V.wbits!==N&&(V.window=null),V.wrap=B,V.wbits=N,A(L))):v}function I(L,N){var B,V;return L?(V=new _,(L.state=V).window=null,(B=P(L,N))!==m&&(L.state=null),B):v}var R,j,q=!0;function U(L){if(q){var N;for(R=new h.Buf32(512),j=new h.Buf32(32),N=0;N<144;)L.lens[N++]=8;for(;N<256;)L.lens[N++]=9;for(;N<280;)L.lens[N++]=7;for(;N<288;)L.lens[N++]=8;for(g(x,L.lens,0,288,R,0,L.work,{bits:9}),N=0;N<32;)L.lens[N++]=5;g(C,L.lens,0,32,j,0,L.work,{bits:5}),q=!1}L.lencode=R,L.lenbits=9,L.distcode=j,L.distbits=5}function z(L,N,B,V){var se,X=L.state;return X.window===null&&(X.wsize=1<<X.wbits,X.wnext=0,X.whave=0,X.window=new h.Buf8(X.wsize)),V>=X.wsize?(h.arraySet(X.window,N,B-X.wsize,X.wsize,0),X.wnext=0,X.whave=X.wsize):(V<(se=X.wsize-X.wnext)&&(se=V),h.arraySet(X.window,N,B-V,se,X.wnext),(V-=se)?(h.arraySet(X.window,N,B-V,V,0),X.wnext=V,X.whave=X.wsize):(X.wnext+=se,X.wnext===X.wsize&&(X.wnext=0),X.whave<X.wsize&&(X.whave+=se))),0}l.inflateReset=A,l.inflateReset2=P,l.inflateResetKeep=S,l.inflateInit=function(L){return I(L,15)},l.inflateInit2=I,l.inflate=function(L,N){var B,V,se,X,oe,Q,ce,H,W,ne,ee,fe,_e,Ae,ye,Se,Pe,Fe,Me,De,O,le,ae,Y,G=0,te=new h.Buf8(4),ge=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!L||!L.state||!L.output||!L.input&&L.avail_in!==0)return v;(B=L.state).mode===12&&(B.mode=13),oe=L.next_out,se=L.output,ce=L.avail_out,X=L.next_in,V=L.input,Q=L.avail_in,H=B.hold,W=B.bits,ne=Q,ee=ce,le=m;e:for(;;)switch(B.mode){case w:if(B.wrap===0){B.mode=13;break}for(;W<16;){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}if(2&B.wrap&&H===35615){te[B.check=0]=255&H,te[1]=H>>>8&255,B.check=p(B.check,te,2,0),W=H=0,B.mode=2;break}if(B.flags=0,B.head&&(B.head.done=!1),!(1&B.wrap)||(((255&H)<<8)+(H>>8))%31){L.msg="incorrect header check",B.mode=30;break}if((15&H)!=8){L.msg="unknown compression method",B.mode=30;break}if(W-=4,O=8+(15&(H>>>=4)),B.wbits===0)B.wbits=O;else if(O>B.wbits){L.msg="invalid window size",B.mode=30;break}B.dmax=1<<O,L.adler=B.check=1,B.mode=512&H?10:12,W=H=0;break;case 2:for(;W<16;){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}if(B.flags=H,(255&B.flags)!=8){L.msg="unknown compression method",B.mode=30;break}if(57344&B.flags){L.msg="unknown header flags set",B.mode=30;break}B.head&&(B.head.text=H>>8&1),512&B.flags&&(te[0]=255&H,te[1]=H>>>8&255,B.check=p(B.check,te,2,0)),W=H=0,B.mode=3;case 3:for(;W<32;){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}B.head&&(B.head.time=H),512&B.flags&&(te[0]=255&H,te[1]=H>>>8&255,te[2]=H>>>16&255,te[3]=H>>>24&255,B.check=p(B.check,te,4,0)),W=H=0,B.mode=4;case 4:for(;W<16;){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}B.head&&(B.head.xflags=255&H,B.head.os=H>>8),512&B.flags&&(te[0]=255&H,te[1]=H>>>8&255,B.check=p(B.check,te,2,0)),W=H=0,B.mode=5;case 5:if(1024&B.flags){for(;W<16;){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}B.length=H,B.head&&(B.head.extra_len=H),512&B.flags&&(te[0]=255&H,te[1]=H>>>8&255,B.check=p(B.check,te,2,0)),W=H=0}else B.head&&(B.head.extra=null);B.mode=6;case 6:if(1024&B.flags&&(Q<(fe=B.length)&&(fe=Q),fe&&(B.head&&(O=B.head.extra_len-B.length,B.head.extra||(B.head.extra=new Array(B.head.extra_len)),h.arraySet(B.head.extra,V,X,fe,O)),512&B.flags&&(B.check=p(B.check,V,fe,X)),Q-=fe,X+=fe,B.length-=fe),B.length))break e;B.length=0,B.mode=7;case 7:if(2048&B.flags){if(Q===0)break e;for(fe=0;O=V[X+fe++],B.head&&O&&B.length<65536&&(B.head.name+=String.fromCharCode(O)),O&&fe<Q;);if(512&B.flags&&(B.check=p(B.check,V,fe,X)),Q-=fe,X+=fe,O)break e}else B.head&&(B.head.name=null);B.length=0,B.mode=8;case 8:if(4096&B.flags){if(Q===0)break e;for(fe=0;O=V[X+fe++],B.head&&O&&B.length<65536&&(B.head.comment+=String.fromCharCode(O)),O&&fe<Q;);if(512&B.flags&&(B.check=p(B.check,V,fe,X)),Q-=fe,X+=fe,O)break e}else B.head&&(B.head.comment=null);B.mode=9;case 9:if(512&B.flags){for(;W<16;){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}if(H!==(65535&B.check)){L.msg="header crc mismatch",B.mode=30;break}W=H=0}B.head&&(B.head.hcrc=B.flags>>9&1,B.head.done=!0),L.adler=B.check=0,B.mode=12;break;case 10:for(;W<32;){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}L.adler=B.check=k(H),W=H=0,B.mode=11;case 11:if(B.havedict===0)return L.next_out=oe,L.avail_out=ce,L.next_in=X,L.avail_in=Q,B.hold=H,B.bits=W,2;L.adler=B.check=1,B.mode=12;case 12:if(N===5||N===6)break e;case 13:if(B.last){H>>>=7&W,W-=7&W,B.mode=27;break}for(;W<3;){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}switch(B.last=1&H,W-=1,3&(H>>>=1)){case 0:B.mode=14;break;case 1:if(U(B),B.mode=20,N!==6)break;H>>>=2,W-=2;break e;case 2:B.mode=17;break;case 3:L.msg="invalid block type",B.mode=30}H>>>=2,W-=2;break;case 14:for(H>>>=7&W,W-=7&W;W<32;){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}if((65535&H)!=(H>>>16^65535)){L.msg="invalid stored block lengths",B.mode=30;break}if(B.length=65535&H,W=H=0,B.mode=15,N===6)break e;case 15:B.mode=16;case 16:if(fe=B.length){if(Q<fe&&(fe=Q),ce<fe&&(fe=ce),fe===0)break e;h.arraySet(se,V,X,fe,oe),Q-=fe,X+=fe,ce-=fe,oe+=fe,B.length-=fe;break}B.mode=12;break;case 17:for(;W<14;){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}if(B.nlen=257+(31&H),H>>>=5,W-=5,B.ndist=1+(31&H),H>>>=5,W-=5,B.ncode=4+(15&H),H>>>=4,W-=4,286<B.nlen||30<B.ndist){L.msg="too many length or distance symbols",B.mode=30;break}B.have=0,B.mode=18;case 18:for(;B.have<B.ncode;){for(;W<3;){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}B.lens[ge[B.have++]]=7&H,H>>>=3,W-=3}for(;B.have<19;)B.lens[ge[B.have++]]=0;if(B.lencode=B.lendyn,B.lenbits=7,ae={bits:B.lenbits},le=g(0,B.lens,0,19,B.lencode,0,B.work,ae),B.lenbits=ae.bits,le){L.msg="invalid code lengths set",B.mode=30;break}B.have=0,B.mode=19;case 19:for(;B.have<B.nlen+B.ndist;){for(;Se=(G=B.lencode[H&(1<<B.lenbits)-1])>>>16&255,Pe=65535&G,!((ye=G>>>24)<=W);){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}if(Pe<16)H>>>=ye,W-=ye,B.lens[B.have++]=Pe;else{if(Pe===16){for(Y=ye+2;W<Y;){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}if(H>>>=ye,W-=ye,B.have===0){L.msg="invalid bit length repeat",B.mode=30;break}O=B.lens[B.have-1],fe=3+(3&H),H>>>=2,W-=2}else if(Pe===17){for(Y=ye+3;W<Y;){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}W-=ye,O=0,fe=3+(7&(H>>>=ye)),H>>>=3,W-=3}else{for(Y=ye+7;W<Y;){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}W-=ye,O=0,fe=11+(127&(H>>>=ye)),H>>>=7,W-=7}if(B.have+fe>B.nlen+B.ndist){L.msg="invalid bit length repeat",B.mode=30;break}for(;fe--;)B.lens[B.have++]=O}}if(B.mode===30)break;if(B.lens[256]===0){L.msg="invalid code -- missing end-of-block",B.mode=30;break}if(B.lenbits=9,ae={bits:B.lenbits},le=g(x,B.lens,0,B.nlen,B.lencode,0,B.work,ae),B.lenbits=ae.bits,le){L.msg="invalid literal/lengths set",B.mode=30;break}if(B.distbits=6,B.distcode=B.distdyn,ae={bits:B.distbits},le=g(C,B.lens,B.nlen,B.ndist,B.distcode,0,B.work,ae),B.distbits=ae.bits,le){L.msg="invalid distances set",B.mode=30;break}if(B.mode=20,N===6)break e;case 20:B.mode=21;case 21:if(6<=Q&&258<=ce){L.next_out=oe,L.avail_out=ce,L.next_in=X,L.avail_in=Q,B.hold=H,B.bits=W,y(L,ee),oe=L.next_out,se=L.output,ce=L.avail_out,X=L.next_in,V=L.input,Q=L.avail_in,H=B.hold,W=B.bits,B.mode===12&&(B.back=-1);break}for(B.back=0;Se=(G=B.lencode[H&(1<<B.lenbits)-1])>>>16&255,Pe=65535&G,!((ye=G>>>24)<=W);){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}if(Se&&!(240&Se)){for(Fe=ye,Me=Se,De=Pe;Se=(G=B.lencode[De+((H&(1<<Fe+Me)-1)>>Fe)])>>>16&255,Pe=65535&G,!(Fe+(ye=G>>>24)<=W);){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}H>>>=Fe,W-=Fe,B.back+=Fe}if(H>>>=ye,W-=ye,B.back+=ye,B.length=Pe,Se===0){B.mode=26;break}if(32&Se){B.back=-1,B.mode=12;break}if(64&Se){L.msg="invalid literal/length code",B.mode=30;break}B.extra=15&Se,B.mode=22;case 22:if(B.extra){for(Y=B.extra;W<Y;){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}B.length+=H&(1<<B.extra)-1,H>>>=B.extra,W-=B.extra,B.back+=B.extra}B.was=B.length,B.mode=23;case 23:for(;Se=(G=B.distcode[H&(1<<B.distbits)-1])>>>16&255,Pe=65535&G,!((ye=G>>>24)<=W);){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}if(!(240&Se)){for(Fe=ye,Me=Se,De=Pe;Se=(G=B.distcode[De+((H&(1<<Fe+Me)-1)>>Fe)])>>>16&255,Pe=65535&G,!(Fe+(ye=G>>>24)<=W);){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}H>>>=Fe,W-=Fe,B.back+=Fe}if(H>>>=ye,W-=ye,B.back+=ye,64&Se){L.msg="invalid distance code",B.mode=30;break}B.offset=Pe,B.extra=15&Se,B.mode=24;case 24:if(B.extra){for(Y=B.extra;W<Y;){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}B.offset+=H&(1<<B.extra)-1,H>>>=B.extra,W-=B.extra,B.back+=B.extra}if(B.offset>B.dmax){L.msg="invalid distance too far back",B.mode=30;break}B.mode=25;case 25:if(ce===0)break e;if(fe=ee-ce,B.offset>fe){if((fe=B.offset-fe)>B.whave&&B.sane){L.msg="invalid distance too far back",B.mode=30;break}_e=fe>B.wnext?(fe-=B.wnext,B.wsize-fe):B.wnext-fe,fe>B.length&&(fe=B.length),Ae=B.window}else Ae=se,_e=oe-B.offset,fe=B.length;for(ce<fe&&(fe=ce),ce-=fe,B.length-=fe;se[oe++]=Ae[_e++],--fe;);B.length===0&&(B.mode=21);break;case 26:if(ce===0)break e;se[oe++]=B.length,ce--,B.mode=21;break;case 27:if(B.wrap){for(;W<32;){if(Q===0)break e;Q--,H|=V[X++]<<W,W+=8}if(ee-=ce,L.total_out+=ee,B.total+=ee,ee&&(L.adler=B.check=B.flags?p(B.check,se,ee,oe-ee):d(B.check,se,ee,oe-ee)),ee=ce,(B.flags?H:k(H))!==B.check){L.msg="incorrect data check",B.mode=30;break}W=H=0}B.mode=28;case 28:if(B.wrap&&B.flags){for(;W<32;){if(Q===0)break e;Q--,H+=V[X++]<<W,W+=8}if(H!==(4294967295&B.total)){L.msg="incorrect length check",B.mode=30;break}W=H=0}B.mode=29;case 29:le=1;break e;case 30:le=-3;break e;case 31:return-4;case 32:default:return v}return L.next_out=oe,L.avail_out=ce,L.next_in=X,L.avail_in=Q,B.hold=H,B.bits=W,(B.wsize||ee!==L.avail_out&&B.mode<30&&(B.mode<27||N!==4))&&z(L,L.output,L.next_out,ee-L.avail_out)?(B.mode=31,-4):(ne-=L.avail_in,ee-=L.avail_out,L.total_in+=ne,L.total_out+=ee,B.total+=ee,B.wrap&&ee&&(L.adler=B.check=B.flags?p(B.check,se,ee,L.next_out-ee):d(B.check,se,ee,L.next_out-ee)),L.data_type=B.bits+(B.last?64:0)+(B.mode===12?128:0)+(B.mode===20||B.mode===15?256:0),(ne==0&&ee===0||N===4)&&le===m&&(le=-5),le)},l.inflateEnd=function(L){if(!L||!L.state)return v;var N=L.state;return N.window&&(N.window=null),L.state=null,m},l.inflateGetHeader=function(L,N){var B;return L&&L.state&&2&(B=L.state).wrap?((B.head=N).done=!1,m):v},l.inflateSetDictionary=function(L,N){var B,V=N.length;return L&&L.state?(B=L.state).wrap!==0&&B.mode!==11?v:B.mode===11&&d(1,N,V,0)!==B.check?-3:z(L,N,V,V)?(B.mode=31,-4):(B.havedict=1,m):v},l.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(a,u,l){var h=a("../utils/common"),d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],p=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],y=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],g=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];u.exports=function(x,C,m,v,w,b,E,k){var _,S,A,P,I,R,j,q,U,z=k.bits,L=0,N=0,B=0,V=0,se=0,X=0,oe=0,Q=0,ce=0,H=0,W=null,ne=0,ee=new h.Buf16(16),fe=new h.Buf16(16),_e=null,Ae=0;for(L=0;L<=15;L++)ee[L]=0;for(N=0;N<v;N++)ee[C[m+N]]++;for(se=z,V=15;1<=V&&ee[V]===0;V--);if(V<se&&(se=V),V===0)return w[b++]=20971520,w[b++]=20971520,k.bits=1,0;for(B=1;B<V&&ee[B]===0;B++);for(se<B&&(se=B),L=Q=1;L<=15;L++)if(Q<<=1,(Q-=ee[L])<0)return-1;if(0<Q&&(x===0||V!==1))return-1;for(fe[1]=0,L=1;L<15;L++)fe[L+1]=fe[L]+ee[L];for(N=0;N<v;N++)C[m+N]!==0&&(E[fe[C[m+N]]++]=N);if(R=x===0?(W=_e=E,19):x===1?(W=d,ne-=257,_e=p,Ae-=257,256):(W=y,_e=g,-1),L=B,I=b,oe=N=H=0,A=-1,P=(ce=1<<(X=se))-1,x===1&&852<ce||x===2&&592<ce)return 1;for(;;){for(j=L-oe,U=E[N]<R?(q=0,E[N]):E[N]>R?(q=_e[Ae+E[N]],W[ne+E[N]]):(q=96,0),_=1<<L-oe,B=S=1<<X;w[I+(H>>oe)+(S-=_)]=j<<24|q<<16|U|0,S!==0;);for(_=1<<L-1;H&_;)_>>=1;if(_!==0?(H&=_-1,H+=_):H=0,N++,--ee[L]==0){if(L===V)break;L=C[m+E[N]]}if(se<L&&(H&P)!==A){for(oe===0&&(oe=se),I+=B,Q=1<<(X=L-oe);X+oe<V&&!((Q-=ee[X+oe])<=0);)X++,Q<<=1;if(ce+=1<<X,x===1&&852<ce||x===2&&592<ce)return 1;w[A=H&P]=se<<24|X<<16|I-b|0}}return H!==0&&(w[I+H]=L-oe<<24|64<<16|0),k.bits=se,0}},{"../utils/common":41}],51:[function(a,u,l){u.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(a,u,l){var h=a("../utils/common"),d=0,p=1;function y(G){for(var te=G.length;0<=--te;)G[te]=0}var g=0,x=29,C=256,m=C+1+x,v=30,w=19,b=2*m+1,E=15,k=16,_=7,S=256,A=16,P=17,I=18,R=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],j=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=new Array(2*(m+2));y(z);var L=new Array(2*v);y(L);var N=new Array(512);y(N);var B=new Array(256);y(B);var V=new Array(x);y(V);var se,X,oe,Q=new Array(v);function ce(G,te,ge,ue,re){this.static_tree=G,this.extra_bits=te,this.extra_base=ge,this.elems=ue,this.max_length=re,this.has_stree=G&&G.length}function H(G,te){this.dyn_tree=G,this.max_code=0,this.stat_desc=te}function W(G){return G<256?N[G]:N[256+(G>>>7)]}function ne(G,te){G.pending_buf[G.pending++]=255&te,G.pending_buf[G.pending++]=te>>>8&255}function ee(G,te,ge){G.bi_valid>k-ge?(G.bi_buf|=te<<G.bi_valid&65535,ne(G,G.bi_buf),G.bi_buf=te>>k-G.bi_valid,G.bi_valid+=ge-k):(G.bi_buf|=te<<G.bi_valid&65535,G.bi_valid+=ge)}function fe(G,te,ge){ee(G,ge[2*te],ge[2*te+1])}function _e(G,te){for(var ge=0;ge|=1&G,G>>>=1,ge<<=1,0<--te;);return ge>>>1}function Ae(G,te,ge){var ue,re,he=new Array(E+1),xe=0;for(ue=1;ue<=E;ue++)he[ue]=xe=xe+ge[ue-1]<<1;for(re=0;re<=te;re++){var pe=G[2*re+1];pe!==0&&(G[2*re]=_e(he[pe]++,pe))}}function ye(G){var te;for(te=0;te<m;te++)G.dyn_ltree[2*te]=0;for(te=0;te<v;te++)G.dyn_dtree[2*te]=0;for(te=0;te<w;te++)G.bl_tree[2*te]=0;G.dyn_ltree[2*S]=1,G.opt_len=G.static_len=0,G.last_lit=G.matches=0}function Se(G){8<G.bi_valid?ne(G,G.bi_buf):0<G.bi_valid&&(G.pending_buf[G.pending++]=G.bi_buf),G.bi_buf=0,G.bi_valid=0}function Pe(G,te,ge,ue){var re=2*te,he=2*ge;return G[re]<G[he]||G[re]===G[he]&&ue[te]<=ue[ge]}function Fe(G,te,ge){for(var ue=G.heap[ge],re=ge<<1;re<=G.heap_len&&(re<G.heap_len&&Pe(te,G.heap[re+1],G.heap[re],G.depth)&&re++,!Pe(te,ue,G.heap[re],G.depth));)G.heap[ge]=G.heap[re],ge=re,re<<=1;G.heap[ge]=ue}function Me(G,te,ge){var ue,re,he,xe,pe=0;if(G.last_lit!==0)for(;ue=G.pending_buf[G.d_buf+2*pe]<<8|G.pending_buf[G.d_buf+2*pe+1],re=G.pending_buf[G.l_buf+pe],pe++,ue===0?fe(G,re,te):(fe(G,(he=B[re])+C+1,te),(xe=R[he])!==0&&ee(G,re-=V[he],xe),fe(G,he=W(--ue),ge),(xe=j[he])!==0&&ee(G,ue-=Q[he],xe)),pe<G.last_lit;);fe(G,S,te)}function De(G,te){var ge,ue,re,he=te.dyn_tree,xe=te.stat_desc.static_tree,pe=te.stat_desc.has_stree,be=te.stat_desc.elems,Ee=-1;for(G.heap_len=0,G.heap_max=b,ge=0;ge<be;ge++)he[2*ge]!==0?(G.heap[++G.heap_len]=Ee=ge,G.depth[ge]=0):he[2*ge+1]=0;for(;G.heap_len<2;)he[2*(re=G.heap[++G.heap_len]=Ee<2?++Ee:0)]=1,G.depth[re]=0,G.opt_len--,pe&&(G.static_len-=xe[2*re+1]);for(te.max_code=Ee,ge=G.heap_len>>1;1<=ge;ge--)Fe(G,he,ge);for(re=be;ge=G.heap[1],G.heap[1]=G.heap[G.heap_len--],Fe(G,he,1),ue=G.heap[1],G.heap[--G.heap_max]=ge,G.heap[--G.heap_max]=ue,he[2*re]=he[2*ge]+he[2*ue],G.depth[re]=(G.depth[ge]>=G.depth[ue]?G.depth[ge]:G.depth[ue])+1,he[2*ge+1]=he[2*ue+1]=re,G.heap[1]=re++,Fe(G,he,1),2<=G.heap_len;);G.heap[--G.heap_max]=G.heap[1],function(Ie,Le){var Ve,$e,Ze,qe,rt,st,Je=Le.dyn_tree,ct=Le.max_code,ut=Le.stat_desc.static_tree,pt=Le.stat_desc.has_stree,lt=Le.stat_desc.extra_bits,ht=Le.stat_desc.extra_base,et=Le.stat_desc.max_length,nt=0;for(qe=0;qe<=E;qe++)Ie.bl_count[qe]=0;for(Je[2*Ie.heap[Ie.heap_max]+1]=0,Ve=Ie.heap_max+1;Ve<b;Ve++)et<(qe=Je[2*Je[2*($e=Ie.heap[Ve])+1]+1]+1)&&(qe=et,nt++),Je[2*$e+1]=qe,ct<$e||(Ie.bl_count[qe]++,rt=0,ht<=$e&&(rt=lt[$e-ht]),st=Je[2*$e],Ie.opt_len+=st*(qe+rt),pt&&(Ie.static_len+=st*(ut[2*$e+1]+rt)));if(nt!==0){do{for(qe=et-1;Ie.bl_count[qe]===0;)qe--;Ie.bl_count[qe]--,Ie.bl_count[qe+1]+=2,Ie.bl_count[et]--,nt-=2}while(0<nt);for(qe=et;qe!==0;qe--)for($e=Ie.bl_count[qe];$e!==0;)ct<(Ze=Ie.heap[--Ve])||(Je[2*Ze+1]!==qe&&(Ie.opt_len+=(qe-Je[2*Ze+1])*Je[2*Ze],Je[2*Ze+1]=qe),$e--)}}(G,te),Ae(he,Ee,G.bl_count)}function O(G,te,ge){var ue,re,he=-1,xe=te[1],pe=0,be=7,Ee=4;for(xe===0&&(be=138,Ee=3),te[2*(ge+1)+1]=65535,ue=0;ue<=ge;ue++)re=xe,xe=te[2*(ue+1)+1],++pe<be&&re===xe||(pe<Ee?G.bl_tree[2*re]+=pe:re!==0?(re!==he&&G.bl_tree[2*re]++,G.bl_tree[2*A]++):pe<=10?G.bl_tree[2*P]++:G.bl_tree[2*I]++,he=re,Ee=(pe=0)===xe?(be=138,3):re===xe?(be=6,3):(be=7,4))}function le(G,te,ge){var ue,re,he=-1,xe=te[1],pe=0,be=7,Ee=4;for(xe===0&&(be=138,Ee=3),ue=0;ue<=ge;ue++)if(re=xe,xe=te[2*(ue+1)+1],!(++pe<be&&re===xe)){if(pe<Ee)for(;fe(G,re,G.bl_tree),--pe!=0;);else re!==0?(re!==he&&(fe(G,re,G.bl_tree),pe--),fe(G,A,G.bl_tree),ee(G,pe-3,2)):pe<=10?(fe(G,P,G.bl_tree),ee(G,pe-3,3)):(fe(G,I,G.bl_tree),ee(G,pe-11,7));he=re,Ee=(pe=0)===xe?(be=138,3):re===xe?(be=6,3):(be=7,4)}}y(Q);var ae=!1;function Y(G,te,ge,ue){ee(G,(g<<1)+(ue?1:0),3),function(re,he,xe,pe){Se(re),pe&&(ne(re,xe),ne(re,~xe)),h.arraySet(re.pending_buf,re.window,he,xe,re.pending),re.pending+=xe}(G,te,ge,!0)}l._tr_init=function(G){ae||(function(){var te,ge,ue,re,he,xe=new Array(E+1);for(re=ue=0;re<x-1;re++)for(V[re]=ue,te=0;te<1<<R[re];te++)B[ue++]=re;for(B[ue-1]=re,re=he=0;re<16;re++)for(Q[re]=he,te=0;te<1<<j[re];te++)N[he++]=re;for(he>>=7;re<v;re++)for(Q[re]=he<<7,te=0;te<1<<j[re]-7;te++)N[256+he++]=re;for(ge=0;ge<=E;ge++)xe[ge]=0;for(te=0;te<=143;)z[2*te+1]=8,te++,xe[8]++;for(;te<=255;)z[2*te+1]=9,te++,xe[9]++;for(;te<=279;)z[2*te+1]=7,te++,xe[7]++;for(;te<=287;)z[2*te+1]=8,te++,xe[8]++;for(Ae(z,m+1,xe),te=0;te<v;te++)L[2*te+1]=5,L[2*te]=_e(te,5);se=new ce(z,R,C+1,m,E),X=new ce(L,j,0,v,E),oe=new ce(new Array(0),q,0,w,_)}(),ae=!0),G.l_desc=new H(G.dyn_ltree,se),G.d_desc=new H(G.dyn_dtree,X),G.bl_desc=new H(G.bl_tree,oe),G.bi_buf=0,G.bi_valid=0,ye(G)},l._tr_stored_block=Y,l._tr_flush_block=function(G,te,ge,ue){var re,he,xe=0;0<G.level?(G.strm.data_type===2&&(G.strm.data_type=function(pe){var be,Ee=4093624447;for(be=0;be<=31;be++,Ee>>>=1)if(1&Ee&&pe.dyn_ltree[2*be]!==0)return d;if(pe.dyn_ltree[18]!==0||pe.dyn_ltree[20]!==0||pe.dyn_ltree[26]!==0)return p;for(be=32;be<C;be++)if(pe.dyn_ltree[2*be]!==0)return p;return d}(G)),De(G,G.l_desc),De(G,G.d_desc),xe=function(pe){var be;for(O(pe,pe.dyn_ltree,pe.l_desc.max_code),O(pe,pe.dyn_dtree,pe.d_desc.max_code),De(pe,pe.bl_desc),be=w-1;3<=be&&pe.bl_tree[2*U[be]+1]===0;be--);return pe.opt_len+=3*(be+1)+5+5+4,be}(G),re=G.opt_len+3+7>>>3,(he=G.static_len+3+7>>>3)<=re&&(re=he)):re=he=ge+5,ge+4<=re&&te!==-1?Y(G,te,ge,ue):G.strategy===4||he===re?(ee(G,2+(ue?1:0),3),Me(G,z,L)):(ee(G,4+(ue?1:0),3),function(pe,be,Ee,Ie){var Le;for(ee(pe,be-257,5),ee(pe,Ee-1,5),ee(pe,Ie-4,4),Le=0;Le<Ie;Le++)ee(pe,pe.bl_tree[2*U[Le]+1],3);le(pe,pe.dyn_ltree,be-1),le(pe,pe.dyn_dtree,Ee-1)}(G,G.l_desc.max_code+1,G.d_desc.max_code+1,xe+1),Me(G,G.dyn_ltree,G.dyn_dtree)),ye(G),ue&&Se(G)},l._tr_tally=function(G,te,ge){return G.pending_buf[G.d_buf+2*G.last_lit]=te>>>8&255,G.pending_buf[G.d_buf+2*G.last_lit+1]=255&te,G.pending_buf[G.l_buf+G.last_lit]=255&ge,G.last_lit++,te===0?G.dyn_ltree[2*ge]++:(G.matches++,te--,G.dyn_ltree[2*(B[ge]+C+1)]++,G.dyn_dtree[2*W(te)]++),G.last_lit===G.lit_bufsize-1},l._tr_align=function(G){ee(G,2,3),fe(G,S,z),function(te){te.bi_valid===16?(ne(te,te.bi_buf),te.bi_buf=0,te.bi_valid=0):8<=te.bi_valid&&(te.pending_buf[te.pending++]=255&te.bi_buf,te.bi_buf>>=8,te.bi_valid-=8)}(G)}},{"../utils/common":41}],53:[function(a,u,l){u.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(a,u,l){(function(h){(function(d,p){if(!d.setImmediate){var y,g,x,C,m=1,v={},w=!1,b=d.document,E=Object.getPrototypeOf&&Object.getPrototypeOf(d);E=E&&E.setTimeout?E:d,y={}.toString.call(d.process)==="[object process]"?function(A){process.nextTick(function(){_(A)})}:function(){if(d.postMessage&&!d.importScripts){var A=!0,P=d.onmessage;return d.onmessage=function(){A=!1},d.postMessage("","*"),d.onmessage=P,A}}()?(C="setImmediate$"+Math.random()+"$",d.addEventListener?d.addEventListener("message",S,!1):d.attachEvent("onmessage",S),function(A){d.postMessage(C+A,"*")}):d.MessageChannel?((x=new MessageChannel).port1.onmessage=function(A){_(A.data)},function(A){x.port2.postMessage(A)}):b&&"onreadystatechange"in b.createElement("script")?(g=b.documentElement,function(A){var P=b.createElement("script");P.onreadystatechange=function(){_(A),P.onreadystatechange=null,g.removeChild(P),P=null},g.appendChild(P)}):function(A){setTimeout(_,0,A)},E.setImmediate=function(A){typeof A!="function"&&(A=new Function(""+A));for(var P=new Array(arguments.length-1),I=0;I<P.length;I++)P[I]=arguments[I+1];var R={callback:A,args:P};return v[m]=R,y(m),m++},E.clearImmediate=k}function k(A){delete v[A]}function _(A){if(w)setTimeout(_,0,A);else{var P=v[A];if(P){w=!0;try{(function(I){var R=I.callback,j=I.args;switch(j.length){case 0:R();break;case 1:R(j[0]);break;case 2:R(j[0],j[1]);break;case 3:R(j[0],j[1],j[2]);break;default:R.apply(p,j)}})(P)}finally{k(A),w=!1}}}}function S(A){A.source===d&&typeof A.data=="string"&&A.data.indexOf(C)===0&&_(+A.data.slice(C.length))}})(typeof self>"u"?h===void 0?this:h:self)}).call(this,typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(jszip_min);var jszip_minExports=jszip_min.exports;const JSZip=getDefaultExportFromCjs(jszip_minExports);class BackupFileParser{createHash(s){const a=s.length,u=[];let l={hash:"",keyMap:[],length:a};for(let h=0;h<32;h++){let d=Math.round(a*Math.random());u.push(s.substr(d,1)),l.keyMap.push(d)}return l.hash=cryptoJsExports.MD5(u.join("")).toString(),l}createBackupFileBlob(s){return new Promise((a,u)=>{try{const l=new JSZip;s.options.system&&delete s.options.system;const h=s.options,d=h.encryptBackupData?h.encryptSecretKey:"";h.encryptSecretKey&&delete s.options.encryptSecretKey;const p=this.encryptData(s.options,d),y=this.encryptData(s.userData,d);l.file("options.json",p),l.file("userdatas.json",y);const g={checkInfo:this.createHash(p+y),version:PPF.getVersion(),time:new Date().getTime(),encryptMode:d?EEncryptMode.AES:""};l.file("manifest.json",JSON.stringify(g)),s.collection&&l.file("collection.json",this.encryptData(s.collection,d)),s.cookies&&l.file("cookies.json",this.encryptData(s.cookies,d)),s.searchResultSnapshot&&l.file("searchResultSnapshot.json",this.encryptData(s.searchResultSnapshot,d)),s.keepUploadTask&&l.file("keepUploadTask.json",this.encryptData(s.keepUploadTask,d)),s.downloadHistory&&l.file("downloadHistory.json",this.encryptData(s.downloadHistory,d)),l.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:9}}).then(x=>{a(x)})}catch(l){u(l)}})}loadZipData(s,a="请输入密钥：",u=""){return new Promise((l,h)=>{JSZip.loadAsync(s).then(d=>{let p=[];return p.push(d.file("manifest.json").async("text")),p.push(d.file("options.json").async("text")),p.push(d.file("userdatas.json").async("text")),d.file("collection.json")&&p.push(d.file("collection.json").async("text")),d.file("cookies.json")&&p.push(d.file("cookies.json").async("text")),d.file("searchResultSnapshot.json")&&p.push(d.file("searchResultSnapshot.json").async("text")),d.file("keepUploadTask.json")&&p.push(d.file("keepUploadTask.json").async("text")),d.file("downloadHistory.json")&&p.push(d.file("downloadHistory.json").async("text")),Promise.all(p)}).then(d=>{const p=JSON.parse(d[0]);if(console.log(p),p.encryptMode){if(u&&this.decryptData(d[1],u)===null&&(u=""),!u){let g=window.prompt(a);if(!g){h(ERestoreError.needSecretKey);return}if(u=g,this.decryptData(d[1],u)===null){h(ERestoreError.errorSecretKey);return}}}else u="";const y={manifest:p,options:this.decryptData(d[1],u),datas:this.decryptData(d[2],u)};d.length>3&&(y.collection=this.decryptData(d[3],u)),d.length>4&&PPF.checkOptionalPermission("cookies")&&(y.cookies=this.decryptData(d[4],u)),d.length>5&&(y.searchResultSnapshot=this.decryptData(d[5],u)),d.length>6&&(y.keepUploadTask=this.decryptData(d[6],u)),d.length>7&&(y.downloadHistory=this.decryptData(d[7],u)),this.checkData(y.manifest,d[1]+d[2])?l(y):h("error")}).catch(d=>{console.log(d),h(d)})})}checkData(s,a){if(!s||!s.checkInfo)return!1;const u=s.checkInfo;if(a.length!==u.length)return!1;const h=[];try{if(u.keyMap.length!==32)return!1;for(let d=0;d<32;d++){let p=u.keyMap[d];h.push(a.substr(p,1))}if(cryptoJsExports.MD5(h.join("")).toString()===u.hash)return!0}catch{}return!1}encryptData(s,a=""){return a?this.encrypt(JSON.stringify(s),a):JSON.stringify(s)}decryptData(s,a=""){if(!a)return JSON.parse(s);try{return JSON.parse(this.decrypt(s,a))}catch{return null}}encrypt(s,a=""){return cryptoJsExports.AES.encrypt(s,a).toString()}decrypt(s,a=""){return cryptoJsExports.AES.decrypt(s,a).toString(cryptoJsExports.enc.Utf8)}}class Config{constructor(s){this.service=s,this.name=EConfigKey.default,this.localStorage=new localStorage,this.syncStorage=new SyncStorage,this.favicon=new Favicon(this.service),this.schemas=[],this.sites=[],this.clients=[],this.publicSites=[],this.requestCount=0,this.backupFileParser=new BackupFileParser,this.options={exceedSizeUnit:ESizeUnit.GiB,sites:[],clients:[],backupServers:[],system:{},allowDropToSend:!0,allowSelectionTextSearch:!0,needConfirmWhenExceedSize:!0,exceedSize:10,search:{rows:50,timeout:3e4,saveKey:!0},connectClientTimeout:3e4,rowsPerPageItems:[10,20,50,100,200,{text:"$vuetify.dataIterator.rowsPerPageAll",value:-1}],searchSolutions:[],navBarIsOpen:!0,showMovieInfoCardOnSearch:!0,beforeSearchingOptions:{getMovieInformation:!0,maxMovieInformationCount:5,searchModeForItem:EBeforeSearchingItemSearchMode.id},showToolbarOnContentPage:!0,downloadFailedRetry:!1,downloadFailedFailedRetryCount:3,downloadFailedFailedRetryInterval:5,batchDownloadInterval:0,enableBackgroundDownload:!1,position:EPluginPosition.right,encryptBackupData:!1,allowSaveSnapshot:!0},this.uiOptions={},this.reload()}reload(){APP.cache.clear(),this.getSystemConfig()}save(s){s&&(this.options=s),this.localStorage.set(this.name,this.cleaningOptions(this.options))}getFavicons(){return new Promise((s,a)=>{let u=[];this.sites.forEach(l=>{u.push(l.activeURL||l.url||"")}),this.options.sites&&this.options.sites.forEach(l=>{u.push(l.activeURL||l.url||"")}),u=[...new Set(u)],this.favicon.gets(u).then(l=>{l.forEach(h=>{let d=this.options.sites.find(p=>{var g;let y=[p.url].concat(p.cdn);return y=y.concat((g=p.formerHosts)==null?void 0:g.map(x=>`//${x}`)).filter(x=>!!x),p.host==h.host||y.join("").indexOf(`//${h.host}`)>-1});d&&(d.icon=h.data)}),this.save(),this.service.options=this.options,s(this.options)}).catch(l=>{this.service.debug(l),a(l)})})}getFavicon(s,a=!1){return new Promise((u,l)=>{this.favicon.get(s,a).then(h=>{let d=this.options.sites.find(p=>{var g;let y=[p.url].concat(p.cdn,(g=p.formerHosts)==null?void 0:g.map(x=>`//${x}`));return p.host==h.host||y.join("").indexOf(`//${h.host}`)>-1});d&&(d.icon=h.data,this.save(),this.service.options=this.options),u(h)}).catch(h=>{this.service.debug(h),l(h)})})}cleaningOptions(s){let a=JSON.parse(JSON.stringify(s));return a.sites&&a.sites.forEach(u=>{this.sites.find(h=>h.host==u.host)&&(["categories","selectors","patterns","torrentTagSelectors","icon","activeURL","searchEntryConfig","schema","supportedFeatures","mergeSchemaTagSelectors"].forEach(h=>{let d=u;d[h]&&delete d[h]}),u.searchEntry&&u.searchEntry.forEach((h,d)=>{h.isCustom||(u.searchEntry[d]={name:h.name,enabled:h.enabled})})),PPF.isExtensionMode&&u.icon&&u.icon.substr(0,10)==="data:image"&&delete u.icon}),a.clients&&a.clients.forEach(u=>{["pathDescription","description","warning","scripts","ver","icon"].forEach(l=>{u[l]&&delete u[l]})}),a}read(){return new Promise((s,a)=>{this.localStorage.get(EConfigKey.uiOptions,u=>{if(u){let l=Object.assign({},this.uiOptions);this.uiOptions=Object.assign(l,u)}}),this.loadConfig(s)})}loadConfig(s){if(this.requestCount>0){setTimeout(()=>{this.loadConfig(s)},100);return}this.localStorage.get(this.name,a=>{this.resetRunTimeOptions(a),s&&s(this.options)})}resetRunTimeOptions(s){if(s){s.system&&delete s.system;let a=Object.assign({},this.options);this.options=Object.assign(a,s)}this.options.locale||(this.options.locale=navigator.language||"zh-CN"),this.options.system={schemas:this.schemas,sites:this.sites,clients:this.clients,publicSites:this.publicSites},this.upgradeSites(),this.options.sites&&this.options.sites.length&&this.sites.forEach(a=>{let u=this.options.sites.findIndex(l=>l.host===a.host);if(u>-1){let l=Object.assign(Object.assign({},a),this.options.sites[u]);a.categories&&(l.categories=a.categories),a.schema&&(l.schema=a.schema),!a.torrentTagSelectors&&l.torrentTagSelectors?delete l.torrentTagSelectors:l.torrentTagSelectors=a.torrentTagSelectors,!a.patterns&&l.patterns?delete l.patterns:l.patterns=a.patterns,!a.levelRequirements&&l.levelRequirements?delete l.levelRequirements:l.levelRequirements=a.levelRequirements,l.searchEntry&&a.searchEntry?a.searchEntry.forEach(h=>{if(l.searchEntry){let d=l.searchEntry&&l.searchEntry.findIndex(p=>p.name==h.name&&!p.isCustom);d!=null&&d>-1?l.searchEntry[d]=Object.assign(Object.assign({},h),{enabled:l.searchEntry[d].enabled}):l.searchEntry.push(Object.assign({},h))}}):a.searchEntry&&(l.searchEntry=a.searchEntry),!a.icon&&!l.icon&&(l.icon=l.url+"/favicon.ico"),this.options.sites[u]=l}}),this.options.sites.forEach(a=>{a.cdn&&a.cdn.length>0?(a.activeURL=a.cdn[0],a.cdn=this.arrayUnique(a.cdn)):a.activeURL=a.url,a.priority==null&&(a.priority=100)}),this.options.clients&&this.options.clients.length&&this.options.clients.forEach((a,u)=>{let l=this.clients.find(h=>h.type===a.type);l&&(this.options.clients[u]=Object.assign(Object.assign({},l),this.options.clients[u]))}),PPF.isExtensionMode&&this.getFavicons(),console.log(this.options)}arrayUnique(s){let a=[],u={};return s.forEach(l=>{u[l]||(a.push(l),u[l]=1)}),a}upgradeSites(){this.sites.forEach(s=>{if(!s.host)return;let a=s.formerHosts,u=s.host;a&&a.length>0&&a.forEach(l=>{let h=this.options.sites.find(d=>d.host===l);h&&(console.log("upgradeSites.site",h,u),h.host=u,h.url=s.url,!s.icon&&!h.icon?h.icon=h.url+"/favicon.ico":h.icon=s.icon),this.options.searchSolutions&&this.options.searchSolutions.forEach(d=>{d.range.forEach(p=>{p.host==l&&(console.log("upgradeSites.searchSolutions",p.host,u),p.host=u)})}),this.options.clients&&this.options.clients.length>0&&this.options.clients.forEach(d=>{let p=d.paths;if(p){for(const y in p)if(y==l&&p.hasOwnProperty(y)){console.log("upgradeSites.client.paths",d.name,y,u);const g=p[y];p[u]=Object.assign([],g),delete p[y]}}})})})}readUIOptions(){return new Promise((s,a)=>{this.localStorage.get(EConfigKey.uiOptions,u=>{if(u){let l=Object.assign({},this.uiOptions);this.uiOptions=Object.assign(l,u)}s(this.uiOptions)})})}saveUIOptions(s){return new Promise((a,u)=>{this.localStorage.set(EConfigKey.uiOptions,s||this.uiOptions),a()})}getSystemConfig(){this.schemas=[],this.sites=[],this.clients=[],this.publicSites=[],this.getContentFromApi(`${API.systemConfig}`).then(s=>{s&&(this.schemas=s.schemas,this.sites=s.sites,this.clients=s.clients,this.publicSites=s.publicSites)})}getSchemas(){this.schemas=[],this.getContentFromApi(`${API.schemas}`).then(s=>{s.length&&s.forEach(a=>{a.type==="dir"&&this.addSchema(API.schemaConfig.replace(/\{\$schema\}/g,a.name))})})}addSchema(s){this.getContentFromApi(s).then(a=>{a&&a.name&&this.schemas.push(a)})}getSites(){this.sites=[],this.getContentFromApi(API.sites).then(s=>{s.length&&s.forEach(a=>{a.type==="dir"&&this.addSite(API.siteConfig.replace(/\{\$site\}/g,a.name))})})}addSite(s){this.getContentFromApi(s).then(a=>{a&&a.name&&this.sites.push(a)})}getClients(){this.clients=[],this.getContentFromApi(API.clients).then(s=>{s.length&&s.forEach(a=>{a.type==="dir"&&this.addClient(API.clientConfig.replace(/\{\$client\}/g,a.name))})})}addClient(s){this.getContentFromApi(s).then(a=>{a&&a.name&&this.clients.push(a)})}getContentFromApi(s){return PPF.updateBadge(++this.requestCount),new Promise((a,u)=>{let l=APP.cache.get(s);if(l){a(l),PPF.updateBadge(--this.requestCount);return}$.getJSON(s).done(h=>{APP.cache.set(s,h),PPF.updateBadge(--this.requestCount),a(h)}).fail(h=>{PPF.updateBadge(--this.requestCount),u&&u(h)})})}backupToGoogle(){return new Promise((s,a)=>{if(chrome.storage&&chrome.storage.sync){let u=this.cleaningOptions(this.options);u.system&&delete u.system;let l=Object.assign([],u.clients),h=Object.assign([],u.sites);delete u.clients,delete u.sites,this.syncStorage.set(this.name,u).then(()=>{this.syncStorage.set(this.name+".clients",l).then(()=>{this.syncStorage.set(this.name+".sites",h).then(()=>{s(this.options)}).catch(d=>{a(APP.createErrorMessage(d))})}).catch(d=>{a(APP.createErrorMessage(d))})}).catch(d=>{a(APP.createErrorMessage(d))})}else a(APP.createErrorMessage("chrome.storage 不存在"))})}restoreFromGoogle(){return new Promise((s,a)=>{chrome.storage&&chrome.storage.sync?this.syncStorage.get(this.name).then(u=>{let l=Object.assign({},this.options.system),h=u;h.system=l,this.syncStorage.get(this.name+".clients").then(d=>{h.clients=d,this.syncStorage.get(this.name+".sites").then(p=>{h.sites=p,this.resetRunTimeOptions(h),this.save(),setTimeout(()=>{s(this.options)},300)}).catch(p=>{a(APP.createErrorMessage(p))})}).catch(d=>{a(APP.createErrorMessage(d))})}).catch(u=>{a(APP.createErrorMessage(u))}):a(APP.createErrorMessage("chrome.storage 不存在"))})}getBackupRawData(){return new Promise((s,a)=>{try{const u=this.service.userData.get("",EUserDataRange.all),l=this.cleaningOptions(this.service.options);delete l.system;let h={options:l,userData:u,collection:{items:this.service.collection.items,groups:this.service.collection.groups},cookies:void 0,searchResultSnapshot:this.service.searchResultSnapshot.items,keepUploadTask:this.service.keepUploadTask.items,downloadHistory:void 0};const d=[];d.push(this.service.controller.downloadHistory.load()),this.service.options.allowBackupCookies&&PPF.checkOptionalPermission("cookies")&&d.push(this.getAllSiteCookies()),Promise.all(d).then(p=>{h.downloadHistory=p[0],p.length>1&&(h.cookies=p[1]),s(h)}).catch(()=>{s(h)})}catch(u){a(u)}})}createBackupFile(s){return new Promise((a,u)=>{this.getBackupFileBlob().then(l=>{FileSaver.saveAs(l,s||this.getNewBackupFileName()),a(!0)}).catch(l=>{u(l)})})}getBackupFileBlob(){return new Promise((s,a)=>{try{this.getBackupRawData().then(u=>{this.backupFileParser.createBackupFileBlob(u).then(l=>{s(l)})}).catch(u=>{a(u)})}catch(u){a(u)}})}getAllSiteCookies(){return new Promise((s,a)=>{PPF.checkPermissions(["cookies"]).then(()=>{const u=this.options.sites;if(u&&u.length>0){const l=[];u.forEach(h=>{l.push(this.getCookiesFromSite(h))}),Promise.all(l).then(h=>{s(h)}).catch(h=>{a(h)})}}).catch(u=>{a(u)})})}getCookiesFromSite(s){return new Promise((a,u)=>{const l=s.activeURL||s.url;chrome.cookies.getAll({url:l},h=>{if(chrome.runtime.lastError){u(chrome.runtime.lastError.message);return}a({host:s.host,url:l,cookies:h}),console.log(h)})})}restoreCookies(s){return new Promise((a,u)=>{let l=[];const h=["name","value","domain","path","secure","httpOnly","expirationDate"];s.forEach(d=>{d.cookies.forEach(p=>{let y=PPF.clone(p);for(const g in y)y.hasOwnProperty(g)&&!h.includes(g)&&delete y[g];y.url=d.url,l.push(this.setCookies(y,d.host))})}),Promise.all(l).then(()=>{a()}).catch(()=>{a()})})}setCookies(s,a){return new Promise((u,l)=>{let h=PPF.getSiteFromHost(a,this.service.options);chrome.cookies.get({url:(h.activeURL||h.url)+"",name:s.name+""},d=>{let p=!1;const y=new Date().getTime()/1e3;(d===null||d.expirationDate&&d.expirationDate<y)&&(p=!0),p?(s.expirationDate&&s.expirationDate<y&&(s.expirationDate=y+60*60*24),chrome.cookies.set(s,g=>{if(chrome.runtime.lastError){l(chrome.runtime.lastError.message);return}u(g),console.log(g)})):(console.log("跳过 %s: %s",a,s.name),u())})})}getNewBackupFileName(){return PPF.getNewBackupFileName()}backupToServer(s){return console.log("backupToServer",s,this.options.backupServers),new Promise((a,u)=>{const l=dayjs().valueOf(),h=this.getNewBackupFileName();let d=null;this.getBackupFileBlob().then(p=>{const y=new FormData;switch(y.append("name",h),y.append("data",p),s.type){case EBackupServerType.OWSS:d=new OWSS(s);break;case EBackupServerType.WebDAV:d=new WebDAV(s);break;default:u("暂不支持");break}d&&d.add(y).then(g=>{a({time:l,fileName:h})}).catch(g=>{u(g)})}).catch(p=>{u(p)})})}restoreFromServer(s,a){return new Promise((u,l)=>{let h=null;switch(s.type){case EBackupServerType.OWSS:h=new OWSS(s);break;case EBackupServerType.WebDAV:h=new WebDAV(s);break;default:l("暂不支持");break}h&&h.get(a).then(d=>{this.backupFileParser.loadZipData(d,this.service.i18n.t("settings.backup.enterSecretKey"),this.service.options.encryptSecretKey).then(p=>{u(p)}).catch(p=>{l(p)})}).catch(d=>{l(d)})})}getBackupListFromServer(s,a={}){return new Promise((u,l)=>{let h=null;switch(s.type){case EBackupServerType.OWSS:h=new OWSS(s);break;case EBackupServerType.WebDAV:h=new WebDAV(s);break;default:l("暂不支持");break}h&&h.list(a).then(d=>{u(d)}).catch(d=>{l(d)})})}deleteFileFromBackupServer(s,a){return new Promise((u,l)=>{let h=null;switch(s.type){case EBackupServerType.OWSS:h=new OWSS(s);break;case EBackupServerType.WebDAV:h=new WebDAV(s);break;default:l("暂不支持");break}h&&h.delete(a).then(d=>{u(d)}).catch(d=>{l(d)})})}testBackupServerConnectivity(s){return new Promise((a,u)=>{let l=null;switch(s.type){case EBackupServerType.OWSS:l=new OWSS(s);break;case EBackupServerType.WebDAV:l=new WebDAV(s);break;default:u("暂不支持");break}l&&l.ping().then(h=>{a(h)}).catch(h=>{u(h)})})}}class ClientController{constructor(){this.options={sites:[],clients:[]},this.clients={}}init(f){this.options=f,this.cleanUpClients()}cleanUpClients(){this.clients={}}getClient(clientOptions){return new Promise((resolve,reject)=>{if(typeof clientOptions=="string"){let f=clientOptions;clientOptions=this.options.clients.find(a=>a.id===f);let s=this.clients[f];if(s){resolve({client:s,options:clientOptions});return}}if(window[clientOptions.type]===void 0)APP.execScript({type:"file",content:`clients/${clientOptions.type}/init.js`}).then(()=>{let client;eval(`client = new ${clientOptions.type}()`),client.init({loginName:clientOptions.loginName,loginPwd:clientOptions.loginPwd,address:clientOptions.address,name:clientOptions.name}),this.clients[clientOptions.id]=client,resolve({client,options:clientOptions})}).catch(f=>{console.log(f),reject({initFailed:!0,msg:f})});else{let client;eval(`client = new ${clientOptions.type}()`),client.init({loginName:clientOptions.loginName,loginPwd:clientOptions.loginPwd,address:clientOptions.address,name:clientOptions.name}),this.clients[clientOptions.id]=client,resolve({client,options:clientOptions})}})}testClientConnectivity(f){return new Promise((s,a)=>{let u={type:EDataResultType.unknown,success:!1};this.getClient(f).then(l=>{l.client.call(EAction.testClientConnectivity,f).then(h=>{u.success=h,h&&(u.type=EDataResultType.success),s(u)}).catch(h=>{u.data=h,u.type=EDataResultType.error,a(u)})}).catch(l=>{u.data=l,u.type=EDataResultType.error,a(u)})})}}class DownloadHistory{constructor(){this.items=[],this.storage=new localStorage,this.load()}load(){return new Promise((s,a)=>{this.storage.get(EConfigKey.downloadHistory,u=>{this.items=u||[],s(this.items)})})}add(s,a="",u="",l=!0){let h={data:s,clientId:u,host:a,success:l,time:new Date().getTime()};this.items?this.items.findIndex(p=>p.data.url===s.url)===-1&&(this.items.push(h),this.updateData()):this.load().then(()=>{this.items.push(h),this.updateData()})}remove(s){return new Promise((a,u)=>{this.load().then(()=>{for(let l=this.items.length-1;l>=0;l--){let h=this.items[l];s.findIndex(p=>p.data.url===h.data.url)>=0&&this.items.splice(l,1)}this.updateData(),a(this.items)})})}clear(){return new Promise((s,a)=>{this.items=[],this.updateData(),s(this.items)})}reset(s){return new Promise((a,u)=>{if(!s){u(!1);return}if(!Array.isArray(s)){u(!1);return}this.items=s,this.updateData(),a(this.items)})}updateData(){this.storage.set(EConfigKey.downloadHistory,this.items)}}var hasOwn=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,defineProperty=Object.defineProperty,gOPD=Object.getOwnPropertyDescriptor,isArray=function f(s){return typeof Array.isArray=="function"?Array.isArray(s):toStr.call(s)==="[object Array]"},isPlainObject=function f(s){if(!s||toStr.call(s)!=="[object Object]")return!1;var a=hasOwn.call(s,"constructor"),u=s.constructor&&s.constructor.prototype&&hasOwn.call(s.constructor.prototype,"isPrototypeOf");if(s.constructor&&!a&&!u)return!1;var l;for(l in s);return typeof l>"u"||hasOwn.call(s,l)},setProperty=function f(s,a){defineProperty&&a.name==="__proto__"?defineProperty(s,a.name,{enumerable:!0,configurable:!0,value:a.newValue,writable:!0}):s[a.name]=a.newValue},getProperty=function f(s,a){if(a==="__proto__")if(hasOwn.call(s,a)){if(gOPD)return gOPD(s,a).value}else return;return s[a]},extend=function f(){var s,a,u,l,h,d,p=arguments[0],y=1,g=arguments.length,x=!1;for(typeof p=="boolean"&&(x=p,p=arguments[1]||{},y=2),(p==null||typeof p!="object"&&typeof p!="function")&&(p={});y<g;++y)if(s=arguments[y],s!=null)for(a in s)u=getProperty(p,a),l=getProperty(s,a),p!==l&&(x&&l&&(isPlainObject(l)||(h=isArray(l)))?(h?(h=!1,d=u&&isArray(u)?u:[]):d=u&&isPlainObject(u)?u:{},setProperty(p,{name:a,newValue:f(x,d,l)})):typeof l<"u"&&setProperty(p,{name:a,newValue:l}));return p};const extend$1=getDefaultExportFromCjs(extend);class SiteService{constructor(s,a){this.options=s,this.systemOptions=a,this.isLogin=!1,this._schema={},this.mergeOptions()}get schema(){if(this._schema.name)return this._schema;let s={};return typeof this.options.schema=="string"&&(s=this.systemOptions.system&&this.systemOptions.system.schemas&&this.systemOptions.system.schemas.find(a=>a.name==this.options.schema)),this._schema=s,s}mergeOptions(){let s=this.systemOptions.system&&this.systemOptions.system.sites&&this.systemOptions.system.sites.find(a=>a.host==this.options.host);if(s){let a=[];if(this.options.searchEntry)for(let u=this.options.searchEntry.length-1;u>=0;u--){const l=this.options.searchEntry[u];l.isCustom&&(a.push(l),this.options.searchEntry.splice(u,1))}this.options=extend$1(!0,{},s,this.options),this.options.searchEntry&&a.length>0&&this.options.searchEntry.push(...a)}console.log(this.options)}}var customParseFormat$1={exports:{}};(function(f,s){(function(a,u){f.exports=u()})(commonjsGlobal,function(){var a={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},u=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,l=/\d\d/,h=/\d\d?/,d=/\d*[^-_:/,()\s\d]+/,p={},y=function(b){return(b=+b)+(b>68?1900:2e3)},g=function(b){return function(E){this[b]=+E}},x=[/[+-]\d\d:?(\d\d)?|Z/,function(b){(this.zone||(this.zone={})).offset=function(E){if(!E||E==="Z")return 0;var k=E.match(/([+-]|\d\d)/g),_=60*k[1]+(+k[2]||0);return _===0?0:k[0]==="+"?-_:_}(b)}],C=function(b){var E=p[b];return E&&(E.indexOf?E:E.s.concat(E.f))},m=function(b,E){var k,_=p.meridiem;if(_){for(var S=1;S<=24;S+=1)if(b.indexOf(_(S,0,E))>-1){k=S>12;break}}else k=b===(E?"pm":"PM");return k},v={A:[d,function(b){this.afternoon=m(b,!1)}],a:[d,function(b){this.afternoon=m(b,!0)}],S:[/\d/,function(b){this.milliseconds=100*+b}],SS:[l,function(b){this.milliseconds=10*+b}],SSS:[/\d{3}/,function(b){this.milliseconds=+b}],s:[h,g("seconds")],ss:[h,g("seconds")],m:[h,g("minutes")],mm:[h,g("minutes")],H:[h,g("hours")],h:[h,g("hours")],HH:[h,g("hours")],hh:[h,g("hours")],D:[h,g("day")],DD:[l,g("day")],Do:[d,function(b){var E=p.ordinal,k=b.match(/\d+/);if(this.day=k[0],E)for(var _=1;_<=31;_+=1)E(_).replace(/\[|\]/g,"")===b&&(this.day=_)}],M:[h,g("month")],MM:[l,g("month")],MMM:[d,function(b){var E=C("months"),k=(C("monthsShort")||E.map(function(_){return _.slice(0,3)})).indexOf(b)+1;if(k<1)throw new Error;this.month=k%12||k}],MMMM:[d,function(b){var E=C("months").indexOf(b)+1;if(E<1)throw new Error;this.month=E%12||E}],Y:[/[+-]?\d+/,g("year")],YY:[l,function(b){this.year=y(b)}],YYYY:[/\d{4}/,g("year")],Z:x,ZZ:x};function w(b){var E,k;E=b,k=p&&p.formats;for(var _=(b=E.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(q,U,z){var L=z&&z.toUpperCase();return U||k[z]||a[z]||k[L].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(N,B,V){return B||V.slice(1)})})).match(u),S=_.length,A=0;A<S;A+=1){var P=_[A],I=v[P],R=I&&I[0],j=I&&I[1];_[A]=j?{regex:R,parser:j}:P.replace(/^\[|\]$/g,"")}return function(q){for(var U={},z=0,L=0;z<S;z+=1){var N=_[z];if(typeof N=="string")L+=N.length;else{var B=N.regex,V=N.parser,se=q.slice(L),X=B.exec(se)[0];V.call(U,X),q=q.replace(X,"")}}return function(oe){var Q=oe.afternoon;if(Q!==void 0){var ce=oe.hours;Q?ce<12&&(oe.hours+=12):ce===12&&(oe.hours=0),delete oe.afternoon}}(U),U}}return function(b,E,k){k.p.customParseFormat=!0,b&&b.parseTwoDigitYear&&(y=b.parseTwoDigitYear);var _=E.prototype,S=_.parse;_.parse=function(A){var P=A.date,I=A.utc,R=A.args;this.$u=I;var j=R[1];if(typeof j=="string"){var q=R[2]===!0,U=R[3]===!0,z=q||U,L=R[2];U&&(L=R[2]),p=this.$locale(),!q&&L&&(p=k.Ls[L]),this.$d=function(se,X,oe){try{if(["x","X"].indexOf(X)>-1)return new Date((X==="X"?1e3:1)*se);var Q=w(X)(se),ce=Q.year,H=Q.month,W=Q.day,ne=Q.hours,ee=Q.minutes,fe=Q.seconds,_e=Q.milliseconds,Ae=Q.zone,ye=new Date,Se=W||(ce||H?1:ye.getDate()),Pe=ce||ye.getFullYear(),Fe=0;ce&&!H||(Fe=H>0?H-1:ye.getMonth());var Me=ne||0,De=ee||0,O=fe||0,le=_e||0;return Ae?new Date(Date.UTC(Pe,Fe,Se,Me,De,O,le+60*Ae.offset*1e3)):oe?new Date(Date.UTC(Pe,Fe,Se,Me,De,O,le)):new Date(Pe,Fe,Se,Me,De,O,le)}catch{return new Date("")}}(P,j,I),this.init(),L&&L!==!0&&(this.$L=this.locale(L).$L),z&&P!=this.format(j)&&(this.$d=new Date("")),p={}}else if(j instanceof Array)for(var N=j.length,B=1;B<=N;B+=1){R[1]=j[B-1];var V=k.apply(this,R);if(V.isValid()){this.$d=V.$d,this.$L=V.$L,this.init();break}B===N&&(this.$d=new Date(""))}else S.call(this,A)}}})})(customParseFormat$1);var customParseFormatExports=customParseFormat$1.exports;const customParseFormat=getDefaultExportFromCjs(customParseFormatExports);var advancedFormat$1={exports:{}};(function(f,s){(function(a,u){f.exports=u()})(commonjsGlobal,function(){return function(a,u){var l=u.prototype,h=l.format;l.format=function(d){var p=this,y=this.$locale();if(!this.isValid())return h.bind(this)(d);var g=this.$utils(),x=(d||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,function(C){switch(C){case"Q":return Math.ceil((p.$M+1)/3);case"Do":return y.ordinal(p.$D);case"gggg":return p.weekYear();case"GGGG":return p.isoWeekYear();case"wo":return y.ordinal(p.week(),"W");case"w":case"ww":return g.s(p.week(),C==="w"?1:2,"0");case"W":case"WW":return g.s(p.isoWeek(),C==="W"?1:2,"0");case"k":case"kk":return g.s(String(p.$H===0?24:p.$H),C==="k"?1:2,"0");case"X":return Math.floor(p.$d.getTime()/1e3);case"x":return p.$d.getTime();case"z":return"["+p.offsetName()+"]";case"zzz":return"["+p.offsetName("long")+"]";default:return C}});return h.bind(this)(x)}}})})(advancedFormat$1);var advancedFormatExports=advancedFormat$1.exports;const advancedFormat=getDefaultExportFromCjs(advancedFormatExports);dayjs.extend(customParseFormat),dayjs.extend(advancedFormat);class InfoParser{constructor(f){this.service=f}getResult(f,s){let a={};if(f){for(const u in s.fields)if(s.fields.hasOwnProperty(u)){let l=s.fields[u],h=this.getFieldData(f,l,s);h!=null&&(a[u]=h)}}return a}debug(...f){this.service?this.service.debug(...f):PPF.debug(...f)}getFieldData(content,config,rule){let query,selectorIndex=0,selectors=[];if(typeof config.selector=="string")selectors.push(config.selector);else if(config.selector&&config.selector.length)selectors=config.selector;else return config.value===void 0?null:config.value;let lastSelector="";selectors.some(selector=>{lastSelector=selector;try{switch(rule.dataType){case ERequestResultType.JSON:if(selector==""?query=content:selector.substr(0,1)=="["?query=eval("content"+selector):query=eval("content."+selector),query!=null)return!0;break;case ERequestResultType.TEXT:case ERequestResultType.HTML:default:if(selector==""?query=content:(query=content.find(selector),query.length==0&&(query=content.filter(selector))),query.length>0)return!0;break}selectorIndex++}catch(f){return this.debug("InfoParser.getFieldData.Error",selector,f.message,f.stack),!0}}),console.log(`selector result for ${lastSelector} :`),console.log(query);let result=null;if(query!=null)if(config.attribute||config.filters||config.switchFilters){config.attribute&&rule.dataType!=ERequestResultType.JSON&&(query=query.attr(config.attribute));let filters;config.switchFilters?filters=config.switchFilters[selectorIndex]||null:filters=config.filters,filters&&filters.every(filter=>{try{query=eval(filter)}catch(f){return this.debug("InfoParser.filter.Error",filter,f.message,f.stack),query=null,!1}return!0}),result=query,Array.isArray(filters)&&console.log(`filter result for ${filters.join(" => ")}: ${result}`)}else switch(rule.dataType){case ERequestResultType.JSON:result=query;break;default:result=query.text().trim();break}return result}getTotalSize(f){let s=0;return f.forEach(a=>{let u=a.match(/^(\d*\.?\d+)(.*[^ZEPTGMK])?([ZEPTGMK](B|iB)?)$/i);if(!u)return;let l=parseFloat(u[1]),h=u[3].toLowerCase();switch(!0){case/ki?b/.test(h):s+=l*Math.pow(2,10);break;case/mi?b/.test(h):s+=l*Math.pow(2,20);break;case/gi?b/.test(h):s+=l*Math.pow(2,30);break;case/ti?b?/.test(h):s+=l*Math.pow(2,40);break;case/pi?b?/.test(h):s+=l*Math.pow(2,50);break;case/ei?b?/.test(h):s+=l*Math.pow(2,60);break;case/zi?b?/.test(h):s+=l*Math.pow(2,70);break}}),s}formatIMDbId(f){return Number(f)&&(f.length<7&&(f=f.padStart(7,"0")),f="tt"+f),f}}class PageParser{constructor(f,s,a=3e4,u){this.options=f,this.site=s,this.timeout=a,this.commonDatas=u,this.infoParserCache={},this.cacheKey="",this.url="";let l=s.url+"";s.cdn&&s.cdn.length>0&&(l=s.cdn[0]),(l+"").substr(-1)!="/"&&(l+="/");let h=this.options.page;if((h+"").substr(0,1)=="/"&&(h=(h+"").substr(1)),this.url=(l+h).replace("://","****").replace(/\/\//g,"/").replace("****","://"),this.requestData=this.options.requestData,this.requestData&&this.commonDatas)try{for(const d in this.requestData)if(this.requestData.hasOwnProperty(d)){const p=this.requestData[d];for(const y in this.commonDatas)this.commonDatas.hasOwnProperty(y)&&(this.requestData[d]=PPF.replaceKeys(p,this.commonDatas[y],y))}}catch(d){console.log(d)}this.cacheKey=cryptoJsExports.MD5(this.url+JSON.stringify(this.requestData||{})).toString()}getCache(){let f=window.localStorage.getItem(this.cacheKey);if(f){let s=JSON.parse(f);if(s.data&&s.time){let a=new Date().getTime();return s.time<a?(window.localStorage.removeItem(this.cacheKey),null):s.data}}return null}setCache(){if(this.options.dataCacheTime&&this.options.dataCacheTime>0){let f={data:this.resultData,time:new Date().getTime()+this.options.dataCacheTime*1e3};window.localStorage.setItem(this.cacheKey,JSON.stringify(f))}}getInfos(){return new Promise((f,s)=>{let a=this.getCache();if(a){f(a);return}this.options.parser&&this.site&&this.runParser(f,s)||$.ajax({url:this.url,method:this.options.requestMethod||ERequestMethod.GET,dataType:"text",headers:this.options.headers,data:this.requestData,timeout:this.timeout}).done(u=>{let l;try{if(this.options.dataType!==ERequestResultType.JSON){let h=new DOMParser().parseFromString(u,"text/html"),d=this.options.topElement||"body";l=$(h).find(d)}else l=JSON.parse(u)}catch(h){s(h);return}if(l&&this.options)try{let h=new InfoParser().getResult(l,this.options);this.resultData=h,this.setCache(),f(h)}catch(h){s(h)}}).fail(u=>{s(u)})})}runParser(resolve,reject){if(!this.site||!this.options.parser)return!1;let siteConfigPath=this.site.schema=="publicSite"?"publicSites":"sites";this.site.path?siteConfigPath+=`/${this.site.path}`:siteConfigPath+=`/${this.site.host}`;let path=this.options.parser;path.substr(0,1)!=="/"&&path.substr(0,4)!=="http"&&(path=`${siteConfigPath}/${path}`),this.site,this.options,this.commonDatas;let script=this.infoParserCache[path];return script?eval(script):APP.getScriptContent(path).done(script=>{this.infoParserCache[path]=script,eval(script)}),!0}}var ESearchResultParseStatus=(f=>(f.success="success",f.needLogin="needLogin",f.noTorrents="noTorrents",f.torrentTableIsEmpty="torrentTableIsEmpty",f.parseError="parseError",f))(ESearchResultParseStatus||{});Object.assign(window,{ESearchResultParseStatus});class Searcher{constructor(f){this.service=f,this.searchConfigs={},this.parseScriptCache={},this.options={sites:[],clients:[]},this.searchRequestQueue={}}searchTorrent(site,key="",payload){return this.service.debug("searchTorrent: start",key,payload),new Promise((resolve,reject)=>{let result={success:!1},siteService=new SiteService(PPF.clone(site),PPF.clone(this.options)),searchConfig={},schema=this.getSiteSchema(site),host=site.host,siteSearchPage="",searchEntryConfig=extend$1(!0,{torrentTagSelectors:[]},schema&&schema.searchEntryConfig?schema.searchEntryConfig:{},siteService.options.searchEntryConfig),searchEntryConfigQueryString="",searchEntryConfigRequestData;if(siteService.options.searchEntry?(searchConfig.rootPath=`sites/${host}/`,searchConfig.entry=siteService.options.searchEntry):schema&&schema.searchEntry&&(searchConfig.rootPath=`schemas/${schema.name}/`,searchConfig.entry=schema.searchEntry),schema&&schema.torrentTagSelectors&&(searchConfig.torrentTagSelectors=schema.torrentTagSelectors),siteService.options.torrentTagSelectors&&(siteService.options.mergeSchemaTagSelectors?searchConfig.torrentTagSelectors=siteService.options.torrentTagSelectors.concat(searchConfig.torrentTagSelectors):searchConfig.torrentTagSelectors=siteService.options.torrentTagSelectors),!searchConfig.entry){result.msg=this.service.i18n.t("service.searcher.siteSearchConfigEntryIsEmpty",{site}),result.type=EDataResultType.error,reject(result),this.service.debug("searchTorrent: tip");return}let isImdbSearch=!1,imdb=key.match(/(tt\d+)/),autoMatched=!1;imdb&&imdb.length>=2&&(key=imdb[1],isImdbSearch=!0);let skipSearch=!1;if(searchEntryConfig&&searchEntryConfig.page&&(siteSearchPage=searchEntryConfig.page,searchEntryConfigQueryString=searchEntryConfig.queryString+"",searchEntryConfig.area&&searchEntryConfig.area.some(area=>{if(area.keyAutoMatch&&new RegExp(area.keyAutoMatch,"").test(key)){if(area.page&&(siteSearchPage=area.page),autoMatched=!0,area.queryString&&(searchEntryConfigQueryString=area.queryString),area.requestData&&(searchEntryConfigRequestData=area.requestData),area.appendQueryString&&(searchEntryConfigQueryString+=area.appendQueryString),area.name=="IMDB"&&area.replaceKeyByTVDB)try{$.ajax({url:"https://thetvdb.com/api/GetSeriesByRemoteID.php?imdbid="+key,cache:!0,dataType:"text",contentType:"text/plain",timeout:this.options.connectClientTimeout||3e4,method:ERequestMethod.GET,async:!1}).done(f=>{let s=new DOMParser().parseFromString(f,"text/html");for(var a of area.replaceKeyByTVDB)switch(a){case"year":let u="",l=$(s).find("FirstAired").text();l!=""&&(u=new Date(l).getFullYear().toString()),searchEntryConfigQueryString=searchEntryConfigQueryString.replace("$year$",u);break;case"name":let h=$(s).find("SeriesName").text();if(h!="")searchEntryConfigQueryString=searchEntryConfigQueryString.replace("$name$",h);else{skipSearch=!0;return}break;default:break}}).fail((f,s,a)=>{skipSearch=!0,result.type=EDataResultType.unknown,reject(result)})}catch{skipSearch=!0,result.type=EDataResultType.unknown,reject(result);return}if(area.name=="IMDB"&&area.convertToANIDB)try{$.ajax({url:"https://raw.githubusercontent.com/Anime-Lists/anime-lists/master/anime-list.xml",cache:!0,dataType:"text",contentType:"text/plain",timeout:this.options.connectClientTimeout||3e4,method:ERequestMethod.GET,async:!1}).done(f=>{let s=$.parseHTML(f),a="anime[imdbid*='"+key+"']:first",u=$(a,s);if(u.length>0&&key.length>=9){let l=u.attr("anidbid");l&&(searchEntryConfigQueryString=searchEntryConfigQueryString.replace("$anidb$",l))}else skipSearch=!0}).fail((f,s,a)=>{skipSearch=!0,result.type=EDataResultType.unknown,reject(result)})}catch{skipSearch=!0,result.type=EDataResultType.unknown,reject(result);return}if(area.replaceKey&&(key=key.replace(new RegExp(area.replaceKey[0],"g"),area.replaceKey[1])),area.parseScript)try{key=eval(area.parseScript)}catch(f){}return!0}return!1})),skipSearch){resolve({status:"success",success:!0,msg:this.getErrorMessage(site,"noTorrents",""),data:{},type:EDataResultType.success});return}this.searchConfigs[host]=searchConfig;let results=[],entryCount=0,doneCount=0;const KEY="$key$";searchEntryConfig.keepOriginKey||(key=encodeURIComponent(key)),searchConfig.entry.forEach(f=>{if(f.skipIMDbId&&isImdbSearch)return;let s=f.entry||siteSearchPage;autoMatched&&s.indexOf(KEY)!==-1&&searchEntryConfigQueryString.indexOf(KEY)!==-1&&(s=PPF.removeQueryStringFromValue(s,KEY));let a=f.queryString;if(searchEntryConfigQueryString&&(a?a&&a.indexOf(KEY)===-1&&(a=searchEntryConfigQueryString+"&"+a):a=searchEntryConfigQueryString),f.appendQueryString&&(a+=f.appendQueryString),searchEntryConfig&&(f.parseScriptFile=searchEntryConfig.parseScriptFile||f.parseScriptFile,f.resultType=searchEntryConfig.resultType||f.resultType,f.requestDataType=searchEntryConfig.requestDataType||f.requestDataType,f.resultSelector=searchEntryConfig.resultSelector||f.resultSelector,f.headers=searchEntryConfig.headers||f.headers,f.asyncParse=searchEntryConfig.asyncParse||f.asyncParse,f.requestData=searchEntryConfigRequestData||searchEntryConfig.requestData||f.requestData),s&&f.parseScriptFile&&f.enabled!==!1){let u=this.options.search&&this.options.search.rows?this.options.search.rows:10;site.cdn&&site.cdn.length>0&&(site.url=site.cdn[0]),(site.url+"").substr(-1)!="/"&&(site.url+="/"),(s+"").substr(0,1)=="/"&&(s=(s+"").substr(1));let l=site.url+s;a&&(s.indexOf("?")!==-1?l+="&"+a:l+="?"+a),l=PPF.removeDuplicateQueryString(l);let h=key+(f.appendToSearchKeyString?` ${f.appendToSearchKeyString}`:"");if(l=this.replaceKeys(l,{key:h,rows:u,passkey:site.passkey?site.passkey:""}),f.requestData)try{for(const p in f.requestData)if(f.requestData.hasOwnProperty(p)){const y=f.requestData[p];if(typeof y!="string")continue;f.requestData[p]=PPF.replaceKeys(y,{key:h,passkey:site.passkey?site.passkey:""}),site.user&&(f.requestData[p]=PPF.replaceKeys(f.requestData[p],site.user,"user"))}}catch(p){this.service.writeErrorLog(p),this.service.debug(p)}if(f.headers){for(const p in f.headers)if(f.headers.hasOwnProperty(p)){const y=f.headers[p];f.headers[p]=PPF.replaceKeys(y,{key:h,passkey:site.passkey?site.passkey:""}),site.user&&(f.headers[p]=PPF.replaceKeys(f.headers[p],site.user,"user")),f.headers[p]=PPF.replaceKeys(f.headers[p],site,"site")}}site.user&&(l=this.replaceKeys(l,site.user,"user")),entryCount++;let d=f.parseScriptFile;d.substr(0,1)!=="/"&&(d=`${searchConfig.rootPath}${d}`),f.parseScript=this.parseScriptCache[d],f.parseScript?this.getSearchResult(l,site,Object.assign(PPF.clone(searchEntryConfig),PPF.clone(f)),searchConfig.torrentTagSelectors).then(p=>{p&&p.length&&results.push(...p),doneCount++,(doneCount===entryCount||results.length>=u)&&resolve(results.slice(0,u))}).catch(p=>{doneCount++,doneCount===entryCount&&(results.length>0?resolve(results.slice(0,u)):reject(p))}):(this.service.debug("searchTorrent: getScriptContent",d),APP.getScriptContent(d).done(p=>{this.service.debug("searchTorrent: getScriptContent done",d),this.parseScriptCache[d]=p,f.parseScript=p,this.getSearchResult(l,site,Object.assign(PPF.clone(searchEntryConfig),PPF.clone(f)),searchConfig.torrentTagSelectors).then(y=>{this.service.debug("searchTorrent: getSearchResult done",l),y&&y.length&&results.push(...y),doneCount++,(doneCount===entryCount||results.length>=u)&&resolve(results.slice(0,u))}).catch(y=>{this.service.debug("searchTorrent: getSearchResult catch",l,y),doneCount++,doneCount===entryCount&&(results.length>0?resolve(results.slice(0,u)):reject(y))})}).fail(p=>{this.service.debug("searchTorrent: getScriptContent fail",p)}))}}),entryCount==0&&(result.msg=this.service.i18n.t("service.searcher.siteSearchEntryIsEmpty",{site}),result.type=EDataResultType.error,reject(result)),this.service.debug("searchTorrent: queue done")})}getSearchResult(f,s,a,u){return new Promise((l,h)=>{a.beforeSearch?new PageParser(a.beforeSearch,s,this.service.options.connectClientTimeout).getInfos().then(p=>{this.addSearchRequestQueue(f,s,a,u,p).then(y=>{l(y)}).catch(y=>{h(y)})}).catch(p=>{this.service.writeErrorLog(p),this.addSearchRequestQueue(f,s,a,u).then(y=>{l(y)}).catch(y=>{h(y)})}):this.addSearchRequestQueue(f,s,a,u).then(d=>{l(d)}).catch(d=>{h(d)})})}addSearchRequestQueue(url,site,entry,torrentTagSelectors,beforeSearchData){let _entry=PPF.clone(entry);if(_entry.parseScript&&delete _entry.parseScript,beforeSearchData&&(this.service.debug("beforeSearchData",beforeSearchData),url=this.replaceKeys(url,beforeSearchData,"beforeSearchData"),entry.requestData))try{for(const f in entry.requestData)if(entry.requestData.hasOwnProperty(f)){const s=entry.requestData[f];entry.requestData[f]=PPF.replaceKeys(s,beforeSearchData,"beforeSearchData")}}catch(f){this.service.writeErrorLog(f),this.service.debug(f)}this.service.debug("getSearchResult.start",{url,site:site.host,entry:_entry});let logId="",contentType="text/plain",data=entry.requestData;switch(entry.requestDataType){case ERequestType.JSON:contentType="application/json",data&&(data=JSON.stringify(data));case ERequestType.TEXT:}return new Promise((resolve,reject)=>{this.searchRequestQueue[url]=$.ajax({url,cache:!0,dataType:"text",contentType,timeout:this.options.connectClientTimeout||3e4,headers:entry.headers,method:entry.requestMethod||ERequestMethod.GET,data}).done(result=>{var f;if(this.service.debug("getSearchResult.done",url),delete this.searchRequestQueue[url],result&&typeof result=="string"&&result.length>100||typeof result=="object"||result&&entry.resultType==ERequestResultType.JSON&&result.toLowerCase().includes("success")){let page,doc;try{switch(entry.resultType){case ERequestResultType.JSON:page=JSON.parse(result);break;default:doc=new DOMParser().parseFromString(result,"text/html"),page=$(doc).find("body");break}}catch(s){logId=this.service.logger.add({module:EModule.background,event:"service.searcher.getSearchResult.siteSearchResultParseFailed",msg:s}),reject({success:!1,msg:this.service.i18n.t("service.searcher.siteSearchResultParseFailed",{site}),data:{logId},type:EDataResultType.error});return}let options={results:[],responseText:result,site,resultSelector:entry.resultSelector,page,entry,torrentTagSelectors,errorMsg:"",isLogged:!1,status:"success",searcher:this,url};try{if(console.log("entry.parseScript ",(f=entry.parseScript)==null?void 0:f.length),entry.parseScript)if(entry.asyncParse){options=Object.assign({reject,resolve},options),eval(entry.parseScript);return}else eval(entry.parseScript);options.errorMsg||options.status!="success"?reject({success:!1,msg:this.getErrorMessage(site,options.status,options.errorMsg),data:{site,isLogged:options.isLogged}}):resolve(PPF.clone(options.results))}catch(s){console.error(s),logId=this.service.logger.add({module:EModule.background,event:"service.searcher.getSearchResult.siteEvalScriptFailed",msg:s}),reject({success:!1,msg:this.service.i18n.t("service.searcher.siteEvalScriptFailed",{site}),data:{logId}})}}else logId=this.service.logger.add({module:EModule.background,event:"service.searcher.getSearchResult.siteSearchResultError",msg:result}),reject({success:!1,msg:this.service.i18n.t("service.searcher.siteSearchResultError",{site}),data:{logId},type:EDataResultType.error})}).fail((f,s,a)=>{delete this.searchRequestQueue[url],this.service.debug({title:"getSearchResult.fail",url,entry,textStatus:s,errorThrown:a}),logId=this.service.logger.add({module:EModule.background,event:"service.searcher.getSearchResult.fail",msg:a,data:{url,entry,code:f.status,textStatus:s,errorThrown:a,responseText:f.responseText}}),reject({data:{logId,textStatus:s},msg:this.service.i18n.t("service.searcher.siteNetworkFailed",{site,msg:`${f.status} ${a}, ${s}`}),success:!1,type:EDataResultType.error})})})}getErrorMessage(f,s="success",a=""){return s!="success"?this.service.i18n.t(`contentPage.search.${s}`,{siteName:f.name,msg:a}):a}abortSearch(f,s=""){return new Promise((a,u)=>{let l=f.host+"",h=this.searchConfigs[l];h.entry&&(this.service.logger.add({module:EModule.background,event:"searcher.abortSearch",msg:this.service.i18n.t("service.searcher.siteAbortSearch",{site:f}),data:{site:f.host,key:s}}),h.entry.forEach(d=>{if(d.entry&&d.parseScriptFile&&d.enabled!==!1){f.cdn&&f.cdn.length>0&&(f.url=f.cdn[0]);let p=this.options.search&&this.options.search.rows?this.options.search.rows:10,y=f.url+d.entry;y=this.replaceKeys(y,{key:s,rows:p,passkey:f.passkey?f.passkey:""});let g=this.searchRequestQueue[y];if(g)try{g.abort(),a()}catch(x){this.service.logger.add({module:EModule.background,event:"searcher.abortSearch.error",msg:this.service.i18n.t("service.searcher.siteAbortSearchError",{site:f}),data:{site:f.host,key:s,error:x}}),u(x)}else a()}else a()}))})}getSiteSchema(f){let s={};return typeof f.schema=="string"&&(s=this.options.system&&this.options.system.schemas&&this.options.system.schemas.find(a=>a.name==f.schema),s===void 0)?s:PPF.clone(s)}replaceKeys(f,s,a=""){let u=f;for(const l in s)if(s.hasOwnProperty(l)){const h=s[l];let d="$"+l+"$";a&&(d=`$${a}.${l}$`),u=u.replace(d,h)}return u}getFieldValue(f,s,a=""){let u;if(f.searchEntryConfig&&f.searchEntryConfig.fieldSelector){if(u=f.searchEntryConfig.fieldSelector[a],!u)return null}else return null;return new InfoParser(this.service).getFieldData(s,u,f.searchEntryConfig.fieldSelector)}getCategoryById(f,s,a){let u={};return f.categories&&f.categories.forEach(l=>{if(l.category&&(l.entry=="*"||s.indexOf(l.entry))){let h=l.category.find(d=>d.id==a);h&&(u=h)}}),u}cfDecodeEmail(f){let s="",a=parseInt(f.substr(0,2),16),u,l;for(u=2;f.length-u;u+=2)l=parseInt(f.substr(u,2),16)^a,s+=String.fromCharCode(l);return s}getRowTags(f,s){let a=[];if(f&&f.host){let l=this.searchConfigs[f.host].torrentTagSelectors;l&&l.length>0&&l.forEach(h=>{if(h.selector){let d=s.find(h.selector);if(d.length){let p=h.color||BASE_TAG_COLORS[h.name]||"",y={name:h.name,color:p};h.title&&d.attr(h.title)&&(y.title=d.attr(h.title)),a.push(y)}}})}return a}}var requiresPort=function f(s,a){if(a=a.split(":")[0],s=+s,!s)return!1;switch(a){case"http":case"ws":return s!==80;case"https":case"wss":return s!==443;case"ftp":return s!==21;case"gopher":return s!==70;case"file":return!1}return s!==0},querystringify$1={},has=Object.prototype.hasOwnProperty,undef;function decode$2(f){try{return decodeURIComponent(f.replace(/\+/g," "))}catch{return null}}function encode$2(f){try{return encodeURIComponent(f)}catch{return null}}function querystring(f){for(var s=/([^=?#&]+)=?([^&]*)/g,a={},u;u=s.exec(f);){var l=decode$2(u[1]),h=decode$2(u[2]);l===null||h===null||l in a||(a[l]=h)}return a}function querystringify(f,s){s=s||"";var a=[],u,l;typeof s!="string"&&(s="?");for(l in f)if(has.call(f,l)){if(u=f[l],!u&&(u===null||u===undef||isNaN(u))&&(u=""),l=encode$2(l),u=encode$2(u),l===null||u===null)continue;a.push(l+"="+u)}return a.length?s+a.join("&"):""}querystringify$1.stringify=querystringify,querystringify$1.parse=querystring;var required=requiresPort,qs=querystringify$1,controlOrWhitespace=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,CRHTLF=/[\n\r\t]/g,slashes=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,port=/:\d+$/,protocolre=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,windowsDriveLetter=/^[a-zA-Z]:/;function trimLeft(f){return(f||"").toString().replace(controlOrWhitespace,"")}var rules=[["#","hash"],["?","query"],function f(s,a){return isSpecial(a.protocol)?s.replace(/\\/g,"/"):s},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],ignore={hash:1,query:1};function lolcation(f){var s;typeof window<"u"?s=window:typeof commonjsGlobal<"u"?s=commonjsGlobal:typeof self<"u"?s=self:s={};var a=s.location||{};f=f||a;var u={},l=typeof f,h;if(f.protocol==="blob:")u=new Url(unescape(f.pathname),{});else if(l==="string"){u=new Url(f,{});for(h in ignore)delete u[h]}else if(l==="object"){for(h in f)h in ignore||(u[h]=f[h]);u.slashes===void 0&&(u.slashes=slashes.test(f.href))}return u}function isSpecial(f){return f==="file:"||f==="ftp:"||f==="http:"||f==="https:"||f==="ws:"||f==="wss:"}function extractProtocol(f,s){f=trimLeft(f),f=f.replace(CRHTLF,""),s=s||{};var a=protocolre.exec(f),u=a[1]?a[1].toLowerCase():"",l=!!a[2],h=!!a[3],d=0,p;return l?h?(p=a[2]+a[3]+a[4],d=a[2].length+a[3].length):(p=a[2]+a[4],d=a[2].length):h?(p=a[3]+a[4],d=a[3].length):p=a[4],u==="file:"?d>=2&&(p=p.slice(2)):isSpecial(u)?p=a[4]:u?l&&(p=p.slice(2)):d>=2&&isSpecial(s.protocol)&&(p=a[4]),{protocol:u,slashes:l||isSpecial(u),slashesCount:d,rest:p}}function resolve(f,s){if(f==="")return s;for(var a=(s||"/").split("/").slice(0,-1).concat(f.split("/")),u=a.length,l=a[u-1],h=!1,d=0;u--;)a[u]==="."?a.splice(u,1):a[u]===".."?(a.splice(u,1),d++):d&&(u===0&&(h=!0),a.splice(u,1),d--);return h&&a.unshift(""),(l==="."||l==="..")&&a.push(""),a.join("/")}function Url(f,s,a){if(f=trimLeft(f),f=f.replace(CRHTLF,""),!(this instanceof Url))return new Url(f,s,a);var u,l,h,d,p,y,g=rules.slice(),x=typeof s,C=this,m=0;for(x!=="object"&&x!=="string"&&(a=s,s=null),a&&typeof a!="function"&&(a=qs.parse),s=lolcation(s),l=extractProtocol(f||"",s),u=!l.protocol&&!l.slashes,C.slashes=l.slashes||u&&s.slashes,C.protocol=l.protocol||s.protocol||"",f=l.rest,(l.protocol==="file:"&&(l.slashesCount!==2||windowsDriveLetter.test(f))||!l.slashes&&(l.protocol||l.slashesCount<2||!isSpecial(C.protocol)))&&(g[3]=[/(.*)/,"pathname"]);m<g.length;m++){if(d=g[m],typeof d=="function"){f=d(f,C);continue}h=d[0],y=d[1],h!==h?C[y]=f:typeof h=="string"?(p=h==="@"?f.lastIndexOf(h):f.indexOf(h),~p&&(typeof d[2]=="number"?(C[y]=f.slice(0,p),f=f.slice(p+d[2])):(C[y]=f.slice(p),f=f.slice(0,p)))):(p=h.exec(f))&&(C[y]=p[1],f=f.slice(0,p.index)),C[y]=C[y]||u&&d[3]&&s[y]||"",d[4]&&(C[y]=C[y].toLowerCase())}a&&(C.query=a(C.query)),u&&s.slashes&&C.pathname.charAt(0)!=="/"&&(C.pathname!==""||s.pathname!=="")&&(C.pathname=resolve(C.pathname,s.pathname)),C.pathname.charAt(0)!=="/"&&isSpecial(C.protocol)&&(C.pathname="/"+C.pathname),required(C.port,C.protocol)||(C.host=C.hostname,C.port=""),C.username=C.password="",C.auth&&(p=C.auth.indexOf(":"),~p?(C.username=C.auth.slice(0,p),C.username=encodeURIComponent(decodeURIComponent(C.username)),C.password=C.auth.slice(p+1),C.password=encodeURIComponent(decodeURIComponent(C.password))):C.username=encodeURIComponent(decodeURIComponent(C.auth)),C.auth=C.password?C.username+":"+C.password:C.username),C.origin=C.protocol!=="file:"&&isSpecial(C.protocol)&&C.host?C.protocol+"//"+C.host:"null",C.href=C.toString()}function set(f,s,a){var u=this;switch(f){case"query":typeof s=="string"&&s.length&&(s=(a||qs.parse)(s)),u[f]=s;break;case"port":u[f]=s,required(s,u.protocol)?s&&(u.host=u.hostname+":"+s):(u.host=u.hostname,u[f]="");break;case"hostname":u[f]=s,u.port&&(s+=":"+u.port),u.host=s;break;case"host":u[f]=s,port.test(s)?(s=s.split(":"),u.port=s.pop(),u.hostname=s.join(":")):(u.hostname=s,u.port="");break;case"protocol":u.protocol=s.toLowerCase(),u.slashes=!a;break;case"pathname":case"hash":if(s){var l=f==="pathname"?"/":"#";u[f]=s.charAt(0)!==l?l+s:s}else u[f]=s;break;case"username":case"password":u[f]=encodeURIComponent(s);break;case"auth":var h=s.indexOf(":");~h?(u.username=s.slice(0,h),u.username=encodeURIComponent(decodeURIComponent(u.username)),u.password=s.slice(h+1),u.password=encodeURIComponent(decodeURIComponent(u.password))):u.username=encodeURIComponent(decodeURIComponent(s))}for(var d=0;d<rules.length;d++){var p=rules[d];p[4]&&(u[p[1]]=u[p[1]].toLowerCase())}return u.auth=u.password?u.username+":"+u.password:u.username,u.origin=u.protocol!=="file:"&&isSpecial(u.protocol)&&u.host?u.protocol+"//"+u.host:"null",u.href=u.toString(),u}function toString(f){(!f||typeof f!="function")&&(f=qs.stringify);var s,a=this,u=a.host,l=a.protocol;l&&l.charAt(l.length-1)!==":"&&(l+=":");var h=l+(a.protocol&&a.slashes||isSpecial(a.protocol)?"//":"");return a.username?(h+=a.username,a.password&&(h+=":"+a.password),h+="@"):a.password?(h+=":"+a.password,h+="@"):a.protocol!=="file:"&&isSpecial(a.protocol)&&!u&&a.pathname!=="/"&&(h+="@"),(u[u.length-1]===":"||port.test(a.hostname)&&!a.port)&&(u+=":"),h+=u+a.pathname,s=typeof a.query=="object"?f(a.query):a.query,s&&(h+=s.charAt(0)!=="?"?"?"+s:s),a.hash&&(h+=a.hash),h}Url.prototype={set,toString},Url.extractProtocol=extractProtocol,Url.location=lolcation,Url.trimLeft=trimLeft,Url.qs=qs;var urlParse=Url;const URLParse=getDefaultExportFromCjs(urlParse);class User{constructor(f){this.service=f,this.requestQueue={},this.requestQueueCount=0,this.infoParserCache={},this.InfoParser=InfoParser}refreshUserData(f=!1){return new Promise((s,a)=>{let u=[];this.service.options.sites.forEach(l=>{if(!l.allowGetUserInfo||l.offline)return!1;if(!f)u.push(this.getUserInfo(l,!0));else if(l.user){let d=[EUserDataRequestStatus.needLogin,EUserDataRequestStatus.unknown].includes(l.user.lastUpdateStatus);(l.user.lastUpdateStatus&&d||!l.user.lastUpdateStatus)&&u.push(this.getUserInfo(l,!0))}}),Promise.all(u).then(l=>{s(l)})})}updateStatus(f,s){s.lastUpdateTime=new Date().getTime(),this.service.userData.update(f,s)}getSiteURL(f){return f.cdn&&f.cdn.length>0?f.cdn[0]:f.url}getUserInfo(f,s=!1){return this.service.options.autoRefreshUserDataLastTime=new Date().getTime(),this.service.saveConfig(),new Promise((a,u)=>{let l=s?a:u;if(!f){l(null);return}let h=this.service.userData.get(f.host)||{},d=this.service.getSiteSelector(f,"userBaseInfo");if(!d){h.lastUpdateStatus=EUserDataRequestStatus.notSupported,this.updateStatus(f,h),l(APP.createErrorMessage({status:EUserDataRequestStatus.notSupported,msg:this.service.i18n.t("service.user.notSupported")}));return}let p=`${this.getSiteURL(f)}${d.page}`,y=f.host;if(this.checkQueue(y,p)){a(h);return}this.getInfos(y,p,d,f).then(g=>{if(console.log("userBaseInfo",y,g),h=Object.assign({},g),d&&d.fields&&d.fields.isLogged?h.isLogged&&(h.name||h.id)?h.isLogged=!0:h.isLogged=!1:(h.name||h.id)&&(h.isLogged=!0),!h.isLogged){h.lastUpdateStatus=EUserDataRequestStatus.needLogin,l(APP.createErrorMessage({msg:this.service.i18n.t("service.user.notLogged"),status:EUserDataRequestStatus.needLogin}));return}if(d=this.service.getSiteSelector(f,"userExtendInfo"),!d){this.updateStatus(f,h),h.lastUpdateStatus=EUserDataRequestStatus.success,a(h);return}if(h.name||h.id){let x=`${this.getSiteURL(f)}${d.page.replace("$user.id$",h.id).replace("$user.name$",h.name).replace("$user.bonusPage$",h.bonusPage).replace("$user.unsatisfiedsPage$",h.unsatisfiedsPage)}`;if(this.checkQueue(y,x)){a(h);return}this.getInfos(y,x,d,f,h).then(C=>{h=Object.assign(h,C),h.lastUpdateStatus=EUserDataRequestStatus.success,this.updateStatus(f,h),this.getMoreInfos(f,h).then(()=>{a(h)})}).catch(C=>{h.lastUpdateStatus=EUserDataRequestStatus.unknown,l(APP.createErrorMessage(C))})}else h.lastUpdateStatus=EUserDataRequestStatus.unknown,l(APP.createErrorMessage({status:EUserDataRequestStatus.unknown,msg:this.service.i18n.t("service.user.getUserInfoFailed")}))}).catch(g=>{h.lastUpdateStatus=EUserDataRequestStatus.unknown,console.log("getInfos Error :",g),l(APP.createErrorMessage(g))})})}getMoreInfos(site,userInfo){return new Promise((resolve,reject)=>{let requests=[],selectors=["userSeedingTorrents","bonusExtendInfo","hnrExtendInfo","levelExtendInfo","userUploadedTorrents"];selectors.forEach(name=>{let host=site.host,rule=this.service.getSiteSelector(site,name);if(rule&&rule.page){let url=`${this.getSiteURL(site)}${rule.page.replace("$user.id$",userInfo.id).replace("$user.name$",userInfo.name).replace("$user.bonusPage$",userInfo.bonusPage).replace("$user.unsatisfiedsPage$",userInfo.unsatisfiedsPage)}`;if(this.checkQueue(host,url))return;if(rule.prerequisites)try{let result=eval(rule.prerequisites);if(result!==!0)return}catch(f){console.log(f);return}requests.push(this.getInfos(host,url,rule,site,userInfo))}}),requests.length?Promise.all(requests).then(f=>{f.forEach(s=>{userInfo=Object.assign(userInfo,s),console.log(userInfo),userInfo.lastUpdateStatus=EUserDataRequestStatus.success,this.updateStatus(site,userInfo)}),resolve(userInfo)}).catch(f=>{resolve(userInfo)}):resolve(userInfo)})}getInfos(f,s,a,u,l){return new Promise((h,d)=>{s=s.replace("://","****").replace(/\/\//g,"/").replace("****","://");let p=a.requestData;if(p&&l)try{for(const x in p)if(p.hasOwnProperty(x)){const C=p[x];p[x]=PPF.replaceKeys(C,l,"user")}}catch(x){console.log(x)}let y=a.headers;if(y&&l)try{for(const x in y)if(y.hasOwnProperty(x)){const C=y[x];y[x]=PPF.replaceKeys(C,l,"user")}}catch(x){console.log(x)}if(y&&u)try{for(const x in y)if(y.hasOwnProperty(x)){const C=y[x];y[x]=PPF.replaceKeys(C,u,"site")}}catch(x){console.log(x)}if(a.parser&&u){this.runParser(a,u,l,h,d);return}PPF.updateBadge(++this.requestQueueCount);let g=$.ajax({url:s,method:a.requestMethod||ERequestMethod.GET,dataType:"text",data:a.requestContentType=="application/json"?JSON.stringify(p):p,contentType:a.requestContentType=="application/json"?"application/json":"application/x-www-form-urlencoded",headers:a.headers,timeout:this.service.options.connectClientTimeout||3e4,cache:!(a.dataType&&a.dataType!==ERequestResultType.JSON)}).done(x=>{this.removeQueue(f,s),PPF.updateBadge(--this.requestQueueCount);let C;try{if(a.dataType!==ERequestResultType.JSON){let m=new DOMParser().parseFromString(x,"text/html"),v=a.topElement||"body";C=$(m).find(v)}else C=JSON.parse(x)}catch(m){this.service.debug("getInfos.error",f,s,m),d(m);return}if(C&&a)try{let m=new InfoParser().getResult(C,a);h(m)}catch(m){this.service.debug(m),d(m)}}).fail((x,C,m)=>{this.removeQueue(f,s),PPF.updateBadge(--this.requestQueueCount);let v=this.service.i18n.t("service.searcher.siteNetworkFailed",{site:u,msg:`${x.status} ${m}, ${C}`});this.service.debug(v,f,s,x.responseText),d(v)});this.addQueue(f,s,g)})}runParser(rule,site,userInfo,resolve,reject){let siteConfigPath=site.schema=="publicSite"?"publicSites":"sites";site.path?siteConfigPath+=`/${site.path}`:siteConfigPath+=`/${site.host}`;let path=rule.parser;path.substr(0,1)!=="/"&&path.substr(0,4)!=="http"&&(path=`${siteConfigPath}/${path}`);let script=this.infoParserCache[path];script?eval(script):APP.getScriptContent(path).done(script=>{this.infoParserCache[path]=script,eval(script)})}addQueue(f,s,a){let u=this.requestQueue[f]||{};u[s]=a,this.requestQueue[f]=u}checkQueue(f,s){return!!(this.requestQueue[f]||{})[s]}removeQueue(f,s){let a=this.requestQueue[f]||{};a[s]&&delete a[s],this.requestQueue[f]=a}abortGetUserInfo(f){return new Promise((s,a)=>{let u=f.host,l=this.requestQueue[u],h=[];if(l){for(const d in l)if(l.hasOwnProperty(d)){const p=l[d];try{p.abort()}catch(y){this.service.logger.add({module:EModule.background,event:"user.abortGetUserInfo.error",msg:this.service.i18n.t("service.user.abortGetUserInfoFailed"),data:{site:f.host,error:y}}),h.push(y)}}delete this.requestQueue[u]}h.length>0?a(h):s(!0)})}getCookie(f,s){return new Promise((a,u)=>{PPF.checkPermissions(["cookies"]).then(()=>{this.service.config.getCookiesFromSite(f).then(l=>{for(const h of l.cookies)h.name===s&&a(h.value);a("")}).catch(l=>{u(l)})}).catch(l=>{u(l)})})}}class MovieInfoService{constructor(){this.doubanApiURL="https://api.douban.com/v2",this.doubanFrodoApi="https://frodo.douban.com/api/v2",this.douban={frodo:{apiKeys:["054022eaeae0b00e0fc068c0c0a2102a"],entApiKeys:["054022eaeae0b00e0fc068c0c0a2102a"],methods:{movie:{search:`${this.doubanFrodoApi}/search?q=$key$&count=$count$&apiKey=$apikey$`,imdb:"https://omit.mkrobot.org/movie/infos/$imdbid$",subject:"https://omit.mkrobot.org/movie/infos/douban$id$"}}},common:{apiKeys:["02646d3fb69a52ff072d47bf23cef8fd","0b2bdeda43b5688921839c8ecb20399b","0dad551ec0f84ed02907ff5c42e8ec70","0df993c66c0c636e29ecbb5344252a4a"],entApiKeys:["0dad551ec0f84ed02907ff5c42e8ec70","02646d3fb69a52ff072d47bf23cef8fd"],methods:{movie:{search:`${this.doubanApiURL}/movie/search?q=$key$&count=$count$&apikey=$apikey$`,imdb:`${this.doubanApiURL}/movie/imdb/$imdbid$?apikey=$apikey$`,subject:`${this.doubanApiURL}/movie/subject/$id$?apikey=$apikey$`}}}},this.omdbApiURL="https://www.omdbapi.com",this.omitApiURL="https://omit.mkrobot.org",this.omdbApiKeys=["e0d3039d","a67d9bce","6be019fc","4ee790e0","d82cb888","d58193b6","15c0aa3f","53acf36d","3a864b75","2892ab46","b507af90","7cf67120","85b2a90c","2896ff0a","aa4b9983","c4e08870","5d5c0049","79a462f2","e4c3fce8","918d70df","e94cb667","eb84d6d7","e192b5a","d62b4cf5","5e6442a3","9b1468c6"],this.doubanApiKeys=["02646d3fb69a52ff072d47bf23cef8fd","0b2bdeda43b5688921839c8ecb20399b","0dad551ec0f84ed02907ff5c42e8ec70","0df993c66c0c636e29ecbb5344252a4a"],this.doubanEntApiKeys=["0dad551ec0f84ed02907ff5c42e8ec70","02646d3fb69a52ff072d47bf23cef8fd"],this.omitApiKeys=["kiqMY6MC"],this.cache={base:{},ratings:{},doubanToIMDb:{},search:{}},this.timeout=3e3,this.doubanApi=this.douban.frodo,this.requsetQueue={}}getInfos(s){return/(douban\d+)/.test(s)?this.getInfoFromDoubanId(s.replace("douban","")):/^(tt\d+)$/.test(s)?this.getInfoFromIMDb(s):new Promise((a,u)=>{u("暂未实现")})}isIMDbId(s){return/^(tt\d+)$/.test(s)}getInfoFromIMDb(s){return new Promise((a,u)=>{if(this.isIMDbId(s)){let l=this.cache.base[s];if(l){a(l);return}let h=PPF.replaceKeys(this.doubanApi.methods.movie.imdb,{imdbid:s,apikey:this.getDoubanApiKey()});$.ajax({url:h,timeout:this.timeout}).done(d=>{let p;d&&(p=d.data||d),this.cache.base[s]=p,a(p)}).fail(d=>{u(d)})}else u("error IMDbId")})}getInfoFromDoubanId(s){return new Promise((a,u)=>{if(/^(\d+)$/.test(s)){let l=this.cache.base[s];if(l){a(l);return}let h=PPF.replaceKeys(this.doubanApi.methods.movie.subject,{id:s,apikey:this.getDoubanApiKey()});$.ajax({url:h,timeout:this.timeout}).done(d=>{let p;d&&(p=d.data||d),this.cache.base[s]=p,a(p)}).fail(d=>{u(d)})}else u("error douban id")})}getRatings(s){return new Promise((a,u)=>{if(this.isIMDbId(s)){let l=this.cache.ratings[s];if(l){a(l);return}let h=0;const d=()=>{let p=this.getOmdbApiKey(),y=`${this.omdbApiURL}/?i=${s}&apikey=${p}&tomatoes=true`;$.ajax({url:y,timeout:this.timeout}).done(g=>{if(g&&g.Error){if(h++,h>=5){u(g);return}this.removeApiKey("omdb",p),d();return}this.cache.ratings[s]=g,a(g)}).fail(g=>{u(g)})};d()}else u("error IMDbId")})}getOmdbApiKey(){return this.omdbApiKeys[Math.floor(Math.random()*this.omdbApiKeys.length)]}getDoubanApiKey(){return this.doubanApi.apiKeys[Math.floor(Math.random()*this.doubanApi.apiKeys.length)]}getDoubanEntApiKey(){return this.doubanApi.entApiKeys[Math.floor(Math.random()*this.doubanApi.entApiKeys.length)]}getIMDbIdFromDouban(s){return new Promise((a,u)=>{let l=this.cache.doubanToIMDb[s];if(l){a(l);return}let h=`${this.omitApiURL}/movie/${s}/douban/imdb`;if(this.requsetQueue[h]){u();return}this.requsetQueue[h]=!0,$.ajax({url:h,timeout:this.timeout}).done(d=>{console.log("getIMDbIdFromDouban",d),d.data?(this.cache.doubanToIMDb[s]=d.data,a(d.data)):u(d)}).fail(d=>{u(d)}).always(()=>{delete this.requsetQueue[h]})})}queryMovieInfoFromDouban(s,a=5){return this.isIMDbId(s)?this.getInfoFromIMDb(s):new Promise((u,l)=>{let h=this.cache.search[s];if(h){u(h);return}let d=`${this.omitApiURL}/movie/search/${s}`;if(this.requsetQueue[d]){l();return}this.requsetQueue[d]=!0,$.ajax({url:d,timeout:this.timeout}).done(p=>{console.log("queryMovieInfoFromDouban",p),p.data?(this.cache.search[s]=p.data,u(p.data)):l(p)}).fail(p=>{l(p)}).always(()=>{delete this.requsetQueue[d]})})}appendApiKey(s="",a){let u;switch(s){case"omdb":u=this.omdbApiKeys;break;case"douban":u=this.doubanApiKeys;break}a.forEach(l=>{l&&!u.includes(l)&&u.push(l)})}removeApiKey(s="",a){let u=[];switch(s){case"omdb":u=this.omdbApiKeys;break;case"douban":u=this.doubanApiKeys;break}let l=u.findIndex(h=>{if(h===a)return!0});l!==-1&&u.splice(l,1)}verifyOmdbApiKey(s){return new Promise((a,u)=>{let l=`${this.omdbApiURL}/?i=tt0111161&apikey=${s}&tomatoes=true`;$.ajax({url:l,timeout:this.timeout}).done(h=>{if(h&&h.Error){u(h.Error);return}a()}).fail(h=>{u(h)})})}verifyDoubanApiKey(s){return new Promise((a,u)=>{let l=`${this.doubanApiURL}/movie/imdb/tt0111161?apikey=${s}`;$.ajax({url:l,timeout:this.timeout}).done(h=>{h&&h.title?a():u(h.Error)}).fail(h=>{u(h)})})}getTopSearches(s=9){return new Promise((a,u)=>{$.ajax({url:`${this.omitApiURL}/movie/top/${s}?apikey=${this.omitApiKeys[0]}`,timeout:this.timeout}).then(l=>{l&&l.data?a(l.data):u()}).catch(l=>{u(l)})})}}/* Common package for dealing with hex/string/uint8 conversions (and sha1 hashing)
*
* @author   Jimmy Wärting <jimmy@warting.se> (https://jimmy.warting.se/opensource)
* @license  MIT
*/const alphabet="0123456789abcdef",encodeLookup=[],decodeLookup=[];for(let f=0;f<256;f++)encodeLookup[f]=alphabet[f>>4&15]+alphabet[f&15],f<16&&(f<10?decodeLookup[48+f]=f:decodeLookup[87+f]=f);const arr2hex=f=>{const s=f.length;let a="",u=0;for(;u<s;)a+=encodeLookup[f[u++]];return a},hex2arr=f=>{const s=f.length>>1,a=s<<1,u=new Uint8Array(s);let l=0,h=0;for(;h<a;)u[l++]=decodeLookup[f.charCodeAt(h++)]<<4|decodeLookup[f.charCodeAt(h++)];return u},concat=(f,s=0)=>{const a=f.length||0;if(!s){let d=a;for(;d--;)s+=f[d].length}const u=new Uint8Array(s);let l=s,h=a;for(;h--;)l-=f[h].length,u.set(f[h],l);return u};for(var chars$1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup=typeof Uint8Array>"u"?[]:new Uint8Array(256),i=0;i<chars$1.length;i++)lookup[chars$1.charCodeAt(i)]=i;var encode$1=function(f){var s=new Uint8Array(f),a,u=s.length,l="";for(a=0;a<u;a+=3)l+=chars$1[s[a]>>2],l+=chars$1[(s[a]&3)<<4|s[a+1]>>4],l+=chars$1[(s[a+1]&15)<<2|s[a+2]>>6],l+=chars$1[s[a+2]&63];return u%3===2?l=l.substring(0,l.length-1)+"=":u%3===1&&(l=l.substring(0,l.length-2)+"=="),l};const decoder=new TextDecoder,arr2text=(f,s)=>s?new TextDecoder(s).decode(f):decoder.decode(f),encoder=new TextEncoder,text2arr=f=>encoder.encode(f),arr2base=f=>encode$1(f),scope=typeof window<"u"?window:self,crypto=scope.crypto||scope.msCrypto||{},subtle=crypto.subtle||crypto.webkitSubtle,formatMap={hex:arr2hex,base64:arr2base},hash=async(f,s,a="sha-1")=>{if(!subtle)throw new Error("no web crypto support");typeof f=="string"&&(f=text2arr(f));const u=new Uint8Array(await subtle.digest(a,f));return s?formatMap[s](u):u};function digitCount(f){const s=f<0?1:0;return f=Math.abs(Number(f||1)),Math.floor(Math.log10(f))+1+s}function getType(f){return ArrayBuffer.isView(f)?"arraybufferview":Array.isArray(f)?"array":f instanceof Number?"number":f instanceof Boolean?"boolean":f instanceof Set?"set":f instanceof Map?"map":f instanceof String?"string":f instanceof ArrayBuffer?"arraybuffer":typeof f}function encode(f,s,a){const u=[];let l=null;return encode._encode(u,f),l=concat(u),encode.bytes=l.length,ArrayBuffer.isView(s)?(s.set(l,a),s):l}encode.bytes=-1,encode._floatConversionDetected=!1,encode._encode=function(f,s){if(s!=null)switch(getType(s)){case"object":encode.dict(f,s);break;case"map":encode.dictMap(f,s);break;case"array":encode.list(f,s);break;case"set":encode.listSet(f,s);break;case"string":encode.string(f,s);break;case"number":encode.number(f,s);break;case"boolean":encode.number(f,s);break;case"arraybufferview":encode.buffer(f,new Uint8Array(s.buffer,s.byteOffset,s.byteLength));break;case"arraybuffer":encode.buffer(f,new Uint8Array(s));break}};const buffE=new Uint8Array([101]),buffD=new Uint8Array([100]),buffL=new Uint8Array([108]);encode.buffer=function(f,s){f.push(text2arr(s.length+":"),s)},encode.string=function(f,s){f.push(text2arr(text2arr(s).byteLength+":"+s))},encode.number=function(f,s){if(Number.isInteger(s))return f.push(text2arr("i"+BigInt(s)+"e"));const a=2147483648,u=s/a<<0,l=s%a<<0,h=u*a+l;f.push(text2arr("i"+h+"e")),h!==s&&!encode._floatConversionDetected&&(encode._floatConversionDetected=!0,console.warn('WARNING: Possible data corruption detected with value "'+s+'":','Bencoding only defines support for integers, value was converted to "'+h+'"'),console.trace())},encode.dict=function(f,s){f.push(buffD);let a=0,u;const l=Object.keys(s).sort(),h=l.length;for(;a<h;a++)u=l[a],s[u]!=null&&(encode.string(f,u),encode._encode(f,s[u]));f.push(buffE)},encode.dictMap=function(f,s){f.push(buffD);const a=Array.from(s.keys()).sort();for(const u of a)s.get(u)!=null&&(ArrayBuffer.isView(u)?encode._encode(f,u):encode.string(f,String(u)),encode._encode(f,s.get(u)));f.push(buffE)},encode.list=function(f,s){let a=0;const u=s.length;for(f.push(buffL);a<u;a++)s[a]!=null&&encode._encode(f,s[a]);f.push(buffE)},encode.listSet=function(f,s){f.push(buffL);for(const a of s)a!=null&&encode._encode(f,a);f.push(buffE)};const INTEGER_START=105,STRING_DELIM=58,DICTIONARY_START=100,LIST_START=108,END_OF_TYPE=101;function getIntFromBuffer(f,s,a){let u=0,l=1;for(let h=s;h<a;h++){const d=f[h];if(d<58&&d>=48){u=u*10+(d-48);continue}if(!(h===s&&d===43)){if(h===s&&d===45){l=-1;continue}if(d===46)break;throw new Error("not a number: buffer["+h+"] = "+d)}}return u*l}function decode$1(f,s,a,u){return f==null||f.length===0?null:(typeof s!="number"&&u==null&&(u=s,s=void 0),typeof a!="number"&&u==null&&(u=a,a=void 0),decode$1.position=0,decode$1.encoding=u||null,decode$1.data=ArrayBuffer.isView(f)?new Uint8Array(f.slice(s,a)):text2arr(f),decode$1.bytes=decode$1.data.length,decode$1.next())}decode$1.bytes=0,decode$1.position=0,decode$1.data=null,decode$1.encoding=null,decode$1.next=function(){switch(decode$1.data[decode$1.position]){case DICTIONARY_START:return decode$1.dictionary();case LIST_START:return decode$1.list();case INTEGER_START:return decode$1.integer();default:return decode$1.buffer()}},decode$1.find=function(f){let s=decode$1.position;const a=decode$1.data.length,u=decode$1.data;for(;s<a;){if(u[s]===f)return s;s++}throw new Error('Invalid data: Missing delimiter "'+String.fromCharCode(f)+'" [0x'+f.toString(16)+"]")},decode$1.dictionary=function(){decode$1.position++;const f={};for(;decode$1.data[decode$1.position]!==END_OF_TYPE;){const s=decode$1.buffer();let a=arr2text(s);a.includes("�")&&(a=arr2hex(s)),f[a]=decode$1.next()}return decode$1.position++,f},decode$1.list=function(){decode$1.position++;const f=[];for(;decode$1.data[decode$1.position]!==END_OF_TYPE;)f.push(decode$1.next());return decode$1.position++,f},decode$1.integer=function(){const f=decode$1.find(END_OF_TYPE),s=getIntFromBuffer(decode$1.data,decode$1.position+1,f);return decode$1.position+=f+1-decode$1.position,s},decode$1.buffer=function(){let f=decode$1.find(STRING_DELIM);const s=getIntFromBuffer(decode$1.data,decode$1.position,f),a=++f+s;return decode$1.position=a,decode$1.encoding?arr2text(decode$1.data.slice(f,a)):decode$1.data.slice(f,a)};function listLength(f){let s=2;for(const a of f)s+=encodingLength$1(a);return s}function mapLength(f){let s=2;for(const[a,u]of f){const l=text2arr(a).byteLength;s+=digitCount(l)+1+l,s+=encodingLength$1(u)}return s}function objectLength(f){let s=2;const a=Object.keys(f);for(let u=0;u<a.length;u++){const l=text2arr(a[u]).byteLength;s+=digitCount(l)+1+l,s+=encodingLength$1(f[a[u]])}return s}function stringLength(f){const s=text2arr(f).byteLength;return digitCount(s)+1+s}function arrayBufferLength(f){const s=f.byteLength-f.byteOffset;return digitCount(s)+1+s}function encodingLength$1(f){if(f==null)return 0;const a=getType(f);switch(a){case"arraybufferview":return arrayBufferLength(f);case"string":return stringLength(f);case"array":case"set":return listLength(f);case"number":return 1+digitCount(Math.floor(f))+1;case"bigint":return 1+f.toString().length+1;case"object":return objectLength(f);case"map":return mapLength(f);default:throw new TypeError(`Unsupported value of type "${a}"`)}}const encodingLength=encodingLength$1,bencode={encode,decode:decode$1,byteLength:encodingLength$1,encodingLength},fetch=self.fetch||(()=>{throw new Error("global fetch is not available!")}),byteTable=[255,255,26,27,28,29,30,31,255,255,255,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255],decode=function(f){if(!ArrayBuffer.isView(f)&&typeof f!="string")throw new TypeError("base32.decode only takes Buffer or string as parameter");let s=0,a=0,u,l=0;ArrayBuffer.isView(f)||(f=text2arr(f));const h=new Uint8Array(Math.ceil(f.length*5/8));for(let d=0;d<f.length&&f[d]!==61;d++){const p=f[d]-48;if(p<byteTable.length)a=byteTable[p],s<=3?(s=(s+5)%8,s===0?(u|=a,h[l]=u,l++,u=0):u|=255&a<<8-s):(s=(s+5)%8,u|=255&a>>>s,h[l]=u,l++,u=255&a<<8-s);else throw new Error("Invalid input - it is not base32 encoded string")}return h.subarray(0,l)};function parseRange(f){const s=(a,u=a)=>Array.from({length:u-a+1},(l,h)=>h+a);return f.reduce((a,u,l,h)=>{const d=u.split("-").map(p=>parseInt(p));return a.concat(s(...d))},[])}/*! magnet-uri. MIT License. WebTorrent LLC <https://webtorrent.io/opensource> */function magnetURIDecode(f){const s={},a=f.split("magnet:?")[1];(a&&a.length>=0?a.split("&"):[]).forEach(h=>{const d=h.split("=");if(d.length!==2)return;const p=d[0];let y=d[1];p==="dn"&&(y=decodeURIComponent(y).replace(/\+/g," ")),(p==="tr"||p==="xs"||p==="as"||p==="ws")&&(y=decodeURIComponent(y)),p==="kt"&&(y=decodeURIComponent(y).split("+")),p==="ix"&&(y=Number(y)),p==="so"&&(y=parseRange(decodeURIComponent(y).split(","))),s[p]?(Array.isArray(s[p])||(s[p]=[s[p]]),s[p].push(y)):s[p]=y});let l;return s.xt&&(Array.isArray(s.xt)?s.xt:[s.xt]).forEach(d=>{(l=d.match(/^urn:btih:(.{40})/))?s.infoHash=l[1].toLowerCase():(l=d.match(/^urn:btih:(.{32})/))?s.infoHash=arr2hex(decode(l[1])):(l=d.match(/^urn:btmh:1220(.{64})/))&&(s.infoHashV2=l[1].toLowerCase())}),s.xs&&(Array.isArray(s.xs)?s.xs:[s.xs]).forEach(d=>{(l=d.match(/^urn:btpk:(.{64})/))&&(s.publicKey=l[1].toLowerCase())}),s.infoHash&&(s.infoHashBuffer=hex2arr(s.infoHash)),s.infoHashV2&&(s.infoHashV2Buffer=hex2arr(s.infoHashV2)),s.publicKey&&(s.publicKeyBuffer=hex2arr(s.publicKey)),s.dn&&(s.name=s.dn),s.kt&&(s.keywords=s.kt),s.announce=[],(typeof s.tr=="string"||Array.isArray(s.tr))&&(s.announce=s.announce.concat(s.tr)),s.urlList=[],(typeof s.as=="string"||Array.isArray(s.as))&&(s.urlList=s.urlList.concat(s.as)),(typeof s.ws=="string"||Array.isArray(s.ws))&&(s.urlList=s.urlList.concat(s.ws)),s.peerAddresses=[],(typeof s["x.pe"]=="string"||Array.isArray(s["x.pe"]))&&(s.peerAddresses=s.peerAddresses.concat(s["x.pe"])),s.announce=Array.from(new Set(s.announce)),s.urlList=Array.from(new Set(s.urlList)),s.peerAddresses=Array.from(new Set(s.peerAddresses)),s}/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let promise;var queueMicrotask_1=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:commonjsGlobal):f=>(promise||(promise=Promise.resolve())).then(f).catch(s=>setTimeout(()=>{throw s},0));const queueMicrotask$1=getDefaultExportFromCjs(queueMicrotask_1);/*! parse-torrent. MIT License. WebTorrent LLC <https://webtorrent.io/opensource> */async function parseTorrent(f){if(typeof f=="string"&&/^(stream-)?magnet:/.test(f)){const s=magnetURIDecode(f);if(!s.infoHash)throw new Error("Invalid torrent identifier");return s}else{if(typeof f=="string"&&(/^[a-f0-9]{40}$/i.test(f)||/^[a-z2-7]{32}$/i.test(f)))return magnetURIDecode(`magnet:?xt=urn:btih:${f}`);if(ArrayBuffer.isView(f)&&f.length===20)return magnetURIDecode(`magnet:?xt=urn:btih:${arr2hex(f)}`);if(ArrayBuffer.isView(f))return await decodeTorrentFile(f);if(f&&f.infoHash)return f.infoHash=f.infoHash.toLowerCase(),f.announce||(f.announce=[]),typeof f.announce=="string"&&(f.announce=[f.announce]),f.urlList||(f.urlList=[]),f;throw new Error("Invalid torrent identifier")}}async function parseTorrentRemote(f,s,a){if(typeof s=="function")return parseTorrentRemote(f,{},s);if(typeof a!="function")throw new Error("second argument must be a Function");let u;try{u=await parseTorrent(f)}catch{}if(u&&u.infoHash)queueMicrotask$1(()=>{a(null,u)});else if(isBlob(f))try{const h=new Uint8Array(await f.arrayBuffer());l(h)}catch(h){return a(new Error(`Error converting Blob: ${h.message}`))}else if(/^https?:/.test(f))try{const h=await fetch(f,{headers:{"user-agent":"WebTorrent (https://webtorrent.io)"},signal:AbortSignal.timeout(3e4),...s}),d=new Uint8Array(await h.arrayBuffer());l(d)}catch(h){return a(new Error(`Error downloading torrent: ${h.message}`))}else typeof path.readFile=="function"&&typeof f=="string"?path.readFile(f,(h,d)=>{if(h)return a(new Error("Invalid torrent identifier"));l(d)}):queueMicrotask$1(()=>{a(new Error("Invalid torrent identifier"))});async function l(h){try{u=await parseTorrent(h)}catch(d){return a(d)}u&&u.infoHash?a(null,u):a(new Error("Invalid torrent identifier"))}}async function decodeTorrentFile(f){ArrayBuffer.isView(f)&&(f=bencode.decode(f)),ensure(f.info,"info"),ensure(f.info["name.utf-8"]||f.info.name,"info.name"),ensure(f.info["piece length"],"info['piece length']"),ensure(f.info.pieces,"info.pieces"),f.info.files?f.info.files.forEach(l=>{ensure(typeof l.length=="number","info.files[0].length"),ensure(l["path.utf-8"]||l.path,"info.files[0].path")}):ensure(typeof f.info.length=="number","info.length");const s={info:f.info,infoBuffer:bencode.encode(f.info),name:arr2text(f.info["name.utf-8"]||f.info.name),announce:[]};s.infoHashBuffer=await hash(s.infoBuffer),s.infoHash=arr2hex(s.infoHashBuffer),f.info.private!==void 0&&(s.private=!!f.info.private),f["creation date"]&&(s.created=new Date(f["creation date"]*1e3)),f["created by"]&&(s.createdBy=arr2text(f["created by"])),ArrayBuffer.isView(f.comment)&&(s.comment=arr2text(f.comment)),Array.isArray(f["announce-list"])&&f["announce-list"].length>0?f["announce-list"].forEach(l=>{l.forEach(h=>{s.announce.push(arr2text(h))})}):f.announce&&s.announce.push(arr2text(f.announce)),ArrayBuffer.isView(f["url-list"])&&(f["url-list"]=f["url-list"].length>0?[f["url-list"]]:[]),s.urlList=(f["url-list"]||[]).map(l=>arr2text(l)),s.announce=Array.from(new Set(s.announce)),s.urlList=Array.from(new Set(s.urlList));const a=f.info.files||[f.info];s.files=a.map((l,h)=>{const d=[].concat(s.name,l["path.utf-8"]||l.path||[]).map(p=>ArrayBuffer.isView(p)?arr2text(p):p);return{path:path.join.apply(null,[path.sep].concat(d)).slice(1),name:d[d.length-1],length:l.length,offset:a.slice(0,h).reduce(sumLength,0)}}),s.length=a.reduce(sumLength,0);const u=s.files[s.files.length-1];return s.pieceLength=f.info["piece length"],s.lastPieceLength=(u.offset+u.length)%s.pieceLength||s.pieceLength,s.pieces=splitPieces(f.info.pieces),s}function isBlob(f){return typeof Blob<"u"&&f instanceof Blob}function sumLength(f,s){return f+s.length}function splitPieces(f){const s=[];for(let a=0;a<f.length;a+=20)s.push(arr2hex(f.slice(a,a+20)));return s}function ensure(f,s){if(!f)throw new Error(`Torrent is missing required field: ${s}`)}class Controller{constructor(s){this.service=s,this.options={sites:[],clients:[]},this.defaultClientOptions={},this.siteDefaultClients={},this.optionsTabId=0,this.downloadHistory=new DownloadHistory,this.clients={},this.searcher=new Searcher(this.service),this.userService=new User(this.service),this.movieInfoService=new MovieInfoService,this.clientController=new ClientController,this.isInitialized=!1,this.contentPages=[],this.debuggerTabId=0,this.imageBase64Cache={},this.downloadFailedRetriesCache={},this.torrentInfosCache={}}init(s){this.reset(s),this.isInitialized=!0}reset(s){this.options=s,this.clientController.init(s),this.searcher.options=s,this.initDefaultClient(),this.siteDefaultClients={},s.connectClientTimeout&&(this.movieInfoService.timeout=s.connectClientTimeout),this.options.apiKey&&(this.options.apiKey.omdb&&this.options.apiKey.omdb.length>0&&this.movieInfoService.appendApiKey("omdb",this.options.apiKey.omdb),this.options.apiKey.douban&&this.options.apiKey.douban.length>0&&this.movieInfoService.appendApiKey("douban",this.options.apiKey.douban))}getSearchResult(s){return this.searcher.searchTorrent(s.site,s.key,s.payload)}abortSearch(s){return this.searcher.abortSearch(s.site,s.key)}getDownloadHistory(){return this.downloadHistory.load()}saveDownloadHistory(s,a="",u="",l=!0){this.options.saveDownloadHistory&&this.downloadHistory.add(s,a,u,l)}removeDownloadHistory(s){return this.downloadHistory.remove(s)}clearDownloadHistory(){return this.downloadHistory.clear()}resetDownloadHistory(s){return this.downloadHistory.reset(s)}sendTorrentToClient(s){return new Promise((a,u)=>{if(!s.url){u({msg:this.service.i18n.t("service.controller.invalidAddress")});return}let h=filters.parseURL(s.url).host,d=this.options.clients.find(p=>p.id===s.clientId);if(!d){u({msg:this.service.i18n.t("service.controller.invalidDownloadServer")});return}this.getClient(d).then(p=>{this.doDownload(p,s,h).then(y=>{a(y)}).catch(y=>{u(y)})})})}sendTorrentToDefaultClient(s){return new Promise((a,u)=>{let h=filters.parseURL(s.url).host,d=this.getSiteFromHost(h);h=d.host+"";let p=this.getSiteDefaultPath(d),y=this.siteDefaultClients[h];!s.savePath&&p&&(s.savePath=p),y?this.doDownload(y,s,h).then(g=>{a(g)}).catch(g=>{u(g)}):this.initSiteDefaultClient(h).then(g=>{this.siteDefaultClients[h]=g,this.doDownload(g,s,h).then(x=>{a(x)}).catch(x=>{u(x)})})})}doDownload(s,a,u=""){let h=filters.parseURL(a.url).host,d=this.getSiteFromHost(h);return console.log("doDownload",s,a,u,d),new Promise((p,y)=>{s.client.call(EAction.addTorrentFromURL,{url:a.url,savePath:a.savePath!==void 0&&a.savePath.includes(",")?a.savePath.split(",")[0]:a.savePath,autoStart:a.autoStart===void 0?!1:a.autoStart,category:a.savePath!==void 0&&a.savePath.includes(",")?a.savePath.split(",")[1]:null,imdbId:a.tagIMDb?a.imdbId:null,upLoadLimit:d!==void 0?d.upLoadLimit:null,clientOptions:s.options,siteConfig:d}).then(g=>{if(this.service.logger.add({module:EModule.background,event:"service.controller.doDownload.finished",msg:this.service.i18n.t("service.controller.downloadFinished",{name:s.options.name,action:EAction.addTorrentFromURL}),data:g}),!a.title&&this.torrentInfosCache[a.url]&&(a.title=this.torrentInfosCache[a.url]),g&&(g.code===0||g.success===!1)){if(this.downloadFailedRetry(s,a,u,g,p,y))return;switch(g.msg){case"timeout":y({success:!1,msg:this.service.i18n.t("service.controller.downloadTimeout"),status:"error"});break;default:y({success:!1,msg:g.msg,status:"error"});break}this.saveDownloadHistory(a,u,s.options.id,!1);return}this.saveDownloadHistory(a,u,s.options.id,!0),this.formatSendResult(g,s.options,a).then(x=>{p(x)}).catch(x=>{y(x)}),this.downloadFailedRetriesCache[a.url]&&delete this.downloadFailedRetriesCache[a.url]}).catch(g=>{this.downloadFailedRetry(s,a,u,g,p,y)||(this.service.logger.add({module:EModule.background,event:"service.controller.doDownload.error",msg:this.service.i18n.t("service.controller.downloadError",{name:s.options.name,action:EAction.addTorrentFromURL}),data:g}),this.saveDownloadHistory(a,u,s.options.id,!1),y(g))})})}downloadFailedRetry(s,a,u="",l,h,d){if(this.options.downloadFailedRetry){let p=this.options.downloadFailedFailedRetryCount;p===void 0&&(p=0);let y=this.downloadFailedRetriesCache[a.url];if(y===void 0&&(y=0),y<p)return y++,this.service.logger.add({module:EModule.background,event:"service.controller.downloadFailedRetries",msg:this.service.i18n.t("service.controller.downloadError",{name:s.options.name,action:EAction.addTorrentFromURL})+" ("+y+")",data:l}),this.downloadFailedRetriesCache[a.url]=y,this.options.downloadFailedFailedRetryInterval&&this.options.downloadFailedFailedRetryInterval>0?setTimeout(()=>{this.doDownload(s,a,u).then(g=>{h(g)}).catch(g=>{d(g)})},this.options.downloadFailedFailedRetryInterval*1e3):this.doDownload(s,a,u).then(g=>{h(g)}).catch(g=>{d(g)}),!0;delete this.downloadFailedRetriesCache[a.url]}return!1}getSiteFromHost(s){return this.options.sites.find(a=>{let u=[a.url].concat(a.cdn);return a.host==s||u.join("").indexOf(s)>-1})}getSiteDefaultPath(s,a=""){a||(a=s.defaultClientId||this.options.defaultClientId);let u=this.options.clients.find(h=>h.id===a),l="";if(u&&u.paths){for(const h in u.paths)if(s.host===h){l=u.paths[h][0];break}}return l}formatSendResult(s,a,u){return new Promise((l,h)=>{let d={type:EDataResultType.success,msg:this.service.i18n.t("service.controller.torrentAdded",{title:u.title})+(u.savePath?this.service.i18n.t("service.controller.torrentSavePath",{path:u.savePath,interpolation:{escapeValue:!1}}):""),success:!0,data:s};switch(a.type){case EDownloadClientType.transmission:if(s.id!=null)d.msg=this.service.i18n.t("service.controller.transmissionSuccess",{data:s}),u.savePath&&(d.msg+=this.service.i18n.t("service.controller.torrentSavePath",{path:u.savePath,interpolation:{escapeValue:!1}}));else if(s.status)switch(s.status){case"duplicate":d.type=EDataResultType.error,d.success=!1,d.msg=this.service.i18n.t("service.controller.transmissionDuplicate",{name:s.torrent.name,id:s.torrent.id});break;case"error":d.type=EDataResultType.error,d.success=!1,d.msg=this.service.i18n.t("service.controller.transmissionError");break;default:d.msg=s.msg;break}else d.msg=s;break}l(d)})}getClient(s){return this.clientController.getClient(s)}initDefaultClient(){if(!this.options.clients)return;let s=this.options.clients.find(a=>a.id===this.options.defaultClientId);s&&this.getClient(s).then(a=>{this.defaultClient=a.client,this.defaultClientOptions=a.options})}initSiteDefaultClient(s){let a=this.options.sites.find(l=>l.host==s),u=this.options.clients.find(l=>l.id===a.defaultClientId);return u?this.getClient(u):new Promise((l,h)=>{l({client:this.defaultClient,options:this.defaultClientOptions})})}copyTextToClipboard(s=""){if(!s)return!1;var a=$("<textarea/>");return a.text(s),$("body").append(a),a.select(),document.execCommand("copy"),a.remove(),!0}getFreeSpace(s){return s.clientId?new Promise((a,u)=>{let l=this.options.clients.find(h=>h.id===s.clientId);l&&this.getClient(l).then(h=>{h.client.call(EAction.getFreeSpace,s).then(d=>{a(d)})})}):this.getDefaultClientFreeSpace(s)}getDefaultClientFreeSpace(s){return new Promise((a,u)=>{this.defaultClient.call(EAction.getFreeSpace,s).then(l=>{a(l)})})}updateOptionsTabId(s){this.optionsTabId=s}searchTorrent(s="",a=""){let u="";s&&(u=`search-torrent/${s}`),a&&(u+=`/${a}`),this.openOptions(u)}openOptions(s=""){let a="/";s&&(a+=s),this.optionsTabId==0?this.openURL(a):chrome.tabs.get(this.optionsTabId,u=>{!chrome.runtime.lastError&&u?chrome.tabs.update(u.id,{active:!0,url:"index.html#"+a}):this.openURL(a)})}openURL(s=""){s&&(s.substr(0,1)==="/"&&(s="index.html#"+s),chrome.tabs.create({url:s},a=>{this.optionsTabId=a.id}))}getSiteSchema(s){let a={};if(typeof s.schema=="string")a=this.options.system&&this.options.system.schemas&&this.options.system.schemas.find(u=>u.name==s.schema);else{let u=this.options.system&&this.options.system.sites&&this.options.system.sites.find(l=>l.host==u.host);u&&u.schema&&(a=u.schema,a.siteOnly=!0)}return a}replaceKeys(s,a){let u=s;for(const l in a)if(a.hasOwnProperty(l)){const h=a[l];u=u.replace("$"+l+"$",h)}return u}call(s,a){return new Promise((u,l)=>{let h=this;console.log("contorller.call",s.action),h[s.action](s.data,a).then(d=>{u(d)}).catch(d=>{l(d)})})}addContentPage(s,a){return new Promise((u,l)=>{try{a.tab&&this.contentPages.push(a.tab.id),u()}catch(h){l(h)}})}backupToGoogle(){return this.service.config.backupToGoogle()}restoreFromGoogle(){return this.service.config.restoreFromGoogle()}clearFromGoogle(){return this.service.config.syncStorage.clear()}reloadConfig(){return new Promise((s,a)=>{this.service.config.reload(),s()})}getTorrentDataFromURL(s){return console.log("getTorrentDataFromURL",s),new Promise((a,u)=>{let l="";typeof s=="string"?(l=s,s={url:l,parseTorrent:!1}):l=s.url;let h=this.getSiteOptionsFromURL(l),d=ERequestMethod.GET;if(h)switch(d=h.downloadMethod||ERequestMethod.GET,h.name){case"M-Team":let y=PPF.getIdFromMTURL(l);if(console.log(`getTorrentDataFromURL.M-Team ${l} -> ${y}`,s),y)if(parseInt(y)){let g=PPF.resolveMTDownloadURL(y,h);console.log(`getTorrentDataFromURL.M-Team1 ${l} -> ${g}`,s),l=g}else console.log(`getTorrentDataFromURL.M-Team2 ${l}, id 链接可能已是直链, 不进行转换...`,s);else u(APP.createErrorMessage(this.service.i18n.t("service.controller.invalidTorrent",{link:EWikiLink.faq})));break}let p=new FileDownloader({url:l,getDataOnly:!0,timeout:this.service.options.connectClientTimeout});p.requestMethod=d,p.onCompleted=()=>{console.log("getTorrentDataFromURL.completed",l),p.content&&/octet-stream|x-bittorrent/gi.test(p.content.type)?parseTorrentRemote(p.content,(y,g)=>{y?(console.log("parse.error",y),s.parseTorrent?u(y):a(p.content)):(g&&(this.torrentInfosCache[l]=g.name),s.parseTorrent?a({url:l,torrent:g,content:p.content}):a(p.content))}):u(APP.createErrorMessage(this.service.i18n.t("service.controller.invalidTorrent",{link:EWikiLink.faq})))},p.onError=y=>{u(APP.createErrorMessage(y))},p.start()})}getSiteOptionsFromURL(s){let a=new URLParse(s).host;return this.options.system&&this.options.system.sites&&this.options.system.sites.find(l=>l.host==a)}getUserInfoForAllSite(){return new Promise((s,a)=>{let u=0,l=0,h=[];this.options.sites.forEach(d=>{d.allowGetUserInfo&&(u++,this.getUserInfo(d).then(p=>{p&&h.push({site:d,user:p}),l++,l>=u&&s(h)}).catch(()=>{l++,l>=u&&s(h)}))}),l==u&&l==0&&a(this.service.i18n.t("service.controller.getUserInfoSiteIsEmpty"))})}getUserInfo(s){return this.userService.getUserInfo(s)}abortGetUserInfo(s){return this.userService.abortGetUserInfo(s)}getBase64FromImageUrl(s){return new Promise((a,u)=>{let l=this.imageBase64Cache[s];if(l){a(l);return}let h=new FileDownloader({url:s,getDataOnly:!0,timeout:this.service.options.connectClientTimeout});h.onCompleted=()=>{if(console.log("getBase64FromImageUrl.completed",s),h.content&&/image/gi.test(h.content.type)){var d=new FileReader;d.onloadend=()=>{this.imageBase64Cache[s]=d.result,a(d.result)},d.readAsDataURL(h.content)}else u(APP.createErrorMessage(this.service.i18n.t("service.controller.invalidImage")))},h.onError=d=>{u(APP.createErrorMessage(d))},h.start()})}getUserHistoryData(s){return new Promise((a,u)=>{let l=this.service.userData.get(s,EUserDataRange.all);a(l)})}resetUserDatas(s){return new Promise((a,u)=>{this.service.userData.reset(s),setTimeout(()=>{this.service.userData.upgrade().then(l=>{console.log("升级站点数据完成")}).catch(l=>{console.error("升级站点数据失败",l)})},1e3),a()})}getMovieInfos(s){return this.movieInfoService.getInfos(s)}getMovieRatings(s){return this.movieInfoService.getRatings(s)}getIMDbIdFromDouban(s){return this.movieInfoService.getIMDbIdFromDouban(s)}queryMovieInfoFromDouban(s){return this.movieInfoService.queryMovieInfoFromDouban(s.key,s.count)}addBrowserDownloads(s){return new Promise((a,u)=>{this.service.checkPermissions(["downloads"]).then(()=>{let l=[];Array.isArray(s)?l=s:l.push(s),l.forEach(h=>{chrome.downloads.download(h,function(d){console.log(d)})}),a(l.length)}).catch(()=>{u({success:!1,msg:this.service.i18n.t("service.controller.noPermission")})})})}getCurrentLanguageResource(s){return new Promise((a,u)=>{let l=this.service.options.locale||"en",h=this.service.i18n.i18next.getResourceBundle(l,"translation");h?s&&h[s]?a(h[s]):a(h):u()})}addLanguage(s){return this.service.i18n.add(s)}replaceLanguage(s){return this.service.i18n.replace(s)}backupToServer(s){return this.service.config.backupToServer(s)}getBackupListFromServer(s={}){const a=s.server;return delete s.server,this.service.config.getBackupListFromServer(a,s)}restoreFromServer(s={}){return this.service.config.restoreFromServer(s.server,s.path)}deleteFileFromBackupServer(s={}){return this.service.config.deleteFileFromBackupServer(s.server,s.path)}sendTorrentsInBackground(s=[]){return new Promise((a,u)=>{this.service.downloadQuene.add(s).run(),a(this.service.i18n.t("service.controller.downloadTaskIsCreated",{count:s.length}))})}createBackupFile(s){return this.service.config.createBackupFile(s)}addTorrentToCollection(s){return this.options.defaultCollectionGroupId&&(s.groups=[this.options.defaultCollectionGroupId]),this.service.collection.add(s)}getTorrentCollections(s){return this.service.collection.load(s)}deleteTorrentFromCollention(s){return Array.isArray(s)?this.service.collection.remove(s):this.service.collection.delete(s)}clearTorrentCollention(){return this.service.collection.clear()}getTorrentCollention(s){return this.service.collection.get(s)}getSiteSelectorConfig(s){return new Promise((a,u)=>{const l=this.service.getSiteSelector(s.host,s.name);l?a(l):u(!1)})}resetTorrentCollections(s){return this.service.collection.reset(s)}getTorrentCollectionGroups(){return this.service.collection.getGroups()}addTorrentCollectionGroup(s){return this.service.collection.addGroup(s)}addTorrentCollectionToGroup(s){return this.service.collection.addToGroup(s.item,s.groupId)}updateTorrentCollectionGroup(s){return this.service.collection.updateGroup(s)}removeTorrentCollectionFromGroup(s){return this.service.collection.removeFromGroup(s.item,s.groupId)}removeTorrentCollectionGroup(s){return this.service.collection.removeGroup(s)}updateTorrentCollention(s){return this.service.collection.update(s)}getAllTorrentCollectionLinks(){return new Promise((s,a)=>{const u=this.service.collection.getAllLinks();u?s(u):a(!1)})}restoreCookies(s){return this.service.config.restoreCookies(s)}resetFavicons(){return this.service.config.favicon.clear(),this.service.config.getFavicons()}resetFavicon(s){return this.service.config.getFavicon(s,!0)}getBackupRawData(){return this.service.config.getBackupRawData()}testBackupServerConnectivity(s){return this.service.config.testBackupServerConnectivity(s)}createSearchResultSnapshot(s){return this.service.searchResultSnapshot.add(s)}getSearchResultSnapshot(s){return this.service.searchResultSnapshot.get(s)}loadSearchResultSnapshot(){return this.service.searchResultSnapshot.load()}removeSearchResultSnapshot(s){return this.service.searchResultSnapshot.remove(s)}clearSearchResultSnapshot(){return this.service.searchResultSnapshot.clear()}resetSearchResultSnapshot(s){return this.service.searchResultSnapshot.reset(s)}createKeepUploadTask(s){return this.service.keepUploadTask.add(s)}getKeepUploadTask(s){return this.service.keepUploadTask.get(s)}loadKeepUploadTask(){return this.service.keepUploadTask.load()}removeKeepUploadTask(s){return this.service.keepUploadTask.remove(s)}clearKeepUploadTask(){return this.service.keepUploadTask.clear()}resetKeepUploadTask(s){return this.service.keepUploadTask.reset(s)}updateKeepUploadTask(s){return this.service.keepUploadTask.update(s)}updateDebuggerTabId(s){return new Promise((a,u)=>{this.debuggerTabId=s,this.debuggerPort=chrome.tabs.connect(s,{name:EModule.debugger}),a()})}pushDebugMsg(s){return new Promise((a,u)=>{console.log(s),this.debuggerTabId&&chrome.tabs.get(this.debuggerTabId,l=>{l&&this.debuggerPort&&this.debuggerPort.postMessage({action:EAction.pushDebugMsg,data:s}),chrome.runtime.lastError&&(console.log(chrome.runtime.lastError.message),this.debuggerTabId=0,this.debuggerPort=void 0)}),a()})}getTopSearches(s=9){return this.movieInfoService.getTopSearches(s)}}let Logger$1=class{constructor(){this.maxLength=1e3,this.items=[],this.storage=new localStorage,this.configKey=EConfigKey.systemLogs,this.load()}load(){return new Promise((s,a)=>{this.storage.get(this.configKey,u=>{this.items=u||[],s(this.items)})})}add(s){let a=new Date().getTime(),u=Object.assign({module:"",time:a,id:PPF.getNewId()},s);return this.items?(this.items.length>=this.maxLength&&this.items.splice(0,1),this.items.push(u),this.storage.set(this.configKey,this.items)):this.load().then(()=>{this.items.push(u),this.storage.set(this.configKey,this.items)}),u.id}remove(s){return new Promise((a,u)=>{this.load().then(()=>{for(let l=this.items.length-1;l>=0;l--){let h=this.items[l];s.findIndex(p=>p.id===h.id)>=0&&this.items.splice(l,1)}this.storage.set(this.configKey,this.items),a(this.items)})})}clear(){return new Promise((s,a)=>{this.items=[],this.storage.set(this.configKey,this.items),s(this.items)})}};class PathHandler{constructor(){}replacePathKey(s,a){if(!s)return s;const u=new Date;return this.replaceKeys(s,{"site.name":a.name,"site.host":a.host,YYYY:u.getFullYear(),MM:("0"+(u.getMonth()+1).toString()).substr(-2),DD:("0"+u.getDate().toString()).substr(-2)})}getSavePath(s,a){if(!s)return;let u=s,l="<...>";if(u&&u.indexOf(l)>=0){let h=window.prompt(`当前为自定义路径：${u} 
请输入路径中 ${l} 部分的内容: `);if(h===null)return!1;u=u.replace(l,h)}return this.replacePathKey(u,a)}replaceKeys(s,a){let u=s;for(const l in a)if(a.hasOwnProperty(l)){const h=a[l];u=u.replace("$"+l+"$",h)}return u}}class ContextMenus{constructor(f){this.service=f,this.options={sites:[],clients:[]},this.rootId="PT-Plugin-Plugin-Content-Menu",this.currentTabId=0,this.siteMenus=[],this.pathHandler=new PathHandler,chrome&&chrome.tabs&&this.initBrowserEvent()}initBrowserEvent(){chrome.tabs.onActivated.addListener(f=>{chrome.tabs.get(f.tabId,s=>{if(this.clearSiteMenus(),s.url){let a=new URLParse(s.url).host;this.createSiteMenus(a)}})}),chrome.tabs.onUpdated.addListener((f,s,a)=>{if(this.clearSiteMenus(),a.url){let u=new URLParse(a.url).host;this.createSiteMenus(u)}}),chrome.browserAction.onClicked.addListener(()=>{this.service.controller.openOptions()})}init(f){this.options=f,this.clear(),this.createSearchMenus(),this.createClientMenus(),this.createPluginIconPopupMenus()}createPluginIconPopupMenus(){this.add({title:this.service.i18n.t("service.contextMenus.history"),contexts:["browser_action"],onclick:()=>{chrome.tabs.create({url:"index.html#/history"})}}),this.add({title:this.service.i18n.t("service.contextMenus.systemLog"),contexts:["browser_action"],onclick:()=>{chrome.tabs.create({url:"index.html#/system-logs"})}}),this.add({type:"separator",contexts:["browser_action"]}),this.add({title:this.service.i18n.t("service.contextMenus.issues"),contexts:["browser_action"],onclick:()=>{chrome.tabs.create({url:"https://github.com/pt-plugins/PT-Plugin-Plus/issues/new"})}})}clear(){chrome&&chrome.contextMenus&&chrome.contextMenus.removeAll()}clearSiteMenus(){this.siteMenus.forEach(f=>{this.remove(f)}),this.siteMenus=[]}getSiteDocumentUrlPatterns(f){let s=f.url+"";s.substr(-1)!="/"&&(s+="/");let a=[`*://${f.host}/*`,`${s}`];if(f.cdn&&f.cdn.length>0)for(let u=0;u<f.cdn.length;u++){const l=f.cdn[u];a.push(`${l}${l.substr(-1)!="/"?"/*":"*"}`,l)}return a}createPathMenus(f,s,a,u){f.forEach((l,h)=>{let d=`${a.id}**${s.host}**${l}**${h}`;this.add({id:d,title:this.pathHandler.replacePathKey(l,s),parentId:u,contexts:["link"],documentUrlPatterns:this.getSiteDocumentUrlPatterns(s),targetUrlPatterns:this.getSiteUrlPatterns(s),onclick:(p,y)=>{let g=p.menuItemId.split("**"),x={clientId:g[0],url:p.linkUrl,savePath:g[2]};this.sendTorrentToClient(y.id,x)}})})}createSiteMenus(f){let s=this.options.sites.find(a=>{let u=[a.url].concat(a.cdn);return a.host===f||u.join("|").indexOf(f)>-1});if(s){if(this.options.allowSelectionTextSearch){let a=s.host;this.siteMenus.push(a),this.add({id:a,title:this.service.i18n.t("service.contextMenus.searchSelectionTextOnThisSite"),contexts:["selection"],documentUrlPatterns:this.getSiteDocumentUrlPatterns(s),onclick:(u,l)=>{this.service.controller.searchTorrent(u.selectionText,f)}})}this.options.clients.forEach(a=>{if(a.paths){let u=`${a.id}-path`,l=0;this.add({id:u,title:this.service.i18n.t("service.contextMenus.downloadClientPath",{clientName:a.name}),contexts:["link"],documentUrlPatterns:this.getSiteDocumentUrlPatterns(s),targetUrlPatterns:this.getSiteUrlPatterns(s)});for(const d in a.paths){let p=a.paths[d];d===s.host&&(l++,this.createPathMenus(p,s,a,u))}let h=a.paths[ECommonKey.allSite];h&&(l++,this.createPathMenus(h,s,a,u)),l>0?this.siteMenus.push(u):this.remove(u)}})}}getSiteUrlPatterns(f){let s=[];if(f.patterns&&f.patterns.torrentLinks)s=f.patterns.torrentLinks;else{let a=this.getSiteSchema(f);a&&a.patterns&&a.patterns.torrentLinks?s=a.patterns.torrentLinks:s.push("*://*/*")}return s}getSiteSchema(f){let s={};return typeof f.schema=="string"&&(s=this.options.system&&this.options.system.schemas&&this.options.system.schemas.find(a=>a.name==f.schema)),s}sendTorrentToClient(f=0,s){console.log("sendTorrentToClient",s);let a=this.getSiteFromURL(s.url);if(a&&s.savePath){let d=this.pathHandler.getSavePath(s.savePath,a);if(d===!1){APP.showNotifications({message:this.service.i18n.t("service.contextMenus.userCanceled")});return}s.savePath=d}let u;try{chrome.tabs.sendMessage(f,{action:EAction.showMessage,data:{type:EDataResultType.info,msg:this.service.i18n.t("service.contextMenus.sendingLink"),timeout:2,indeterminate:!0}},d=>{if(chrome.runtime.lastError){(chrome.runtime.lastError.message||"").match(/Could not establish connection/)?APP.showNotifications({message:this.service.i18n.t("service.contextMenus.pluginStatusIsUnknown")}):APP.showNotifications({message:chrome.runtime.lastError.message});return}u=d})}catch(d){APP.showNotifications({message:d});return}this.service.logger.add({module:EModule.background,event:"contextMenus.sendTorrentToClient.begin",msg:this.service.i18n.t("service.contextMenus.sendingLink"),data:s});let l=this.options.clients.find(d=>d.id===s.clientId);if(!l){chrome.tabs.sendMessage(f,{action:EAction.showMessage,data:{type:EDataResultType.error,msg:this.service.i18n.t("service.contextMenus.downloadClientGetFailed")}}),this.service.logger.add({module:EModule.background,event:"contextMenus.sendTorrentToClient.getClientError",msg:this.service.i18n.t("service.contextMenus.downloadClientGetFailed"),data:s}),this.hideNotice(f,u);return}s.autoStart=l.autoStart,console.log(s);let h=this.getParsedURL(s.url);if(typeof h!="string"){chrome.tabs.sendMessage(f,{action:EAction.showMessage,data:h}),this.hideNotice(f,u);return}s.url=h,this.service.controller.sendTorrentToClient(s).then(d=>{this.service.logger.add({module:EModule.background,event:"contextMenus.sendTorrentToClient.done",msg:this.service.i18n.t("service.contextMenus.sendTorrentToClientDone"),data:d}),chrome.tabs.sendMessage(f,{action:EAction.showMessage,data:d})}).catch(d=>{this.service.logger.add({module:EModule.background,event:"contextMenus.sendTorrentToClient.error",msg:this.service.i18n.t("service.contextMenus.sendTorrentToClientError"),data:d}),chrome.tabs.sendMessage(f,{action:EAction.showMessage,data:d.status==""?this.service.i18n.t("service.contextMenus.sendTorrentToClientError"):d})}).finally(()=>{this.hideNotice(f,u)})}hideNotice(f=0,s){s&&(s.id?chrome.tabs.sendMessage(f,{action:EAction.hideMessage,data:s.id}):s.hide&&s.hide())}createSearchMenus(){this.options.allowSelectionTextSearch&&(this.add({title:this.service.i18n.t("service.contextMenus.searchSelectionText"),contexts:["selection"],onclick:(a,u)=>{this.service.controller.searchTorrent(a.selectionText)}}),this.pushMoreSearchMenus());let f="searchWithIMDb";this.add({id:f,title:this.service.i18n.t("service.contextMenus.searchByIMDb"),contexts:["link"],targetUrlPatterns:["*://www.imdb.com/title/tt*"]}),this.add({parentId:f,title:this.service.i18n.t("service.contextMenus.searchByDefault"),contexts:["link"],targetUrlPatterns:["*://www.imdb.com/title/tt*"],onclick:(a,u)=>{if(a.linkUrl){let l=a.linkUrl.match(/(tt\d+)/);l&&l.length>=2&&this.service.controller.searchTorrent(l[1])}}}),this.pushMoreSearchMenus(f,["link"],["*://www.imdb.com/title/tt*"],/(tt\d+)/);let s="searchWithDouban";this.add({id:s,title:this.service.i18n.t("service.contextMenus.searchByDouban"),contexts:["link"],targetUrlPatterns:["*://movie.douban.com/subject/*"]}),this.add({parentId:s,title:this.service.i18n.t("service.contextMenus.searchByDefault"),contexts:["link"],targetUrlPatterns:["*://movie.douban.com/subject/*"],onclick:(a,u)=>{if(a.linkUrl){let l=a.linkUrl.match(/subject\/(\d+)/);l&&l.length>=2&&this.service.controller.searchTorrent("douban"+l[1])}}}),this.pushMoreSearchMenus(s,["link"],["*://movie.douban.com/subject/*"],/subject\/(\d+)/,"douban")}pushMoreSearchMenus(f=void 0,s=["selection"],a=void 0,u=/(tt\d+)/,l=""){const h=this.options.sites;if(h&&h.length>0){let p=`${f}searchInSite`;this.add({id:p,title:this.service.i18n.t("service.contextMenus.searchInSite"),contexts:s,parentId:f,targetUrlPatterns:a}),h.forEach(y=>{let g=`${p}**${y.host}`;this.add({id:g,title:`${y.name} - ${y.host}`,parentId:p,contexts:s,targetUrlPatterns:a,onclick:(x,C)=>{let m=x.menuItemId.split("**");if(this.service.debug(this.service.i18n.t("service.contextMenus.searchInSite"),x),s.includes("link")&&x.linkUrl){let v=x.linkUrl.match(u);v&&v.length>=2&&this.service.controller.searchTorrent(l+v[1],m[1])}else this.service.controller.searchTorrent(x.selectionText,m[1])}})})}const d=this.options.searchSolutions;if(d&&d.length>0){let p=`${f}searchInSolution`;this.add({id:p,title:this.service.i18n.t("service.contextMenus.searchInSolution"),contexts:s,parentId:f,targetUrlPatterns:a}),d.forEach(y=>{let g=`${p}**${y.id}`;this.add({id:g,title:`${y.name}`,parentId:p,contexts:s,targetUrlPatterns:a,onclick:(x,C)=>{this.service.debug(this.service.i18n.t("service.contextMenus.searchInSolution"),x);let m=x.menuItemId.split("**");if(s.includes("link")&&x.linkUrl){let v=x.linkUrl.match(u);v&&v.length>=2&&this.service.controller.searchTorrent(l+v[1],m[1])}else this.service.controller.searchTorrent(x.selectionText,m[1])}})})}this.add({title:this.service.i18n.t("service.contextMenus.searchInAllSite"),parentId:f,contexts:s,targetUrlPatterns:a,onclick:(p,y)=>{if(p.linkUrl){let g=p.linkUrl.match(u);s.includes("link")&&g&&g.length>=2&&this.service.controller.searchTorrent(l+g[1],"all")}else this.service.controller.searchTorrent(p.selectionText,"all")}})}createClientMenus(){let f=this.options.clients.filter(s=>s.enabled!==!1);if(console.log("createClientMenus",this.options.clients),console.log("createClientMenus",f),this.options.defaultClientId){let s=this.options.clients.find(a=>a.id===this.options.defaultClientId);s&&this.add({id:s.id,title:this.service.i18n.t("service.contextMenus.sendTorrentToDefaultClient",{client:s}),contexts:["link"],onclick:(a,u)=>{this.sendTorrentToClient(u.id,{clientId:a.menuItemId,url:a.linkUrl})}})}f.length>1&&(this.add({id:this.rootId,title:this.service.i18n.t("service.contextMenus.sendTorrentToClient"),contexts:["link"]}),f.forEach(s=>{s.id!==this.options.defaultClientId&&this.add({id:s.id,title:`${s.name} -> ${s.address}`,parentId:this.rootId,contexts:["link"],onclick:(a,u)=>{this.sendTorrentToClient(u.id,{clientId:a.menuItemId,url:a.linkUrl})}})}))}add(f,s){f.id||(f.id=this.getRandomString()),chrome&&chrome.contextMenus&&chrome.contextMenus.create(f,s)}remove(f,s){try{chrome.contextMenus.remove(f,s),chrome.runtime.lastError&&console.log(chrome.runtime.lastError)}catch(a){console.log(a)}}getRandomString(f=16,s=!0){let a=s?"abcdefhijkmnprstwxyz2345678ABCDEFGHJKMNPQRSTWXYZ":"abcdefghijkmnopqrstuvwxyz0123456789ABCDEFGHIJKMNOPQRSTUVWXYZ",u=a.length,l=[];for(let h=0;h<f;h++)l.push(a.charAt(Math.floor(Math.random()*u)));return l.join("")}getParsedURL(source){let url=new URLParse(source),site=this.getSiteFromURL(source);if(!site)return source;let options={url,site,result:source,error:{}},parser=this.getSiteParser(site.host,"downloadURL");if(parser)try{eval(parser)}catch(f){console.error(f)}return options.error&&options.error.msg?options.error:options.result}getSiteParser(f,s){let a=this.options.system&&this.options.system.sites&&this.options.system.sites.find(l=>l.host===f);if(!a)return"";let u=a.parser&&a.parser[s];if(!u){let l=this.options.system&&this.options.system.schemas&&this.options.system.schemas.find(h=>h.name===a.schema);l&&l.parser&&(u=l.parser[s])}return u}getSiteFromURL(f){let s=new URLParse(f);if(!s.host)return null;let a=this.options.sites.find(u=>{let l=[u.url].concat(u.cdn);return u.host==s.host||l.join("").indexOf(s.host)>-1});return a||null}}class UserData{constructor(s){this.service=s,this.items=null,this.storage=new localStorage,this.configKey=EConfigKey.userDatas,this.load()}load(){return new Promise((s,a)=>{this.storage.get(this.configKey,u=>{console.log("UserData.load",u),this.items=u||{},s(this.items)})})}get(s,a=EUserDataRange.latest){if(!this.items)return null;if(!s)return this.items;let u=this.items[s];if(!u)return null;switch(a){case EUserDataRange.all:return u;case EUserDataRange.today:return u[PPF.getToDay()]}return u[EUserDataRange.latest]}update(s,a){let u=s.host;if(!u)return;let l=Object.assign({},a);if(this.items==null)this.load().then(()=>{this.update(s,a)});else{let h=this.items[u],d=PPF.getToDay();h||(h={}),h[d]=l,h[EUserDataRange.latest]=l,this.items[u]=h,this.storage.set(this.configKey,this.items).then(()=>{this.service.saveUserData()})}}clear(){return new Promise((s,a)=>{this.items={},this.storage.set(this.configKey,this.items).then(()=>{this.service.saveUserData(),s(this.items)})})}upgrade(){return new Promise((s,a)=>{if(this.service.options&&this.service.options.system&&this.service.options.system.sites){let u=this.service.options.system.sites;this.load().then(l=>{l?(u.forEach(h=>{if(!h.host)return;let d=h.formerHosts,p=h.host;d&&d.length>0&&d.forEach(y=>{for(const g in l)if(g==y&&l.hasOwnProperty(g)){const x=l[g];l[p]=Object.assign({},x),delete l[g]}})}),this.items=l,this.storage.set(this.configKey,l),this.service.saveUserData(),s(l)):a(null)})}else a(null)})}reset(s){this.items=s,this.storage.set(this.configKey,this.items).then(()=>{this.service.saveUserData()})}}class OmniBox{constructor(s){this.service=s,this.splitString=" → ",this.initEvents()}init(){}initEvents(){chrome&&chrome.omnibox&&(chrome.omnibox.onInputChanged.addListener((s,a)=>{if(s&&this.service.options.searchSolutions){let u=[];this.service.options.searchSolutions.forEach(l=>{u.push({content:`${l.name}${this.splitString}${s}`,description:this.service.i18n.t("service.omnibox.search",{solutionName:l.name,text:s})})}),u.length>0&&a(u)}}),chrome.omnibox.onInputEntered.addListener(s=>{let a="",u="",l="";if(s.indexOf(this.splitString)!=-1){if([a,l]=s.split(this.splitString),a&&this.service.options.searchSolutions){let h=this.service.options.searchSolutions.find(d=>d.name==a);h&&(u=h.id)}}else l=s;chrome.tabs.create({url:"index.html#/search-torrent/"+l+(u?`/${u}`:"")})}))}}function _typeof(f){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},_typeof(f)}function _classCallCheck(f,s){if(!(f instanceof s))throw new TypeError("Cannot call a class as a function")}function _toPrimitive(f,s){if(_typeof(f)!=="object"||f===null)return f;var a=f[Symbol.toPrimitive];if(a!==void 0){var u=a.call(f,s||"default");if(_typeof(u)!=="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(f)}function _toPropertyKey(f){var s=_toPrimitive(f,"string");return _typeof(s)==="symbol"?s:String(s)}function _defineProperties(f,s){for(var a=0;a<s.length;a++){var u=s[a];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(f,_toPropertyKey(u.key),u)}}function _createClass(f,s,a){return s&&_defineProperties(f.prototype,s),a&&_defineProperties(f,a),Object.defineProperty(f,"prototype",{writable:!1}),f}function _assertThisInitialized(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}function _setPrototypeOf(f,s){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(u,l){return u.__proto__=l,u},_setPrototypeOf(f,s)}function _inherits(f,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(s&&s.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),Object.defineProperty(f,"prototype",{writable:!1}),s&&_setPrototypeOf(f,s)}function _possibleConstructorReturn(f,s){if(s&&(_typeof(s)==="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(f)}function _getPrototypeOf(f){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},_getPrototypeOf(f)}function _defineProperty(f,s,a){return s=_toPropertyKey(s),s in f?Object.defineProperty(f,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):f[s]=a,f}function _arrayWithHoles(f){if(Array.isArray(f))return f}function _iterableToArray(f){if(typeof Symbol<"u"&&f[Symbol.iterator]!=null||f["@@iterator"]!=null)return Array.from(f)}function _arrayLikeToArray(f,s){(s==null||s>f.length)&&(s=f.length);for(var a=0,u=new Array(s);a<s;a++)u[a]=f[a];return u}function _unsupportedIterableToArray(f,s){if(f){if(typeof f=="string")return _arrayLikeToArray(f,s);var a=Object.prototype.toString.call(f).slice(8,-1);if(a==="Object"&&f.constructor&&(a=f.constructor.name),a==="Map"||a==="Set")return Array.from(f);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return _arrayLikeToArray(f,s)}}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _toArray(f){return _arrayWithHoles(f)||_iterableToArray(f)||_unsupportedIterableToArray(f)||_nonIterableRest()}function ownKeys(f,s){var a=Object.keys(f);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(f);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(f,l).enumerable})),a.push.apply(a,u)}return a}function _objectSpread(f){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?ownKeys(Object(a),!0).forEach(function(u){_defineProperty(f,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach(function(u){Object.defineProperty(f,u,Object.getOwnPropertyDescriptor(a,u))})}return f}var consoleLogger={type:"logger",log:function f(s){this.output("log",s)},warn:function f(s){this.output("warn",s)},error:function f(s){this.output("error",s)},output:function f(s,a){console&&console[s]&&console[s].apply(console,a)}},Logger=function(){function f(s){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};_classCallCheck(this,f),this.init(s,a)}return _createClass(f,[{key:"init",value:function(a){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=u.prefix||"i18next:",this.logger=a||consoleLogger,this.options=u,this.debug=u.debug}},{key:"setDebug",value:function(a){this.debug=a}},{key:"log",value:function(){for(var a=arguments.length,u=new Array(a),l=0;l<a;l++)u[l]=arguments[l];return this.forward(u,"log","",!0)}},{key:"warn",value:function(){for(var a=arguments.length,u=new Array(a),l=0;l<a;l++)u[l]=arguments[l];return this.forward(u,"warn","",!0)}},{key:"error",value:function(){for(var a=arguments.length,u=new Array(a),l=0;l<a;l++)u[l]=arguments[l];return this.forward(u,"error","")}},{key:"deprecate",value:function(){for(var a=arguments.length,u=new Array(a),l=0;l<a;l++)u[l]=arguments[l];return this.forward(u,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(a,u,l,h){return h&&!this.debug?null:(typeof a[0]=="string"&&(a[0]="".concat(l).concat(this.prefix," ").concat(a[0])),this.logger[u](a))}},{key:"create",value:function(a){return new f(this.logger,_objectSpread(_objectSpread({},{prefix:"".concat(this.prefix,":").concat(a,":")}),this.options))}},{key:"clone",value:function(a){return a=a||this.options,a.prefix=a.prefix||this.prefix,new f(this.logger,a)}}]),f}(),baseLogger=new Logger,EventEmitter=function(){function f(){_classCallCheck(this,f),this.observers={}}return _createClass(f,[{key:"on",value:function(a,u){var l=this;return a.split(" ").forEach(function(h){l.observers[h]=l.observers[h]||[],l.observers[h].push(u)}),this}},{key:"off",value:function(a,u){if(this.observers[a]){if(!u){delete this.observers[a];return}this.observers[a]=this.observers[a].filter(function(l){return l!==u})}}},{key:"emit",value:function(a){for(var u=arguments.length,l=new Array(u>1?u-1:0),h=1;h<u;h++)l[h-1]=arguments[h];if(this.observers[a]){var d=[].concat(this.observers[a]);d.forEach(function(y){y.apply(void 0,l)})}if(this.observers["*"]){var p=[].concat(this.observers["*"]);p.forEach(function(y){y.apply(y,[a].concat(l))})}}}]),f}();function defer(){var f,s,a=new Promise(function(u,l){f=u,s=l});return a.resolve=f,a.reject=s,a}function makeString(f){return f==null?"":""+f}function copy(f,s,a){f.forEach(function(u){s[u]&&(a[u]=s[u])})}function getLastOfPath(f,s,a){function u(p){return p&&p.indexOf("###")>-1?p.replace(/###/g,"."):p}function l(){return!f||typeof f=="string"}for(var h=typeof s!="string"?[].concat(s):s.split(".");h.length>1;){if(l())return{};var d=u(h.shift());!f[d]&&a&&(f[d]=new a),Object.prototype.hasOwnProperty.call(f,d)?f=f[d]:f={}}return l()?{}:{obj:f,k:u(h.shift())}}function setPath(f,s,a){var u=getLastOfPath(f,s,Object),l=u.obj,h=u.k;l[h]=a}function pushPath(f,s,a,u){var l=getLastOfPath(f,s,Object),h=l.obj,d=l.k;h[d]=h[d]||[],u&&(h[d]=h[d].concat(a)),u||h[d].push(a)}function getPath(f,s){var a=getLastOfPath(f,s),u=a.obj,l=a.k;if(u)return u[l]}function getPathWithDefaults(f,s,a){var u=getPath(f,a);return u!==void 0?u:getPath(s,a)}function deepExtend(f,s,a){for(var u in s)u!=="__proto__"&&u!=="constructor"&&(u in f?typeof f[u]=="string"||f[u]instanceof String||typeof s[u]=="string"||s[u]instanceof String?a&&(f[u]=s[u]):deepExtend(f[u],s[u],a):f[u]=s[u]);return f}function regexEscape(f){return f.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var _entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function escape$1(f){return typeof f=="string"?f.replace(/[&<>"'\/]/g,function(s){return _entityMap[s]}):f}var isIE10=typeof window<"u"&&window.navigator&&typeof window.navigator.userAgentData>"u"&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1,chars=[" ",",","?","!",";"];function looksLikeObjectPath(f,s,a){s=s||"",a=a||"";var u=chars.filter(function(p){return s.indexOf(p)<0&&a.indexOf(p)<0});if(u.length===0)return!0;var l=new RegExp("(".concat(u.map(function(p){return p==="?"?"\\?":p}).join("|"),")")),h=!l.test(f);if(!h){var d=f.indexOf(a);d>0&&!l.test(f.substring(0,d))&&(h=!0)}return h}function ownKeys$1(f,s){var a=Object.keys(f);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(f);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(f,l).enumerable})),a.push.apply(a,u)}return a}function _objectSpread$1(f){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?ownKeys$1(Object(a),!0).forEach(function(u){_defineProperty(f,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(a)):ownKeys$1(Object(a)).forEach(function(u){Object.defineProperty(f,u,Object.getOwnPropertyDescriptor(a,u))})}return f}function _createSuper(f){var s=_isNativeReflectConstruct();return function(){var u=_getPrototypeOf(f),l;if(s){var h=_getPrototypeOf(this).constructor;l=Reflect.construct(u,arguments,h)}else l=u.apply(this,arguments);return _possibleConstructorReturn(this,l)}}function _isNativeReflectConstruct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function deepFind(f,s){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(f){if(f[s])return f[s];for(var u=s.split(a),l=f,h=0;h<u.length;++h){if(!l||typeof l[u[h]]=="string"&&h+1<u.length)return;if(l[u[h]]===void 0){for(var d=2,p=u.slice(h,h+d).join(a),y=l[p];y===void 0&&u.length>h+d;)d++,p=u.slice(h,h+d).join(a),y=l[p];if(y===void 0)return;if(y===null)return null;if(s.endsWith(p)){if(typeof y=="string")return y;if(p&&typeof y[p]=="string")return y[p]}var g=u.slice(h+d).join(a);return g?deepFind(y,g,a):void 0}l=l[u[h]]}return l}}var ResourceStore=function(f){_inherits(a,f);var s=_createSuper(a);function a(u){var l,h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};return _classCallCheck(this,a),l=s.call(this),isIE10&&EventEmitter.call(_assertThisInitialized(l)),l.data=u||{},l.options=h,l.options.keySeparator===void 0&&(l.options.keySeparator="."),l.options.ignoreJSONStructure===void 0&&(l.options.ignoreJSONStructure=!0),l}return _createClass(a,[{key:"addNamespaces",value:function(l){this.options.ns.indexOf(l)<0&&this.options.ns.push(l)}},{key:"removeNamespaces",value:function(l){var h=this.options.ns.indexOf(l);h>-1&&this.options.ns.splice(h,1)}},{key:"getResource",value:function(l,h,d){var p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},y=p.keySeparator!==void 0?p.keySeparator:this.options.keySeparator,g=p.ignoreJSONStructure!==void 0?p.ignoreJSONStructure:this.options.ignoreJSONStructure,x=[l,h];d&&typeof d!="string"&&(x=x.concat(d)),d&&typeof d=="string"&&(x=x.concat(y?d.split(y):d)),l.indexOf(".")>-1&&(x=l.split("."));var C=getPath(this.data,x);return C||!g||typeof d!="string"?C:deepFind(this.data&&this.data[l]&&this.data[l][h],d,y)}},{key:"addResource",value:function(l,h,d,p){var y=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1},g=this.options.keySeparator;g===void 0&&(g=".");var x=[l,h];d&&(x=x.concat(g?d.split(g):d)),l.indexOf(".")>-1&&(x=l.split("."),p=h,h=x[1]),this.addNamespaces(h),setPath(this.data,x,p),y.silent||this.emit("added",l,h,d,p)}},{key:"addResources",value:function(l,h,d){var p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(var y in d)(typeof d[y]=="string"||Object.prototype.toString.apply(d[y])==="[object Array]")&&this.addResource(l,h,y,d[y],{silent:!0});p.silent||this.emit("added",l,h,d)}},{key:"addResourceBundle",value:function(l,h,d,p,y){var g=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1},x=[l,h];l.indexOf(".")>-1&&(x=l.split("."),p=d,d=h,h=x[1]),this.addNamespaces(h);var C=getPath(this.data,x)||{};p?deepExtend(C,d,y):C=_objectSpread$1(_objectSpread$1({},C),d),setPath(this.data,x,C),g.silent||this.emit("added",l,h,d)}},{key:"removeResourceBundle",value:function(l,h){this.hasResourceBundle(l,h)&&delete this.data[l][h],this.removeNamespaces(h),this.emit("removed",l,h)}},{key:"hasResourceBundle",value:function(l,h){return this.getResource(l,h)!==void 0}},{key:"getResourceBundle",value:function(l,h){return h||(h=this.options.defaultNS),this.options.compatibilityAPI==="v1"?_objectSpread$1(_objectSpread$1({},{}),this.getResource(l,h)):this.getResource(l,h)}},{key:"getDataByLanguage",value:function(l){return this.data[l]}},{key:"hasLanguageSomeTranslations",value:function(l){var h=this.getDataByLanguage(l),d=h&&Object.keys(h)||[];return!!d.find(function(p){return h[p]&&Object.keys(h[p]).length>0})}},{key:"toJSON",value:function(){return this.data}}]),a}(EventEmitter),postProcessor={processors:{},addPostProcessor:function f(s){this.processors[s.name]=s},handle:function f(s,a,u,l,h){var d=this;return s.forEach(function(p){d.processors[p]&&(a=d.processors[p].process(a,u,l,h))}),a}};function ownKeys$2(f,s){var a=Object.keys(f);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(f);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(f,l).enumerable})),a.push.apply(a,u)}return a}function _objectSpread$2(f){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?ownKeys$2(Object(a),!0).forEach(function(u){_defineProperty(f,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(a)):ownKeys$2(Object(a)).forEach(function(u){Object.defineProperty(f,u,Object.getOwnPropertyDescriptor(a,u))})}return f}function _createSuper$1(f){var s=_isNativeReflectConstruct$1();return function(){var u=_getPrototypeOf(f),l;if(s){var h=_getPrototypeOf(this).constructor;l=Reflect.construct(u,arguments,h)}else l=u.apply(this,arguments);return _possibleConstructorReturn(this,l)}}function _isNativeReflectConstruct$1(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var checkedLoadedFor={},Translator=function(f){_inherits(a,f);var s=_createSuper$1(a);function a(u){var l,h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return _classCallCheck(this,a),l=s.call(this),isIE10&&EventEmitter.call(_assertThisInitialized(l)),copy(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],u,_assertThisInitialized(l)),l.options=h,l.options.keySeparator===void 0&&(l.options.keySeparator="."),l.logger=baseLogger.create("translator"),l}return _createClass(a,[{key:"changeLanguage",value:function(l){l&&(this.language=l)}},{key:"exists",value:function(l){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(l==null)return!1;var d=this.resolve(l,h);return d&&d.res!==void 0}},{key:"extractFromKey",value:function(l,h){var d=h.nsSeparator!==void 0?h.nsSeparator:this.options.nsSeparator;d===void 0&&(d=":");var p=h.keySeparator!==void 0?h.keySeparator:this.options.keySeparator,y=h.ns||this.options.defaultNS||[],g=d&&l.indexOf(d)>-1,x=!this.options.userDefinedKeySeparator&&!h.keySeparator&&!this.options.userDefinedNsSeparator&&!h.nsSeparator&&!looksLikeObjectPath(l,d,p);if(g&&!x){var C=l.match(this.interpolator.nestingRegexp);if(C&&C.length>0)return{key:l,namespaces:y};var m=l.split(d);(d!==p||d===p&&this.options.ns.indexOf(m[0])>-1)&&(y=m.shift()),l=m.join(p)}return typeof y=="string"&&(y=[y]),{key:l,namespaces:y}}},{key:"translate",value:function(l,h,d){var p=this;if(_typeof(h)!=="object"&&this.options.overloadTranslationOptionHandler&&(h=this.options.overloadTranslationOptionHandler(arguments)),h||(h={}),l==null)return"";Array.isArray(l)||(l=[String(l)]);var y=h.returnDetails!==void 0?h.returnDetails:this.options.returnDetails,g=h.keySeparator!==void 0?h.keySeparator:this.options.keySeparator,x=this.extractFromKey(l[l.length-1],h),C=x.key,m=x.namespaces,v=m[m.length-1],w=h.lng||this.language,b=h.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(w&&w.toLowerCase()==="cimode"){if(b){var E=h.nsSeparator||this.options.nsSeparator;return y?(k.res="".concat(v).concat(E).concat(C),k):"".concat(v).concat(E).concat(C)}return y?(k.res=C,k):C}var k=this.resolve(l,h),_=k&&k.res,S=k&&k.usedKey||C,A=k&&k.exactUsedKey||C,P=Object.prototype.toString.apply(_),I=["[object Number]","[object Function]","[object RegExp]"],R=h.joinArrays!==void 0?h.joinArrays:this.options.joinArrays,j=!this.i18nFormat||this.i18nFormat.handleAsObject,q=typeof _!="string"&&typeof _!="boolean"&&typeof _!="number";if(j&&_&&q&&I.indexOf(P)<0&&!(typeof R=="string"&&P==="[object Array]")){if(!h.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");var U=this.options.returnedObjectHandler?this.options.returnedObjectHandler(S,_,_objectSpread$2(_objectSpread$2({},h),{},{ns:m})):"key '".concat(C," (").concat(this.language,")' returned an object instead of string.");return y?(k.res=U,k):U}if(g){var z=P==="[object Array]",L=z?[]:{},N=z?A:S;for(var B in _)if(Object.prototype.hasOwnProperty.call(_,B)){var V="".concat(N).concat(g).concat(B);L[B]=this.translate(V,_objectSpread$2(_objectSpread$2({},h),{joinArrays:!1,ns:m})),L[B]===V&&(L[B]=_[B])}_=L}}else if(j&&typeof R=="string"&&P==="[object Array]")_=_.join(R),_&&(_=this.extendTranslation(_,l,h,d));else{var se=!1,X=!1,oe=h.count!==void 0&&typeof h.count!="string",Q=a.hasDefaultValue(h),ce=oe?this.pluralResolver.getSuffix(w,h.count,h):"",H=h["defaultValue".concat(ce)]||h.defaultValue;!this.isValidLookup(_)&&Q&&(se=!0,_=H),this.isValidLookup(_)||(X=!0,_=C);var W=h.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey,ne=W&&X?void 0:_,ee=Q&&H!==_&&this.options.updateMissing;if(X||se||ee){if(this.logger.log(ee?"updateKey":"missingKey",w,v,C,ee?H:_),g){var fe=this.resolve(C,_objectSpread$2(_objectSpread$2({},h),{},{keySeparator:!1}));fe&&fe.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var _e=[],Ae=this.languageUtils.getFallbackCodes(this.options.fallbackLng,h.lng||this.language);if(this.options.saveMissingTo==="fallback"&&Ae&&Ae[0])for(var ye=0;ye<Ae.length;ye++)_e.push(Ae[ye]);else this.options.saveMissingTo==="all"?_e=this.languageUtils.toResolveHierarchy(h.lng||this.language):_e.push(h.lng||this.language);var Se=function(Fe,Me,De){var O=Q&&De!==_?De:ne;p.options.missingKeyHandler?p.options.missingKeyHandler(Fe,v,Me,O,ee,h):p.backendConnector&&p.backendConnector.saveMissing&&p.backendConnector.saveMissing(Fe,v,Me,O,ee,h),p.emit("missingKey",Fe,v,Me,_)};this.options.saveMissing&&(this.options.saveMissingPlurals&&oe?_e.forEach(function(Pe){p.pluralResolver.getSuffixes(Pe,h).forEach(function(Fe){Se([Pe],C+Fe,h["defaultValue".concat(Fe)]||H)})}):Se(_e,C,H))}_=this.extendTranslation(_,l,h,k,d),X&&_===C&&this.options.appendNamespaceToMissingKey&&(_="".concat(v,":").concat(C)),(X||se)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?_=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?"".concat(v,":").concat(C):C,se?_:void 0):_=this.options.parseMissingKeyHandler(_))}return y?(k.res=_,k):_}},{key:"extendTranslation",value:function(l,h,d,p,y){var g=this;if(this.i18nFormat&&this.i18nFormat.parse)l=this.i18nFormat.parse(l,_objectSpread$2(_objectSpread$2({},this.options.interpolation.defaultVariables),d),p.usedLng,p.usedNS,p.usedKey,{resolved:p});else if(!d.skipInterpolation){d.interpolation&&this.interpolator.init(_objectSpread$2(_objectSpread$2({},d),{interpolation:_objectSpread$2(_objectSpread$2({},this.options.interpolation),d.interpolation)}));var x=typeof l=="string"&&(d&&d.interpolation&&d.interpolation.skipOnVariables!==void 0?d.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables),C;if(x){var m=l.match(this.interpolator.nestingRegexp);C=m&&m.length}var v=d.replace&&typeof d.replace!="string"?d.replace:d;if(this.options.interpolation.defaultVariables&&(v=_objectSpread$2(_objectSpread$2({},this.options.interpolation.defaultVariables),v)),l=this.interpolator.interpolate(l,v,d.lng||this.language,d),x){var w=l.match(this.interpolator.nestingRegexp),b=w&&w.length;C<b&&(d.nest=!1)}d.nest!==!1&&(l=this.interpolator.nest(l,function(){for(var _=arguments.length,S=new Array(_),A=0;A<_;A++)S[A]=arguments[A];return y&&y[0]===S[0]&&!d.context?(g.logger.warn("It seems you are nesting recursively key: ".concat(S[0]," in key: ").concat(h[0])),null):g.translate.apply(g,S.concat([h]))},d)),d.interpolation&&this.interpolator.reset()}var E=d.postProcess||this.options.postProcess,k=typeof E=="string"?[E]:E;return l!=null&&k&&k.length&&d.applyPostProcessor!==!1&&(l=postProcessor.handle(k,l,h,this.options&&this.options.postProcessPassResolved?_objectSpread$2({i18nResolved:p},d):d,this)),l}},{key:"resolve",value:function(l){var h=this,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p,y,g,x,C;return typeof l=="string"&&(l=[l]),l.forEach(function(m){if(!h.isValidLookup(p)){var v=h.extractFromKey(m,d),w=v.key;y=w;var b=v.namespaces;h.options.fallbackNS&&(b=b.concat(h.options.fallbackNS));var E=d.count!==void 0&&typeof d.count!="string",k=E&&!d.ordinal&&d.count===0&&h.pluralResolver.shouldUseIntlApi(),_=d.context!==void 0&&(typeof d.context=="string"||typeof d.context=="number")&&d.context!=="",S=d.lngs?d.lngs:h.languageUtils.toResolveHierarchy(d.lng||h.language,d.fallbackLng);b.forEach(function(A){h.isValidLookup(p)||(C=A,!checkedLoadedFor["".concat(S[0],"-").concat(A)]&&h.utils&&h.utils.hasLoadedNamespace&&!h.utils.hasLoadedNamespace(C)&&(checkedLoadedFor["".concat(S[0],"-").concat(A)]=!0,h.logger.warn('key "'.concat(y,'" for languages "').concat(S.join(", "),`" won't get resolved as namespace "`).concat(C,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),S.forEach(function(P){if(!h.isValidLookup(p)){x=P;var I=[w];if(h.i18nFormat&&h.i18nFormat.addLookupKeys)h.i18nFormat.addLookupKeys(I,w,P,A,d);else{var R;E&&(R=h.pluralResolver.getSuffix(P,d.count,d));var j="".concat(h.options.pluralSeparator,"zero");if(E&&(I.push(w+R),k&&I.push(w+j)),_){var q="".concat(w).concat(h.options.contextSeparator).concat(d.context);I.push(q),E&&(I.push(q+R),k&&I.push(q+j))}}for(var U;U=I.pop();)h.isValidLookup(p)||(g=U,p=h.getResource(P,A,U,d))}}))})}}),{res:p,usedKey:y,exactUsedKey:g,usedLng:x,usedNS:C}}},{key:"isValidLookup",value:function(l){return l!==void 0&&!(!this.options.returnNull&&l===null)&&!(!this.options.returnEmptyString&&l==="")}},{key:"getResource",value:function(l,h,d){var p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(l,h,d,p):this.resourceStore.getResource(l,h,d,p)}}],[{key:"hasDefaultValue",value:function(l){var h="defaultValue";for(var d in l)if(Object.prototype.hasOwnProperty.call(l,d)&&h===d.substring(0,h.length)&&l[d]!==void 0)return!0;return!1}}]),a}(EventEmitter);function capitalize(f){return f.charAt(0).toUpperCase()+f.slice(1)}var LanguageUtil=function(){function f(s){_classCallCheck(this,f),this.options=s,this.supportedLngs=this.options.supportedLngs||!1,this.logger=baseLogger.create("languageUtils")}return _createClass(f,[{key:"getScriptPartFromCode",value:function(a){if(!a||a.indexOf("-")<0)return null;var u=a.split("-");return u.length===2||(u.pop(),u[u.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(u.join("-"))}},{key:"getLanguagePartFromCode",value:function(a){if(!a||a.indexOf("-")<0)return a;var u=a.split("-");return this.formatLanguageCode(u[0])}},{key:"formatLanguageCode",value:function(a){if(typeof a=="string"&&a.indexOf("-")>-1){var u=["hans","hant","latn","cyrl","cans","mong","arab"],l=a.split("-");return this.options.lowerCaseLng?l=l.map(function(h){return h.toLowerCase()}):l.length===2?(l[0]=l[0].toLowerCase(),l[1]=l[1].toUpperCase(),u.indexOf(l[1].toLowerCase())>-1&&(l[1]=capitalize(l[1].toLowerCase()))):l.length===3&&(l[0]=l[0].toLowerCase(),l[1].length===2&&(l[1]=l[1].toUpperCase()),l[0]!=="sgn"&&l[2].length===2&&(l[2]=l[2].toUpperCase()),u.indexOf(l[1].toLowerCase())>-1&&(l[1]=capitalize(l[1].toLowerCase())),u.indexOf(l[2].toLowerCase())>-1&&(l[2]=capitalize(l[2].toLowerCase()))),l.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?a.toLowerCase():a}},{key:"isSupportedCode",value:function(a){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(a=this.getLanguagePartFromCode(a)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(a)>-1}},{key:"getBestMatchFromCodes",value:function(a){var u=this;if(!a)return null;var l;return a.forEach(function(h){if(!l){var d=u.formatLanguageCode(h);(!u.options.supportedLngs||u.isSupportedCode(d))&&(l=d)}}),!l&&this.options.supportedLngs&&a.forEach(function(h){if(!l){var d=u.getLanguagePartFromCode(h);if(u.isSupportedCode(d))return l=d;l=u.options.supportedLngs.find(function(p){if(p.indexOf(d)===0)return p})}}),l||(l=this.getFallbackCodes(this.options.fallbackLng)[0]),l}},{key:"getFallbackCodes",value:function(a,u){if(!a)return[];if(typeof a=="function"&&(a=a(u)),typeof a=="string"&&(a=[a]),Object.prototype.toString.apply(a)==="[object Array]")return a;if(!u)return a.default||[];var l=a[u];return l||(l=a[this.getScriptPartFromCode(u)]),l||(l=a[this.formatLanguageCode(u)]),l||(l=a[this.getLanguagePartFromCode(u)]),l||(l=a.default),l||[]}},{key:"toResolveHierarchy",value:function(a,u){var l=this,h=this.getFallbackCodes(u||this.options.fallbackLng||[],a),d=[],p=function(g){g&&(l.isSupportedCode(g)?d.push(g):l.logger.warn("rejecting language code not found in supportedLngs: ".concat(g)))};return typeof a=="string"&&a.indexOf("-")>-1?(this.options.load!=="languageOnly"&&p(this.formatLanguageCode(a)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&p(this.getScriptPartFromCode(a)),this.options.load!=="currentOnly"&&p(this.getLanguagePartFromCode(a))):typeof a=="string"&&p(this.formatLanguageCode(a)),h.forEach(function(y){d.indexOf(y)<0&&p(l.formatLanguageCode(y))}),d}}]),f}(),sets=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],_rulesPluralsTypes={1:function f(s){return+(s>1)},2:function f(s){return+(s!=1)},3:function f(s){return 0},4:function f(s){return s%10==1&&s%100!=11?0:s%10>=2&&s%10<=4&&(s%100<10||s%100>=20)?1:2},5:function f(s){return s==0?0:s==1?1:s==2?2:s%100>=3&&s%100<=10?3:s%100>=11?4:5},6:function f(s){return s==1?0:s>=2&&s<=4?1:2},7:function f(s){return s==1?0:s%10>=2&&s%10<=4&&(s%100<10||s%100>=20)?1:2},8:function f(s){return s==1?0:s==2?1:s!=8&&s!=11?2:3},9:function f(s){return+(s>=2)},10:function f(s){return s==1?0:s==2?1:s<7?2:s<11?3:4},11:function f(s){return s==1||s==11?0:s==2||s==12?1:s>2&&s<20?2:3},12:function f(s){return+(s%10!=1||s%100==11)},13:function f(s){return+(s!==0)},14:function f(s){return s==1?0:s==2?1:s==3?2:3},15:function f(s){return s%10==1&&s%100!=11?0:s%10>=2&&(s%100<10||s%100>=20)?1:2},16:function f(s){return s%10==1&&s%100!=11?0:s!==0?1:2},17:function f(s){return s==1||s%10==1&&s%100!=11?0:1},18:function f(s){return s==0?0:s==1?1:2},19:function f(s){return s==1?0:s==0||s%100>1&&s%100<11?1:s%100>10&&s%100<20?2:3},20:function f(s){return s==1?0:s==0||s%100>0&&s%100<20?1:2},21:function f(s){return s%100==1?1:s%100==2?2:s%100==3||s%100==4?3:0},22:function f(s){return s==1?0:s==2?1:(s<0||s>10)&&s%10==0?2:3}},deprecatedJsonVersions=["v1","v2","v3"],suffixesOrder={zero:0,one:1,two:2,few:3,many:4,other:5};function createRules(){var f={};return sets.forEach(function(s){s.lngs.forEach(function(a){f[a]={numbers:s.nr,plurals:_rulesPluralsTypes[s.fc]}})}),f}var PluralResolver=function(){function f(s){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};_classCallCheck(this,f),this.languageUtils=s,this.options=a,this.logger=baseLogger.create("pluralResolver"),(!this.options.compatibilityJSON||this.options.compatibilityJSON==="v4")&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=createRules()}return _createClass(f,[{key:"addRule",value:function(a,u){this.rules[a]=u}},{key:"getRule",value:function(a){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(a,{type:u.ordinal?"ordinal":"cardinal"})}catch{return}return this.rules[a]||this.rules[this.languageUtils.getLanguagePartFromCode(a)]}},{key:"needsPlural",value:function(a){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=this.getRule(a,u);return this.shouldUseIntlApi()?l&&l.resolvedOptions().pluralCategories.length>1:l&&l.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(a,u){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(a,l).map(function(h){return"".concat(u).concat(h)})}},{key:"getSuffixes",value:function(a){var u=this,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=this.getRule(a,l);return h?this.shouldUseIntlApi()?h.resolvedOptions().pluralCategories.sort(function(d,p){return suffixesOrder[d]-suffixesOrder[p]}).map(function(d){return"".concat(u.options.prepend).concat(d)}):h.numbers.map(function(d){return u.getSuffix(a,d,l)}):[]}},{key:"getSuffix",value:function(a,u){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},h=this.getRule(a,l);return h?this.shouldUseIntlApi()?"".concat(this.options.prepend).concat(h.select(u)):this.getSuffixRetroCompatible(h,u):(this.logger.warn("no plural rule found for: ".concat(a)),"")}},{key:"getSuffixRetroCompatible",value:function(a,u){var l=this,h=a.noAbs?a.plurals(u):a.plurals(Math.abs(u)),d=a.numbers[h];this.options.simplifyPluralSuffix&&a.numbers.length===2&&a.numbers[0]===1&&(d===2?d="plural":d===1&&(d=""));var p=function(){return l.options.prepend&&d.toString()?l.options.prepend+d.toString():d.toString()};return this.options.compatibilityJSON==="v1"?d===1?"":typeof d=="number"?"_plural_".concat(d.toString()):p():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&a.numbers.length===2&&a.numbers[0]===1?p():this.options.prepend&&h.toString()?this.options.prepend+h.toString():h.toString()}},{key:"shouldUseIntlApi",value:function(){return!deprecatedJsonVersions.includes(this.options.compatibilityJSON)}}]),f}();function ownKeys$3(f,s){var a=Object.keys(f);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(f);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(f,l).enumerable})),a.push.apply(a,u)}return a}function _objectSpread$3(f){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?ownKeys$3(Object(a),!0).forEach(function(u){_defineProperty(f,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(a)):ownKeys$3(Object(a)).forEach(function(u){Object.defineProperty(f,u,Object.getOwnPropertyDescriptor(a,u))})}return f}var Interpolator=function(){function f(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_classCallCheck(this,f),this.logger=baseLogger.create("interpolator"),this.options=s,this.format=s.interpolation&&s.interpolation.format||function(a){return a},this.init(s)}return _createClass(f,[{key:"init",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};a.interpolation||(a.interpolation={escapeValue:!0});var u=a.interpolation;this.escape=u.escape!==void 0?u.escape:escape$1,this.escapeValue=u.escapeValue!==void 0?u.escapeValue:!0,this.useRawValueToEscape=u.useRawValueToEscape!==void 0?u.useRawValueToEscape:!1,this.prefix=u.prefix?regexEscape(u.prefix):u.prefixEscaped||"{{",this.suffix=u.suffix?regexEscape(u.suffix):u.suffixEscaped||"}}",this.formatSeparator=u.formatSeparator?u.formatSeparator:u.formatSeparator||",",this.unescapePrefix=u.unescapeSuffix?"":u.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":u.unescapeSuffix||"",this.nestingPrefix=u.nestingPrefix?regexEscape(u.nestingPrefix):u.nestingPrefixEscaped||regexEscape("$t("),this.nestingSuffix=u.nestingSuffix?regexEscape(u.nestingSuffix):u.nestingSuffixEscaped||regexEscape(")"),this.nestingOptionsSeparator=u.nestingOptionsSeparator?u.nestingOptionsSeparator:u.nestingOptionsSeparator||",",this.maxReplaces=u.maxReplaces?u.maxReplaces:1e3,this.alwaysFormat=u.alwaysFormat!==void 0?u.alwaysFormat:!1,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var a="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(a,"g");var u="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(u,"g");var l="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(l,"g")}},{key:"interpolate",value:function(a,u,l,h){var d=this,p,y,g,x=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function C(E){return E.replace(/\$/g,"$$$$")}var m=function(k){if(k.indexOf(d.formatSeparator)<0){var _=getPathWithDefaults(u,x,k);return d.alwaysFormat?d.format(_,void 0,l,_objectSpread$3(_objectSpread$3(_objectSpread$3({},h),u),{},{interpolationkey:k})):_}var S=k.split(d.formatSeparator),A=S.shift().trim(),P=S.join(d.formatSeparator).trim();return d.format(getPathWithDefaults(u,x,A),P,l,_objectSpread$3(_objectSpread$3(_objectSpread$3({},h),u),{},{interpolationkey:A}))};this.resetRegExp();var v=h&&h.missingInterpolationHandler||this.options.missingInterpolationHandler,w=h&&h.interpolation&&h.interpolation.skipOnVariables!==void 0?h.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables,b=[{regex:this.regexpUnescape,safeValue:function(k){return C(k)}},{regex:this.regexp,safeValue:function(k){return d.escapeValue?C(d.escape(k)):C(k)}}];return b.forEach(function(E){for(g=0;p=E.regex.exec(a);){var k=p[1].trim();if(y=m(k),y===void 0)if(typeof v=="function"){var _=v(a,p,h);y=typeof _=="string"?_:""}else if(h&&h.hasOwnProperty(k))y="";else if(w){y=p[0];continue}else d.logger.warn("missed to pass in variable ".concat(k," for interpolating ").concat(a)),y="";else typeof y!="string"&&!d.useRawValueToEscape&&(y=makeString(y));var S=E.safeValue(y);if(a=a.replace(p[0],S),w?(E.regex.lastIndex+=y.length,E.regex.lastIndex-=p[0].length):E.regex.lastIndex=0,g++,g>=d.maxReplaces)break}}),a}},{key:"nest",value:function(a,u){var l=this,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},d,p,y=_objectSpread$3({},h);y.applyPostProcessor=!1,delete y.defaultValue;function g(v,w){var b=this.nestingOptionsSeparator;if(v.indexOf(b)<0)return v;var E=v.split(new RegExp("".concat(b,"[ ]*{"))),k="{".concat(E[1]);v=E[0],k=this.interpolate(k,y);var _=k.match(/'/g),S=k.match(/"/g);(_&&_.length%2===0&&!S||S.length%2!==0)&&(k=k.replace(/'/g,'"'));try{y=JSON.parse(k),w&&(y=_objectSpread$3(_objectSpread$3({},w),y))}catch(A){return this.logger.warn("failed parsing options string in nesting for key ".concat(v),A),"".concat(v).concat(b).concat(k)}return delete y.defaultValue,v}for(;d=this.nestingRegexp.exec(a);){var x=[],C=!1;if(d[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(d[1])){var m=d[1].split(this.formatSeparator).map(function(v){return v.trim()});d[1]=m.shift(),x=m,C=!0}if(p=u(g.call(this,d[1].trim(),y),y),p&&d[0]===a&&typeof p!="string")return p;typeof p!="string"&&(p=makeString(p)),p||(this.logger.warn("missed to resolve ".concat(d[1]," for nesting ").concat(a)),p=""),C&&(p=x.reduce(function(v,w){return l.format(v,w,h.lng,_objectSpread$3(_objectSpread$3({},h),{},{interpolationkey:d[1].trim()}))},p.trim())),a=a.replace(d[0],p),this.regexp.lastIndex=0}return a}}]),f}();function ownKeys$4(f,s){var a=Object.keys(f);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(f);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(f,l).enumerable})),a.push.apply(a,u)}return a}function _objectSpread$4(f){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?ownKeys$4(Object(a),!0).forEach(function(u){_defineProperty(f,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(a)):ownKeys$4(Object(a)).forEach(function(u){Object.defineProperty(f,u,Object.getOwnPropertyDescriptor(a,u))})}return f}function parseFormatStr(f){var s=f.toLowerCase().trim(),a={};if(f.indexOf("(")>-1){var u=f.split("(");s=u[0].toLowerCase().trim();var l=u[1].substring(0,u[1].length-1);if(s==="currency"&&l.indexOf(":")<0)a.currency||(a.currency=l.trim());else if(s==="relativetime"&&l.indexOf(":")<0)a.range||(a.range=l.trim());else{var h=l.split(";");h.forEach(function(d){if(d){var p=d.split(":"),y=_toArray(p),g=y[0],x=y.slice(1),C=x.join(":").trim().replace(/^'+|'+$/g,"");a[g.trim()]||(a[g.trim()]=C),C==="false"&&(a[g.trim()]=!1),C==="true"&&(a[g.trim()]=!0),isNaN(C)||(a[g.trim()]=parseInt(C,10))}})}}return{formatName:s,formatOptions:a}}function createCachedFormatter(f){var s={};return function(u,l,h){var d=l+JSON.stringify(h),p=s[d];return p||(p=f(l,h),s[d]=p),p(u)}}var Formatter=function(){function f(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_classCallCheck(this,f),this.logger=baseLogger.create("formatter"),this.options=s,this.formats={number:createCachedFormatter(function(a,u){var l=new Intl.NumberFormat(a,u);return function(h){return l.format(h)}}),currency:createCachedFormatter(function(a,u){var l=new Intl.NumberFormat(a,_objectSpread$4(_objectSpread$4({},u),{},{style:"currency"}));return function(h){return l.format(h)}}),datetime:createCachedFormatter(function(a,u){var l=new Intl.DateTimeFormat(a,_objectSpread$4({},u));return function(h){return l.format(h)}}),relativetime:createCachedFormatter(function(a,u){var l=new Intl.RelativeTimeFormat(a,_objectSpread$4({},u));return function(h){return l.format(h,u.range||"day")}}),list:createCachedFormatter(function(a,u){var l=new Intl.ListFormat(a,_objectSpread$4({},u));return function(h){return l.format(h)}})},this.init(s)}return _createClass(f,[{key:"init",value:function(a){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}},l=u.interpolation;this.formatSeparator=l.formatSeparator?l.formatSeparator:l.formatSeparator||","}},{key:"add",value:function(a,u){this.formats[a.toLowerCase().trim()]=u}},{key:"addCached",value:function(a,u){this.formats[a.toLowerCase().trim()]=createCachedFormatter(u)}},{key:"format",value:function(a,u,l,h){var d=this,p=u.split(this.formatSeparator),y=p.reduce(function(g,x){var C=parseFormatStr(x),m=C.formatName,v=C.formatOptions;if(d.formats[m]){var w=g;try{var b=h&&h.formatParams&&h.formatParams[h.interpolationkey]||{},E=b.locale||b.lng||h.locale||h.lng||l;w=d.formats[m](g,E,_objectSpread$4(_objectSpread$4(_objectSpread$4({},v),h),b))}catch(k){d.logger.warn(k)}return w}else d.logger.warn("there was no format function for ".concat(m));return g},a);return y}}]),f}();function ownKeys$5(f,s){var a=Object.keys(f);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(f);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(f,l).enumerable})),a.push.apply(a,u)}return a}function _objectSpread$5(f){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?ownKeys$5(Object(a),!0).forEach(function(u){_defineProperty(f,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(a)):ownKeys$5(Object(a)).forEach(function(u){Object.defineProperty(f,u,Object.getOwnPropertyDescriptor(a,u))})}return f}function _createSuper$2(f){var s=_isNativeReflectConstruct$2();return function(){var u=_getPrototypeOf(f),l;if(s){var h=_getPrototypeOf(this).constructor;l=Reflect.construct(u,arguments,h)}else l=u.apply(this,arguments);return _possibleConstructorReturn(this,l)}}function _isNativeReflectConstruct$2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function removePending(f,s){f.pending[s]!==void 0&&(delete f.pending[s],f.pendingCount--)}var Connector=function(f){_inherits(a,f);var s=_createSuper$2(a);function a(u,l,h){var d,p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return _classCallCheck(this,a),d=s.call(this),isIE10&&EventEmitter.call(_assertThisInitialized(d)),d.backend=u,d.store=l,d.services=h,d.languageUtils=h.languageUtils,d.options=p,d.logger=baseLogger.create("backendConnector"),d.waitingReads=[],d.maxParallelReads=p.maxParallelReads||10,d.readingCalls=0,d.maxRetries=p.maxRetries>=0?p.maxRetries:5,d.retryTimeout=p.retryTimeout>=1?p.retryTimeout:350,d.state={},d.queue=[],d.backend&&d.backend.init&&d.backend.init(h,p.backend,p),d}return _createClass(a,[{key:"queueLoad",value:function(l,h,d,p){var y=this,g={},x={},C={},m={};return l.forEach(function(v){var w=!0;h.forEach(function(b){var E="".concat(v,"|").concat(b);!d.reload&&y.store.hasResourceBundle(v,b)?y.state[E]=2:y.state[E]<0||(y.state[E]===1?x[E]===void 0&&(x[E]=!0):(y.state[E]=1,w=!1,x[E]===void 0&&(x[E]=!0),g[E]===void 0&&(g[E]=!0),m[b]===void 0&&(m[b]=!0)))}),w||(C[v]=!0)}),(Object.keys(g).length||Object.keys(x).length)&&this.queue.push({pending:x,pendingCount:Object.keys(x).length,loaded:{},errors:[],callback:p}),{toLoad:Object.keys(g),pending:Object.keys(x),toLoadLanguages:Object.keys(C),toLoadNamespaces:Object.keys(m)}}},{key:"loaded",value:function(l,h,d){var p=l.split("|"),y=p[0],g=p[1];h&&this.emit("failedLoading",y,g,h),d&&this.store.addResourceBundle(y,g,d),this.state[l]=h?-1:2;var x={};this.queue.forEach(function(C){pushPath(C.loaded,[y],g),removePending(C,l),h&&C.errors.push(h),C.pendingCount===0&&!C.done&&(Object.keys(C.loaded).forEach(function(m){x[m]||(x[m]={});var v=C.loaded[m];v.length&&v.forEach(function(w){x[m][w]===void 0&&(x[m][w]=!0)})}),C.done=!0,C.errors.length?C.callback(C.errors):C.callback())}),this.emit("loaded",x),this.queue=this.queue.filter(function(C){return!C.done})}},{key:"read",value:function(l,h,d){var p=this,y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,x=arguments.length>5?arguments[5]:void 0;if(!l.length)return x(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:l,ns:h,fcName:d,tried:y,wait:g,callback:x});return}return this.readingCalls++,this.backend[d](l,h,function(C,m){if(p.readingCalls--,p.waitingReads.length>0){var v=p.waitingReads.shift();p.read(v.lng,v.ns,v.fcName,v.tried,v.wait,v.callback)}if(C&&m&&y<p.maxRetries){setTimeout(function(){p.read.call(p,l,h,d,y+1,g*2,x)},g);return}x(C,m)})}},{key:"prepareLoading",value:function(l,h){var d=this,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},y=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),y&&y();typeof l=="string"&&(l=this.languageUtils.toResolveHierarchy(l)),typeof h=="string"&&(h=[h]);var g=this.queueLoad(l,h,p,y);if(!g.toLoad.length)return g.pending.length||y(),null;g.toLoad.forEach(function(x){d.loadOne(x)})}},{key:"load",value:function(l,h,d){this.prepareLoading(l,h,{},d)}},{key:"reload",value:function(l,h,d){this.prepareLoading(l,h,{reload:!0},d)}},{key:"loadOne",value:function(l){var h=this,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",p=l.split("|"),y=p[0],g=p[1];this.read(y,g,"read",void 0,void 0,function(x,C){x&&h.logger.warn("".concat(d,"loading namespace ").concat(g," for language ").concat(y," failed"),x),!x&&C&&h.logger.log("".concat(d,"loaded namespace ").concat(g," for language ").concat(y),C),h.loaded(l,x,C)})}},{key:"saveMissing",value:function(l,h,d,p,y){var g=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(h)){this.logger.warn('did not save key "'.concat(d,'" as the namespace "').concat(h,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}d==null||d===""||(this.backend&&this.backend.create&&this.backend.create(l,h,d,p,null,_objectSpread$5(_objectSpread$5({},g),{},{isUpdate:y})),!(!l||!l[0])&&this.store.addResource(l[0],h,d,p))}}]),a}(EventEmitter);function get(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(s){var a={};if(_typeof(s[1])==="object"&&(a=s[1]),typeof s[1]=="string"&&(a.defaultValue=s[1]),typeof s[2]=="string"&&(a.tDescription=s[2]),_typeof(s[2])==="object"||_typeof(s[3])==="object"){var u=s[3]||s[2];Object.keys(u).forEach(function(l){a[l]=u[l]})}return a},interpolation:{escapeValue:!0,format:function(s,a,u,l){return s},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function transformOptions(f){return typeof f.ns=="string"&&(f.ns=[f.ns]),typeof f.fallbackLng=="string"&&(f.fallbackLng=[f.fallbackLng]),typeof f.fallbackNS=="string"&&(f.fallbackNS=[f.fallbackNS]),f.supportedLngs&&f.supportedLngs.indexOf("cimode")<0&&(f.supportedLngs=f.supportedLngs.concat(["cimode"])),f}function ownKeys$6(f,s){var a=Object.keys(f);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(f);s&&(u=u.filter(function(l){return Object.getOwnPropertyDescriptor(f,l).enumerable})),a.push.apply(a,u)}return a}function _objectSpread$6(f){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?ownKeys$6(Object(a),!0).forEach(function(u){_defineProperty(f,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(a)):ownKeys$6(Object(a)).forEach(function(u){Object.defineProperty(f,u,Object.getOwnPropertyDescriptor(a,u))})}return f}function _createSuper$3(f){var s=_isNativeReflectConstruct$3();return function(){var u=_getPrototypeOf(f),l;if(s){var h=_getPrototypeOf(this).constructor;l=Reflect.construct(u,arguments,h)}else l=u.apply(this,arguments);return _possibleConstructorReturn(this,l)}}function _isNativeReflectConstruct$3(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function noop(){}function bindMemberFunctions(f){var s=Object.getOwnPropertyNames(Object.getPrototypeOf(f));s.forEach(function(a){typeof f[a]=="function"&&(f[a]=f[a].bind(f))})}var I18n=function(f){_inherits(a,f);var s=_createSuper$3(a);function a(){var u,l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=arguments.length>1?arguments[1]:void 0;if(_classCallCheck(this,a),u=s.call(this),isIE10&&EventEmitter.call(_assertThisInitialized(u)),u.options=transformOptions(l),u.services={},u.logger=baseLogger,u.modules={external:[]},bindMemberFunctions(_assertThisInitialized(u)),h&&!u.isInitialized&&!l.isClone){if(!u.options.initImmediate)return u.init(l,h),_possibleConstructorReturn(u,_assertThisInitialized(u));setTimeout(function(){u.init(l,h)},0)}return u}return _createClass(a,[{key:"init",value:function(){var l=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=arguments.length>1?arguments[1]:void 0;typeof h=="function"&&(d=h,h={}),!h.defaultNS&&h.defaultNS!==!1&&h.ns&&(typeof h.ns=="string"?h.defaultNS=h.ns:h.ns.indexOf("translation")<0&&(h.defaultNS=h.ns[0]));var p=get();this.options=_objectSpread$6(_objectSpread$6(_objectSpread$6({},p),this.options),transformOptions(h)),this.options.compatibilityAPI!=="v1"&&(this.options.interpolation=_objectSpread$6(_objectSpread$6({},p.interpolation),this.options.interpolation)),h.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=h.keySeparator),h.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=h.nsSeparator);function y(k){return k?typeof k=="function"?new k:k:null}if(!this.options.isClone){this.modules.logger?baseLogger.init(y(this.modules.logger),this.options):baseLogger.init(null,this.options);var g;this.modules.formatter?g=this.modules.formatter:typeof Intl<"u"&&(g=Formatter);var x=new LanguageUtil(this.options);this.store=new ResourceStore(this.options.resources,this.options);var C=this.services;C.logger=baseLogger,C.resourceStore=this.store,C.languageUtils=x,C.pluralResolver=new PluralResolver(x,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),g&&(!this.options.interpolation.format||this.options.interpolation.format===p.interpolation.format)&&(C.formatter=y(g),C.formatter.init(C,this.options),this.options.interpolation.format=C.formatter.format.bind(C.formatter)),C.interpolator=new Interpolator(this.options),C.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},C.backendConnector=new Connector(y(this.modules.backend),C.resourceStore,C,this.options),C.backendConnector.on("*",function(k){for(var _=arguments.length,S=new Array(_>1?_-1:0),A=1;A<_;A++)S[A-1]=arguments[A];l.emit.apply(l,[k].concat(S))}),this.modules.languageDetector&&(C.languageDetector=y(this.modules.languageDetector),C.languageDetector.init(C,this.options.detection,this.options)),this.modules.i18nFormat&&(C.i18nFormat=y(this.modules.i18nFormat),C.i18nFormat.init&&C.i18nFormat.init(this)),this.translator=new Translator(this.services,this.options),this.translator.on("*",function(k){for(var _=arguments.length,S=new Array(_>1?_-1:0),A=1;A<_;A++)S[A-1]=arguments[A];l.emit.apply(l,[k].concat(S))}),this.modules.external.forEach(function(k){k.init&&k.init(l)})}if(this.format=this.options.interpolation.format,d||(d=noop),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var m=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);m.length>0&&m[0]!=="dev"&&(this.options.lng=m[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined");var v=["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"];v.forEach(function(k){l[k]=function(){var _;return(_=l.store)[k].apply(_,arguments)}});var w=["addResource","addResources","addResourceBundle","removeResourceBundle"];w.forEach(function(k){l[k]=function(){var _;return(_=l.store)[k].apply(_,arguments),l}});var b=defer(),E=function(){var _=function(A,P){l.isInitialized&&!l.initializedStoreOnce&&l.logger.warn("init: i18next is already initialized. You should call init just once!"),l.isInitialized=!0,l.options.isClone||l.logger.log("initialized",l.options),l.emit("initialized",l.options),b.resolve(P),d(A,P)};if(l.languages&&l.options.compatibilityAPI!=="v1"&&!l.isInitialized)return _(null,l.t.bind(l));l.changeLanguage(l.options.lng,_)};return this.options.resources||!this.options.initImmediate?E():setTimeout(E,0),b}},{key:"loadResources",value:function(l){var h=this,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:noop,p=d,y=typeof l=="string"?l:this.language;if(typeof l=="function"&&(p=l),!this.options.resources||this.options.partialBundledLanguages){if(y&&y.toLowerCase()==="cimode")return p();var g=[],x=function(v){if(v){var w=h.services.languageUtils.toResolveHierarchy(v);w.forEach(function(b){g.indexOf(b)<0&&g.push(b)})}};if(y)x(y);else{var C=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);C.forEach(function(m){return x(m)})}this.options.preload&&this.options.preload.forEach(function(m){return x(m)}),this.services.backendConnector.load(g,this.options.ns,function(m){!m&&!h.resolvedLanguage&&h.language&&h.setResolvedLanguage(h.language),p(m)})}else p(null)}},{key:"reloadResources",value:function(l,h,d){var p=defer();return l||(l=this.languages),h||(h=this.options.ns),d||(d=noop),this.services.backendConnector.reload(l,h,function(y){p.resolve(),d(y)}),p}},{key:"use",value:function(l){if(!l)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!l.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return l.type==="backend"&&(this.modules.backend=l),(l.type==="logger"||l.log&&l.warn&&l.error)&&(this.modules.logger=l),l.type==="languageDetector"&&(this.modules.languageDetector=l),l.type==="i18nFormat"&&(this.modules.i18nFormat=l),l.type==="postProcessor"&&postProcessor.addPostProcessor(l),l.type==="formatter"&&(this.modules.formatter=l),l.type==="3rdParty"&&this.modules.external.push(l),this}},{key:"setResolvedLanguage",value:function(l){if(!(!l||!this.languages)&&!(["cimode","dev"].indexOf(l)>-1))for(var h=0;h<this.languages.length;h++){var d=this.languages[h];if(!(["cimode","dev"].indexOf(d)>-1)&&this.store.hasLanguageSomeTranslations(d)){this.resolvedLanguage=d;break}}}},{key:"changeLanguage",value:function(l,h){var d=this;this.isLanguageChangingTo=l;var p=defer();this.emit("languageChanging",l);var y=function(m){d.language=m,d.languages=d.services.languageUtils.toResolveHierarchy(m),d.resolvedLanguage=void 0,d.setResolvedLanguage(m)},g=function(m,v){v?(y(v),d.translator.changeLanguage(v),d.isLanguageChangingTo=void 0,d.emit("languageChanged",v),d.logger.log("languageChanged",v)):d.isLanguageChangingTo=void 0,p.resolve(function(){return d.t.apply(d,arguments)}),h&&h(m,function(){return d.t.apply(d,arguments)})},x=function(m){!l&&!m&&d.services.languageDetector&&(m=[]);var v=typeof m=="string"?m:d.services.languageUtils.getBestMatchFromCodes(m);v&&(d.language||y(v),d.translator.language||d.translator.changeLanguage(v),d.services.languageDetector&&d.services.languageDetector.cacheUserLanguage(v)),d.loadResources(v,function(w){g(w,v)})};return!l&&this.services.languageDetector&&!this.services.languageDetector.async?x(this.services.languageDetector.detect()):!l&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(x):x(l),p}},{key:"getFixedT",value:function(l,h,d){var p=this,y=function g(x,C){var m;if(_typeof(C)!=="object"){for(var v=arguments.length,w=new Array(v>2?v-2:0),b=2;b<v;b++)w[b-2]=arguments[b];m=p.options.overloadTranslationOptionHandler([x,C].concat(w))}else m=_objectSpread$6({},C);m.lng=m.lng||g.lng,m.lngs=m.lngs||g.lngs,m.ns=m.ns||g.ns,m.keyPrefix=m.keyPrefix||d||g.keyPrefix;var E=p.options.keySeparator||".",k=m.keyPrefix?"".concat(m.keyPrefix).concat(E).concat(x):x;return p.t(k,m)};return typeof l=="string"?y.lng=l:y.lngs=l,y.ns=h,y.keyPrefix=d,y}},{key:"t",value:function(){var l;return this.translator&&(l=this.translator).translate.apply(l,arguments)}},{key:"exists",value:function(){var l;return this.translator&&(l=this.translator).exists.apply(l,arguments)}},{key:"setDefaultNamespace",value:function(l){this.options.defaultNS=l}},{key:"hasLoadedNamespace",value:function(l){var h=this,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var p=this.resolvedLanguage||this.languages[0],y=this.options?this.options.fallbackLng:!1,g=this.languages[this.languages.length-1];if(p.toLowerCase()==="cimode")return!0;var x=function(v,w){var b=h.services.backendConnector.state["".concat(v,"|").concat(w)];return b===-1||b===2};if(d.precheck){var C=d.precheck(this,x);if(C!==void 0)return C}return!!(this.hasResourceBundle(p,l)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||x(p,l)&&(!y||x(g,l)))}},{key:"loadNamespaces",value:function(l,h){var d=this,p=defer();return this.options.ns?(typeof l=="string"&&(l=[l]),l.forEach(function(y){d.options.ns.indexOf(y)<0&&d.options.ns.push(y)}),this.loadResources(function(y){p.resolve(),h&&h(y)}),p):(h&&h(),Promise.resolve())}},{key:"loadLanguages",value:function(l,h){var d=defer();typeof l=="string"&&(l=[l]);var p=this.options.preload||[],y=l.filter(function(g){return p.indexOf(g)<0});return y.length?(this.options.preload=p.concat(y),this.loadResources(function(g){d.resolve(),h&&h(g)}),d):(h&&h(),Promise.resolve())}},{key:"dir",value:function(l){if(l||(l=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!l)return"rtl";var h=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"];return h.indexOf(this.services.languageUtils.getLanguagePartFromCode(l))>-1||l.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}},{key:"cloneInstance",value:function(){var l=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:noop,p=_objectSpread$6(_objectSpread$6(_objectSpread$6({},this.options),h),{isClone:!0}),y=new a(p);(h.debug!==void 0||h.prefix!==void 0)&&(y.logger=y.logger.clone(h));var g=["store","services","language"];return g.forEach(function(x){y[x]=l[x]}),y.services=_objectSpread$6({},this.services),y.services.utils={hasLoadedNamespace:y.hasLoadedNamespace.bind(y)},y.translator=new Translator(y.services,y.options),y.translator.on("*",function(x){for(var C=arguments.length,m=new Array(C>1?C-1:0),v=1;v<C;v++)m[v-1]=arguments[v];y.emit.apply(y,[x].concat(m))}),y.init(p,d),y.translator.options=y.options,y.translator.backendConnector.services.utils={hasLoadedNamespace:y.hasLoadedNamespace.bind(y)},y}},{key:"toJSON",value:function(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}]),a}(EventEmitter);_defineProperty(I18n,"createInstance",function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;return new I18n(f,s)});var instance=I18n.createInstance();instance.createInstance=I18n.createInstance,instance.createInstance,instance.init,instance.loadResources,instance.reloadResources,instance.use,instance.changeLanguage,instance.getFixedT,instance.t,instance.exists,instance.setDefaultNamespace,instance.hasLoadedNamespace,instance.loadNamespaces,instance.loadLanguages;class i18nService{constructor(s){this.service=s,this.loadedLanguages=[],this.i18next=instance}init(){return instance.init({interpolation:{prefix:"{",suffix:"}"}}),this.reset(this.service.options.locale||"en")}reset(s){return new Promise((a,u)=>{if(console.log(instance.language),instance.language!==s){if(!this.loadedLanguages.includes(s)){$.getJSON(`${API.host}/i18n/${s}.json`).done(l=>{instance.addResourceBundle(s,"translation",l.words,!0,!0),this.loadedLanguages.push(s),instance.changeLanguage(s).then(()=>{a(s)})}).fail(l=>{if(s!="en"){this.reset("en").then(()=>{a(s)});return}u(l)});return}instance.changeLanguage(s).then(()=>{a(s)});return}a(s)})}t(s,a){return instance.t(s,a)}add(s){return new Promise((a,u)=>{s.name&&s.code?this.loadedLanguages.includes(s.code)?u():(instance.addResourceBundle(s.code,"translation",s.words,!0,!0),this.loadedLanguages.push(s.code),instance.changeLanguage(s.code).then(()=>{a(s.code)})):u()})}replace(s){return new Promise((a,u)=>{s.name&&s.code?this.loadedLanguages.includes(s.code)&&(instance.addResourceBundle(s.code,"translation",s.words,!0,!0),instance.changeLanguage(s.code).then(()=>{a(s.code)})):u()})}}class DownloadQuene{constructor(s){this.service=s,this.queues=[],this.isRunning=!1,this.timer=void 0,this.successCount=0,this.failedCount=0}add(s){return Array.isArray(s)?this.queues.push(...s):this.queues.push(s),this}run(){if(this.isRunning)return this;clearTimeout(this.timer);const s=this.queues.shift();if(s){this.isRunning=!0;const a=(this.service.options.batchDownloadInterval||0)*1e3;(s.clientId?this.service.controller.sendTorrentToClient:this.service.controller.sendTorrentToDefaultClient).call(this.service.controller,s).then(()=>{this.successCount++}).catch(l=>{console.log(l),this.failedCount++}).finally(()=>{this.isRunning=!1,a>0?this.timer=window.setTimeout(()=>{this.run()},a):this.run()})}else PPF.showNotifications({message:this.service.i18n.t("service.controller.downloadTaskIsCompleted",{success:this.successCount,failed:this.failedCount})},1e4),this.successCount=0,this.failedCount=0;return this}}class Collection{constructor(){this.items=[],this.groups=[],this.storage=new localStorage,this.movieInfoService=new MovieInfoService,this.configKey=EConfigKey.collection,this.load()}load(s){return new Promise((a,u)=>{this.storage.get(this.configKey,l=>{let h={groups:[],items:[]};Array.isArray(l)?h.items=l:l&&(h=Object.assign(h,l)),this.groups=h.groups||[],this.items=h.items||[];let d=[];s?this.items.forEach(p=>{p.groups&&p.groups.includes(s)&&d.push(p)}):d=this.items,this.updateGroupCount(),a(d)})})}updateGroupCount(){this.groups.forEach(s=>{s.count=0,this.items.forEach(a=>{a.groups&&s.id&&a.groups.includes(s.id)&&(s.count||(s.count=0),s.count++)})})}add(s){return new Promise((a,u)=>{let l=Object.assign({time:new Date().getTime(),site:null},s),h=Object.assign({},l.movieInfo);l.site&&delete l.site,l.link=PPF.getCleaningURL(l.link),h.imdbId||h.doubanId?this.getMoviceInfo(h.imdbId,h.doubanId).then(d=>{l.movieInfo=d,this.push(l),a(this.items)}).catch(d=>{console.log(d),this.push(l),a(this.items)}):(this.push(l),a(this.items))})}getMoviceInfo(s="",a=""){return new Promise((u,l)=>{let h=s,d=this.movieInfoService.getInfoFromIMDb;a&&(h=a,d=this.movieInfoService.getInfoFromDoubanId),d.call(this.movieInfoService,h).then(p=>{let y={imdbId:s,doubanId:p.id.toString().replace(/(\D)/g,""),image:p.image||(p.images?p.images.small:void 0),title:p.title,link:p.mobile_link||p.share_url,alt_title:p.alt_title||p.original_title,year:p.year};!p.year&&p.attrs&&(y.year=p.attrs.year[0]),u(y)}).catch(p=>{l()})})}push(s){this.items.findIndex(u=>u.link===s.link)===-1&&(this.items.push(s),this.updateGroupCount(),this.storage.set(this.configKey,{groups:this.groups,items:this.items}))}update(s){return new Promise((a,u)=>{this.load().then(()=>{s.link=PPF.getCleaningURL(s.link);let l=this.items.findIndex(h=>h.link===s.link);if(l>=0){this.items[l]=s;let h=Object.assign({},s.movieInfo);if(s.site&&delete s.site,h.imdbId||h.doubanId){this.getMoviceInfo(h.imdbId,h.doubanId).then(d=>{s.movieInfo=d,this.items[l]=s,this.updateData(),a(this.items)}).catch(d=>{console.log(d),this.updateData(),a(this.items)});return}}this.updateData(),a(this.items)})})}updateData(){this.updateGroupCount(),this.storage.set(this.configKey,{groups:this.groups,items:this.items})}delete(s){return this.remove([s])}remove(s){return new Promise((a,u)=>{this.load().then(()=>{for(let l=this.items.length-1;l>=0;l--){let h=this.items[l];s.findIndex(p=>p.link===h.link)>=0&&this.items.splice(l,1)}this.updateGroupCount(),this.storage.set(this.configKey,{groups:this.groups,items:this.items}),a(this.items)})})}clear(){return new Promise((s,a)=>{this.items=[],this.groups=[],this.storage.set(this.configKey,{}),s({})})}get(s){return new Promise((a,u)=>{s=PPF.getCleaningURL(s),this.load().then(()=>{let l=this.items.find(h=>h.link===s);l?a(l):u(!1)})})}reset(s){return new Promise((a,u)=>{if(!s){u(!1);return}Array.isArray(s)?this.items=s:(this.groups=s.groups||this.groups,this.items=s.items||this.items),this.storage.set(this.configKey,{groups:this.groups,items:this.items}),a({groups:this.groups,items:this.items})})}addGroup(s){return new Promise((a,u)=>{let l=Object.assign({id:PPF.getNewId().substr(0,8),update:new Date().getTime()},s);this.groups.push(l),this.storage.set(this.configKey,{groups:this.groups,items:this.items}),a(this.groups)})}removeGroup(s){return new Promise((a,u)=>{let l=[];Array.isArray(s)?l=s:l.push(s),this.load().then(()=>{for(let h=this.groups.length-1;h>=0;h--){let d=this.groups[h];l.findIndex(y=>y.id===d.id)>=0&&(this.items.forEach(y=>{if(!y.groups)return;let g=y.groups.findIndex(x=>x===d.id);g!==-1&&y.groups.splice(g,1)}),this.groups.splice(h,1))}this.updateGroupCount(),this.storage.set(this.configKey,{groups:this.groups,items:this.items}),a(this.groups)})})}updateGroup(s){return new Promise((a,u)=>{this.load().then(()=>{let l=this.groups.findIndex(h=>h.id===s.id);l>=0&&(this.groups[l]=s),this.storage.set(this.configKey,{groups:this.groups,items:this.items}),a(this.groups)})})}getGroups(){return new Promise((s,a)=>{this.load().then(()=>{s(this.groups)})})}addToGroup(s,a){return new Promise((u,l)=>{s.groups||(s.groups=[]),s.groups.findIndex(d=>d===a)===-1?(s.groups.push(a),this.update(s).then(()=>{u(!0)})):l(!1)})}removeFromGroup(s,a){return new Promise((u,l)=>{if(s.groups){let h=s.groups.findIndex(d=>d===a);h!==-1?(s.groups.splice(h,1),this.update(s).then(()=>{u(!0)})):l(!1)}})}getAllLinks(){let s=[];return this.items.forEach(a=>{s.push(PPF.getCleaningURL(a.link))}),s}}class SearchResultSnapshot{constructor(){this.items=[],this.storage=new localStorage,this.configKey=EConfigKey.searchResultSnapshot,this.load()}load(){return new Promise((s,a)=>{this.storage.get(this.configKey,u=>{let l={items:[]};Array.isArray(u)?l.items=u:u&&(l=Object.assign(l,u)),this.items=l.items||[],console.log(u),s(this.items)})})}add(s){return new Promise((a,u)=>{let l=Object.assign({time:new Date().getTime(),id:PPF.getNewId()},s);this.items.push(l),this.updateData(),a(this.items)})}updateData(){this.storage.set(this.configKey,{items:this.items})}get(s){return new Promise((a,u)=>{this.load().then(()=>{let l=this.items.find(h=>h.id===s);l?a(l):u(!1)})})}delete(s){return this.remove([s])}remove(s){return new Promise((a,u)=>{this.load().then(()=>{for(let l=this.items.length-1;l>=0;l--){let h=this.items[l];s.findIndex(p=>p.id===h.id)>=0&&this.items.splice(l,1)}this.updateData(),a(this.items)})})}clear(){return new Promise((s,a)=>{this.items=[],this.updateData(),s([])})}reset(s){return new Promise((a,u)=>{if(!s){u(!1);return}if(!Array.isArray(s)){u(!1);return}this.items=s,this.updateData(),a(this.items)})}}class KeepUploadTask{constructor(){this.items=[],this.storage=new localStorage,this.configKey=EConfigKey.keepUploadTask,this.load()}load(){return new Promise((s,a)=>{this.storage.get(this.configKey,u=>{let l={items:[]};Array.isArray(u)?l.items=u:u&&(l=Object.assign(l,u)),this.items=l.items||[],console.log(u),s(this.items)})})}add(s){return new Promise((a,u)=>{let l=Object.assign({time:new Date().getTime(),id:PPF.getNewId()},s);this.items.push(l),this.updateData(),a(this.items)})}update(s){return new Promise((a,u)=>{this.load().then(()=>{let l=this.items.findIndex(h=>h.id===s.id);l>=0&&(this.items[l]=s),this.updateData(),a(this.items)})})}updateData(){this.storage.set(this.configKey,{items:this.items})}get(s){return new Promise((a,u)=>{this.load().then(()=>{let l=this.items.find(h=>h.id===s);l?a(l):u(!1)})})}delete(s){return this.remove([s])}remove(s){return new Promise((a,u)=>{this.load().then(()=>{for(let l=this.items.length-1;l>=0;l--){let h=this.items[l];s.findIndex(p=>p.id===h.id)>=0&&this.items.splice(l,1)}this.updateData(),a(this.items)})})}clear(){return new Promise((s,a)=>{this.items=[],this.updateData(),s([])})}reset(s){return new Promise((a,u)=>{if(!s){u(!1);return}if(!Array.isArray(s)){u(!1);return}this.items=s,this.updateData(),a(this.items)})}}class PTPlugin{constructor(s=!1){this.config=new Config(this),this.options={sites:[],clients:[]},this.localMode=!1,this.controller=new Controller(this),this.logger=new Logger$1,this.contentMenus=new ContextMenus(this),this.userData=new UserData(this),this.omniBox=new OmniBox(this),this.i18n=new i18nService(this),this.downloadQuene=new DownloadQuene(this),this.collection=new Collection,this.searchResultSnapshot=new SearchResultSnapshot,this.keepUploadTask=new KeepUploadTask,this.reloadCount=0,this.autoRefreshUserDataTimer=0,this.autoRefreshUserDataIsWorking=!1,this.autoRefreshUserDataFailedCount=0,this.gDummyHeaderPrefix="Overwrite-",s||this.initBrowserEvent(),this.logger.add({module:EModule.background,event:ELogEvent.init}),this.localMode=s,this.initConfig()}requestMessage(s,a){return this.debug(`${ELogEvent.requestMessage}.${s.action}`),new Promise((u,l)=>{let h;try{switch(s.action){case EAction.readConfig:this.localMode?this.readConfig().then(()=>{u(this.options)}):u(this.options);break;case EAction.saveConfig:s.data.locale&&s.data.locale!=this.options.locale&&this.i18n.reset(s.data.locale),this.config.save(s.data),this.options=s.data,this.controller.isInitialized&&this.controller.reset(this.options),setTimeout(()=>{this.contentMenus.init(this.options)},100),this.resetTimer(),u(this.options);break;case EAction.getClearedOptions:u(this.config.cleaningOptions(this.options));break;case EAction.resetRunTimeOptions:this.config.resetRunTimeOptions(s.data),this.options=this.config.options,u(this.options);break;case EAction.copyTextToClipboard:h=this.controller.copyTextToClipboard(s.data),h?u(h):l();break;case EAction.openOptions:this.controller.openOptions(s.data),u(!0);break;case EAction.updateOptionsTabId:this.controller.updateOptionsTabId(s.data),u(!0);break;case EAction.searchTorrent:console.log(s.data),this.controller.searchTorrent(s.data),u(!0);break;case EAction.testClientConnectivity:this.controller.clientController.testClientConnectivity(s.data).then(d=>{u(d)}).catch(d=>{this.logger.add({module:EModule.background,event:`${EAction.testClientConnectivity}`,msg:this.i18n.t("service.testClientConnectivityFailed",{address:s.data.address}),data:d}),l(d)});break;case EAction.getSystemLogs:this.logger.load().then(d=>{u(d)}).catch(d=>{l(d)});break;case EAction.removeSystemLogs:this.logger.remove(s.data).then(d=>{u(d)}).catch(d=>{l(d)});break;case EAction.clearSystemLogs:this.logger.clear().then(d=>{u(d)}).catch(d=>{l(d)});break;case EAction.writeLog:this.logger.add(s.data),u(!0);break;case EAction.readUIOptions:this.config.readUIOptions().then(d=>{u(d)}).catch(d=>{l(d)});break;case EAction.saveUIOptions:this.config.saveUIOptions(s.data).then(d=>{u(d)}).catch(d=>{l(d)});break;case EAction.changeLanguage:return this.i18n.reset(s.data);default:if(this[s.action]){this[s.action](s.data,a).then(d=>{u(d)}).catch(d=>{l(d)});return}this.controller.call(s,a).then(d=>{u(d)}).catch(d=>{l(d)});break}}catch(d){l(d)}})}initConfig(){if(this.reloadCount<10&&(this.config.sites.length===0||this.config.clients.length===0)){setTimeout(()=>{this.initConfig()},500),this.reloadCount++;return}this.readConfig().then(()=>{this.initI18n()})}initI18n(){this.i18n.init().then(()=>{this.init()}).catch(()=>{console.debug("i18n init error")})}readConfig(){return new Promise((s,a)=>{this.config.read().then(u=>{this.initUserData(),this.options=u,s(u),this.localMode||this.controller.init(this.options)})})}saveConfig(){this.config.save(this.options)}initUserData(){this.options.sites.forEach(s=>{s.user=this.userData.get(s.host)})}resetTimer(s=!1){clearInterval(this.autoRefreshUserDataTimer);let a=this;typeof chrome=="object"&&chrome.alarms?chrome.alarms.clear(EAlarm.refreshJob,function(u){console.log(u?`Alarm ${EAlarm.refreshJob} was successfully cleared.`:`Alarm ${EAlarm.refreshJob} was not cleared.`),a.options.autoRefreshUserData&&(a.options.autoRefreshByAlarm?a.setRefreshUserDataJob(s):a.resetAutoRefreshUserDataTimer(s))}):a.options.autoRefreshUserData&&a.resetAutoRefreshUserDataTimer(s)}resetAutoRefreshUserDataTimer(s=!1){console.log("resetAutoRefreshUserDataTimer"),clearInterval(this.autoRefreshUserDataTimer),this.options.autoRefreshUserDataNextTime=this.getNextTime(0),new Date().getTime()>=this.options.autoRefreshUserDataNextTime&&(s?PPF.getToDay()!=PPF.getToDay(this.options.autoRefreshUserDataLastTime)?this.options.autoRefreshUserDataNextTime=new Date().getTime()+1e4:this.options.autoRefreshUserDataNextTime=this.getNextTime():this.options.autoRefreshUserDataNextTime=this.getNextTime()),this.autoRefreshUserDataTimer=window.setInterval(()=>{this.refreshUserData()},1e3)}refreshUserData(){console.log("refreshUserData");let s=new Date().getTime();this.autoRefreshUserDataFailedCount=0;let a=this.options.autoRefreshUserDataFailedRetryCount||3,u=this.options.autoRefreshUserDataFailedRetryInterval||5;this.options.autoRefreshUserDataNextTime&&s>=this.options.autoRefreshUserDataNextTime&&!this.autoRefreshUserDataIsWorking?(this.options.autoRefreshUserDataNextTime=this.getNextTime(),this.autoRefreshUserDataIsWorking=!0,this.controller.userService.refreshUserData(this.autoRefreshUserDataFailedCount>0).then(l=>{var d;this.debug("refreshUserData DONE.",l),this.autoRefreshUserDataIsWorking=!1;let h=!1;if(l.some(p=>{if(!p||!p.id&&p.msg&&p.msg.status!=EUserDataRequestStatus.notSupported)return h=!0,!0}),h?(this.autoRefreshUserDataFailedCount<a?(this.options.autoRefreshUserDataNextTime=new Date().getTime()+u*6e4,this.debug("数据刷新失败, 下次重试时间",new Date(this.options.autoRefreshUserDataNextTime).toLocaleString()),this.resetTimer()):this.debug("数据刷新失败, 重试次数已超限制"),this.autoRefreshUserDataFailedCount++):(this.debug("数据刷新完成"),this.autoRefreshUserDataFailedCount=0),this.options.autoBackupData&&(!h||this.autoRefreshUserDataFailedCount>=a)){let{autoBackupDataServerId:p}=this.options;console.log(`上传用户数据到 -> ${p}`);let y=(d=this.options.backupServers)==null?void 0:d.filter(g=>g.id===p)[0];y?(console.log(`开始上传用户数据到 -> ${y.name}`),this.controller.backupToServer(y).then(g=>console.log(`用户数据上传完成 -> ${y.name}`,g)).catch(g=>console.log(`用户数据上传失败 -> ${y.name}`,g))):console.log(`未找到备份服务器 -> ${p}`,this.options.backupServers)}})):console.debug("refresh data skipped...")}getNextTime(s=1){let a=PPF.getToDay(),u=new Date(`${a} ${this.options.autoRefreshUserDataHours}:${this.options.autoRefreshUserDataMinutes}:00`);return new Date(u.setDate(u.getDate()+s)).getTime()}saveUserData(){this.initUserData(),this.config.save(this.options)}init(){this.localMode||(this.contentMenus.init(this.options),this.resetTimer(!0))}debug(...s){s.forEach(a=>{this.controller.pushDebugMsg(a)})}writeLog(s){this.logger.add(s)}writeErrorLog(s){this.logger.add({module:EModule.background,event:"一般错误",msg:typeof s=="string"?s:JSON.stringify(s)})}initBrowserEvent(){if(window.chrome===void 0||!chrome.runtime)return;console.log("service.initBrowserEvent"),chrome.runtime.onMessage&&chrome.runtime.onMessage.addListener((a,u,l)=>(this.requestMessage(a,u).then(h=>{l&&l({resolve:h})}).catch(h=>{l&&l({reject:h})}),!0)),chrome.runtime.onInstalled.addListener(a=>{console.log("chrome.runtime.onInstalled",a),a.reason=="update"&&this.upgrade()});let s=[];switch(PPF.browserName){case EBrowserType.Firefox:s=["requestHeaders","blocking"];break;case EBrowserType.Edge:case EBrowserType.Chrome:default:s=["requestHeaders","blocking","extraHeaders"];break}chrome.webRequest.onBeforeSendHeaders.addListener(a=>{let u=[];return a.requestHeaders&&(u=a.requestHeaders.map(l=>l.name.startsWith(this.gDummyHeaderPrefix)?{name:l.name.replace(this.gDummyHeaderPrefix,""),value:l.value}:{name:l.name,value:l.value})),{requestHeaders:u}},{urls:["<all_urls>"]},s)}upgrade(){setTimeout(()=>{this.userData.upgrade()},1e3)}getSiteParser(s,a){let u=this.options.system&&this.options.system.sites&&this.options.system.sites.find(h=>h.host===s);if(!u)return"";let l=u.parser&&u.parser[a];if(!l){let h=this.options.system&&this.options.system.schemas&&this.options.system.schemas.find(d=>d.name===u.schema);l=h.parser&&h.parser[a]}return l}getSiteSelector(s,a){let u=typeof s=="string"?s:s.host,l=this.clone(this.options.system),d=l.sites.concat(this.options.sites).find(g=>g.host===u);if(!d){if(typeof s=="string")return null;d=s}let p=d.selectors&&d.selectors[a],y=l.schemas.find(g=>d!=null&&g.name===d.schema);if(!p)y&&y.selectors&&(p=y.selectors[a]);else{if(p.disabled===!0)return null;y&&y.selectors&&y.selectors[a]&&p.merge===!0&&(p.fields=Object.assign(y.selectors[a].fields,p.fields),p=Object.assign(y.selectors[a],p))}return p}clone(s){return PPF.clone(s)}checkPermissions(s){return PPF.checkPermissions(s)}requestPermissions(s){return PPF.requestPermissions(s)}setRefreshUserDataJob(s=!1){let a=0,u=2,l=this.getNextTime(0);Date.now()>l?(s&&PPF.getToDay()!=PPF.getToDay(this.options.autoRefreshUserDataLastTime)&&(a=1),a<1&&(this.options.autoRefreshUserDataNextTime=this.getNextTime(),a=Math.round((this.options.autoRefreshUserDataNextTime-Date.now())/1e3/60),a=a>1?a:1)):(this.options.autoRefreshUserDataNextTime=l,a=1),console.log(`setRefreshUserDataJob delay in ${a}, period: ${u}`),chrome.alarms.create(EAlarm.refreshJob,{delayInMinutes:a,periodInMinutes:u}),chrome.alarms.onAlarm.addListener(h=>{h.name===EAlarm.refreshJob&&(console.debug("alarm RefreshUserDataJob invoked"),this.refreshUserData())})}}const PTService=new PTPlugin;Object.assign(window,{PTServiceFilters:filters,PTBackgroundService:PTService,i18n:PTService.i18n})})();
