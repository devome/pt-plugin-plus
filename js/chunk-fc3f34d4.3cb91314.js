(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fc3f34d4"],{"26e5":function(t,e,i){},"3ec9":function(t,e,i){"use strict";i("7b4f")},4049:function(t,e,i){},"4bd4":function(t,e,i){"use strict";i("26e5");var s=i("94ab");e["a"]={name:"v-form",mixins:[Object(s["b"])("form")],inheritAttrs:!1,props:{value:Boolean,lazyValidation:Boolean},data:function(){return{inputs:[],watchers:[],errorBag:{}}},watch:{errorBag:{handler:function(){var t=Object.values(this.errorBag).includes(!0);this.$emit("input",!t)},deep:!0,immediate:!0}},methods:{watchInput:function(t){var e=this,i=function(t){return t.$watch("hasError",(function(i){e.$set(e.errorBag,t._uid,i)}),{immediate:!0})},s={_uid:t._uid,valid:void 0,shouldValidate:void 0};return this.lazyValidation?s.shouldValidate=t.$watch("shouldValidate",(function(n){n&&(e.errorBag.hasOwnProperty(t._uid)||(s.valid=i(t)))})):s.valid=i(t),s},validate:function(){var t=this.inputs.filter((function(t){return!t.validate(!0)})).length;return!t},reset:function(){for(var t=this,e=this.inputs.length;e--;)this.inputs[e].reset();this.lazyValidation&&setTimeout((function(){t.errorBag={}}),0)},resetValidation:function(){for(var t=this,e=this.inputs.length;e--;)this.inputs[e].resetValidation();this.lazyValidation&&setTimeout((function(){t.errorBag={}}),0)},register:function(t){var e=this.watchInput(t);this.inputs.push(t),this.watchers.push(e)},unregister:function(t){var e=this.inputs.find((function(e){return e._uid===t._uid}));if(e){var i=this.watchers.find((function(t){return t._uid===e._uid}));i.valid&&i.valid(),i.shouldValidate&&i.shouldValidate(),this.watchers=this.watchers.filter((function(t){return t._uid!==e._uid})),this.inputs=this.inputs.filter((function(t){return t._uid!==e._uid})),this.$delete(this.errorBag,e._uid)}}},render:function(t){var e=this;return t("form",{staticClass:"v-form",attrs:Object.assign({novalidate:!0},this.$attrs),on:{submit:function(t){return e.$emit("submit",t)}}},this.$slots.default)}}},"573e":function(t,e,i){"use strict";i("9040")},6820:function(t,e,i){},"7b4f":function(t,e,i){},8205:function(t,e,i){"use strict";i("6820")},9040:function(t,e,i){},b637:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"site-plugins"},[i("v-alert",{attrs:{value:!0,type:"info"}},[t._v(t._s(t.$t("settings.sitePlugins.index.title"))+" ["+t._s(t.site.name)+"]")]),i("v-card",[i("v-card-title",[i("v-btn",{attrs:{color:"success"},on:{click:t.add}},[i("v-icon",{staticClass:"mr-2"},[t._v("add")]),t._v("\n        "+t._s(t.$t("common.add"))+"\n      ")],1),i("v-btn",{attrs:{color:"error",disabled:0==t.selected.length},on:{click:t.removeSelected}},[i("v-icon",{staticClass:"mr-2"},[t._v("remove")]),t._v("\n        "+t._s(t.$t("common.remove"))+"\n      ")],1),i("v-divider",{staticClass:"mx-3 mt-0",attrs:{inset:"",vertical:""}}),i("input",{ref:"fileImport",staticStyle:{display:"none"},attrs:{type:"file",multiple:"",accept:"application/json"}}),i("v-btn",{attrs:{color:"info"},on:{click:t.importConfig}},[i("v-icon",{staticClass:"mr-2"},[t._v("folder_open")]),t._v("\n        "+t._s(t.$t("settings.sites.index.importConfig"))+"\n      ")],1),i("v-divider",{staticClass:"mx-3 mt-0",attrs:{inset:"",vertical:""}}),i("v-btn",{attrs:{color:"info",href:"https://github.com/pt-plugins/PT-Plugin-Plus/wiki/config-custom-plugin",target:"_blank",rel:"noopener noreferrer nofollow"}},[i("v-icon",{staticClass:"mr-2"},[t._v("help")]),t._v("\n        "+t._s(t.$t("settings.siteSearchEntry.index.help"))+"\n      ")],1),i("v-spacer"),i("v-text-field",{staticClass:"search",attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""}})],1),i("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.plugins,pagination:t.pagination,"item-key":"name","select-all":""},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"items",fn:function(e){return[i("td",{staticStyle:{width:"20px"}},[e.item.isCustom?i("v-checkbox",{attrs:{primary:"","hide-details":""},model:{value:e.selected,callback:function(i){t.$set(e,"selected",i)},expression:"props.selected"}}):t._e()],1),i("td",[i("a",{on:{click:function(i){return t.edit(e.item)}}},[i("span",{staticClass:"ml-2"},[t._v(t._s(e.item.name))])])]),i("td",t._l(e.item.pages,(function(e,s){return i("v-chip",{key:s,attrs:{label:"",color:"light-blue","text-color":"white",small:""}},[t._v("\n            "+t._s(e)+"\n          ")])})),1),i("td",[t._v(t._s(e.item.url))]),i("td",[e.item.isCustom?i("v-icon",{staticClass:"mr-2",attrs:{small:"",title:t.$t("common.edit")},on:{click:function(i){return t.edit(e.item)}}},[t._v("edit")]):t._e(),e.item.isCustom?i("v-icon",{attrs:{small:"",color:"error",title:t.$t("common.remove")},on:{click:function(i){return t.removeConfirm(e.item)}}},[t._v("delete")]):t._e(),e.item.isCustom?i("v-icon",{staticClass:"ml-2",attrs:{small:"",color:"info",title:t.$t("common.share")},on:{click:function(i){return t.share(e.item)}}},[t._v("share")]):t._e()],1)]}}]),model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1),i("AddItem",{on:{save:t.addItem},model:{value:t.showAddDialog,callback:function(e){t.showAddDialog=e},expression:"showAddDialog"}}),i("EditItem",{attrs:{initData:t.selectedItem},on:{save:t.updateItem},model:{value:t.showEditDialog,callback:function(e){t.showEditDialog=e},expression:"showEditDialog"}}),i("v-dialog",{attrs:{width:"300"},model:{value:t.dialogRemoveConfirm,callback:function(e){t.dialogRemoveConfirm=e},expression:"dialogRemoveConfirm"}},[i("v-card",[i("v-card-title",{staticClass:"headline red lighten-2"},[t._v(t._s(t.$t("settings.sitePlugins.index.removeTitle")))]),i("v-card-text",[t._v(t._s(t.$t("settings.sitePlugins.index.removeConfirm")))]),i("v-divider"),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{flat:"",color:"info"},on:{click:function(e){t.dialogRemoveConfirm=!1}}},[i("v-icon",[t._v("cancel")]),i("span",{staticClass:"ml-1"},[t._v(t._s(t.$t("common.cancel")))])],1),i("v-btn",{attrs:{color:"error",flat:""},on:{click:t.remove}},[i("v-icon",[t._v("check_circle_outline")]),i("span",{staticClass:"ml-1"},[t._v(t._s(t.$t("common.ok")))])],1)],1)],1)],1),i("v-snackbar",{attrs:{top:"",timeout:3e3,color:"error"},model:{value:t.haveError,callback:function(e){t.haveError=e},expression:"haveError"}},[t._v(t._s(t.errorMsg))]),i("v-snackbar",{attrs:{bottom:"",timeout:3e3,color:"success"},model:{value:t.haveSuccess,callback:function(e){t.haveSuccess=e},expression:"haveSuccess"}},[t._v(t._s(t.successMsg))])],1)},n=[],a=i("75fc"),o=(i("7f7f"),i("7514"),i("ac6a"),i("6b54"),i("2b0e")),l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("v-dialog",{attrs:{fullscreen:""},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("v-card",[i("v-toolbar",{attrs:{dark:"",color:"blue-grey darken-2"}},[i("v-toolbar-title",[t._v(t._s(t.$t("settings.sitePlugins.add.title")))]),i("v-spacer"),i("v-btn",{attrs:{icon:"",flat:"",color:"success",href:"https://github.com/pt-plugins/PT-Plugin-Plus/wiki/config-custom-plugin",target:"_blank",rel:"noopener noreferrer nofollow",title:t.$t("common.help")}},[i("v-icon",[t._v("help")])],1)],1),i("v-card-text",{staticClass:"body"},[i("Editor",{attrs:{initData:t.selected},on:{change:t.change}})],1),i("v-divider"),i("v-card-actions",{staticClass:"pa-3 toolbar"},[i("v-spacer"),i("v-btn",{attrs:{flat:"",color:"error"},on:{click:t.cancel}},[i("v-icon",[t._v("cancel")]),i("span",{staticClass:"ml-1"},[t._v(t._s(t.$t("common.cancel")))])],1),i("v-btn",{attrs:{flat:"",color:"success",disabled:!t.valid},on:{click:t.save}},[i("v-icon",[t._v("check_circle_outline")]),i("span",{staticClass:"ml-1"},[t._v(t._s(t.$t("common.ok")))])],1)],1)],1)],1)],1)},r=[],c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-card",{staticClass:"mb-5",attrs:{color:t.$vuetify.dark?"":"grey lighten-4"}},[i("v-card-text",[i("v-form",{model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[i("v-text-field",{ref:"name",attrs:{label:t.$t("settings.sitePlugins.editor.name"),placeholder:t.$t("settings.sitePlugins.editor.name"),required:"",rules:t.rules.require,disabled:t.option.readonly},model:{value:t.option.name,callback:function(e){t.$set(t.option,"name",e)},expression:"option.name"}}),i("v-combobox",{attrs:{"hide-selected":"",hint:t.$t("settings.sitePlugins.editor.pagesTip"),label:t.$t("settings.sitePlugins.editor.pages"),multiple:"","persistent-hint":"","small-chips":"",disabled:t.option.readonly},model:{value:t.option.pages,callback:function(e){t.$set(t.option,"pages",e)},expression:"option.pages"}}),i("v-combobox",{attrs:{"hide-selected":"",hint:t.$t("settings.sitePlugins.editor.scriptsTip"),label:t.$t("settings.sitePlugins.editor.scripts"),multiple:"","persistent-hint":"","small-chips":"",disabled:t.option.readonly},model:{value:t.option.scripts,callback:function(e){t.$set(t.option,"scripts",e)},expression:"option.scripts"}}),i("v-combobox",{attrs:{"hide-selected":"",hint:t.$t("settings.sitePlugins.editor.stylesTip"),label:t.$t("settings.sitePlugins.editor.styles"),multiple:"","persistent-hint":"","small-chips":"",disabled:t.option.readonly},model:{value:t.option.styles,callback:function(e){t.$set(t.option,"styles",e)},expression:"option.styles"}}),i("v-textarea",{attrs:{label:t.$t("settings.sitePlugins.editor.script"),height:"200",disabled:t.option.readonly},model:{value:t.option.script,callback:function(e){t.$set(t.option,"script",e)},expression:"option.script"}}),i("v-textarea",{attrs:{label:t.$t("settings.sitePlugins.editor.style"),height:"200",disabled:t.option.readonly},model:{value:t.option.style,callback:function(e){t.$set(t.option,"style",e)},expression:"option.style"}})],1)],1)],1)},u=[],d=o["default"].extend({data:function(){return{rules:{require:[function(t){return!!t||"!"}]},valid:!1,option:{name:"",id:null,pages:[],scripts:[],styles:[],script:"",style:"",readonly:!1}}},props:{initData:{type:Object,default:function(){return{valid:!1,readonly:!1}}}},watch:{option:{handler:function(){this.$emit("change",{data:this.option,valid:this.valid})},deep:!0},initData:function(){this.initData&&(this.option=Object.assign({},this.initData))}}}),h=d,m=(i("3ec9"),i("2877")),v=i("6544"),p=i.n(v),g=i("b0af"),f=i("99d9"),b=i("2b5d"),_=i("4bd4"),$=i("2677"),w=i("a844"),x=Object(m["a"])(h,c,u,!1,null,null,null),C=x.exports;p()(x,{VCard:g["a"],VCardText:f["b"],VCombobox:b["a"],VForm:_["a"],VTextField:$["a"],VTextarea:w["a"]});var k=o["default"].extend({components:{Editor:C},data:function(){return{show:!1,selected:{script:'(function() {\n  console.log("I\'m a plugin.");\n})();'},valid:!1,newData:{}}},props:{value:Boolean},model:{prop:"value",event:"change"},watch:{show:function(){this.$emit("change",this.show),this.show||(this.selected={})},value:function(){this.show=this.value}},methods:{save:function(){this.$emit("save",Object.assign({isCustom:!0},this.newData)),this.show=!1},cancel:function(){this.show=!1},change:function(t){console.log(t),this.newData=t.data,this.valid=t.valid}}}),y=k,V=(i("573e"),i("8336")),P=i("169a"),D=i("ce7e"),I=i("132d"),E=i("9910"),S=i("71d9"),T=i("2a7f"),O=Object(m["a"])(y,l,r,!1,null,"8e863dca",null),j=O.exports;p()(O,{VBtn:V["a"],VCard:g["a"],VCardActions:f["a"],VCardText:f["b"],VDialog:P["a"],VDivider:D["a"],VIcon:I["a"],VSpacer:E["a"],VToolbar:S["a"],VToolbarTitle:T["b"]});var B=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-dialog",{attrs:{fullscreen:""},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("v-card",[i("v-toolbar",{attrs:{dark:"",color:"blue-grey darken-2"}},[i("v-toolbar-title",[t._v(t._s(t.$t("settings.sitePlugins.edit.title")))]),i("v-spacer"),i("v-btn",{attrs:{icon:"",flat:"",color:"success",href:"https://github.com/pt-plugins/PT-Plugin-Plus/wiki/config-custom-plugin",target:"_blank",rel:"noopener noreferrer nofollow",title:t.$t("common.help")}},[i("v-icon",[t._v("help")])],1)],1),i("v-card-text",{staticClass:"body"},[i("Editor",{attrs:{initData:t.defaultItem},on:{change:t.change}})],1),i("v-divider"),i("v-card-actions",{staticClass:"pa-3 toolbar"},[i("v-spacer"),i("v-btn",{attrs:{flat:"",color:"error"},on:{click:t.cancel}},[i("v-icon",[t._v("cancel")]),i("span",{staticClass:"ml-1"},[t._v(t._s(t.$t("common.cancel")))])],1),i("v-btn",{attrs:{flat:"",color:"success",disabled:!t.valid||t.defaultItem.readonly},on:{click:t.save}},[i("v-icon",[t._v("check_circle_outline")]),i("span",{staticClass:"ml-1"},[t._v(t._s(t.$t("common.ok")))])],1)],1)],1)],1)},M=[],A=o["default"].extend({components:{Editor:C},data:function(){return{show:!1,defaultItem:{},newData:{},valid:!1}},props:{value:Boolean,initData:Object},model:{prop:"value",event:"change"},watch:{show:function(){this.$emit("change",this.show)},value:function(){this.show=this.value,this.show&&(this.defaultItem=Object.assign({},this.initData))}},methods:{save:function(){this.$emit("save",this.newData),this.show=!1},cancel:function(){this.show=!1},change:function(t){console.log(t),this.newData=t.data,this.valid=t.valid}}}),F=A,R=(i("e941"),Object(m["a"])(F,B,M,!1,null,"ee564c72",null)),z=R.exports;p()(R,{VBtn:V["a"],VCard:g["a"],VCardActions:f["a"],VCardText:f["b"],VDialog:P["a"],VDivider:D["a"],VIcon:I["a"],VSpacer:E["a"],VToolbar:S["a"],VToolbarTitle:T["b"]});var J=i("0a02"),q=i("21a6"),N=i.n(q),L=o["default"].extend({components:{AddItem:j,EditItem:z},data:function(){return{selected:[],pagination:{rowsPerPage:-1},showAddDialog:!1,showEditDialog:!1,site:{},selectedItem:{name:"",id:null,pages:[],scripts:[],styles:[],script:"",style:"",readonly:!1},dialogRemoveConfirm:!1,plugins:[],fileImport:null,errorMsg:"",haveError:!1,haveSuccess:!1,successMsg:""}},methods:{add:function(){this.showAddDialog=!0},edit:function(t){this.selectedItem=J["a"].clone(t),t.id||(this.selectedItem.readonly=!0),this.showEditDialog=!0},removeConfirm:function(t){this.selectedItem=t,this.dialogRemoveConfirm=!0},remove:function(){this.dialogRemoveConfirm=!1,this.$store.commit("removePlugin",{host:this.site.host,plugin:this.selectedItem}),this.selectedItem={},this.reloadPlugins(this.site.host)},removeSelected:function(){var t=this;confirm(this.$t("settings.sitePlugins.index.removeSelectedConfirm").toString())&&(this.selected.forEach((function(e){e.isCustom&&t.$store.commit("removePlugin",{host:t.site.host,plugin:e})})),this.selected=[],this.reloadPlugins(this.site.host))},updateItem:function(t){console.log(t),this.selectedItem=t,this.$store.commit("updatePlugin",{host:this.site.host,plugin:t}),this.reloadPlugins(this.site.host)},addItem:function(t){console.log(t),this.$store.commit("addPlugin",{host:this.site.host,plugin:t}),this.reloadPlugins(this.site.host)},reloadPlugins:function(t){if(this.site=this.$store.state.options.sites.find((function(e){return e.host==t})),this.site){var e=[],i=this.site.schema;if("string"===typeof i){var s=this.$store.state.options.system.schemas.find((function(t){return t.name==i}));s&&e.push.apply(e,Object(a["a"])(s.plugins))}else if(i&&i.plugins){var n=this.$store.state.options.system.sites.find((function(e){return e.host==t}));n&&n.schema&&n.schema.plugins&&e.push.apply(e,Object(a["a"])(n.schema.plugins))}this.site.plugins&&e.push.apply(e,Object(a["a"])(this.site.plugins)),this.plugins=e}},clearMessage:function(){this.successMsg="",this.errorMsg=""},share:function(t){var e=(this.site.host||this.site.name)+"-plugin-"+t.name+".json",i=new Blob([JSON.stringify(t)],{type:"text/plain"});N.a.saveAs(i,e)},importConfig:function(){this.fileImport.click()},importConfigFile:function(t){var e=this;this.clearMessage();var i=t.srcElement;if(i.files.length>0&&i.files[0].name.length>0){for(var s=0;s<i.files.length;s++){var n=i.files[s],a=new FileReader;a.onload=function(t){try{var i=JSON.parse(t.target.result);e.importPlugin(i)}catch(s){console.log(s),e.errorMsg=e.$t("common.importFailed").toString()}},a.onerror=function(){e.errorMsg=e.$t("settings.backup.loadError").toString()},a.readAsText(n)}i.value=""}},importPlugin:function(t){if(t.name&&t.id&&t.isCustom&&t.pages&&t.pages.length>0){var e=this.getPlugin(t);if(e){var i=window.prompt(this.$t("settings.sitePlugins.index.importNameDuplicate",{name:e.name}).toString());return i?(t.name=i,void this.importPlugin(t)):void 0}this.addItem(t),this.successMsg=this.$t("common.importSuccess").toString()}else this.errorMsg=this.$t("settings.sitePlugins.index.invalidPlugin").toString()},getPlugin:function(t){var e=this.site.plugins;return e&&e.length>0?e.find((function(e){return e.name===t.name})):null}},created:function(){var t=this.$route.params["host"];console.log("create",this.$route.params),t&&this.reloadPlugins(t)},mounted:function(){this.fileImport=this.$refs.fileImport,this.fileImport.addEventListener("change",this.importConfigFile)},beforeDestroy:function(){this.fileImport.removeEventListener("change",this.importConfigFile)},computed:{headers:function(){return[{text:this.$t("settings.sitePlugins.index.headers.name"),align:"left",value:"name"},{text:this.$t("settings.sitePlugins.index.headers.pages"),align:"left",value:"pages"},{text:this.$t("settings.sitePlugins.index.headers.enable"),align:"left",value:"enable"},{text:this.$t("settings.sitePlugins.index.headers.action"),value:"name",sortable:!1}]}},watch:{successMsg:function(){this.haveSuccess=""!=this.successMsg},errorMsg:function(){this.haveError=""!=this.errorMsg}}}),G=L,H=(i("8205"),i("0798")),K=i("12b2"),Q=i("ac7c"),U=i("cc20"),W=i("8fea"),X=i("2db4"),Y=Object(m["a"])(G,s,n,!1,null,"6c9c35a4",null);e["default"]=Y.exports;p()(Y,{VAlert:H["a"],VBtn:V["a"],VCard:g["a"],VCardActions:f["a"],VCardText:f["b"],VCardTitle:K["a"],VCheckbox:Q["a"],VChip:U["a"],VDataTable:W["a"],VDialog:P["a"],VDivider:D["a"],VIcon:I["a"],VSnackbar:X["a"],VSpacer:E["a"],VTextField:$["a"]})},e941:function(t,e,i){"use strict";i("4049")}}]);