(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-027f245e"],{"14b5":function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));n("a481"),n("6b54"),n("7f7f");var s=n("d225"),a=n("b0b4"),o=function(){function t(){Object(s["a"])(this,t)}return Object(a["a"])(t,[{key:"replacePathKey",value:function(t,e){if(!t)return t;var n=new Date;return this.replaceKeys(t,{"site.name":e.name,"site.host":e.host,YYYY:n.getFullYear(),MM:("0"+(n.getMonth()+1).toString()).substr(-2),DD:("0"+n.getDate().toString()).substr(-2)})}},{key:"getSavePath",value:function(t,e){if(t){var n=t,s="<...>";if(n&&n.indexOf(s)>=0){var a=window.prompt("当前为自定义路径：".concat(n," \n请输入路径中 ").concat(s," 部分的内容: "));if(null===a)return!1;n=n.replace(s,a)}return this.replacePathKey(n,e)}}},{key:"replaceKeys",value:function(t,e){var n=t;for(var s in e)if(e.hasOwnProperty(s)){var a=e[s];n=n.replace("$"+s+"$",a)}return n}}]),t}()},3046:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-btn",{class:[t.mini?"btn-mini":""],attrs:{flat:t.flat,icon:t.icon,small:t.small,loading:t.loading,title:t.title||t.$t("searchTorrent.sendToClientTip"),color:t.color},on:{click:function(e){return e.stopPropagation(),t.showSiteContentMenus.apply(null,arguments)}}},[t.haveSuccess?n("v-icon",{attrs:{color:"success",small:""}},[t._v("done")]):t.haveError?n("v-icon",{attrs:{color:"red",small:""}},[t._v("close")]):n("v-icon",{attrs:{small:""}},[t._v(t._s(t.iconText))]),t.label?n("span",{staticClass:"ml-2"},[t._v(t._s(t.label))]):t._e()],1)},a=[],o=(n("6b54"),n("b54a"),n("7f7f"),n("7514"),n("ac6a"),n("c5f6"),n("2b0e")),i=n("f62e"),r=n("14b5"),l=n("a1f4"),c=n("0a02"),u=new l["a"],d=o["default"].extend({props:{flat:Boolean,icon:Boolean,small:Boolean,mini:Boolean,color:String,iconText:{type:String,default:"cloud_download"},downloadOptions:{type:[Object,Array],default:function(){return{host:String,url:String}}},getOptionsOnly:Boolean,label:String,title:String,payload:[Object,Array,String,Number]},data:function(){return{options:this.$store.state.options,contentMenus:[],pathHandler:new r["a"],loading:!1,site:{},haveSuccess:!1,haveError:!1,allContentMenus:[]}},methods:{getSiteContentMenus:function(t){var e=[],n=[];if(this.contentMenus&&this.contentMenus.length>0)return this.contentMenus;function s(n,s){n.forEach((function(n){e.push({client:s,path:n,host:t})}))}return this.options.clients.forEach((function(a){if(n.push({client:a,path:"",host:t}),a.paths){for(var o in a.paths){var r=a.paths[o];t===o&&s(r,a)}var l=a.paths[i["f"].allSite];l&&(e.length>0&&e.push({}),s(l,a))}})),e.length>0&&n.splice(0,0,{}),e=e.concat(n),this.contentMenus=e,e},getSiteFromHost:function(t){return this.options.sites.find((function(e){var n=e.cdn||[];return e.url&&n.push(e.url),e.host==t||n.join("").indexOf(t)>-1}))},showSiteContentMenus:function(t){var e=this;if(Array.isArray(this.downloadOptions))this.showAllContentMenus(t);else{var n=this.downloadOptions,s=n.host;if(!s&&n.site&&(s=n.site.host),s){this.site=n.site||this.getSiteFromHost(s);var a=this.getSiteContentMenus(s),o=[];a.forEach((function(t){if(t.client&&t.client.name){var s=e.$vuetify.breakpoint.xs?t.client.name:e.$t("searchTorrent.downloadTo",{path:"".concat(t.client.name," -> ").concat(t.client.address)});t.path&&(s+=" ->".concat(e.pathHandler.replacePathKey(t.path,e.site))),o.push({title:s,fn:function(){if(n.url){console.log(n,t);var s={url:n.url,title:n.title,savePath:t.path,autoStart:t.client.autoStart,link:n.link,clientId:t.client.id};if(e.getOptionsOnly)return s.savePath=e.pathHandler.getSavePath(s.savePath,e.site),void e.$emit("itemClick",{payload:e.payload,downloadOptions:Object.assign({clientName:t.client.name},s)});e.sendToClient(s)}}})}else o.push({})})),c["a"].showContextMenu(o,t)}}},showAllContentMenus:function(t){var e=[],n=[],s=this;function a(t){var e=s.$t("searchTorrent.downloadTo",{path:"".concat(t.client.name," -> ").concat(t.client.address)}).toString();t.path&&(e+=" -> ".concat(t.path)),n.push({title:e,fn:function(){s.sendTorrentsInBackground(t)}})}0==this.allContentMenus.length?(this.options.clients.forEach((function(t){e.push({client:t,path:""})})),e.forEach((function(t){if(t.client&&t.client.name){if(a(t),t.client.paths){var e=t.client.paths[i["f"].allSite];e&&e.forEach((function(e){if(-1==e.indexOf("$site.name$")&&-1==e.indexOf("$site.host$")&&-1==e.indexOf("<...>")){var n=c["a"].clone(t);n.path=e,a(n)}}))}}else n.push({})})),this.allContentMenus=n):n=this.allContentMenus,c["a"].showContextMenu(n,t)},sendTorrentsInBackground:function(t){var e=this,n=[];this.downloadOptions.forEach((function(e){n.push({title:e.title,url:e.url,clientId:t.client.id,savePath:t.path,autoStart:t.client.autoStart,link:e.link})})),this.loading=!0,u.sendRequest(i["b"].sendTorrentsInBackground,null,n).then((function(t){console.log("命令执行完成",t),e.haveSuccess=!0,e.$emit("success",t)})).catch((function(t){console.log(t),e.haveError=!0,e.$emit("error",t.msg||t)})).finally((function(){e.loading=!1,setTimeout((function(){e.clearStatus()}),5e3)}))},sendToClient:function(t){var e=this;this.clearStatus();var n=this.pathHandler.getSavePath(t.savePath,this.site);!1!==n&&(this.loading=!0,t.savePath=n,u.sendRequest(i["b"].sendTorrentToClient,null,t).then((function(t){console.log("命令执行完成",t),"success"==t.type?(e.haveSuccess=!0,e.$emit("success",t.msg)):(e.haveError=!0,e.$emit("error",t.msg))})).catch((function(t){console.log(t),e.haveError=!0,e.$emit("error",t.msg||t)})).finally((function(){e.loading=!1,setTimeout((function(){e.clearStatus()}),5e3)})))},clearStatus:function(){this.haveSuccess=!1,this.haveError=!1}}}),h=d,f=n("2877"),p=n("6544"),v=n.n(p),m=n("8336"),g=n("132d"),k=Object(f["a"])(h,s,a,!1,null,null,null);e["a"]=k.exports;v()(k,{VBtn:m["a"],VIcon:g["a"]})},"386b":function(t,e,n){var s=n("5ca1"),a=n("79e5"),o=n("be13"),i=/"/g,r=function(t,e,n,s){var a=String(o(t)),r="<"+e;return""!==n&&(r+=" "+n+'="'+String(s).replace(i,"&quot;")+'"'),r+">"+a+"</"+e+">"};t.exports=function(t,e){var n={};n[t]=e(r),s(s.P+s.F*a((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})),"String",n)}},7938:function(t,e,n){},a605:function(t,e,n){"use strict";n("7938")},b54a:function(t,e,n){"use strict";n("386b")("link",(function(t){return function(e){return t(this,"a","href",e)}}))},d479:function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-alert",{attrs:{value:!0,type:"info"}},[t._v(t._s(t.$t("keepUploadTask.title")))]),n("v-card",[n("v-card-title",[n("v-btn",{attrs:{color:"error",disabled:0==t.selected.length},on:{click:t.removeSelected}},[n("v-icon",{staticClass:"mr-2"},[t._v("remove")]),t._v("\n        "+t._s(t.$t("common.remove"))+"\n      ")],1),n("v-btn",{attrs:{color:"error",disabled:0==t.items.length},on:{click:t.clear}},[n("v-icon",{staticClass:"mr-2"},[t._v("clear")]),t._v("\n        "+t._s(t.$t("common.clear"))+"\n      ")],1),n("v-btn",{attrs:{color:"info",href:"https://github.com/pt-plugins/PT-Plugin-Plus/wiki/keep-upload-task",target:"_blank",rel:"noopener noreferrer nofollow"}},[n("v-icon",{staticClass:"mr-2"},[t._v("help")]),t._v("\n        "+t._s(t.$t("settings.searchSolution.index.help"))+"\n      ")],1),n("v-spacer"),n("v-text-field",{staticClass:"search",attrs:{"append-icon":"search",label:t.$t("keepUploadTask.filterSearchResults"),"single-line":"","hide-details":"",enterkeyhint:"search"},model:{value:t.filterKey,callback:function(e){t.filterKey=e},expression:"filterKey"}})],1),n("v-data-table",{staticClass:"elevation-1",attrs:{search:t.filterKey,"custom-filter":t.searchResultFilter,headers:t.headers,items:t.items,pagination:t.pagination,"item-key":"id","select-all":""},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"items",fn:function(e){return[n("tr",{on:{click:function(t){e.expanded=!e.expanded}}},[n("td",{staticStyle:{width:"20px"}},[n("v-checkbox",{attrs:{primary:"","hide-details":""},model:{value:e.selected,callback:function(n){t.$set(e,"selected",n)},expression:"props.selected"}})],1),n("td",{staticClass:"text-xs-center"},[n("v-avatar",{attrs:{size:"18"}},[n("img",{attrs:{src:e.item.site.icon}})]),n("br"),n("span",{staticClass:"caption"},[t._v(t._s(e.item.site.name))])],1),n("td",{staticClass:"py-2"},[n("a",{staticClass:"subheading",attrs:{href:e.item.items[0].link,target:"_blank",title:e.item.title,rel:"noopener noreferrer nofollow"},domProps:{innerHTML:t._s(e.item.title)}}),n("div",{staticClass:"body-1"},[e.item.items[0].subTitle?n("span",[t._v(t._s(e.item.items[0].subTitle))]):t._e()]),n("div",{staticClass:"caption"},[t._v("\n              "+t._s(t.$t("keepUploadTask.savePath"))+t._s(e.item.downloadOptions.clientName)+" ->\n              "+t._s(e.item.downloadOptions.savePath||t.$t("keepUploadTask.defaultPath"))+"\n              "),n("DownloadTo",{attrs:{flat:"",icon:"",small:"",title:t.$t("keepUploadTask.setSavePath"),iconText:"edit","get-options-only":"",payload:e.item,downloadOptions:e.item.items[0]},on:{itemClick:t.setDownloadOptions}})],1),n("div",{staticClass:"caption"},[t._v("\n              "+t._s(t.$t("keepUploadTask.torrentCount"))+t._s(e.item.items.length)+"\n            ")])]),n("td",{staticClass:"text-xs-right"},[t._v(t._s(t._f("formatSize")(e.item.size)))]),n("td",[t._v(t._s(t._f("formatDate")(e.item.time)))]),n("td",[n("v-btn",{staticClass:"mx-0",attrs:{small:"",color:"success",icon:"",flat:"",title:t.$t("keepUploadTask.sendBaseTorrent")},on:{click:function(n){return n.stopPropagation(),t.sendBaseTorrent(e.item)}}},[n("v-icon",{attrs:{small:""}},[t._v("filter_1")])],1),n("v-btn",{staticClass:"mx-0",attrs:{small:"",color:"info",icon:"",flat:"",title:t.$t("keepUploadTask.sendOtherTorrents")},on:{click:function(n){return n.stopPropagation(),t.sendOtherTorrents(e.item)}}},[n("v-icon",{attrs:{small:""}},[t._v("filter_2")])],1),n("v-btn",{staticClass:"mx-0",attrs:{small:"",color:"primary",icon:"",flat:"",title:t.$t("keepUploadTask.sendAllTorrents")},on:{click:function(n){return n.stopPropagation(),t.sendAllTorrents(e.item)}}},[n("v-icon",{attrs:{small:""}},[t._v("save_alt")])],1),n("v-btn",{staticClass:"mx-0",attrs:{color:"info",small:"",icon:"",flat:"",title:t.$t("searchTorrent.copyToClipboardTip")},on:{click:function(n){return n.stopPropagation(),t.copyLinksToClipboard(e.item)}}},[n("v-icon",{attrs:{small:""}},[t._v("file_copy")])],1),n("v-btn",{staticClass:"mx-0",attrs:{small:"",color:"error",icon:"",flat:"",title:t.$t("common.remove")},on:{click:function(n){return n.stopPropagation(),t.removeConfirm(e.item)}}},[n("v-icon",{attrs:{small:""}},[t._v("delete")])],1)],1)])]}},{key:"expand",fn:function(e){return[n("v-list",{staticClass:"ml-5",attrs:{subheader:"",dense:""}},[t._l(e.item.items,(function(e){return[n("v-list-tile",{key:e.link,staticClass:"ml-5"},[n("v-list-tile-avatar",[n("v-avatar",{attrs:{size:"18"}},[n("img",{attrs:{src:e.site.icon}})])],1),n("v-list-tile-content",[n("v-list-tile-title",[n("a",{attrs:{href:e.link,target:"_blank",title:e.title,rel:"noopener noreferrer nofollow"},domProps:{innerHTML:t._s(e.title)}})]),n("v-list-tile-sub-title",[t._v(t._s(e.subTitle))])],1)],1)]}))],2)]}}]),model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1),n("v-alert",{attrs:{value:!0,color:"warning"}},[n("div",[t._v("\n      警告：\n      "),n("ul",[n("li",[t._v("\n          辅种前请确认下载服务器已关闭类似于 “自动开始下载” 的选项（如果有）。\n        ")]),n("li",[t._v("\n          助手仅对种子文件做简单验证，不保证辅种成功，请自行斟酌是否要使用辅种功能！\n        ")]),n("li",[t._v("\n          如出现因辅种失败造成的爆仓，由用户自行负责！别找我，别找我，别找我。\n        ")])])])]),n("v-dialog",{attrs:{width:"300"},model:{value:t.dialogRemoveConfirm,callback:function(e){t.dialogRemoveConfirm=e},expression:"dialogRemoveConfirm"}},[n("v-card",[n("v-card-title",{staticClass:"headline red lighten-2"},[t._v(t._s(t.$t("keepUploadTask.removeConfirmTitle")))]),n("v-card-text",[t._v(t._s(t.$t("keepUploadTask.removeConfirm")))]),n("v-divider"),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{flat:"",color:"info"},on:{click:function(e){t.dialogRemoveConfirm=!1}}},[n("v-icon",[t._v("cancel")]),n("span",{staticClass:"ml-1"},[t._v(t._s(t.$t("common.cancel")))])],1),n("v-btn",{attrs:{color:"error",flat:""},on:{click:function(e){return t.remove()}}},[n("v-icon",[t._v("check_circle_outline")]),n("span",{staticClass:"ml-1"},[t._v(t._s(t.$t("common.ok")))])],1)],1)],1)],1),n("v-snackbar",{attrs:{top:"",timeout:3e3,color:"error"},model:{value:t.haveError,callback:function(e){t.haveError=e},expression:"haveError"}},[t._v(t._s(t.errorMsg))]),n("v-snackbar",{attrs:{bottom:"",timeout:3e3,color:"success"},model:{value:t.haveSuccess,callback:function(e){t.haveSuccess=e},expression:"haveSuccess"}},[t._v(t._s(t.successMsg))])],1)},a=[],o=(n("28a5"),n("b54a"),n("ac6a"),n("6b54"),n("2b0e")),i=n("f62e"),r=n("a1f4"),l=n("0a02"),c=n("3046"),u=new r["a"],d=o["default"].extend({components:{DownloadTo:c["a"]},data:function(){return{selected:[],selectedItem:{},pagination:{rowsPerPage:10,sortBy:"time",descending:!0},items:[],dialogRemoveConfirm:!1,options:this.$store.state.options,errorMsg:"",haveError:!1,haveSuccess:!1,successMsg:"",siteCache:{},filterKey:"",filteredDatas:[]}},methods:{setDownloadOptions:function(t){console.log(t),t.payload.downloadOptions=t.downloadOptions,u.sendRequest(i["b"].updateKeepUploadTask,null,t.payload)},clear:function(){var t=this;confirm(this.$t("keepUploadTask.clearConfirm").toString())&&u.sendRequest(i["b"].clearKeepUploadTask).then((function(e){console.log("clearKeepUploadTask",e),t.items=[]}))},removeSelected:function(){this.selected&&this.selected.length>0&&confirm(this.$t("common.removeSelectedConfirm",{count:this.selected.length}).toString())&&this.remove(this.selected)},remove:function(t){var e=this;t||(t=[this.selectedItem]),u.sendRequest(i["b"].removeKeepUploadTask,null,t).then((function(t){console.log("removeKeepUploadTask",t),e.resetItems(t)})),this.dialogRemoveConfirm=!1},removeConfirm:function(t){this.selectedItem=t,this.dialogRemoveConfirm=!0},resetItems:function(t){var e=this;this.items=[],t.forEach((function(t){t.items.forEach((function(t){t.site=l["a"].getSiteFromHost(t.host,e.options)})),t.site=l["a"].getSiteFromHost(t.items[0].host,e.options),e.items.push(t)}))},loadKeepUploadTask:function(){var t=this;u.sendRequest(i["b"].loadKeepUploadTask).then((function(e){console.log(e),t.resetItems(e)}))},getInfos:function(t){var e="";return e},clearMessage:function(){this.successMsg="",this.errorMsg=""},sendBaseTorrent:function(t){this.sendTorrentsInBackground(t.downloadOptions)},sendOtherTorrents:function(t){var e=[];t.items.slice(1).forEach((function(n){var s=l["a"].clone(t.downloadOptions);s=Object.assign(s,{title:n.title,url:n.url,link:n.link}),e.push(s)})),this.sendTorrentsInBackground(e)},sendAllTorrents:function(t){var e=[];t.items.forEach((function(n){var s=l["a"].clone(t.downloadOptions);s=Object.assign(s,{title:n.title,url:n.url,link:n.link}),e.push(s)})),this.sendTorrentsInBackground(e)},sendTorrentsInBackground:function(t){var e=this;console.log(t),t.length>1&&!confirm(this.$t("keepUploadTask.sendConfirm",{count:t.length}).toString())||u.sendRequest(i["b"].sendTorrentsInBackground,null,t).then((function(t){e.successMsg=e.$t("keepUploadTask.sendSuccess").toString(),console.log("命令执行完成",t),e.$emit("success",t)})).catch((function(t){console.log(t),e.errorMsg=e.$t("keepUploadTask.sendError").toString()})).finally((function(){}))},copyLinksToClipboard:function(t){var e=this,n=[];t.items.forEach((function(t){n.push(t.url)})),this.clearMessage(),u.sendRequest(i["b"].copyTextToClipboard,null,n.join("\n")).then((function(t){e.successMsg=e.$t("searchTorrent.copySelectedToClipboardSuccess",{count:n.length}).toString()})).catch((function(){e.errorMsg=e.$t("searchTorrent.copyLinkToClipboardError").toString()}))},searchResultFilter:function(t,e){if(e=e.toString().toLowerCase(),this.filteredDatas=[],""===e.trim())return t;var n=e.split(" ");return this.filteredDatas=t.filter((function(t){var e=(t.title+(t.items[0].subTitle||"")).toLowerCase(),s=!0;return n.forEach((function(t){""!=t.trim()&&(s=s&&e.indexOf(t)>-1)})),s})),this.filteredDatas}},created:function(){this.loadKeepUploadTask()},computed:{headers:function(){return[{text:this.$t("keepUploadTask.headers.site"),align:"center",width:"60px",value:"data.title"},{text:this.$t("keepUploadTask.headers.title"),align:"left",value:"data.title"},{text:this.$t("keepUploadTask.headers.size"),align:"right",value:"data.size"},{text:this.$t("keepUploadTask.headers.time"),align:"left",value:"time"},{text:this.$t("history.headers.action"),value:"name",sortable:!1}]}},watch:{successMsg:function(){this.haveSuccess=""!=this.successMsg},errorMsg:function(){this.haveError=""!=this.errorMsg}}}),h=d,f=(n("a605"),n("2877")),p=n("6544"),v=n.n(p),m=n("0798"),g=n("8212"),k=n("8336"),b=n("b0af"),T=n("99d9"),_=n("12b2"),C=n("ac7c"),S=n("8fea"),y=n("169a"),w=n("ce7e"),$=n("132d"),x=n("8860"),M=n("ba95"),O=n("c954"),P=n("5d23"),E=n("2db4"),U=n("9910"),V=n("2677"),B=Object(f["a"])(h,s,a,!1,null,null,null);e["default"]=B.exports;v()(B,{VAlert:m["a"],VAvatar:g["a"],VBtn:k["a"],VCard:b["a"],VCardActions:T["a"],VCardText:T["b"],VCardTitle:_["a"],VCheckbox:C["a"],VDataTable:S["a"],VDialog:y["a"],VDivider:w["a"],VIcon:$["a"],VList:x["a"],VListTile:M["a"],VListTileAvatar:O["a"],VListTileContent:P["b"],VListTileSubTitle:P["c"],VListTileTitle:P["d"],VSnackbar:E["a"],VSpacer:U["a"],VTextField:V["a"]})}}]);