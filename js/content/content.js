!function(t){function e(e){for(var n,s,a=e[0],c=e[1],u=e[2],p=0,h=[];p<a.length;p++)s=a[p],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&h.push(i[s][0]),i[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);for(l&&l(e);h.length;)h.shift()();return r.push.apply(r,u||[]),o()}function o(){for(var t,e=0;e<r.length;e++){for(var o=r[e],n=!0,a=1;a<o.length;a++){var c=o[a];0!==i[c]&&(n=!1)}n&&(r.splice(e--,1),t=s(s.s=o[0]))}return t}var n={},i={0:0},r=[];function s(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=t,s.c=n,s.d=function(t,e,o){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(o,n,function(e){return t[e]}.bind(null,n));return o},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var a=window.webpackJsonp=window.webpackJsonp||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var u=0;u<a.length;u++)e(a[u]);var l=c;r.push([14,1]),o()}({0:function(t,e,o){"use strict";var n,i,r,s,a,c,u,l,p,h,d,f,g,m,v,y,_,b,w,S,P,T,D,C,M,E,B,O,x;o.d(e,"k",(function(){return n})),o.d(e,"j",(function(){return i})),o.d(e,"f",(function(){return r})),o.d(e,"b",(function(){return s})),o.d(e,"i",(function(){return a})),o.d(e,"a",(function(){return c})),o.d(e,"l",(function(){return u})),o.d(e,"d",(function(){return l})),o.d(e,"e",(function(){return p})),o.d(e,"c",(function(){return y})),o.d(e,"g",(function(){return _})),o.d(e,"h",(function(){return P})),function(t){t.ZiB="ZiB",t.EiB="EiB",t.PiB="PiB",t.TiB="TiB",t.GiB="GiB",t.MiB="MiB",t.KiB="KiB"}(n||(n={})),function(t){t.JSON="json",t.XML="xml",t.HTML="html",t.TEXT="text"}(i||(i={})),function(t){t.transmission="transmission",t.utorrent="utorrent",t.deluge="deluge",t.synologyDownloadStation="synologyDownloadStation",t.rutorrent="rutorrent",t.qbittorrent="qbittorrent"}(r||(r={})),function(t){t.normal="normal",t.label="label",t.spliter="spliter",t.popup="popup"}(s||(s={})),function(t){t.POST="POST",t.GET="GET"}(a||(a={})),function(t){t.readConfig="readConfig",t.saveConfig="saveConfig",t.reloadConfig="reloadConfig",t.sendTorrentToDefaultClient="sendTorrentToDefaultClient",t.sendTorrentToClient="sendTorrentToClient",t.searchTorrent="searchTorrent",t.copyTextToClipboard="copyTextToClipboard",t.addTorrentFromURL="addTorrentFromURL",t.getFreeSpace="getFreeSpace",t.downloadFromDroper="downloadFromDroper",t.openOptions="openOptions",t.updateOptionsTabId="updateOptionsTabId",t.getSearchResult="getSearchResult",t.getDownloadHistory="getDownloadHistory",t.removeDownloadHistory="removeDownloadHistory",t.clearDownloadHistory="clearDownloadHistory",t.testClientConnectivity="testClientConnectivity",t.getSystemLogs="getSystemLogs",t.removeSystemLogs="removeSystemLogs",t.clearSystemLogs="clearSystemLogs",t.readUIOptions="readUIOptions",t.saveUIOptions="saveUIOptions",t.showMessage="showMessage",t.writeLog="writeLog",t.serviceStoped="serviceStoped",t.addContentPage="addContentPage",t.abortSearch="abortSearch",t.backupToGoogle="backupToGoogle",t.restoreFromGoogle="restoreFromGoogle",t.clearFromGoogle="clearFromGoogle",t.getTorrentDataFromURL="getTorrentDataFromURL",t.getUserInfo="getUserInfo",t.abortGetUserInfo="abortGetUserInfo",t.refreshUserData="refreshUserData",t.getClearedOptions="getClearedOptions",t.resetRunTimeOptions="resetRunTimeOptions",t.getBase64FromImageUrl="getBase64FromImageUrl",t.getUserHistoryData="getUserHistoryData",t.getMovieInfos="getMovieInfos",t.getMovieRatings="getMovieRatings",t.getIMDbIdFromDouban="getIMDbIdFromDouban",t.queryMovieInfoFromDouban="queryMovieInfoFromDouban",t.addBrowserDownloads="addBrowserDownloads",t.checkPermissions="checkPermissions",t.requestPermissions="requestPermissions",t.changeLanguage="changeLanguage",t.getCurrentLanguageResource="getCurrentLanguageResource",t.addLanguage="addLanguage",t.replaceLanguage="replaceLanguage",t.hideMessage="hideMessage",t.resetUserDatas="resetUserDatas",t.backupToServer="backupToServer",t.restoreFromServer="restoreFromServer",t.getBackupListFromServer="getBackupListFromServer",t.deleteFileFromBackupServer="deleteFileFromBackupServer",t.sendTorrentsInBackground="sendTorrentsInBackground",t.createBackupFile="createBackupFile",t.checkBackupData="checkBackupData",t.addTorrentToCollection="addTorrentToCollection",t.getTorrentCollections="getTorrentCollections",t.deleteTorrentFromCollention="deleteTorrentFromCollention",t.clearTorrentCollention="clearTorrentCollention",t.getTorrentCollention="getTorrentCollention",t.getSiteSelectorConfig="getSiteSelectorConfig",t.resetTorrentCollections="resetTorrentCollections",t.getTorrentCollectionGroups="getTorrentCollectionGroups",t.addTorrentCollectionGroup="addTorrentCollectionGroup",t.addTorrentCollectionToGroup="addTorrentCollectionToGroup",t.updateTorrentCollectionGroup="updateTorrentCollectionGroup",t.removeTorrentCollectionFromGroup="removeTorrentCollectionFromGroup",t.removeTorrentCollectionGroup="removeTorrentCollectionGroup",t.updateTorrentCollention="updateTorrentCollention",t.getAllTorrentCollectionLinks="getAllTorrentCollectionLinks",t.restoreCookies="restoreCookies",t.resetFavicons="resetFavicons",t.resetFavicon="resetFavicon",t.getBackupRawData="getBackupRawData",t.testBackupServerConnectivity="testBackupServerConnectivity",t.createSearchResultSnapshot="createSearchResultSnapshot",t.loadSearchResultSnapshot="loadSearchResultSnapshot",t.getSearchResultSnapshot="getSearchResultSnapshot",t.removeSearchResultSnapshot="removeSearchResultSnapshot",t.clearSearchResultSnapshot="clearSearchResultSnapshot",t.resetSearchResultSnapshot="resetSearchResultSnapshot",t.createKeepUploadTask="createKeepUploadTask",t.loadKeepUploadTask="loadKeepUploadTask",t.getKeepUploadTask="getKeepUploadTask",t.removeKeepUploadTask="removeKeepUploadTask",t.clearKeepUploadTask="clearKeepUploadTask",t.resetKeepUploadTask="resetKeepUploadTask",t.updateKeepUploadTask="updateKeepUploadTask",t.resetDownloadHistory="resetDownloadHistory",t.pushDebugMsg="pushDebugMsg",t.updateDebuggerTabId="updateDebuggerTabId",t.getTopSearches="getTopSearches"}(c||(c={})),function(t){t.text="TEXT",t.json="JSON"}(u||(u={})),function(t){t.default="PT-Plugin-Plus-Config",t.downloadHistory="PT-Plugin-Plus-downloadHistory",t.systemLogs="PT-Plugin-Plus-systemLogs",t.uiOptions="PT-Plugin-Plus-uiOptions",t.cache="PT-Plugin-Plus-Cache-Contents",t.userDatas="PT-Plugin-Plus-User-Datas",t.collection="PT-Plugin-Plus-Collection",t.searchResultSnapshot="PT-Plugin-Plus-SearchResultSnapshot",t.keepUploadTask="PT-Plugin-Plus-KeepUploadTask"}(l||(l={})),function(t){t.success="success",t.error="error",t.info="info",t.warning="warning",t.unknown="unknown"}(p||(p={})),function(t){t.background="background",t.content="content",t.options="options",t.popup="popup",t.debugger="debugger"}(h||(h={})),function(t){t.init="init",t.requestMessage="requestMessage"}(d||(d={})),function(t){t.systemLogs="systemLogs",t.searchTorrent="searchTorrent"}(f||(f={})),function(t){t.home="home",t.downloadPaths="downloadPaths",t.searchTorrent="searchTorrent"}(g||(g={})),function(t){t.latest="latest",t.today="today",t.all="all"}(m||(m={})),function(t){t.needLogin="needLogin",t.notSupported="notSupported",t.unknown="unknown",t.success="success"}(v||(v={})),function(t){t.allSite="__allSite__",t.all="__all__",t.noGroup="__noGroup__"}(y||(y={})),function(t){t.development="development",t.normal="normal",t.crx="crx"}(_||(_={})),function(t){t.id="id",t.name="name"}(b||(b={})),function(t){t[t.downloading=1]="downloading",t[t.sending=2]="sending",t[t.completed=255]="completed",t[t.inactive=3]="inactive"}(w||(w={})),function(t){t.OWSS="OWSS",t.WebDAV="WebDAV"}(S||(S={})),function(t){t.left="left",t.right="right"}(P||(P={})),function(t){t.faq="https://github.com/pt-plugins/PT-Plugin-Plus/wiki/frequently-asked-questions"}(T||(T={})),function(t){t.all="all",t.options="options",t.userDatas="userDatas",t.collection="collection",t.cookies="cookies",t.searchResultSnapshot="searchResultSnapshot",t.keepUploadTask="keepUploadTask",t.downloadHistory="downloadHistory"}(D||(D={})),function(t){t.Chrome="Chrome",t.Firefox="Firefox"}(C||(C={})),function(t){t.success="success",t.error="error",t.loading="loading"}(M||(M={})),function(t){t.time="time",t.name="name",t.size="size"}(E||(E={})),function(t){t.desc="desc",t.asc="asc"}(B||(B={})),function(t){t.AES="AES"}(O||(O={})),function(t){t.needSecretKey="needSecretKey",t.errorSecretKey="errorSecretKey"}(x||(x={}))},14:function(t,e,o){"use strict";o.r(e);var n=o(0),i=function(){function t(){this.isExtensionMode=!1,window.chrome&&chrome.extension&&(this.isExtensionMode=!0)}return t.prototype.set=function(t,e,o){var i=this;return void 0===o&&(o=n.l.json),new Promise((function(r,s){if(i.isExtensionMode){var a={};a[t]=e,chrome.storage.local.set(a,(function(){r()}))}else"string"!=typeof e&&o==n.l.json&&(e=JSON.stringify(e)),window.localStorage.setItem(t,e),r()}))},t.prototype.get=function(t,e,o){if(void 0===o&&(o=n.l.json),this.isExtensionMode)chrome.storage.local.get(t,(function(o){o&&o[t]?e(o[t]):e(null)}));else{var i=window.localStorage.getItem(t);i&&o==n.l.json&&(i=JSON.parse(i)),e&&e(i)}},t}(),r=o(4),s=o.n(r),a=o(2),c={formatNumber:function(t,e){if(void 0===e&&(e="###,###,###,###.00"),void 0===t)return"";var o=function(t,e,o){if(""===t||void 0===t)return""===e||void 0===e?"":e;var n="",i="",r="",s=0;o||(t=t.split("").reverse().join(""),e=e.split("").reverse().join(""));for(var a=0,c=0;c<e.length;c++,a++)if(void 0!==(i=t.charAt(a)))switch(n=e.charAt(c)){case"#":r+=i,s=c;break;case"0":r=i||i===n?r+i:r+0,s=c;break;case".":case",":r+=i===n?i:(a--,n);break;default:r+=n,a--}return a!==t.length&&"0"!==e.charAt(e.length-1)&&s!==e.length&&"0"!==e.charAt(s)&&(r=r.substr(0,s+1)+t.substr(a)+r.substr(s+1)),","===(r=(o?r:r.split("").reverse().join("")).replace(/(^,)|(,$)|(,,+)/g,"")).substr(0,1)&&(r=r.substr(1)),"-,"===r.substr(0,2)&&(r="-"+r.substr(2)),r},n=t.toString();if(0===n.length)return"";var i=parseFloat(n);if(isNaN(i))return n;if(!e)return n;var r=e.split("."),s=n.split(".");return r.length>1?o(s[0],r[0])+"."+o(s[1],r[1],1):o(s[0],r[0])},formatSize:function(t,e,o){void 0===e&&(e=!1),void 0===o&&(o="");var n,i=parseFloat(t);if(isNaN(i))return"";if(i<0)return"N/A";if(0===i)return e?"":"speed"===o?"0.00 KiB/s":"0.00";var r="KiB",s="###,###,###,###.00 ",a="###,###,###,###.000 ";return i<1e3*Math.pow(2,10)?(n=i/Math.pow(2,10),r="KiB"):i<1e3*Math.pow(2,20)?(n=i/Math.pow(2,20),r="MiB"):i<1e3*Math.pow(2,30)?(n=i/Math.pow(2,30),r="GiB"):i<1e3*Math.pow(2,40)?(n=i/Math.pow(2,40),r="TiB",s=a):i<1e3*Math.pow(2,50)?(n=i/Math.pow(2,50),r="PiB",s=a):i<1e3*Math.pow(2,60)?(n=i/Math.pow(2,60),r="EiB",s=a):(n=i/Math.pow(2,70),r="ZiB",s=a),"speed"===o&&(r+="/s"),this.formatNumber(n,s)+r},formatSizeWithNegative:function(t,e,o){void 0===e&&(e=!1),void 0===o&&(o="");var n=t=parseFloat(t);t<0&&(n=-n);var i=this.formatSize(n,e,o);return t<0&&(i="- "+i),i},formatSpeed:function(t,e){return void 0===e&&(e=!1),this.formatSize(t,e,"speed")},parseURL:function(t){var e=document.createElement("a");return e.href=t,{source:t,protocol:e.protocol.replace(":",""),host:e.hostname,port:e.port,query:e.search,params:function(){for(var t,o={},n=e.search.replace(/^\?/,"").split("&"),i=n.length,r=0;r<i;r++)n[r]&&(o[(t=n[r].split("="))[0]]=t[1]);return o}(),hash:e.hash.replace("#",""),path:e.pathname.replace(/^([^/])/,"/$1"),segments:e.pathname.replace(/^\//,"").split("/"),origin:e.protocol+"//"+e.hostname+(e.port?":"+e.port:"")}},timeAgoToNumber:function(t){var e=t.trim().match(/^([\d.]+).+?((year|month|week|day|hour|min|minute)s?)( +ago)?(.+)?$/i);if(!e)return 0;var o=new Date,n=e[3],i=Math.round(parseFloat(e[1])),r=new Date;switch(n.toLowerCase()){case"year":r=new Date(o.setFullYear(o.getFullYear()-i));break;case"month":r=new Date(o.setMonth(o.getMonth()-i));break;case"day":r=new Date(o.setDate(o.getDate()-i));break;case"week":r=new Date(o.setDate(o.getDate()-7*i));break;case"hour":r=new Date(o.setHours(o.getHours()-i));break;case"min":case"minute":r=new Date(o.setMinutes(o.getMinutes()-i))}return r.getTime()}},u=o(8),l=o.n(u),p=(function(){function t(t){var e=this;this.options=t,this.count=0,this.completedCount=0,this.downloadingCount=0,this.files={},this.queues=[],t.files&&t.files.forEach((function(t){e.push(t)}))}t.prototype.push=function(t){var e=this;if(!(!t.url||t.url&&this.files[t.url])){var o=new p(t);o.onCompleted=function(){e.downloadingCount--,e.completedCount++,e.onCompleted(o),delete e.files[o.url]},o.onStart=function(){e.downloadingCount++},o.onError=function(t){e.downloadingCount--,e.completedCount++,e.options.onError&&e.options.onError.call(e,o,t),delete e.files[o.url]},o.onProgress=function(t,n,i){e.options.onProgress&&e.options.onProgress.call(e,o,t,n,i)},this.files[o.url]=o,this.queues.push(o),this.count++,this.options.autoStart&&o.start()}},t.prototype.start=function(){},t.prototype.onCompleted=function(t){this.options.onCompleted&&this.options.onCompleted.call(this,t)}}(),function(){function t(t){this.lastTime=0,this.startTime=0,this.status=0,this.statusText="",this.url="",this.requestMethod=n.i.GET,this.postData=null,this.fileName="",this.loaded=0,this.total=0,this.percent=0,this.speed=0,this.showSpeed="",this.onProgress=function(){},this.onCompleted=function(){},this.onError=function(){},this.onStart=function(){},this.getDataOnly=!1,this.timeout=0,this.xhr=new XMLHttpRequest,this.fileName=t.fileName||"",this.url=t.url,this.getDataOnly=t.getDataOnly||!1,this.timeout=t.timeout||0,this.requestMethod=t.method||n.i.GET}return t.prototype.start=function(){var t=this;this.lastTime=+new Date,this.startTime=this.lastTime,this.statusText="\u6570\u636e\u51c6\u5907\u4e2d\u2026\u2026",this.timeout>0&&(this.xhr.timeout=this.timeout),this.xhr.open(this.requestMethod,this.url,!0),this.xhr.responseType="blob",this.xhr.onreadystatechange=function(){switch(t.xhr.readyState){case 4:switch(t.xhr.status){case 200:case 302:t.content=t.xhr.response,t.downloadCompleted();break;default:0!=t.xhr.status&&t.downloadError("["+t.url+"] \u4e0b\u8f7d\u5931\u8d25\uff0c\u8fd4\u56de\u7684\u72b6\u6001\u7801\u4e3a\uff1a"+t.xhr.status)}break;case 2:var e=t.xhr.getResponseHeader("Content-Disposition");!e||t.fileName||t.getDataOnly||(t.fileName=t.getFileName(e))}},this.xhr.onprogress=function(e){t.loaded=e.loaded,t.total=e.total,t.percent=(e.loaded/e.total*100).toFixed(2),t.lastTime=+new Date,t.speed=t.loaded/(t.startTime-t.lastTime),t.updateProgress()},this.xhr.onerror=function(e){t.downloadError(e)},this.xhr.ontimeout=function(){t.downloadError("["+t.url+"] \u4e0b\u8f7d\u8d85\u65f6")};var e=null;this.postData&&(e=$.param(this.postData)),this.requestMethod==n.i.POST&&this.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.xhr.send(e),this.onStart&&this.onStart.call(this)},t.prototype.getFileName=function(t){void 0===t&&(t="");for(var e,o=t.split(";"),n={},i="",r=0;r<o.length;r++){var s=o[r].replace(" ","").split("=");2==s.length&&(n[s[0]]=s[1].trim())}if(e=n["filename*"]){r=e.lastIndexOf("'");i=e.substr(r+1)}else i=n.filename;return i=i.replace(/"/g,""),decodeURI(i)},t.prototype.downloadCompleted=function(){this.loaded>0&&!this.getDataOnly&&l.a.saveAs(this.content,this.fileName),this.onCompleted&&this.onCompleted.call(this)},t.prototype.downloadError=function(t){this.onError&&this.onError.call(this,t)},t.prototype.updateProgress=function(){this.onProgress&&this.onProgress.call(this,this.loaded,this.total,this.speed)},t}()),h="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",d=(function(){function t(t){this.service=t,this.cache={},this.loadCache()}t.prototype.loadCache=function(){var t=window.localStorage.getItem("Favicon-Cache");t&&(this.cache=JSON.parse(t)||{})},t.prototype.saveCache=function(){window.localStorage.setItem("Favicon-Cache",JSON.stringify(this.cache))},t.prototype.clear=function(){this.cache={},this.saveCache()},t.prototype.reset=function(){var t=JSON.parse(JSON.stringify(this.cache));this.cache={};var e=[];for(var o in t)if(t.hasOwnProperty(o)){var n=t[o];e.push(n.origin)}return this.gets(e)},t.prototype.gets=function(t){var e=this;return new Promise((function(o,n){var i=[];t.forEach((function(t){i.push(e.get(t))})),Promise.all(i).then((function(t){o(t)})).catch((function(t){n(t)}))}))},t.prototype.get=function(t,e){var o=this;return void 0===e&&(e=!1),new Promise((function(n,i){var r=c.parseURL(t),s=o.cache[r.host];if(s&&!e)return n(s);o.cacheFavicon(r.origin,r.host).then((function(t){n(t)})).catch((function(t){i(t)}))}))},t.prototype.cacheFavicon=function(t,e){var o=this;return new Promise((function(n,i){o.download(t+"/favicon.ico").then((function(r){r&&/image/gi.test(r.type)?o.transformBlob(r,"base64").then((function(e){n(o.set(t,e))})).catch((function(t){i(t)})):o.cacheFromIndex(t,e).then((function(t){n(t)})).catch((function(t){i(t)}))})).catch((function(){o.cacheFromIndex(t,e).then((function(t){n(t)})).catch((function(t){i(t)}))}))}))},t.prototype.set=function(t,e){var o=c.parseURL(t),n={origin:o.origin,host:o.host,data:e};return this.cache[o.host]=n,this.saveCache(),n},t.prototype.cacheFromIndex=function(t,e){var o=this;return new Promise((function(e,n){o.download(t).then((function(i){i&&/text/gi.test(i.type)?o.transformBlob(i,"text").then((function(i){try{var r=(new DOMParser).parseFromString(i,"text/html"),s=$(r).find("head").find("link[rel*=icon]:first");if(s&&s.length>0){var a=c.parseURL(t),u=s.attr("href")+"";"//"===u.substr(0,2)?u=a.protocol+":"+u:"http"!==u.substr(0,4)&&(u=a.origin+"/"+u),o.download(u).then((function(i){i&&/image/gi.test(i.type)?o.transformBlob(i,"base64").then((function(n){e(o.set(t,n))})).catch((function(t){o.debug(t),n(t)})):e(o.set(t,h))})).catch((function(){e(o.set(t,h))}))}else e(o.set(t,h))}catch(n){console.log(n),o.debug(n),e(o.set(t,h))}})).catch((function(t){o.debug(t),n(t)})):n()})).catch((function(){e(o.set(t,h))}))}))},t.prototype.transformBlob=function(t,e){return new Promise((function(o,n){var i=new FileReader;switch(i.addEventListener("loadend",(function(){i.result?o(i.result):n()})),e){case"text":i.readAsText(t);break;case"base64":i.readAsDataURL(t)}}))},t.prototype.download=function(t){var e=this;return new Promise((function(o,n){var i=new p({url:t,getDataOnly:!0,timeout:5e3});i.onCompleted=function(){i.content?o(i.content):n()},i.onError=function(t){console.log("Favicon.download.error",t),e.debug(t),n(t)},i.start()}))},t.prototype.debug=function(){for(var t,e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];this.service&&(t=this.service).debug.apply(t,e)}}(),""),f=!1;try{var g=chrome.runtime;f=!0,(d=g.getManifest().options_ui.page.replace("index.html",""))&&"/"==d.substr(-1)&&(d=d.substr(0,d.length-1)),d||(d="chrome-extension://"+chrome.runtime.id)}catch(t){f=!1}var m=f?(f?d:"")+"/resource":"http://"+window.location.hostname+":8001",v={host:m,schemas:m+"/schemas.json",schemaConfig:m+"/schemas/{$schema}/config.json",sites:m+"/sites.json",siteConfig:m+"/sites/{$site}/config.json",clients:m+"/clients.json",clientConfig:m+"/clients/{$client}/config.json",latestReleases:"https://api.github.com/repos/pt-plugins/PT-Plugin-Plus/releases/latest",systemConfig:m+"/systemConfig.json"},y={debugMode:!1,scriptQueues:[],isExtensionMode:f,cache:{localStorage:new i,cacheKey:n.d.cache,contents:{},expires:86400,init:function(t){var e=this;y.debugMode&&console.log("cache.init"),this.localStorage.get(this.cacheKey,(function(o){if(o){var n=o.expires;n&&new Date>new Date(n)||y.debugMode?e.contents={}:e.contents=o}t&&t()}))},get:function(t){return this.contents?this.contents[s()(t)]:null},set:function(t,e){this.contents[s()(t)]=e,this.contents.update=(new Date).getTime(),this.contents.expires=(new Date).getTime()+this.expires,this.localStorage.set(this.cacheKey,this.contents)},clear:function(){this.contents={},this.localStorage.set(this.cacheKey,this.contents)},getLastUpdateTime:function(){var t=this;return new Promise((function(e,o){t.localStorage.get(t.cacheKey,(function(t){if(t){var n=t.update;e(n||0)}else o()}))}))}},addScript:function(t){y.debugMode&&console.log("addScript",t),this.scriptQueues.push(t)},applyScripts:function(){var t=this,e=this.scriptQueues.shift();e&&this.execScript(e).then((function(){t.applyScripts()}))},execScript:function(t){var e=this;return new Promise((function(o,n){switch(t.type){case"code":e.runScript(t.content),o();break;default:var i=t.content||t;"http"!==i.substr(0,4)&&("/"!==i.substr(0,1)&&(i="/"+i),i=""+_.host+i);var r=e.cache.get(i);try{r?(e.runScript(r),o()):(console.log("execScript: %s",i),$.ajax({url:i,dataType:"text"}).done((function(t){e.runScript(t),e.cache.set(i,t),o()})).fail((function(t,e,o){t.responseJSON&&t.responseJSON.code&&t.responseJSON.msg?n(t.responseJSON.msg+" ("+t.responseJSON.code+")"):n(e+", "+o)})))}catch(t){n(t)}}}))},runScript:function(t,e){void 0===e&&(e=window),eval.call(e,t)},applyStyle:function(t){var e=this;return new Promise((function(o,n){var i=$("<style/>").appendTo(document.body);switch(t.type){case"file":var r=t.content;"http"!==r.substr(0,4)&&("/"!==r.substr(0,1)&&(r="/"+r),r=""+_.host+r);var s=e.cache.get(r);s?(i.html(s),o()):$.get(r,(function(t){i.html(t),e.cache.set(r,t),o()}),"text");break;default:i.html(t.content),o()}}))},getScriptContent:function(t){var e=_.host+"/"+t;return e="http"===t.substr(0,4)?t:e.replace("resource//","resource/"),y.debugMode&&console.log("getScriptContent",e),$.ajax({url:e,dataType:"text"})},createErrorMessage:function(t){return{type:n.e.error,msg:t,success:!1}},showNotifications:function(t,e){void 0===e&&(e=3e3),a.a.showNotifications(t,e)},getInstallType:function(){return new Promise((function(t,e){chrome&&chrome.management?chrome.management.getSelf((function(e){e.updateUrl&&e.updateUrl.indexOf("pt-plugins/PT-Plugin-Plus")>0?t(n.g.crx):t(e.installType)})):e()}))}};y.cache.init();var _=v,b=function(){function t(){this.isExtensionMode=y.isExtensionMode}return t.prototype.sendRequest=function(t,e,o){var i=this;return new Promise((function(r,s){if(i.isExtensionMode)try{chrome.runtime.sendMessage({action:t,data:o},(function(n){if(chrome.runtime.lastError){var i=chrome.runtime.lastError.message||"";if(console.log("Extension.sendRequest.runtime",t,o,chrome.runtime.lastError.message),/Could not establish connection/.test(i))return y.showNotifications({message:"\u63d2\u4ef6\u72b6\u6001\u672a\u77e5\uff0c\u5f53\u524d\u64cd\u4f5c\u53ef\u80fd\u5931\u8d25\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u540e\u518d\u8bd5"}),void s(chrome.runtime.lastError);if(!/The message port closed before a response was received/.test(i))return void s(chrome.runtime.lastError)}e&&e(n.resolve||n.reject),n.reject?s(n.reject):!n.resolve||"error"!==n.resolve.status&&!1!==n.resolve.success?r(n.resolve):s(n.resolve)}))}catch(t){/Invocation of form runtime\.connect|doesn't match definition runtime\.connect|Extension context invalidated/.test(t.message)?s({type:n.e.error,msg:"\u63d2\u4ef6\u72b6\u6001\u672a\u77e5\uff0c\u5f53\u524d\u64cd\u4f5c\u53ef\u80fd\u5931\u8d25\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u540e\u518d\u8bd5",success:!1}):s(t)}else 0}))},t}(),w=function(){function t(){}return t.prototype.replacePathKey=function(t,e){if(!t)return t;var o=new Date;return this.replaceKeys(t,{"site.name":e.name,"site.host":e.host,YYYY:o.getFullYear(),MM:("0"+(o.getMonth()+1).toString()).substr(-2),DD:("0"+o.getDate().toString()).substr(-2)})},t.prototype.getSavePath=function(t,e){if(t){var o=t;if(o&&o.indexOf("<...>")>=0){var n=window.prompt("\u5f53\u524d\u4e3a\u81ea\u5b9a\u4e49\u8def\u5f84\uff1a"+o+" \n\u8bf7\u8f93\u5165\u8def\u5f84\u4e2d <...> \u90e8\u5206\u7684\u5185\u5bb9: ");if(null===n)return!1;o=o.replace("<...>",n)}return this.replacePathKey(o,e)}},t.prototype.replaceKeys=function(t,e){var o=t;for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];o=o.replace("$"+n+"$",i)}return o},t}(),S=o(1),P=o(9),T=function(){function t(){this.options={sites:[],clients:[]},this.site={name:""},this.action=n.a,this.filters=c,this.downloadClientType=n.f,this.sizeUnit=n.k,this.buttonType=n.b,this.allSiteKey=n.c.allSite,this.schema={},this.scripts=[],this.styles=[],this.messageItems={},this.buttonBar=null,this.droper=$("<div style='display:none;' class='pt-plugin-droper'/>"),this.buttons=[],this.logo=null,this.backgroundServiceIsStoped=!1,this.locationURL=location.href,this.pathHandler=new w,this.i18n=S.a,this.infoParser=new P.a,this.pageSelector={},this.autoPosition=!0,this.positionStorageKey="",this.extension=new b,this.extension.isExtensionMode&&(this.readConfig(),this.initBrowserEvent())}return t.prototype.readConfig=function(){var t=this;this.extension.sendRequest(n.a.readConfig,(function(e){t.options=e,t.initI18n()}))},t.prototype.init=function(){var t=this;this.initPages(),setInterval((function(){t.checkLocationURL()}),1e3)},t.prototype.initI18n=function(){var t=this;this.extension.sendRequest(n.a.getCurrentLanguageResource,null,"contentPage").then((function(e){var o,n=t.options.locale||"en";S.a.init({lng:n,interpolation:{prefix:"{",suffix:"}"},resources:(o={},o[n]={translation:e},o)}),t.init()}))},t.prototype.getSiteFromHost=function(t){y.debugMode&&console.log("getSiteFromHost",t);var e=[];this.options.sites&&e.push.apply(e,this.options.sites),this.options.system&&this.options.system.publicSites&&e.push.apply(e,this.options.system.publicSites);var o=e.find((function(e){var o=[e.url].concat(e.cdn);return e.host==t||o.join("").indexOf("//"+t)>-1}));return o?JSON.parse(JSON.stringify(o)):null},t.prototype.initPages=function(){var t=this;this.initSiteConfig().then((function(){t.initPlugins()})).catch((function(){y.debugMode&&console.log("initPages \u5931\u8d25")}))},t.prototype.initSiteConfig=function(){var t=this;return new Promise((function(e,o){if(t.options.showToolbarOnContentPage)if(t.site=t.getSiteFromHost(window.location.hostname),t.site&&(t.site.url=window.location.origin+"/"),t.site&&t.site.name){if("string"==typeof t.site.schema)t.schema=t.options.system&&t.options.system.schemas&&t.options.system.schemas.find((function(e){return e.name==t.site.schema}));else{var n=t.options.system&&t.options.system.sites&&t.options.system.sites.find((function(e){return e.host==t.site.host}));n&&n.schema&&"string"!=typeof n.schema&&(t.schema=n.schema,t.schema.siteOnly=!0)}t.initPageSelector().finally((function(){e()}))}else o();else o()}))},t.prototype.initPlugins=function(){var t=this;this.positionStorageKey="pt-plugin-"+this.site.host+"-position",this.scripts=[],this.styles=[],this.initButtonBar(),this.initDroper(),this.schema&&this.schema.plugins&&this.schema.plugins.forEach((function(e){-1!==e.pages.findIndex((function(t){var e=window.location.href,o=window.location.pathname;return-1!==e.indexOf(t)||new RegExp(t,"").test(o)}))&&e.scripts.forEach((function(e){var o=e;"/"!==o.substr(0,1)&&(o=t.schema.siteOnly?"sites/"+t.site.host+"/"+e:"schemas/"+t.schema.name+"/"+e),t.scripts.push({type:"file",content:o})}))}));var e=this.options.system&&this.options.system.sites&&this.options.system.sites.find((function(e){return e.host==t.site.host}));if(this.site.plugins){if("publicSite"!==this.site.schema&&e)for(var o=this.site.plugins.length-1;o>=0;o--){this.site.plugins[o].isCustom||this.site.plugins.splice(o,1)}}else this.site.plugins=[];if(e&&e.plugins&&(this.site.plugins=e.plugins.concat(this.site.plugins)),this.site.plugins){var i="publicSite"==this.site.schema?"publicSites":"sites";this.site.path?i+="/"+this.site.path:i+="/"+this.site.host,this.site.plugins.forEach((function(e){-1!==e.pages.findIndex((function(t){var e=window.location.pathname;return-1!==e.indexOf(t)||new RegExp(t,"").test(e)}))&&(e.scripts&&e.scripts.forEach((function(e){var o=e;"/"!==o.substr(0,1)&&"http"!==o.substr(0,4)&&(o=i+"/"+e),t.scripts.push({type:"file",content:o})})),e.script&&t.scripts.push({type:"code",content:e.script}),e.styles&&e.styles.forEach((function(e){var o=e;"/"!==o.substr(0,1)&&"http"!==o.substr(0,4)&&(o=i+"/"+e),t.styles.push({type:"file",content:o})})),e.style&&t.styles.push({type:"code",content:e.style}))}))}this.styles&&this.styles.length>0&&this.styles.forEach((function(t){y.applyStyle(t)})),this.scripts&&this.scripts.length>0&&(this.scripts.forEach((function(t){y.addScript(t)})),y.applyScripts()),this.extension.sendRequest(n.a.addContentPage).catch((function(t){console.log(t)}))},t.prototype.call=function(t,e){var o=this;return new Promise((function(n,i){if(o.backgroundServiceIsStoped)i({msg:S.a.t("backgroundServiceIsStoped")});else try{o.extension.sendRequest(t,null,e).then((function(t){t?n&&n(t):i&&i()})).catch((function(t){i(t)}))}catch(e){o.showNotice(S.a.t("actionExecutionFailed",{action:t})),i(e)}}))},t.prototype.initButtonBar=function(){var t=this;if($(".pt-plugin-body").length&&$(".pt-plugin-body").remove(),this.buttonBar=$("<div class='pt-plugin-body'/>").appendTo(document.body),window.Drag){var e=$("<div class='pt-plugin-drag-title' title='"+S.a.t("dragTitle")+"'>").appendTo(this.buttonBar);new window.Drag(this.buttonBar.get(0),{handle:e.get(0),onStop:function(e){console.log(e),t.saveButtonBarPosition(e)}}),e.on("dblclick",(function(){t.resetButtonBarPosition()}))}this.logo=$("<div class='pt-plugin-logo' title='"+S.a.t("pluginTitle")+"'/>").appendTo(this.buttonBar),this.logo.on("click",(function(){t.call(n.a.openOptions)})),this.initButtonBarPosition(),this.buttonBar.hide()},t.prototype.initButtonBarPosition=function(){var t=window.localStorage.getItem(this.positionStorageKey);if(t)try{var e=JSON.parse(t);return this.buttonBar.css({top:e.top,left:e.left}),void(this.autoPosition=!1)}catch(t){console.log(t)}this.buttonBar.css({top:window.innerHeight/2,left:"unset"}),this.options.position==n.h.left&&this.buttonBar.css({right:"unset",left:"5px"})},t.prototype.resetButtonBarPosition=function(){window.localStorage.removeItem(this.positionStorageKey),this.autoPosition=!0,this.initButtonBarPosition(),this.recalculateButtonBarPosition()},t.prototype.saveButtonBarPosition=function(t){window.localStorage.setItem(this.positionStorageKey,JSON.stringify(t)),this.autoPosition=!1},t.prototype.addButton=function(t){var e=this;t=Object.assign({type:n.b.normal},t);var o=$("<hr/>").appendTo(this.buttonBar),i="<a class='pt-plugin-button'/>";t.click&&t.type!=n.b.label||(i="<span class='pt-plugin-button'/>");var r=$(i).attr({title:t.title,key:t.key}).data("line",o),s=$("<div class='pt-plugin-button-inner'/>").appendTo(r),a=$("<div class='pt-plugin-loading'/>").appendTo(r),c=$("<div class='action-success'/>").html('<div class="action-success-ani"></div>').appendTo(r);t.icon&&$("<i class='material-icons md-36'/>").html(t.icon).appendTo(s),$("<div/>").html(t.label).appendTo(s);var u=function(o){t.type==n.b.normal?a.hide():s.hide(),c.show(),o&&o.msg&&(o.type||(o.type="success"),e.showNotice(o)),setTimeout((function(){c.hide(),s.show()}),2e3)},l=function(o){t.type==n.b.normal&&a.hide(),s.show(),e.showNotice({msg:o||S.a.t("callbackFailed",{label:t.label})})};t.click&&r.click((function(e){t.type==n.b.normal&&(s.hide(),a.show()),t.click(u,l,e)})),r.appendTo(this.buttonBar),t.onDrop&&this.addDroper(r,t.onDrop,u,l),this.buttons.push(r),this.recalculateButtonBarPosition()},t.prototype.removeButton=function(t){var e=this.buttons.findIndex((function(e){return e.attr("key")==t}));if(-1!=e){var o=this.buttons[e],n=o.data("line");n&&n.remove(),o.remove(),this.buttons.splice(e,1)}this.recalculateButtonBarPosition()},t.prototype.recalculateButtonBarPosition=function(){this.buttons.length>0?this.buttonBar.show():this.buttonBar.hide(),this.autoPosition&&this.buttonBar.css({top:window.innerHeight/2-this.buttonBar.outerHeight(!0)/2})},t.prototype.showNotice=function(t){y.debugMode&&console.log(t),(t=Object.assign({type:"error",timeout:5,position:"bottomRight",progressBar:!0,width:320,indeterminate:!1},"string"==typeof t?{msg:t}:"object"==typeof t.msg?t.msg:t)).text=t.text||t.msg,t.timeout&&(t.timeout=10*t.timeout),delete t.msg;var e=new window.NoticeJs(t);return!0===t.indeterminate?(this.messageItems[e.id]=e,e.show(),e):$(e.show())},t.prototype.hideMessage=function(t){this.messageItems[t]&&this.messageItems[t].close()},t.prototype.getSiteDefaultPath=function(t){void 0===t&&(t=""),t||(t=this.site.defaultClientId||this.options.defaultClientId);var e=this.options.clients.find((function(e){return e.id===t})),o="";if(e&&e.paths)for(var n in e.paths)if(this.site.host===n){o=e.paths[n][0];break}return this.pathHandler.replacePathKey(o,this.site)},t.prototype.getClientOptions=function(t){return void 0===t&&(t=""),t||(t=this.site.defaultClientId||this.options.defaultClientId),this.options.clients.find((function(e){return e.id===t}))},t.prototype.initDroper=function(){var t=this;this.options.allowDropToSend&&(document.addEventListener("dragstart",(function(t){if("A"==t.target.tagName){var e={url:t.target.getAttribute("href"),title:t.target.getAttribute("title")};t.dataTransfer.setData("text/plain",JSON.stringify(e))}})),this.buttonBar.on("dragover",(function(e){e.stopPropagation(),e.preventDefault(),t.showDroper()})),this.buttonBar.on("dragleave",(function(e){t.buttonBar.removeClass("pt-plugin-body-over")})),this.buttonBar.on("mouseleave",(function(e){t.buttonBar.removeClass("pt-plugin-body-over"),t.hideDroper()})),this.droper.appendTo(this.buttonBar),this.droper[0].addEventListener("dragover",(function(e){e.stopPropagation(),e.preventDefault(),t.logo.addClass("pt-plugin-onLoading"),t.buttonBar.addClass("pt-plugin-body-over")}),!1),this.droper[0].addEventListener("drop",(function(e){e.stopPropagation(),e.preventDefault(),t.hideDroper();try{var o=JSON.parse(e.dataTransfer.getData("text/plain"));if(o)if(o.url){var i=o.url.match(/imdb\.com\/title\/(tt\d+)/);if(i&&i.length>1)return t.extension.sendRequest(n.a.openOptions,null,"search-torrent/"+i[1]),void t.logo.removeClass("pt-plugin-onLoading");t.pageApp?t.pageApp.call(n.a.downloadFromDroper,o).then((function(){t.logo.removeClass("pt-plugin-onLoading")})).catch((function(){t.logo.removeClass("pt-plugin-onLoading")})):(t.showNotice({type:n.e.info,msg:S.a.t("notSupported"),timeout:3}),t.logo.removeClass("pt-plugin-onLoading"))}else t.logo.removeClass("pt-plugin-onLoading")}catch(e){t.logo.removeClass("pt-plugin-onLoading")}}),!1),this.droper.on("dragleave dragend",(function(e){e.stopPropagation(),e.preventDefault(),t.hideDroper(),t.logo.removeClass("pt-plugin-onLoading"),t.buttonBar.removeClass("pt-plugin-body-over")})))},t.prototype.addDroper=function(t,e,o,n){var i=this;if(e){var r=$("<div style='display:none;' class='pt-plugin-droper'/>");r.appendTo(this.buttonBar),r.on("dragover",(function(t){t.stopPropagation(),t.preventDefault(),i.buttonBar.addClass("pt-plugin-body-over")})),r.on("drop",(function(t){console.log(t),t.stopPropagation(),t.preventDefault(),i.hideDroper();try{(r=JSON.parse(t.originalEvent.dataTransfer.getData("text/plain")))&&r.url&&e.call(i,r,t,o,n)}catch(s){var r;(r=t.originalEvent.dataTransfer.getData("text/plain"))&&(r={url:r},e.call(i,r,t,o,n))}})),r.on("dragleave dragend",(function(t){t.stopPropagation(),t.preventDefault(),i.hideDroper(),i.buttonBar.removeClass("pt-plugin-body-over")})),r.offset(t.position())}},t.prototype.hideDroper=function(){$(".pt-plugin-droper").hide()},t.prototype.showDroper=function(){$(".pt-plugin-droper").show()},t.prototype.initBrowserEvent=function(){var t=this;chrome.runtime.onMessage.addListener((function(e,o,i){switch(y.debugMode&&console.log("content.onMessage",e),e.action){case n.a.showMessage:var r=t.showNotice(e.data);i&&i(r);break;case n.a.hideMessage:t.hideMessage(e.data);break;case n.a.serviceStoped:t.backgroundServiceIsStoped=!0}}))},t.prototype.checkLocationURL=function(){location.href!=this.locationURL&&(this.locationURL=location.href,this.initPages())},t.prototype.initPageSelector=function(){var t=this;return new Promise((function(e,o){t.call(n.a.getSiteSelectorConfig,{host:t.site.host,name:location.pathname}).then((function(o){t.pageSelector=o,e()})).catch((function(){t.call(n.a.getSiteSelectorConfig,{host:t.site.host,name:"common"}).then((function(o){t.pageSelector=o,e()})).catch((function(){e()}))}))}))},t.prototype.getFieldValue=function(t,e){var o;return void 0===t&&(t=""),void 0===e&&(e=$("body")),console.log("getFieldValue",t),this.pageSelector&&this.pageSelector.fields&&(o=this.pageSelector.fields[t])?this.infoParser.getFieldData(e,o,this.pageSelector):null},t}();Object.assign(window,{PTService:new T,PPF:a.a})},2:function(t,e,o){"use strict";o.d(e,"a",(function(){return l}));var n=o(7),i=o(4),r=o.n(i),s=o(5),a=o(3),c=o.n(a),u=o(6),l=new(function(){function t(){this.isExtensionMode=!1,this.browserName="",this.manifest={manifest_version:2,name:"",version:""};try{this.isExtensionMode=!!(chrome.runtime&&chrome.extension&&chrome.runtime.getManifest),this.manifest=chrome.runtime.getManifest()}catch(t){console.log("HelpFunctions: is not extension mode.",t)}this.browserName=(new u.UAParser).getBrowser().name||""}return t.prototype.getToDay=function(t){var e=new Date;t&&(e=new Date(t));var o=e.getFullYear(),n=e.getMonth()+1,i=n<10?"0"+n:n,r=e.getDate();return o+"-"+i+"-"+(r<10?"0"+r:r)},t.prototype.updateBadge=function(t){if(this.isExtensionMode)try{0==t?(chrome.browserAction.setBadgeText({text:""}),chrome.browserAction.enable()):(chrome.browserAction.setBadgeText({text:t.toString()}),chrome.browserAction.setBadgeBackgroundColor({color:"#aabbcc"}),chrome.browserAction.disable())}catch(t){console.log(t)}},t.prototype.getVersion=function(){return this.isExtensionMode?"v"+(this.manifest.version_name||this.manifest.version):"localVersion"},t.prototype.getRandomString=function(t,e){void 0===t&&(t=32),void 0===e&&(e=!1);for(var o=e?"abcdefhijkmnprstwxyz2345678ABCDEFGHJKMNPQRSTWXYZ":"abcdefghijkmnopqrstuvwxyz0123456789ABCDEFGHIJKMNOPQRSTUVWXYZ",n=o.length,i=[],r=0;r<t;r++)i.push(o.charAt(Math.floor(Math.random()*n)));return i.join("")},t.prototype.getNewId=function(){return r()((new Date).getTime().toString()+this.getRandomString()).toString()},t.prototype.showNotifications=function(t,e){void 0===e&&(e=3e3),t=Object.assign({type:"basic",iconUrl:chrome.extension.getURL("/assets/icon-128.png"),title:"PT \u52a9\u624b Plus",priority:0,message:""},t);var o=Math.floor(99999*Math.random())+"";chrome.notifications.create(o,t,(function(t){o=t})),setTimeout((function(){chrome.notifications.clear(o,(function(){}))}),e)},t.prototype.removeDuplicateQueryString=function(t){var e,o=[],n="",i=/([^&=]+)=([^&]*)/g,r="",s=t.indexOf("?");if(-1!==s){for(r=t.substr(0,s+1),n=t.substr(s+1);e=i.exec(n);){var a=e[1]+"="+e[2];o.includes(a)||o.push(a)}return r+o.join("&")}return t},t.prototype.removeQueryStringFromValue=function(t,e){var o,n=[],i="",r=/([^&=]+)=([^&]*)/g,s="",a=t.indexOf("?");if(-1!==a){for(s=t.substr(0,a+1),i=t.substr(a+1);o=r.exec(i);){var c=o[1]+"="+o[2];o[2]!==e&&n.push(c)}return s+n.join("&")}return t},t.prototype.removeQueryStringFields=function(t,e){var o,n=[],i="",r=/([^&=]+)=([^&]*)/g,s="",a=t.indexOf("?");if(-1!==a){for(s=t.substr(0,a+1),i=t.substr(a+1);o=r.exec(i);){var c=o[1]+"="+o[2];e.includes(o[1])||n.push(c)}return s+n.join("&")}return t},t.prototype.clone=function(t){return JSON.parse(JSON.stringify(t))},t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];console.log.apply(console,Object(n.a)([(new Date).toLocaleString()],t))},t.prototype.showContextMenu=function(t,e){try{s.show(t,e),$(".basicContext").css({left:"-=20px",top:"+=10px"})}catch(t){}},t.prototype.getCleaningURL=function(t){return this.removeQueryStringFields(t,["hit","cmtpage","page"])},t.prototype.checkPermissions=function(t){return new Promise((function(e,o){chrome&&chrome.permissions?chrome.permissions.contains({permissions:t},(function(t){!0===t?e(!0):o({success:!1})})):o({success:!1})}))},t.prototype.requestPermissions=function(t){return new Promise((function(e,o){chrome&&chrome.permissions?chrome.permissions.request({permissions:t},(function(t){!0===t?e(!0):o({success:!1})})):o({success:!1})}))},t.prototype.usePermissions=function(t,e,o){var n=this;return void 0===e&&(e=!1),void 0===o&&(o=""),new Promise((function(i,r){n.checkPermissions(t).then((function(t){i(t)})).catch((function(){var s=!0;e&&(s=confirm(o)),s?n.requestPermissions(t).then((function(t){i(t)})).catch((function(t){r(t)})):r({success:!1})}))}))},t.prototype.getSiteFromHost=function(t,e){var o=[];e.sites&&o.push.apply(o,e.sites),e.system&&e.system.publicSites&&o.push.apply(o,e.system.publicSites);var n=o.find((function(e){var o,n=[e.url].concat(e.cdn,null===(o=e.formerHosts)||void 0===o?void 0:o.map((function(t){return"//"+t})));return e.host==t||n.join("").indexOf("//"+t)>-1}));return n?this.clone(n):null},t.prototype.getNewBackupFileName=function(){return"PT-Plugin-Plus-Backup-"+c()().format("YYYY-MM-DD_HH-mm-ss")+".zip"},t.prototype.replaceKeys=function(t,e,o){if(void 0===o&&(o=""),!t)return t;var n=t;for(var i in e)if(e.hasOwnProperty(i)){var r=e[i],s="$"+i+"$";o&&(s="$"+o+"."+i+"$"),n=n.replace(s,r)}return n},t.prototype.checkOptionalPermission=function(t){return!!(this.isExtensionMode&&this.manifest&&this.manifest.optional_permissions)&&this.manifest.optional_permissions.includes(t)},t.prototype.transformTime=function(t,e){if(!e||!t)return t;var o=t;/^(\d){10}$/.test(o+"")&&(o=1e3*parseInt(o+""));var n=c()(o).format("YYYY-MM-DDTHH:mm:ss");return o=new Date(""+n+e).getTime()},t}())},9:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return InfoParser}));var _interface_common__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),dayjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3),dayjs__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(dayjs__WEBPACK_IMPORTED_MODULE_1__),_service_public__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(2),dayjs_plugin_customParseFormat__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(10),dayjs_plugin_customParseFormat__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(dayjs_plugin_customParseFormat__WEBPACK_IMPORTED_MODULE_3__),dayjs_plugin_advancedFormat__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(11),dayjs_plugin_advancedFormat__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(dayjs_plugin_advancedFormat__WEBPACK_IMPORTED_MODULE_4__);dayjs__WEBPACK_IMPORTED_MODULE_1___default.a.extend(dayjs_plugin_customParseFormat__WEBPACK_IMPORTED_MODULE_3___default.a),dayjs__WEBPACK_IMPORTED_MODULE_1___default.a.extend(dayjs_plugin_advancedFormat__WEBPACK_IMPORTED_MODULE_4___default.a);var InfoParser=function(){function InfoParser(t){this.service=t}return InfoParser.prototype.getResult=function(t,e){var o={};if(t)for(var n in e.fields)if(e.fields.hasOwnProperty(n)){var i=e.fields[n],r=this.getFieldData(t,i,e);null!=r&&(o[n]=r)}return o},InfoParser.prototype.debug=function(){for(var t,e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];this.service?(t=this.service).debug.apply(t,e):_service_public__WEBPACK_IMPORTED_MODULE_2__.a.debug.apply(_service_public__WEBPACK_IMPORTED_MODULE_2__.a,e)},InfoParser.prototype.getFieldData=function(content,config,rule){var _this=this,query,selectorIndex=0,selectors=[];if("string"==typeof config.selector)selectors.push(config.selector);else{if(!config.selector||!config.selector.length)return void 0===config.value?null:config.value;selectors=config.selector}selectors.some((function(selector){try{switch(rule.dataType){case _interface_common__WEBPACK_IMPORTED_MODULE_0__.j.JSON:if(query=""==selector?content:"["==selector.substr(0,1)?eval("content"+selector):eval("content."+selector),null!=query)return!0;break;case _interface_common__WEBPACK_IMPORTED_MODULE_0__.j.TEXT:case _interface_common__WEBPACK_IMPORTED_MODULE_0__.j.HTML:default:if(""==selector?query=content:(query=content.find(selector),0==query.length&&(query=content.filter(selector))),query.length>0)return!0}selectorIndex++}catch(t){return _this.debug("InfoParser.getFieldData.Error",selector,t.message,t.stack),!0}}));var result=null,dateTime=dayjs__WEBPACK_IMPORTED_MODULE_1___default.a,_self=this;if(null!=query)if(config.attribute||config.filters||config.switchFilters){config.attribute&&rule.dataType!=_interface_common__WEBPACK_IMPORTED_MODULE_0__.j.JSON&&(query=query.attr(config.attribute));var filters=void 0;filters=config.switchFilters?config.switchFilters[selectorIndex]||null:config.filters,filters&&filters.every((function(filter){try{query=eval(filter)}catch(t){return _this.debug("InfoParser.filter.Error",filter,t.message,t.stack),query=null,!1}return!0})),result=query}else switch(rule.dataType){case _interface_common__WEBPACK_IMPORTED_MODULE_0__.j.JSON:result=query;break;default:result=query.text().trim()}return result},InfoParser.prototype.getTotalSize=function(t){var e=0;return t.forEach((function(t){var o=t.match(/^(\d*\.?\d+)(.*[^ZEPTGMK])?([ZEPTGMK](B|iB)?)$/i);if(o){var n=parseFloat(o[1]),i=o[3].toLowerCase();switch(!0){case/ki?b/.test(i):e+=n*Math.pow(2,10);break;case/mi?b/.test(i):e+=n*Math.pow(2,20);break;case/gi?b/.test(i):e+=n*Math.pow(2,30);break;case/ti?b?/.test(i):e+=n*Math.pow(2,40);break;case/pi?b?/.test(i):e+=n*Math.pow(2,50);break;case/ei?b?/.test(i):e+=n*Math.pow(2,60);break;case/zi?b?/.test(i):e+=n*Math.pow(2,70)}}})),e},InfoParser}()}});