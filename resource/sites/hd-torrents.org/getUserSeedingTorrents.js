!function(e,t){let s=e.site.activeURL+e.rule.page;s=s.replace("$user.id$",e.userInfo.id).replace("$user.name$",e.userInfo.name).replace("://","****").replace(/\/\//g,"/").replace("****","://"),new class{constructor(e,t){this.options=e,this.dataURL=t,this.body=null,this.rawData="",this.pageInfo={count:0,current:0},this.result={seedingSize:0},this.load()}done(){this.options.resolve(this.result)}parse(){const e=(new DOMParser).parseFromString(this.rawData,"text/html");this.body=$(e).find("body"),this.getPageInfo();let s=new t.InfoParser(t.service).getResult(this.body,this.options.rule);s&&(this.result.seedingSize+=s.seedingSize),this.pageInfo.current<this.pageInfo.count?(this.pageInfo.current++,this.load()):this.done()}getPageInfo(){if(this.pageInfo.count>0)return;const e=this.body.find("a[href*='activepage']:contains('1'):last").attr("href");this.pageInfo.count=e?parseInt(e.getQueryString("activepage")):1}load(){let e=this.dataURL;this.pageInfo.current>0&&(e+="&activepage="+this.pageInfo.current),$.get(e).done((e=>{this.rawData=e,this.parse()})).fail((()=>{this.done()}))}}(e,s)}(_options,_self);