!function(e){console.log("this is browse.js");class t extends window.NexusPHPCommon{init(){this.initButtons(),this.initFreeSpaceButton(),PTService.pageApp=this}initButtons(){this.initListButtons(!1)}getDownloadURLs(){let t=PTService.site.url;"/"!=t.substr(-1)&&(t+="/");let i=e("a[href*='download'][onclick!='return show_confirm();']").toArray(),s=e.map(i,(i=>{let s=e(i).attr("href");return s&&"http"!==s.substr(0,4)&&(s=`${t}${s}`+(PTService.site.passkey?"&passkey="+PTService.site.passkey:"")),s}));return 0==i.length?"获取下载链接失败，未能正确定位到链接":s}getDownloadURL(e){return`https://${PTService.site.host}/download.php?id=${e}`+(PTService.site.passkey?"&passkey="+PTService.site.passkey:"")}call(e,t){return new Promise(((i,s)=>{e===PTService.action.downloadFromDroper&&this.downloadFromDroper(t,(()=>{i()}))}))}downloadFromDroper(e,t){"string"==typeof e&&(e={url:e,title:""});let i=e.url.getQueryString("id"),s=this.getDownloadURL(i);s?this.sendTorrentToDefaultClient(s).then((e=>{t(e)})).catch((e=>{t(e)})):t()}confirmWhenExceedSize(){return this.confirmSize(e("div.visitedlinks").find("div[class='torrenttable']:contains('MB'),div[class='torrenttable']:contains('GB'),div[class='torrenttable']:contains('TB')"))}}(new t).init()}(jQuery);