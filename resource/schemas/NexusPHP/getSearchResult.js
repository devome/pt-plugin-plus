!function(t,e){let r=new class{constructor(){this.haveData=!1,/takelogin\.php|<form action="\?returnto=/.test(t.responseText)?t.status=ESearchResultParseStatus.needLogin:(t.isLogged=!0,/没有种子|No [Tt]orrents?|Your search did not match anything|用准确的关键字重试/.test(t.responseText)?t.status=ESearchResultParseStatus.noTorrents:(this.haveData=!0,this.site=t.site))}getResult(){if(!this.haveData)return[];let r=t.site,s=PTServiceFilters.parseURL(r.url),i=t.resultSelector||"table.torrents:last";i=i.replace("> tbody > tr","");let a=t.page.find(i),l=a.find("> tbody > tr");if(0==l.length)return t.status=ESearchResultParseStatus.torrentTableIsEmpty,[];let n=[],h=a.find("> thead > tr > th"),o=0;0==h.length&&(o=1,h=l.eq(0).find("th,td"));let d={time:-1,size:-1,seeders:-1,leechers:-1,completed:-1,comments:-1,author:h.length-1,category:-1};r.url.lastIndexOf("/")!=r.url.length-1&&(r.url+="/");for(let t=0;t<h.length;t++){let e=h.eq(t),r=e.text();e.find(".comments").length?(d.comments=t,d.author=t==d.author?-1:d.author):e.find("img.time,div.date,div.icons.time").length?(d.time=t,d.author=t==d.author?-1:d.author):e.find("img.size,div[alt='size'],div.icons.size").length?(d.size=t,d.author=t==d.author?-1:d.author):e.find("img.seeders,div[alt='seeders'],div.icons.seeders").length?(d.seeders=t,d.author=t==d.author?-1:d.author):e.find("img.leechers,div[alt='leechers'],div.icons.leechers").length?(d.leechers=t,d.author=t==d.author?-1:d.author):e.find("img.snatched,div[alt='snatched'],div.icons.snatched").length?(d.completed=t,d.author=t==d.author?-1:d.author):/(cat|类型|類型|分类|分類|Тип)/gi.test(r)&&(d.category=t,d.author=t==d.author?-1:d.author)}t.entry.fieldIndex&&(d=Object.assign(d,t.entry.fieldIndex));try{for(let i=o;i<l.length;i++){const a=l.eq(i);"zhiding"===a.attr("id")&&a.removeAttr("id");let h=a.find(">td"),o=this.getTitle(a,h,d);if(0==o.length)continue;let u=o.attr("href");u&&"//"===u.substr(0,2)?u=`${s.protocol}://${u}`:u&&"http"!==u.substr(0,4)&&(u=`${r.url}${u}`);let c=this.getDownloadLink(a,u);if(c&&"//"===c.substr(0,2)?c=`${s.protocol}://${c}`:c&&"http"!==c.substr(0,4)&&(c=`${r.url}${c}`),!c)continue;c+=r&&r.passkey?"&passkey="+r.passkey:"";let g={title:o.attr("title")||o.text(),subTitle:this.getSubTitle(o,a),link:u,url:c,size:this.getFieldValue(a,h,d,"size")||0,time:-1==d.time?"":this.getTime(h.eq(d.time)),author:this.getFieldValue(a,h,d,"author")||"",seeders:this.getFieldValue(a,h,d,"seeders")||0,leechers:this.getFieldValue(a,h,d,"leechers")||0,completed:this.getFieldValue(a,h,d,"completed")||0,comments:this.getFieldValue(a,h,d,"comments")||0,site:r,tags:e.getRowTags(this.site,a),entryName:t.entry.name,category:-1==d.category?null:this.getFieldValue(a,h,d,"category")||this.getCategory(h.eq(d.category)),progress:e.getFieldValue(r,a,"progress"),status:e.getFieldValue(r,a,"status"),imdbId:this.getIMDbId(a)};n.push(g)}}catch(e){t.status=ESearchResultParseStatus.parseError,t.errorMsg=e.stack}return n}getFieldValue(t,r,s,i,a){let l=t,n=null;r&&s&&void 0!==s[i]&&-1!==s[i]&&(n=r.eq(s[i]),l=n||t);let h=e.getFieldValue(this.site,l,i);if(!h&&n){if(a)return n;h=n.text()}return h}getTime(e){let r=e.find("span[title],time[title]").attr("title");return r||(r=$("<span>").html(e.html().replace("<br>"," ")).text()),["pt.sjtu.edu.cn","piggo.me"].some((e=>e===t.site.host))&&r.match(/\d+[分时天月年]/g)&&(r=Date.now()-this._parseTime(r),r=new Date(r).toLocaleString("zh-CN",{hour12:!1}).replace(/\//g,"-")),r||""}_parseTime(t){const e=t.match(/\d+[分时天月年]/g);let r=0;return e.forEach((t=>{const e=t.match(/(\d+)([分时天月年])/),s=parseInt(e[1]),i=e[2];switch(!0){case"分"===i:r+=s;break;case"时"===i:r+=60*s;break;case"天"===i:r+=60*s*24;break;case"月"===i:r+=60*s*24*30;break;case"年"===i:r+=60*s*24*365}})),60*r*1e3}getTitle(r,s,i){let a=this.getFieldValue(r,s,i,"title",!0)||r.find("a[href*='hit'][title]:not(a[href*='comment'])").first();if("string"==typeof a)return a;0==a.length&&(a=r.find("a[href*='hit']:has(b)").first()),0==a.length&&"u2.dmhy.org"===t.site.host&&(a=r.find("a.tooltip[href*='hit']").first());let l=a.find("span.__cf_email__");return l.length>0&&l.each(((t,r)=>{$(r).replaceWith(e.cfDecodeEmail($(r).data("cfemail")))})),a}getIMDbId(t){let r=e.getFieldValue(this.site,t,"imdbId");if(r)return r;try{let e=t.find("a[href*='imdb.com/title/tt']").first().attr("href");if(e&&(r=e.match(/(tt\d+)/),r))return r[0]}catch(t){return console.log(t),null}return null}getSubTitle(r,s){let i=e.getFieldValue(this.site,s,"subTitle");if(i)return i;try{if(i=r.parent().html().split("<br>"),i&&i.length>1)i=$("<span>").html(i[i.length-1]).text();else switch(t.site.host){case"hdchina.org":r.parent().next().is("h4")&&(i=r.parent().next().text());break;case"kp.m-team.cc":case"xp.m-team.cc":case"ap.m-team.cc":i=(r=s.find("a[href*='hit'][title]").last()).parent().html().split("<br>"),i=$("<span>").html(i[i.length-1]).text();break;case"u2.dmhy.org":i=$(".torrentname > tbody > tr:eq(1)",s).find(".tooltip").text();break;case"whu.pt":case"hudbt.hust.edu.cn":i=$("h3",s).text();break;default:i=""}return i||""}catch(t){return""}}getDownloadLink(e,r){let s;switch(t.site.host){case"hdsky.me":{let t=e.find('form[action*="download.php"]:eq(0)');if(t.length>0){s=t.attr("action");break}}default:{let t=e.find("img.download").parent();s=t.length?"A"!==t.get(0).tagName?`download.php?id=${r.getQueryString("id")}`:t.attr("href"):`download.php?id=${r.getQueryString("id")}`,s+="&https=1"}}return s}getCategory(e){let r={name:"",link:""},s=e.find("a:first"),i=s.find("img:first");return s.length&&(r.link=s.attr("href"),"http"!==r.link.substr(0,4)&&(r.link=t.site.url+r.link)),i.length?r.name=i.attr("title")||i.attr("alt"):r.name=s.text(),r}}(t);t.results=r.getResult(),console.log(t.results)}(options,options.searcher);