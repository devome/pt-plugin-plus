!function(e){console.log("this is torrent.js");class t extends window.NexusPHPCommon{init(){this.initButtons(),this.initFreeSpaceButton(),PTService.pageApp=this}initButtons(){this.initListButtons()}getDownloadURLs(){let t=PTService.filters.parseURL(location.href),i=PTService.getSiteFromHost(t.host),s=PTService.getFieldValue("downloadURLs");if(!s){let t=e("a[href*='download.php']").toArray();if(0===t.length&&(t=e(".torrentname a[href*='details.php']").toArray()),0===t.length)return this.t("getDownloadURLsFailed");s=e.map(t,(t=>{let s=e(t).attr("href").replace(/details\.php/gi,"download.php");if(s){-1===s.indexOf("passkey=")&&PTService.site.passkey&&(s+="&passkey="+PTService.site.passkey),s&&-1===s.indexOf("https=1")&&!PTService.site.disableHttps&&(s+="&https=1");try{i&&"HDChina"===i.name&&(s+=`&uid=${i.user.id}`)}catch{}}return s}))}return s&&(s=s.map((e=>this.getFullURL(e)))),s}confirmWhenExceedSize(){return this.confirmSize(e(".torrents").find("td:contains('MB'),td:contains('GB'),td:contains('TB'),td:contains('MiB'),td:contains('GiB'),td:contains('TiB')"))}getDroperURL(e){let t=PTService.site.url;if("/"!=t.substr(-1)&&(t+="/"),!e.getQueryString)return PTService.showNotice({msg:"系统依赖函数（getQueryString）未正确加载，请尝试刷新页面或重新启用插件。"}),null;if(-1===e.indexOf("download.php")){let i=e.getQueryString("id");e=i?t+"download.php?id="+i+(PTService.site.passkey?"&passkey="+PTService.site.passkey:"")+(PTService.site.disableHttps?"":"&https=1"):""}return e}}(new t).init()}(jQuery);