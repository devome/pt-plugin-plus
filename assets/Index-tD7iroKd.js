import{V as l,n as c,P as d}from"./index-CFTjSAoW.js";const h=l.extend({data(){return{rules:{require:[a=>!!a||"!"]},pagination:{rowsPerPage:-1},haveError:!1,haveSuccess:!1,successMsg:"",errorMsg:"",isValid:!1,checked:[],sites:[],selected:[],loading:!1}},props:{option:Object,initSites:{type:Array}},watch:{successMsg(){this.haveSuccess=this.successMsg!=""},errorMsg(){this.haveError=this.errorMsg!=""},initSites(){this.loading=!0,this.selected=[],this.sites=this.initSites,this.sites.forEach(a=>{a.enabled&&this.selected.push(a)}),this.loading=!1,this.change(!1)},selected(){this.sites.forEach(a=>{a.enabled=!1}),this.selected.forEach(a=>{a.enabled=!0}),this.change()}},methods:{change(a=!0){if(this.loading)return;let e=[];this.sites.forEach(t=>{if(t.enabled){let s=[];t.searchEntry&&t.searchEntry.forEach(i=>{i.enabled&&s.push(i.id||i.name)}),e.push({host:t.host,siteName:t.name,entry:s})}}),a&&this.$emit("change",{id:this.option.id,name:this.option.name,range:e}),this.checked=e},selectAll(a){this.sites.forEach(e=>{e.enabled=a,e.searchEntry&&e.searchEntry.forEach(t=>{t.enabled=a})}),this.change()},getSiteEntry(a,e){let t=this.sites.find(s=>s.host===a);if(t&&t.searchEntry){let s=[],i=t.searchEntry;if(e.forEach(o=>{let n=i.findIndex(r=>r.id==o||r.name==o);i[n]&&i[n].name&&s.push(i[n].name)}),s.length>0)return" -> "+s.join(";")}return""}},created(){},computed:{selectedAll(){return this.checked.length===this.sites.length},selectedSome(){return this.checked.length>0&&!this.selectedAll},selectAllIcon(){return this.selectedAll?"check_box":this.selectedSome?"indeterminate_check_box":"check_box_outline_blank"},headers(){return[{text:this.$t("settings.searchSolution.editor.headers.name"),align:"left",value:"name"}]}}});var u=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"search-solution-editor"},[t("v-card",{staticClass:"body",attrs:{color:e.$vuetify.dark?"":"grey lighten-4"}},[t("v-card-text",[t("v-form",{staticClass:"content",model:{value:e.isValid,callback:function(s){e.isValid=s},expression:"isValid"}},[t("v-layout",{attrs:{row:""}},[t("v-flex",{attrs:{xs3:""}},[t("v-subheader",[e._v(e._s(e.$t("settings.searchSolution.editor.name")))])],1),t("v-flex",{attrs:{xs9:""}},[t("v-text-field",{attrs:{label:e.$t("settings.searchSolution.editor.name"),placeholder:e.$t("settings.searchSolution.editor.name"),required:"",rules:e.rules.require},on:{change:function(s){return e.change(!0)}},model:{value:e.option.name,callback:function(s){e.$set(e.option,"name",s)},expression:"option.name"}})],1)],1),t("v-layout",{attrs:{row:""}},[t("v-flex",{attrs:{xs3:""}},[t("v-subheader",[e._v(e._s(e.$t("settings.searchSolution.editor.range")))])],1),t("v-flex",{attrs:{xs9:""}},[t("div",{staticClass:"list"},[t("v-list",{attrs:{dense:""}},[t("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.sites,pagination:e.pagination,"item-key":"host","select-all":"","hide-actions":""},on:{"update:pagination":function(s){e.pagination=s}},scopedSlots:e._u([{key:"items",fn:function(s){return[t("tr",[t("td",{staticStyle:{width:"20px"}},[t("v-checkbox",{attrs:{primary:"","hide-details":""},model:{value:s.selected,callback:function(i){e.$set(s,"selected",i)},expression:"props.selected"}})],1),t("td",[t("div",[e._v(e._s(s.item.name))]),s.item.enabled?t("v-container",{staticClass:"ma-0 pa-0 ml-4",attrs:{fluid:""}},[t("v-layout",{staticClass:"ma-0 pa-0",attrs:{row:"",wrap:""}},e._l(s.item.searchEntry,function(i,o,n){return t("v-flex",{key:n,staticClass:"ma-0 pa-0",attrs:{xs3:""}},[t("v-checkbox",{staticClass:"ma-0 pa-0 caption",attrs:{label:i.name},on:{change:function(r){return e.change(!0)}},model:{value:i.enabled,callback:function(r){e.$set(i,"enabled",r)},expression:"item.enabled"}})],1)}),1)],1):e._e()],1)])]}}]),model:{value:e.selected,callback:function(s){e.selected=s},expression:"selected"}})],1)],1)])],1)],1),t("v-divider",{staticClass:"mb-2"}),t("div",{staticClass:"bottom"},[e._l(e.checked,function(s,i){return[t("v-chip",{key:i,staticClass:"mr-2 pl-0",attrs:{label:"",color:"blue-grey","text-color":"white",small:"",disabled:""}},[e._v(e._s(s.siteName)+e._s(e.getSiteEntry(s.host,s.entry)))])]})],2)],1)],1),t("v-snackbar",{attrs:{absolute:"",top:"",timeout:3e3,color:"error"},model:{value:e.haveError,callback:function(s){e.haveError=s},expression:"haveError"}},[e._v(e._s(e.errorMsg))]),t("v-snackbar",{attrs:{absolute:"",bottom:"",timeout:3e3,color:"success"},model:{value:e.haveSuccess,callback:function(s){e.haveSuccess=s},expression:"haveSuccess"}},[e._v(e._s(e.successMsg))])],1)},v=[],m=c(h,u,v,!1,null,null,null,null);const f=m.exports,p=l.extend({components:{Editor:f},data(){return{show:!1,valid:!1,sites:[],defaultItem:{id:"",name:"",range:[]},newValue:{}}},props:{value:Boolean,option:Object},model:{prop:"value",event:"change"},watch:{show(){this.$emit("change",this.show)},value(){this.show=this.value,this.show&&this.option&&(this.defaultItem=Object.assign({},this.option))},option(){console.log("option change",this.option),this.resetSites()}},methods:{save(){this.newValue&&(this.$emit("save",this.newValue),this.resetSites()),this.show=!1},cancel(){this.show=!1},change(a){console.log(a),this.newValue=a,this.valid=!!a.name},resetSites(){let a=d.clone(this.$store.state.options.sites);this.sites=[],a.forEach(e=>{this.sites.push(Object.assign({},e))}),console.log("resetSites",this.option,this.sites),this.option&&this.option.id&&this.option.range.forEach(e=>{let t=this.sites.findIndex(s=>s.host===e.host);if(t>-1){let s=this.sites[t];s.enabled=!0;let i=s.searchEntry;i&&(i.forEach((o,n)=>{i[n].enabled=!1}),e.entry&&e.entry.forEach(o=>{let n=i.findIndex(r=>r.id==o||r.name==o);i[n]&&i[n].name&&(i[n].enabled=!0)}))}})}},created(){this.resetSites()}});var _=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("v-dialog",{attrs:{fullscreen:""},model:{value:e.show,callback:function(s){e.show=s},expression:"show"}},[t("v-card",[t("v-card-title",{staticClass:"headline blue-grey darken-2",staticStyle:{color:"white"}},[e._v(e._s(e.$t("settings.searchSolution.edit.title")))]),t("v-card-text",{staticClass:"body"},[t("Editor",{attrs:{option:e.defaultItem,initSites:e.sites},on:{change:e.change}})],1),t("v-divider"),t("v-card-actions",{staticClass:"pa-3 toolber"},[t("v-spacer"),t("v-btn",{attrs:{flat:"",color:"error"},on:{click:e.cancel}},[t("v-icon",[e._v("cancel")]),t("span",{staticClass:"ml-1"},[e._v(e._s(e.$t("common.cancel")))])],1),t("v-btn",{attrs:{flat:"",color:"success",disabled:!e.valid},on:{click:e.save}},[t("v-icon",[e._v("check_circle_outline")]),t("span",{staticClass:"ml-1"},[e._v(e._s(e.$t("common.ok")))])],1)],1)],1)],1)},g=[],b=c(p,_,g,!1,null,"350c6803",null,null);const x=b.exports,S=l.extend({components:{EditItem:x},data(){return{showAddDialog:!1,showEditDialog:!1,itemDuplicate:!1,selected:[],selectedItem:{},pagination:{rowsPerPage:-1},items:[],dialogRemoveConfirm:!1,options:{}}},methods:{add(){this.selectedItem={},this.showEditDialog=!0},updateItem(a){this.$store.dispatch("updateSearchSolution",a),this.pagination.rowsPerPage=0,this.pagination.rowsPerPage=-1},edit(a){if(!this.options.searchSolutions)return;let e=this.options.searchSolutions.findIndex(t=>a.id===t.id);e!==-1&&(this.selectedItem=d.clone(this.options.searchSolutions[e]),this.showEditDialog=!0)},remove(){this.dialogRemoveConfirm=!1,this.$store.dispatch("removeSearchSolution",this.selectedItem),this.selectedItem={}},removeConfirm(a){this.selectedItem=a,this.dialogRemoveConfirm=!0},removeSelected(){confirm(this.$t("settings.searchSolution.index.removeSelectedConfirm").toString())&&(console.log(this.selected),this.selected.forEach(a=>{this.$store.dispatch("removeSearchSolution",a)}),this.selected=[])},getSiteEntry(a,e){let t=this.options.sites.find(s=>s.host===a);if(t&&t.searchEntry){let s=[],i=t.searchEntry;if(e.forEach(o=>{let n=i.findIndex(r=>r.id==o||r.name==o);i[n]&&i[n].name&&s.push(i[n].name)}),s.length>0)return" -> "+s.join(";")}return""},editSearchEntry(a){this.$router.push({name:"set-site-search-entry",params:{host:a}})}},created(){this.options=this.$store.state.options,this.items=this.$store.state.options.searchSolutions},computed:{headers(){return[{text:this.$t("settings.searchSolution.index.headers.name"),align:"left",value:"name"},{text:this.$t("settings.searchSolution.index.headers.range"),align:"left",value:"range"},{text:this.$t("settings.searchSolution.index.headers.action"),value:"name",sortable:!1}]}}});var k=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"set-download-clients"},[t("v-alert",{attrs:{value:!0,type:"info"}},[e._v(e._s(e.$t("settings.searchSolution.index.title")))]),t("v-card",[t("v-card-title",[t("v-btn",{attrs:{color:"success"},on:{click:e.add}},[t("v-icon",{staticClass:"mr-2"},[e._v("add")]),e._v(" "+e._s(e.$t("common.add"))+" ")],1),t("v-btn",{attrs:{color:"error",disabled:e.selected.length==0},on:{click:e.removeSelected}},[t("v-icon",{staticClass:"mr-2"},[e._v("remove")]),e._v(" "+e._s(e.$t("common.remove"))+" ")],1),t("v-btn",{attrs:{color:"info",href:"https://github.com/pt-plugins/PT-Plugin-Plus/wiki/search-solution-definition",target:"_blank",rel:"noopener noreferrer nofollow"}},[t("v-icon",{staticClass:"mr-2"},[e._v("help")]),e._v(" "+e._s(e.$t("settings.searchSolution.index.help"))+" ")],1),t("v-spacer"),t("v-text-field",{staticClass:"search",attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""}})],1),t("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.items,pagination:e.pagination,"item-key":"name","select-all":""},on:{"update:pagination":function(s){e.pagination=s}},scopedSlots:e._u([{key:"items",fn:function(s){return[t("td",{staticStyle:{width:"20px"}},[t("v-checkbox",{attrs:{primary:"","hide-details":""},model:{value:s.selected,callback:function(i){e.$set(s,"selected",i)},expression:"props.selected"}})],1),t("td",[t("a",{on:{click:function(i){return e.edit(s.item)}}},[e._v(e._s(s.item.name))])]),t("td",[e._l(s.item.range,function(i,o){return[t("v-chip",{key:o,staticClass:"mr-2 pl-0",attrs:{label:"",color:"blue-grey","text-color":"white",small:""},on:{click:function(n){return e.editSearchEntry(i.host)}}},[e._v(e._s(i.siteName)+e._s(e.getSiteEntry(i.host,i.entry)))])]})],2),t("td",[t("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(i){return e.edit(s.item)}}},[e._v("edit")]),t("v-icon",{attrs:{small:"",color:"error"},on:{click:function(i){return e.removeConfirm(s.item)}}},[e._v("delete")])],1)]}}]),model:{value:e.selected,callback:function(s){e.selected=s},expression:"selected"}})],1),t("EditItem",{on:{save:e.updateItem},model:{value:e.showAddDialog,callback:function(s){e.showAddDialog=s},expression:"showAddDialog"}}),t("EditItem",{attrs:{option:e.selectedItem},on:{save:e.updateItem},model:{value:e.showEditDialog,callback:function(s){e.showEditDialog=s},expression:"showEditDialog"}}),t("v-dialog",{attrs:{width:"300"},model:{value:e.dialogRemoveConfirm,callback:function(s){e.dialogRemoveConfirm=s},expression:"dialogRemoveConfirm"}},[t("v-card",[t("v-card-title",{staticClass:"headline red lighten-2"},[e._v(e._s(e.$t("settings.searchSolution.index.removeConfirmTitle")))]),t("v-card-text",[e._v(e._s(e.$t("settings.searchSolution.index.removeConfirm")))]),t("v-divider"),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{flat:"",color:"info"},on:{click:function(s){e.dialogRemoveConfirm=!1}}},[t("v-icon",[e._v("cancel")]),t("span",{staticClass:"ml-1"},[e._v(e._s(e.$t("common.cancel")))])],1),t("v-btn",{attrs:{color:"error",flat:""},on:{click:e.remove}},[t("v-icon",[e._v("check_circle_outline")]),t("span",{staticClass:"ml-1"},[e._v(e._s(e.$t("common.ok")))])],1)],1)],1)],1),t("v-snackbar",{attrs:{top:"",timeout:3e3,color:"error"},model:{value:e.itemDuplicate,callback:function(s){e.itemDuplicate=s},expression:"itemDuplicate"}},[e._v(e._s(e.$t("settings.searchSolution.index.itemDuplicate")))])],1)},$=[],E=c(S,k,$,!1,null,"661ad192",null,null);const w=E.exports;export{w as default};
