import{V as l,E as i,F as c,v as r,b as m,n as v}from"./index-C2uF3Qql.js";const n=new m,d=l.extend({data(){return{selected:[],selectedItem:{},pagination:{rowsPerPage:10,sortBy:"time",descending:!0},items:[],dialogRemoveConfirm:!1,options:this.$store.state.options,errorMsg:"",haveError:!1,haveSuccess:!1,successMsg:"",filterKey:""}},methods:{clear(){confirm(this.$t("common.clearConfirm").toString())&&n.sendRequest(i.clearSystemLogs).then(o=>{this.items=o})},remove(){n.sendRequest(i.removeSystemLogs,null,[this.selectedItem]).then(o=>{console.log("removeSystemLogs",o),this.items=o}),this.dialogRemoveConfirm=!1},removeConfirm(o){this.selectedItem=o,this.dialogRemoveConfirm=!0},getSystemLogs(){n.sendRequest(i.getSystemLogs).then(o=>{this.items=o})},save(){const o=window.Blob,e=new o([JSON.stringify(this.items)],{type:"text/plain"});c.saveAs(e,"PT-Plugin-Plus-System-Logs.json")},updatePagination(o){console.log(o),this.$store.dispatch("updatePagination",{key:r.systemLogs,options:o})},getErrorDetail(o){let e="";if(o)try{e=JSON.stringify(o)}catch{e=""}return e}},created(){this.getSystemLogs(),this.pagination=this.$store.getters.pagination(r.systemLogs,{rowsPerPage:10,sortBy:"time",descending:!0})},computed:{headers(){return[{text:this.$t("systemLog.headers.module"),align:"left",value:"module"},{text:this.$t("systemLog.headers.event"),align:"left",value:"event"},{text:this.$t("systemLog.headers.time"),align:"left",value:"time"},{text:this.$t("systemLog.headers.msg"),align:"left",value:"msg"},{text:this.$t("systemLog.headers.action"),value:"name",sortable:!1}]}}});var g=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"system-logs"},[t("v-alert",{attrs:{value:!0,type:"info"}},[e._v(e._s(e.$t("systemLog.title")))]),t("v-card",[t("v-card-title",[t("v-btn",{attrs:{color:"error",disabled:e.selected.length==0}},[t("v-icon",{staticClass:"mr-2"},[e._v("remove")]),e._v(" "+e._s(e.$t("common.remove"))+" ")],1),t("v-btn",{attrs:{color:"error",disabled:e.items.length==0},on:{click:e.clear}},[t("v-icon",{staticClass:"mr-2"},[e._v("clear")]),e._v(" "+e._s(e.$t("common.clear"))+" ")],1),t("v-btn",{attrs:{color:"success"},on:{click:e.save}},[t("v-icon",[e._v("save")]),t("span",{staticClass:"ml-1"},[e._v(e._s(e.$t("systemLog.save")))])],1),t("v-spacer"),t("v-text-field",{staticClass:"search",attrs:{"append-icon":"search",label:"Search","single-line":"","hide-details":""},model:{value:e.filterKey,callback:function(s){e.filterKey=s},expression:"filterKey"}})],1),t("v-data-table",{staticClass:"elevation-1",attrs:{search:e.filterKey,headers:e.headers,items:e.items,pagination:e.pagination,"item-key":"time","select-all":"","rows-per-page-items":e.options.rowsPerPageItems},on:{"update:pagination":[function(s){e.pagination=s},e.updatePagination]},scopedSlots:e._u([{key:"items",fn:function(s){return[t("tr",{on:{click:function(a){s.expanded=!s.expanded}}},[t("td",{staticStyle:{width:"20px"}},[t("v-checkbox",{attrs:{primary:"","hide-details":""},model:{value:s.selected,callback:function(a){e.$set(s,"selected",a)},expression:"props.selected"}})],1),t("td",[e._v(e._s(s.item.module))]),t("td",[e._v(e._s(s.item.event))]),t("td",[e._v(e._s(e._f("formatDate")(s.item.time,"YYYY-MM-DD HH:mm:ss")))]),t("td",[e._v(e._s(s.item.msg))]),t("td",[t("v-icon",{attrs:{small:"",color:"error"},on:{click:function(a){return e.removeConfirm(s.item)}}},[e._v("delete")])],1)])]}},{key:"expand",fn:function(s){return[t("v-card",{attrs:{flat:""}},[t("v-card-text",[e._v(e._s(e.getErrorDetail(s.item.data)))])],1)]}}]),model:{value:e.selected,callback:function(s){e.selected=s},expression:"selected"}})],1),t("v-dialog",{attrs:{width:"300"},model:{value:e.dialogRemoveConfirm,callback:function(s){e.dialogRemoveConfirm=s},expression:"dialogRemoveConfirm"}},[t("v-card",[t("v-card-title",{staticClass:"headline red lighten-2"},[e._v(e._s(e.$t("common.removeConfirmTitle")))]),t("v-card-text",[e._v(e._s(e.$t("common.removeConfirm")))]),t("v-divider"),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{flat:"",color:"info"},on:{click:function(s){e.dialogRemoveConfirm=!1}}},[t("v-icon",[e._v("cancel")]),t("span",{staticClass:"ml-1"},[e._v(e._s(e.$t("common.cancel")))])],1),t("v-btn",{attrs:{color:"error",flat:""},on:{click:e.remove}},[t("v-icon",[e._v("check_circle_outline")]),t("span",{staticClass:"ml-1"},[e._v(e._s(e.$t("common.ok")))])],1)],1)],1)],1),t("v-snackbar",{attrs:{top:"",timeout:3e3,color:"error"},model:{value:e.haveError,callback:function(s){e.haveError=s},expression:"haveError"}},[e._v(e._s(e.errorMsg))]),t("v-snackbar",{attrs:{bottom:"",timeout:3e3,color:"success"},model:{value:e.haveSuccess,callback:function(s){e.haveSuccess=s},expression:"haveSuccess"}},[e._v(e._s(e.successMsg))])],1)},u=[],f=v(d,g,u,!1,null,"48fd2e2d",null,null);const _=f.exports;export{_ as default};
